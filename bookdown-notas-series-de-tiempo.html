<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>Notas de Clase: Series de Tiempo</title>

    <meta name="author" content="Benjamín Oliva, Omar Alfaro-Rivera y Emiliano Pérez Caullieres" />
  
   <meta name="description" content="Trabajo siempre en proceso de mejora, para cualquier comentario o aclaración, contactar al correo <a href="mailto:benjov@ciencias.unam.mx" class="email">benjov@ciencias.unam.mx</a> o <a href="mailto:omarxalpha@gmail.com" class="email">omarxalpha@gmail.com</a>" />
   <meta name="generator" content="placeholder" />
  <meta property="og:title" content="Notas de Clase: Series de Tiempo" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Trabajo siempre en proceso de mejora, para cualquier comentario o aclaración, contactar al correo <a href="mailto:benjov@ciencias.unam.mx" class="email">benjov@ciencias.unam.mx</a> o <a href="mailto:omarxalpha@gmail.com" class="email">omarxalpha@gmail.com</a>" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Notas de Clase: Series de Tiempo" />
  
  <meta name="twitter:description" content="Trabajo siempre en proceso de mejora, para cualquier comentario o aclaración, contactar al correo <a href="mailto:benjov@ciencias.unam.mx" class="email">benjov@ciencias.unam.mx</a> o <a href="mailto:omarxalpha@gmail.com" class="email">omarxalpha@gmail.com</a>" />
  
  <!-- JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script>
  <script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet" />
    <script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script>
    <script src="libs/bs3compat-0.4.0/transition.js"></script>
    <script src="libs/bs3compat-0.4.0/tabs.js"></script>
    <script src="libs/bs3compat-0.4.0/bs3compat.js"></script>
    <link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet" />
    <script src="libs/bs4_book-1.0.0/bs4_book.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script>

  <!-- CSS -->
  <style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
      <link rel="stylesheet" href="style.css" />
  
</head>

<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<!--bookdown:title:start-->
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book">
    <a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Notas de Clase: Series de Tiempo</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>

      <nav aria-label="Table of contents">
        <h2>Table of contents</h2>
        <div id="book-toc"></div>

        <div class="book-extra">
          <p><a id="book-repo" href="#">View book source <i class="fab fa-github"></i></a></li></p>
        </div>
      </nav>
    </div>
  </header>

  <main class="col-sm-12 col-md-9 col-lg-7" id="content">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="introducción" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introducción</h1>
<p>Estas notas son un resumen, una síntesis comparativa y, en algunos casos, una interpretación propia de los libros de texto de Cowpertwait y Metcalfe (2009), Guerrero-Guzman (2014), Enders (2015), Franses y van Dijk (2003), Kirchgassner, Wolters, y Hassler (2012), Lutkepohl (2005), Wei (2019), entre
otros. En algunos casos se incorpora información adicional para efectos de dar contexto al tema analizado (ver sección de Bibliografía para mayores detalles).</p>
<p>El objetivo de este documento es proporcionar un conjunto de apuntes que sirva de apoyo para la clase, por ello no deben considerarse como notas exhaustivas o como un sustituto de la clase y los laboratorios. Asimismo, es deseable que los alumnos puedan aportar sus observaciones y correcciones
a estas notas, las observaciones a estas notas son esperadas y siempre serán bienvenidas y agradecidas.</p>
<p>Este es un trabajo siempre en proceso de mejora, para cualquier comentario o aclaración, contactar al correo <a href="mailto:benjov@ciencias.unam.mx" class="email">benjov@ciencias.unam.mx</a>, <a href="mailto:omarxalpha@gmail.com" class="email">omarxalpha@gmail.com</a> o <a href="mailto:emilianoprzcls@gmail.com" class="email">emilianoprzcls@gmail.com</a></p>
<p>En estas notas se estudian los temas que típicamente son incluidos como parte de un curso estándar de análisis de series de tiempo y agrega otros tantos, los cuales son:</p>
<ol style="list-style-type: decimal">
<li><p>Modelos estacionarios univaraidos: <span class="math inline">\(AR(p)\)</span>, <span class="math inline">\(MA(q)\)</span>, <span class="math inline">\(ARMA(p, q)\)</span> y <span class="math inline">\(ARIMA(p, d, q)\)</span>;</p></li>
<li><p>Modelos no estacionarios univariados y Pruebas de raíz unitaria (o pruebas para determinar que una serie es estacionaria);</p></li>
<li><p>Modelos multivariados, entre lo que se incluye a los Vectores Autoregresivos (VAR) y los procedimientos de Cointegración</p></li>
<li><p>Modelación de series univariadas con errores con heterocedasticidad y autocorrelación: ARCH(r), GARCH(n), etc.;</p></li>
<li><p>Modelos multivariados con errores con heterocedasticidad y autocorrelación: M-GARCH y M-GARCH-M;</p></li>
<li><p>Casos particulares en los que las series incluidas en un modelo multivariado no son del mismo orden de integración, conocidos como modelos
ADL.</p></li>
<li><p>Modelos de Datos Panel en series de tiempo, y</p></li>
<li><p>Modelos no lineales como los de cambios de régimen.</p></li>
</ol>
<div id="la-naturaleza-de-los-datos-de-series-de-tiempo" class="section level2" number="1.1">
<h2><span class="header-section-number">1.1</span> La naturaleza de los datos de Series de Tiempo</h2>
<p>El análisis de series de tiempo tiene muchas aplicaciones en diversos campos de la ciencia. Por ejemplo, en la economía continuamente se está expuesto a observaciones de los mercados financieros, indicadores de empleo, índices o indicadores del nivel de producción, índices de precios, etc. En otros campos de las ciencias sociales se emplea el análisis de series de tiempo para analizar
la evolución de la población, los nacimientos, o el número de personas con matriculas escolares. Finalmente, en las ciencias exactas se pueden encontrar casos como los de un epidemiólogo que puede estar interesado en el número de casos de influenza observados en algún periodo de tiempo dado y si a estos se les puede asociar con algún tipo de estacionalidad o si se trata del inicio de un fenómeno atípico.</p>
<p>La primera aproximación que se suele tener a las series de tiempo es mediante el exámen de datos puestos en una gráfica, en la cual uno de los ejes es el tiempo y el otro es el valor tomado por la variable. No obstante, en este tipo de exámenes existen dos enfoques. Por un lado, existe el efoque de la importancia del tiempo, el cual consiste en reconocer cómo lo que sucede hoy es afectado por lo que pasó ayer o, en general, en periodos pasados, o cómo lo que pasa hoy afectará los eventos futuros. Por otro lado, existe el enfoque del análisis frecuentista o de frecuencia, mediante el cual se busca reconocer la importancia que tiene para los investigadores los ciclos (estacionales, de crisis económicas, etc.)</p>
</div>
<div id="ejemplos-y-aplicaciones-de-las-series-de-tiempo" class="section level2" number="1.2">
<h2><span class="header-section-number">1.2</span> Ejemplos y aplicaciones de las Series de Tiempo</h2>
<p>Un primer ejemplo que puede ilustrar la presencia de los dos tipos de
enfoques antes mencionadas es la Figura @ref(fig:fig1). En esta figura se muestra la evolución del Indicador Global de la Actividad Económica (IGAE) en su versión global o del total de la economía y en su versión únicamente para las actividades primarias entre enero de 2002 y mayo de 2021.</p>
<div class="figure" style="text-align: center">
<img src="index_files/figure-html/fig1-1.png" alt="Indicador Global de Actividad Económica (IGAE) Global y para las Actividades Primarias (2008=100), Ene.2002 - May.2021" width="672" />
<p class="caption">
(#fig:fig1)Indicador Global de Actividad Económica (IGAE) Global y para las Actividades Primarias (2008=100), Ene.2002 - May.2021
</p>
</div>
<p>Como se puede observar, el IGAE del total de la economía muestra, principalmente, que el enfoque del tiempo es más relevante. Es decir, que existe cierta persistencia en el indicador, lo que significa que la economía crece en razón del crecimiento reportado en periodos pasados. No obstante, lo que no podemos reconocer es que los eventos futuros tienen un efecto en el desempeño de la economía hoy día. Así, no es común observar cambios abruptos
del indicador, salvo por la crisis global de 2008 y la reciente crisis causada
por la Covid-19.</p>
<div class="figure" style="text-align: center">
<img src="index_files/figure-html/fig2-1.png" alt="Índice de Confianza del Consumidor (ICC): General y resultado de ¿Cómo considera usted la situación economica del país hoy en día comparada con la de hace 12 meses? (puntos), Ene.2002-may.2021" width="672" />
<p class="caption">
(#fig:fig2)Índice de Confianza del Consumidor (ICC): General y resultado de ¿Cómo considera usted la situación economica del país hoy en día comparada con la de hace 12 meses? (puntos), Ene.2002-may.2021
</p>
</div>
<p>Por el contrario, el IGAE de las actividades primarias muestra una presencia
significativa de la importancia de la frecuencia. No pasa desapercibido que
existen muchos ciclos en la evolución del indicador. Algo que suena común
en las actividades primarias, cuya producción depende de eventos que son
ciclícos agrícolas asociados con el clima u otros factores determinantes de la
oferta de productos agrícolas. Otro factor que puede incluir en el indicador
son elementos de demanda, más que los de oferta. Por ejemplo, el consumo
de alimentos típicos de algunas temporadas del año.</p>
<p>Como segundo ejemplo, en la Figura @ref(fig:fig2) se ilustra la evolución reciente del índice de Confianza del Consumidor (ICC) en dos de sus versiones: i) el Índice global y ii) el Índice de confianza de los consumidores cuando estos consideran la situación actual en la economía en relación el año anterior.</p>
<p>Destacamos que el ICC mide las expectativas de los consumidores en
razón de la información pasada y de la esperada, segun dichos consumidores.</p>
<div class="figure" style="text-align: center">
<img src="index_files/figure-html/fig3-1.png" alt="Índice de Precios y Cotizaciones de la Bolsa Mexicana de Valores (Panel Derecho) y Tipo de Cambio para Solventar Obligaciones en Moneda Extranjera, pesos por dólar (Panel izquierdo), Ene.2002-May.2021 " width="672" />
<p class="caption">
(#fig:fig3)Índice de Precios y Cotizaciones de la Bolsa Mexicana de Valores (Panel Derecho) y Tipo de Cambio para Solventar Obligaciones en Moneda Extranjera, pesos por dólar (Panel izquierdo), Ene.2002-May.2021
</p>
</div>
<p>Así, es probable que las dos series de tiempo exhiban un gran peso para los
eventos pasados, pero a la vez, un componente -probablemente menor- del
componente de frecuencia. Esto último en razón de que los consumidores
suelen considerar en sus expectativas de consumo los periódos cíclicos de la
economía: temporadas navideñaas, pagos de colegiaturas, etc. Este sengundo
ejemplo tambien ilustra que la confianza del consumidor no necesariamente
está directamente correlacionada con el desempeño de la economía.</p>
<p>Como tercer ejemplo se muestra la evolución de dos series. La Figura @ref(fig:fig3) ilustra el comportamiento reciente de dos indicadores que son referencia para los inversionistas. Por un lado, se ubica el índice de Precios y Cotizaciones de la BMV (IPC), el cuál refleja el valor de las acciones de empresas que cotizan en la BMV y el volumen de acciones comercializadas, en conjunto. De esta forma, se ha interpretado que el IPC refleja el rendimiento del capital promedio invertido en las empresas que cotizan en la BMV.</p>
<p>Por otro lado, en la Figura @ref(fig:fig3) se presenta la evolución del Tipo de Cambio (TDC){indicador financiero que se suele utilizar como medio de reserva de valor. Esto, en razón de que el TDC es conocido como un instrumento que en momentos de crisis toma valores contraciclicos de la economía mexicana. No obstante, ambos indicadores no son comparables. Para hacerlos comparbles
en la Figura @ref(fig:fig4) se presentan en versión índice con una base en el primer mes de la muestra.</p>
<div class="figure" style="text-align: center">
<img src="index_files/figure-html/fig4-1.png" alt="Índice del índice de Precios y Cotizaciones de la Bolsa Mexicana de Valores (Panel Derecho) e Índice del Tipo de Cambio para Solventar Obligaciones en Moneda Extranjera (ambos enero de 2002 = 100), pesos por dólar (Panel izquierdo), Ene.2002-May.2021 " width="672" />
<p class="caption">
(#fig:fig4)Índice del índice de Precios y Cotizaciones de la Bolsa Mexicana de Valores (Panel Derecho) e Índice del Tipo de Cambio para Solventar Obligaciones en Moneda Extranjera (ambos enero de 2002 = 100), pesos por dólar (Panel izquierdo), Ene.2002-May.2021
</p>
</div>
<p>En la perspectiva de la Figura @ref(fig:fig4) se puede apreciar que el TDC no es tan rentable, ya que una inversión en la BMV mediante el IPC, en el largo plazo, muestra más redimientos. Asimismo, la Figura @ref(fig:fig4) ilustra que en ambas series se observa un dominio de la condición de tiempo y no uno de frecuencia. Es decir, tanto el IPC como el TDC no responden a condiciones como ciclos o temporadas que si son observables en actividades económicas como las
primarias.</p>
<p>Finalmente, la Figura @ref(fig:fig5) ilustra un característica que también resulta de gran interés en el analásis de series de tiempo: los datos de alta frecuencia y de comportamiento no regular. Como se puede observar, en la Figura @ref(fig:fig5) se muestran las diferencias logarítmicas de las series de IGAE de la actividad total, el IPC y el TDC.</p>
<div class="figure" style="text-align: center">
<img src="index_files/figure-html/fig5-1.png" alt="Tasas de Crecimiento mensuales (diferencias logarítmicas) de Indicador Global de la Actividad Económica, Índice de Precios y Cotizaciones de la Bolsa Mexicana de Valores (Panel Derecho) y Tipo de Cambio para Solventar Obligaciones en Moneda Extranjera, Ene.2002-May.2021 " width="90%" />
<p class="caption">
(#fig:fig5)Tasas de Crecimiento mensuales (diferencias logarítmicas) de Indicador Global de la Actividad Económica, Índice de Precios y Cotizaciones de la Bolsa Mexicana de Valores (Panel Derecho) y Tipo de Cambio para Solventar Obligaciones en Moneda Extranjera, Ene.2002-May.2021
</p>
</div>
<p>Dichas diferencia se pueden interpretar como una tasa de crecimiento de las series por las siguientes razones. Consideremos una serie de tiempo dada por <span class="math inline">\(y_t\)</span>, cuya versión logarítmica es <span class="math inline">\(ln(y_t\)</span>). De esta forma, la diferencia logarítmica esta dada por la ecuación @ref(eq:difflog):</p>
<p><span class="math display">\[\begin{equation}
   \Delta ln(y_t) = ln(y_t) - ln(y_{t-1}) = ln \left( \frac{y_t}{y_{t-1}} \right)
   (\#eq:difflog)
\end{equation}\]</span></p>
<p>Ahora bien, si retomamos la definición de tasa de crecimiento (TC) de una serie de tiempo <span class="math inline">\(y_t\)</span> entre el periodo <span class="math inline">\(t\)</span> y <span class="math inline">\(t-1\)</span> podemos obtener que:</p>
<p><span class="math display">\[\begin{equation}
    TC = \frac{y_t - y_{t-1}}{y_{t-1}} = \frac{y_t}{y_{t-1}} - 1
    (\#eq:TC)
\end{equation}\]</span></p>
<p>De esta forma, si tomamos el logarítmo de la expresión de la ecuación @ref(eq:TC) obtenemos la siguiente aproximación:</p>
<p><span class="math display">\[\begin{equation}
    \frac{y_t}{y_{t-1}} -1  \approx ln \left( \frac{y_t}{y_{t-1}} \right) = ln(y_t) - ln(y_{t-1})
    (\#eq:TCDiffLog)
\end{equation}\]</span></p>
<p>La ecuación @ref(eq:TCDiffLog) es cierta cuando los valores de <span class="math inline">\(y_t\)</span> y <span class="math inline">\(y_{t-1}\)</span> son muy parecidos, es decir, cuando las variaciones no son tan abruptas. Otra forma de interpretar la ecuación @ref(eq:TCDiffLog) es que para tasas de crecimiento pequeñas, se puede utilizar como una buena aproximación a la diferencia logarítmica mostrada en la ecuación @ref(eq:difflog).</p>
<p>En la Figura @ref(fig:fig5) se reportan las diferencias logarítmicas del IGAE, IPC y TDC, todos, como una media de distitntos tipos de redimientos. Es decir, podemos decir que un capitalista promedio (suponiendo que solo puede invertir en la actividad económica, en la bolsa o en el dólar), puede observar que le es más redituable en función de sus preferencias.</p>
<p>Notése que la dinámica de las variaciones de cada una de las series es significativamente diferente. Destaca que el TDC es una de las variables que, en general, no muestra grandes cambios a lo largo del tiempo. No obstante, se han observado cambios radicales, cuando menos en el año 2008. Lo anterior, son caracteristicas que se han observado para el IPC. En cambio, el IGAE muestra un comportamiento más estable o estacionario.</p>
<!--chapter:end:index.Rmd-->
</div>
</div>
<div id="elementos-de-ecuaciones-en-diferencia" class="section level1" number="2">
<h1><span class="header-section-number">2</span> Elementos de Ecuaciones en Diferencia</h1>
<div id="ecuaciones-en-diferencia-para-procesos-deterministas" class="section level2" number="2.1">
<h2><span class="header-section-number">2.1</span> Ecuaciones en Diferencia para procesos deterministas</h2>
<p>En el capítulo previo se hizó una introducción al concepto de series de tiempo. En este Capítulo se pretende desarrollar la construcción de los procesos generadores de datos de las series de tiempo. En un sentido más formal, se expondrá que las series de tiempo se pueden considerar como una secuencia de variables aleatorias.</p>
<p>Para tales efectos, se desarrollará una introducción al concepto de ecuaciones en diferencia. Así, las preguntas que se pretende responder son:</p>
<ol style="list-style-type: decimal">
<li><p>¿Cuál es la solución de la ecuación en diferencia que se estudia?</p></li>
<li><p>¿Cuáles son las condiciones para que un proceso estocástico, representado mediante una ecuación en diferencia, llegue a alcanzar un punto de equilibrio en el largo plazo?</p></li>
</ol>
<p>El término de <em>ecuación en diferencia</em> sirve para denominar un proceso similar o equivalente dentro de las ecuaciones diferenciales, dentro del cual se consideran a un conjunto de variables que están en función del tiempo. Así, si consideramos al tiempo como una variable continua, es decir, consideramos una variable <span class="math inline">\(Z(t)\)</span>, podemos expresar las siguientes expresiones para la ecuación diferencial:</p>
<p><span class="math display">\[\begin{equation}
    \frac{dZ(t)}{dt}; \frac{d^2Z(t)}{dt^2}; \ldots; \frac{d^kZ(t)}{dt^k}
        (\#eq:eqDiff)
\end{equation}\]</span></p>
<p>Por otro lado, suponiendo el caso del tiempo en forma discreta, es decir, con <span class="math inline">\(t = \ldots, -2, -1, 0, 1, 2, \ldots\)</span>, entonces el comportamiento de la serie de variables dadas por <span class="math inline">\(Z_t\)</span>, la cual se puede expresar como:</p>
<p><span class="math display">\[\begin{equation}
    \Delta Z_t; \Delta^2 Z_t; \ldots; \Delta^k Z_t
    (\#eq:Diff1)
\end{equation}\]</span></p>
<p>Observemos que una forma técnicamente más correcta es escribir las expresiones anteriores como:</p>
<p><span class="math display">\[\begin{equation}
    \frac{\Delta Z_t}{\Delta t}; \frac{\Delta^2 Z_t}{\Delta t^2}; \ldots; \frac{\Delta^k Z_t}{\Delta t^k}
    (\#eq:Diff2)
\end{equation}\]</span></p>
<p>No obstante, no pasa desapercibido que <span class="math inline">\(\Delta t = 1\)</span>, por lo que resultan equivalentes ambos conjuntos de expresiones @ref(eq:Diff1) y @ref(eq:Diff2).</p>
<div id="ecuaciones-en-diferencia-lineales-de-primer-orden" class="section level3" number="2.1.1">
<h3><span class="header-section-number">2.1.1</span> Ecuaciones en Diferencia Lineales de Primer Orden</h3>
<p>El primer caso que se suele estudiar en relación a Ecuaciones en Diferencia es el de las Ecuaciones en Diferencia Lineales de Primer Orden. Al respecto, al igual que en el caso continúo, las variaciones de la variable <span class="math inline">\(Z_t\)</span> se pueden expresar como se ilustra en el siguiente ejemplo. Consideremos la siguiente ecuación:</p>
<p><span class="math display">\[\begin{equation}
    Z_t = a_0 + a_1 Z_{t-1}
    (\#eq:EDPO)
\end{equation}\]</span></p>
<p>Donde, <span class="math inline">\(t = \ldots, -2, -1, 0, 1, 2, \ldots\)</span>, y <span class="math inline">\(a_0\)</span> y <span class="math inline">\(a_1 \neq 0\)</span> son números reales constantes. De @ref(eq:EDPO) podememos despejar la variable <span class="math inline">\(Z_{t-1}\)</span> y obtener una forma de ecuación en diferencia:
<span class="math display">\[\begin{equation}
    Z_t - a_1 Z_{t-1} = a_0
    (\#eq:EDPO2)
\end{equation}\]</span></p>
<p>Ahora denotemos a <span class="math inline">\(L Z_t = Z_{t-1}\)</span>, es decir, mediante el operador <span class="math inline">\(L\)</span> se puede rezagar una variable dada. En general, podemos decir que el operador tiene dos propiedades, la primera es que es lineal en el sentido de que abre sumas y saca escalares como se muestra en la siguiente expresión para el caso de un (1) rezago:</p>
<p><span class="math display">\[\begin{equation}
    L(\alpha Z_{t} + \beta) = \alpha Z_{t-1} + \beta
    (\#eq:E1Lag)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\alpha, \beta \in \mathbb{R}\)</span> y <span class="math inline">\(\alpha, \beta \neq 0\)</span>. Otro reesultado implícito en esta primera propiedad es que el operador rezago aplicado a cualquier escalar dará como resultado el escalar, puesto que este es una constante sin importa el momento <span class="math inline">\(t\)</span> en el cual se encuentre la variable <span class="math inline">\(Z\)</span>.</p>
<p>La segunda propiedad del operador es que se puede aplicar de forma consecutiva a una misma variable. Es decir, <span class="math inline">\(L ( Z_{t-1}) = L L Z_{t} = L^2 Z_{t}\)</span>, por lo que en general tendremos: <span class="math inline">\(L^p Z_t = Z_{t-p}\)</span> (con <span class="math inline">\(p \in \mathbb{Z}\)</span>). Así, en el caso de p rezagos la propiedad de linealidad del operador rezago será:</p>
<p><span class="math display">\[\begin{equation}
    L^p (\alpha Z_{t} + \beta) = \alpha Z_{t-p} + \beta
   (\#eq:LinProp)
\end{equation}\]</span></p>
<p>Dicho lo anterio podemos escribir la solución general de @ref(eq:EDPO2) como:</p>
<p><span class="math display">\[\begin{eqnarray}
    Z_t - a_1 L Z_t &amp; = &amp; a_0 \nonumber \\
    (1 - a_1 L)Z_t &amp; = &amp; a_0 \nonumber \\
    Z_t &amp; = &amp; a_0 \frac{1}{1 - a_1 L} + s a^t_1 \nonumber \\
    Z_t &amp; = &amp; a_0 \frac{1}{1 - a_1} + s a^t_1
    (\#eq:PROC01)
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(a_1 \neq 1\)</span> y <span class="math inline">\(t = \ldots, -2, -1, 0, 1, 2, \ldots\)</span>. Notése que la aplicación del operador rezago <span class="math inline">\(L\)</span> a la constante <span class="math inline">\(a_1\)</span> dará como resultado el valor de la misma constante, ya que ésta no depende del momento <span class="math inline">\(t\)</span> en el cuál observemos a la variable <span class="math inline">\(Z_t\)</span>. En la ecuación @ref(eq:PROC01) se adiciona un término <span class="math inline">\(s a^t_1\)</span> que permite ubicar la trayectoria inicial de la solución de la ecuación. El componente no significa un cambio respecto de la ecuación @ref(eq:EDPO2) original, ya que si buscaramos reconstruir a ésta ecuación tendríamos:
<span class="math display">\[\begin{eqnarray}
    (1 - a_1 L) s a^t_1 &amp; = &amp; s a^t_1 - a_1 s L a^{t}_1 \nonumber \\
    &amp; = &amp; s a^t_1 - a_1 s a^{t - 1}_1 \nonumber \\
    &amp; = &amp; s a^t_1 - s a^t_1 \nonumber \\
    &amp; = &amp; 0 \nonumber
\end{eqnarray}\]</span></p>
<p>La ecuación @ref(eq:PROC01) se suele interpretar como la solución de largo plazo. Ahora demostraremos por qué es cierta la ecuación y discutiremos algunas condiciones que se deben observar en esta solución para que sea una solución convergente. No obstante, primero discutiremos un método indirecto e incompleto para demostrar el resultado, dicho método es conocido como el método iterativo. Plantearemos las siguientes ecuaciones partículares donde suponemos la existencia del valor inicial <span class="math inline">\(Z_0\)</span> del proceso:</p>
<p><span class="math display">\[\begin{equation*}
    Z_1 = a_0 + a_1 Z_0
\end{equation*}\]</span></p>
<p><span class="math display">\[\begin{eqnarray*}
Z_2 &amp; = &amp; a_0 + a_1 Z_1 \\
    &amp; = &amp; a_0 + a_1 (a_0 + a_1 Z_0) \\
    &amp; = &amp; a_0 +  a_0 a_1 + a^2_1 Z_0 \\
    &amp; = &amp; a_0 (1 + a_1) + a^2_1 Z_0
\end{eqnarray*}\]</span></p>
<p><span class="math display">\[\begin{eqnarray*}
Z_3 &amp; = &amp; a_0 + a_1 Z_2 \\
    &amp; = &amp; a_0 + a_1 (a_0 +  a_0 a_1 + a^2_1 Z_0) \\
    &amp; = &amp; a_0 +  a_0 a_1 + a_0 a^2_1 + a^3_1 Z_0 \\
    &amp; = &amp; a_0 (1 + a_1 + a^2_1) + a^3_1 Z_0
\end{eqnarray*}\]</span></p>
<p>De lo anterior se puede inferir que el método iterativo convergerá hacia una expresión como la siguiente en el momento <span class="math inline">\(t\)</span>:</p>
<p><span class="math display">\[\begin{eqnarray}
Z_t &amp; = &amp; a_0 + a_1 Z_{t-1} \nonumber \\
    &amp; = &amp; a_0 (1 + a_1 + a^2_1 + \ldots + a^{t-1}_1) + a^t_1 Z_0 \nonumber \\
    &amp; = &amp; a_0 \sum^{t-1}_{i = 0}{a^i_1} + a^t_1 Z_0
    (\#eq:SUM)
\end{eqnarray}\]</span></p>
<p>Donde, es necesario que en la ecuación @ref(eq:SUM) se cumpla que <span class="math inline">\(\lvert{a_1}\lvert &lt; 1\)</span> para que la suma sea convergente –más adelante detallaremos esta afirmación–. A este tipo de ecuaciones se les puede denominar como lineales. Esto en razón de que ningún término de la variable <span class="math inline">\(Z\)</span> aparce elevado a ninguna potencia distinta a 1. También, son de primer orden, ya que el rezago de la variable <span class="math inline">\(Z\)</span> es sólo de un período.</p>
<p>En adelante trabajaremos con ecuaciones en las que la variable <span class="math inline">\(Z\)</span> se encuentra rezagada en cualquiera de los siguientes casos:
<span class="math display">\[\begin{equation}
    Z_t, Z_{t-1}, Z_{t-2}, Z_{t-3}, \ldots, Z_{t-p}, \ldots
    (\#eq:SUM0)
\end{equation}\]</span></p>
<p>Por lo que diremos que en adelante el curso versará sobre ecuaciones en diferencia lineales y de cualquier orden <span class="math inline">\(p\)</span>.</p>
<p>Retomando la ecuación @ref(eq:SUM) y considerando la parte de la suma de los términos de <span class="math inline">\(a^i_1\)</span>, de tal forma que buscaremos dar una expresión más compresible a dicho término. Definamos la siguiente expresión como:
<span class="math display">\[\begin{equation}
    S_{t-1} = \sum^{t-1}_{i = 0}{a^i_1}
    (\#eq:St1)
\end{equation}\]</span></p>
<p>Por lo tanto, <span class="math inline">\(S_t\)</span> estaría dado por la siguiente expresión:
<span class="math display">\[\begin{eqnarray}
S_{t} &amp; = &amp; a_1 \sum^{t-1}_{i = 0}{a^i_1} \nonumber \\
      &amp; = &amp; a_1 (1 + a_1 + a^2_1 + \ldots + a^{t-1}_1) \nonumber \\
      &amp; = &amp; a_1 + a^2_1 + a^3_1 + \ldots + a^{t}_1 \nonumber \\
      &amp; = &amp; a_1 S_{t-1}
      (\#eq:St)
\end{eqnarray}\]</span></p>
<p>Tomando los dos resultados de las ecuaciones @ref(eq:St1) y @ref(eq:St) anteriores, podemos expresar que si a <span class="math inline">\(S_{t-1}\)</span> le restamos <span class="math inline">\(S_t\)</span>, y desarrollando ambos lados de la ecuación anterior podemos obtener:</p>
<p><span class="math display">\[\begin{eqnarray}
    S_{t-1} - a_1 S_{t-1} &amp; = &amp; S_{t-1} - S_{t} \nonumber \\
    (1 - a_1) S_{t-1} &amp; = &amp; (1 + a_1 + a^2_1 + \ldots + a^{t-1}_1) - (a_1 + a^2_1 + a^3_1 + \ldots + a^{t}_1) \nonumber \\
    (1 - a_1) S_{t-1} &amp; = &amp; 1 - a^{t}_1 \nonumber
\end{eqnarray}\]</span></p>
<p>Así, podemos concluir que:
<span class="math display">\[\begin{equation}
    S_{t-1} = \frac{1 - a^{t}_1}{1 - a_1}
    (\#eq:SUM2)
\end{equation}\]</span></p>
<p>Conjuntando éste último resultado de la ecuación @ref(eq:SUM2) con la ecuación @ref(eq:SUM) tenemos la siguiente solución por el método de iteración:</p>
<p><span class="math display">\[\begin{equation}
    Z_t = a_0 \left( \frac{1 - a^{t}_1}{1 - a_1} \right) + a^t_1 Z_0
    (\#eq:SOLITER)
\end{equation}\]</span></p>
<p>De esta forma la ecuación @ref(eq:SOLITER) es una solición para la ecuación @ref(eq:SUM), que es una ecuación de un proceso de una Ecuación en Diferencia plantenado en la ecuación @ref(eq:EDPO). Está solución aún no es general, en el sentido de que sea válida para cualquiel tipo de proceso: convergente o divergente. Dicha convergencia o divengencia estará determinada por el paramétro <span class="math inline">\(a_1\)</span>. No debe pasar desapercibido que cuando <span class="math inline">\(t \rightarrow \infty\)</span> o cuando la muestra es muy grande (lo que es equivalente), podemos decir que la solución solo puede converger a la siguiente expresión cuando se considera que <span class="math inline">\(|a_1| &lt; 1\)</span>:
<span class="math display">\[\begin{equation}
    Z_t = a_0 \left( \frac{1}{1 - a_1} \right)
    (\#eq:trayec)
\end{equation}\]</span></p>
<p>Retomemos ahora el caso general descrito en la ecuación @ref(eq:PROC01) y determinemos una solución general en la cual <span class="math inline">\(a_1 \neq 1\)</span> y <span class="math inline">\(t = \ldots, -2, -1, 0, 1, 2, \ldots\)</span>. Para ello observemos que el siguiente componente en la ecuación mencionada se puede interpretar como la suma infinita de términos descritos como:
<span class="math display">\[\begin{eqnarray}
    \frac{1}{1 - a_1} &amp; = &amp; 1 + a_1 + a_1^2 + \ldots + a_1^t + \ldots \nonumber \\
    &amp; = &amp; \sum_{i = 0}^{\infty} a_1^{i}
    (\#eq:SUMINF)
\end{eqnarray}\]</span></p>
<p>Donde claramente es necesario que <span class="math inline">\(|a_1| &lt; 1\)</span>. Por lo tanto, sólo faltaría determinar el valor de la constante <span class="math inline">\(s\)</span> en la ecuación @ref(eq:PROC01) de la siguiente forma, supongamos que observamos el proceso en el momento inicial, por lo que es posible determinar el valor de la constante conociendo el valor inicial del proceso como sigue:
<span class="math display">\[\begin{equation}
    Z_0 = a_0 \frac{1}{1 - a_1} + s
(\#eq:Z0)
\end{equation}\]</span></p>
<p>De la ecuación @ref(eq:Z0) tenemos que:
<span class="math display">\[\begin{equation}
    s = Z_0 - a_0 \frac{1}{1 - a_1}
(\#eq:eqs)
\end{equation}\]</span></p>
<p>Así, juntando la ecuación @ref(eq:PROC01) y ecuación @ref(eq:eqs) tenemos la expresión:</p>
<p><span class="math display">\[\begin{equation}
    Z_t = a_0 \frac{1 - a^t_1}{1 - a_1} + a^t_1 Z_0
(\#eq:SOLGEN)
\end{equation}\]</span></p>
<p>No debe pasar desapercibido que está solución es la misma que la mostrada en la ecuación (@ref(eq:SOLITER), por lo que en realidad ambas ecuaciones son una solución general indistintamente entre las ecuaciones @ref(eq:SOLITER) y @ref(eq:SOLGEN). Ambas convergen a la expresión como la ecuación @ref(eq:trayec), con la misma condición de convergencia <span class="math inline">\(|a_1| &lt; 1\)</span>. Para ilustrar estas ecuaciones veámos algunos ejemplos al respecto.</p>
<p>Consideremos que tenemos un proceso <span class="math inline">\(Z_t\)</span> que es descrito por una ecuación en diferencia lineal de primer orden dada por:</p>
<p><span class="math display">\[\begin{equation}
    Z_t = 2 + 0.9 Z_{t-1}
(\#eq:ex1)
\end{equation}\]</span></p>
<p>Siguiendo la expresión mostrada en la ecuación @ref(eq:SOLGEN), obtenemos la expresión:
<span class="math display">\[\begin{equation}
    Z_t = 2 \left( \frac{1 - 0.9^{t}}{1 - 0.9} \right) + 0.9^t Z_0
(\#eq:ex2)
\end{equation}\]</span></p>
<p>Donde asumiremos que el valor inicial es <span class="math inline">\(Z_0 = 10\)</span> y que la expresión debe converger al valor de 20, cuando <span class="math inline">\(t\)</span> es muy grande o tiende a infinito. De forma similar tomemos otro ejemplo, en el cual asumimos la siguiente expresión:
<span class="math display">\[\begin{equation}
    Z_t = 2 - 0.5 Z_{t-1}
(\#eq:ex3)
\end{equation}\]</span></p>
<p>Siguiendo la expresión mostrada en la ecuación @ref(eq:SOLGEN), obtenemos:</p>
<p><span class="math display">\[\begin{equation}
    Z_t = 2 \left( \frac{1 - (-0.5)^{t}}{1 + 0.5} \right) + (-0.5)^t Z_0
(\#eq:ex4)
\end{equation}\]</span></p>
<p>Donde asumiremos que el valor inicial es <span class="math inline">\(Z_0 = 10\)</span> y que la ecuación converge al valor de <span class="math inline">\(1.3333333 \ldots\)</span>, cuando <span class="math inline">\(t\)</span> es muy grande o tiende a infinito. Ahora simulemos el comportamiento de ambos procesos y estableceremos los resultados del Cuadro @ref(tab:table1). Notemos que el segundo proceso converge de una forma más rapida que el primero. El Cuadro @ref(tab:table1) se ilustra en las siguientes dos Figura @ref(fig:fig21) y Figura @ref(fig:fig22).</p>
</div>
<div id="ecuaciones-en-diferencia-lineales-de-segundo-orden-y-de-orden-superior" class="section level3" number="2.1.2">
<h3><span class="header-section-number">2.1.2</span> Ecuaciones en Diferencia Lineales de Segundo Orden y de orden superior</h3>
<p>Como un segundo caso a estudiar se ubica el caso de las Ecuaciones en Diferencia Lineales de Segundo Orden y de orden superior. Primero, sea una ecuación como la siguiente, la cual es lineal y de segundo orden, ya que tiene asociado un término de <span class="math inline">\(Z_t\)</span> rezagado dos periódos:
<span class="math display">\[\begin{equation}
    Z_t = a_0 + a_1 Z_{t-1} + a_2 Z_{t-2}
    (\#eq:EDSO)
\end{equation}\]</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>Tiempo <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>Zt <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="dv">101</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>Zt2 <span class="ot">=</span> <span class="fu">rep</span>(<span class="cn">NA</span>,<span class="dv">101</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>Zt[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>Zt2[<span class="dv">1</span>] <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">101</span>)){</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  Zt[i] <span class="ot">=</span> <span class="dv">2</span><span class="fl">+0.9</span><span class="sc">*</span>Zt[i<span class="dv">-1</span>]</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  Zt2[i] <span class="ot">=</span> <span class="dv">2</span> <span class="sc">-</span> <span class="fl">0.5</span><span class="sc">*</span>Zt2[i<span class="dv">-1</span>]</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>lista <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">97</span><span class="sc">:</span><span class="dv">101</span>)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>Tiempo1 <span class="ot">=</span> Tiempo[lista]</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>Zt1<span class="ot">=</span>Zt[lista]</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>Zt21<span class="ot">=</span>Zt2[lista]</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>tabla1 <span class="ot">=</span> <span class="fu">data.frame</span>(Tiempo1, Zt1, Zt21)</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabla1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Tiempo&quot;</span>, <span class="st">&quot;$Z_t =2+0.9Z_{t-1}$&quot;</span>, <span class="st">&quot;$Z_t = 2-0.5Z_{t-1}$&quot;</span>)</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tabla1, <span class="at">caption =</span> <span class="st">&quot;Dos ejemplos de Procesos de Ecuaciones Lineales de Primer Orden Convergentes &quot;</span>, <span class="at">format =</span> <span class="st">&quot;pandoc&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">10</span>)</span></code></pre></div>
<table>
<caption>(#tab:table1)Dos ejemplos de Procesos de Ecuaciones Lineales de Primer Orden Convergentes</caption>
<thead>
<tr class="header">
<th align="right">Tiempo</th>
<th align="right"><span class="math inline">\(Z_t =2+0.9Z_{t-1}\)</span></th>
<th align="right"><span class="math inline">\(Z_t = 2-0.5Z_{t-1}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">10.00000</td>
<td align="right">10.000000</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">11.00000</td>
<td align="right">-3.000000</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">11.90000</td>
<td align="right">3.500000</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">12.71000</td>
<td align="right">0.250000</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">13.43900</td>
<td align="right">1.875000</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">14.09510</td>
<td align="right">1.062500</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">14.68559</td>
<td align="right">1.468750</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">15.21703</td>
<td align="right">1.265625</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">15.69533</td>
<td align="right">1.367188</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">16.12580</td>
<td align="right">1.316406</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">16.51322</td>
<td align="right">1.341797</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">16.86189</td>
<td align="right">1.329102</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">17.17570</td>
<td align="right">1.335449</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">17.45813</td>
<td align="right">1.332275</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">17.71232</td>
<td align="right">1.333862</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">17.94109</td>
<td align="right">1.333069</td>
</tr>
<tr class="odd">
<td align="right">96</td>
<td align="right">19.99960</td>
<td align="right">1.333333</td>
</tr>
<tr class="even">
<td align="right">97</td>
<td align="right">19.99964</td>
<td align="right">1.333333</td>
</tr>
<tr class="odd">
<td align="right">98</td>
<td align="right">19.99967</td>
<td align="right">1.333333</td>
</tr>
<tr class="even">
<td align="right">99</td>
<td align="right">19.99970</td>
<td align="right">1.333333</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">19.99973</td>
<td align="right">1.333333</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(,<span class="fu">aes</span>(<span class="at">x =</span> Tiempo, <span class="at">y=</span>Zt))<span class="sc">+</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">col=</span><span class="st">&quot;blue4&quot;</span>)<span class="sc">+</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col=</span> <span class="st">&quot;blue4&quot;</span>)<span class="sc">+</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="fu">expression</span>(Z[t]))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="01-Elementos_Eq_Diff_files/figure-html/fig21-1.png" alt="Evolución del proceso dado por $Z_t =2+0.9Z_{t-1}$" width="672" />
<p class="caption">
(#fig:fig21)Evolución del proceso dado por <span class="math inline">\(Z_t =2+0.9Z_{t-1}\)</span>
</p>
</div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(,<span class="fu">aes</span>(<span class="at">x =</span> Tiempo, <span class="at">y=</span>Zt2))<span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">col=</span><span class="st">&quot;red4&quot;</span>)<span class="sc">+</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col=</span> <span class="st">&quot;red4&quot;</span>)<span class="sc">+</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="fu">expression</span>(Z[t]))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="01-Elementos_Eq_Diff_files/figure-html/fig22-1.png" alt="Evolución del proceso dado por $Z_t =2-0.5Z_{t-1}$" width="672" />
<p class="caption">
(#fig:fig22)Evolución del proceso dado por <span class="math inline">\(Z_t =2-0.5Z_{t-1}\)</span>
</p>
</div>
<p>Donde <span class="math inline">\(t = \ldots, -2, -1, 0, 1, 2, \ldots\)</span> y <span class="math inline">\(a_1, a_2 \neq 0\)</span>. Reordenando la ecuación @ref(eq:EDSO) podemos escribir:
<span class="math display">\[\begin{eqnarray}
    Z_t - a_1 Z_{t-1} - a_2 Z_{t-2} &amp; = &amp; a_0 \nonumber \\
    Z_t - a_1 L Z_{t} - a_2 L^2 Z_{t} &amp; = &amp; a_0 \nonumber \\
    (1 - a_1 L - a_2 L^2)Z_t &amp; = &amp; a_0
    (\#eq:EDSOSOL)
\end{eqnarray}\]</span></p>
<p>Así, la solución general propuesta para la ecuación @ref(eq:EDSOSOL) es la siguiente, la cual es una forma analóga a una Ecuación Lineal en Diferencia de Primer Orden:
<span class="math display">\[\begin{equation}
    Z_t = \frac{a_0}{1 - a_1 - a_2} + s_1 g^t_1 + s_2 g^t_2
    (\#eq:SOLGEN2)
\end{equation}\]</span></p>
<p>En donde <span class="math inline">\(s_1\)</span> y <span class="math inline">\(s_2\)</span> son constantes que se determinan mediante dos condiciones iniciales –por lo que para resolver este tipo de ecuaciones requerimos conocer dos condiciones iniciales–. Los valores de <span class="math inline">\(g_1\)</span> y <span class="math inline">\(g_2\)</span> están relacionados con los coeficientes <span class="math inline">\(a_1\)</span> y <span class="math inline">\(a_2\)</span>, de esta forma:</p>
<p><span class="math display">\[\begin{equation}
  a_1  =  g_1 + g_2
  (\#eq:a1)
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
    a_2  =  - g_1 g_2
    (\#eq:a2)
\end{equation}\]</span></p>
<p>Lo anterior surge del siguiente procedimiento y recordando que siempre es posible descomponer una ecuación cuadrática en expresiones como las siguientes:
<span class="math display">\[\begin{eqnarray}
    (1 - a_1 L - a_2 L^2) &amp; = &amp; (1 - g_1 L)(1 - g_2 L) \nonumber \\
    &amp; = &amp; 1 - g_1 L - g_2 L + g_1 g_2 L^2 \nonumber \\
    &amp; = &amp; 1 - (g_1 + g_2) L + g_1 g_2 L^2
    (\#eq:eqcaracteristica)
\end{eqnarray}\]</span></p>
<p>Donde se observa la equivalencia mostrada en las ecuaciones @ref(eq:a1) y @ref(eq:a2). Así, considerando la ecuación @ref(eq:SOLGEN2) tenemos que:
<span class="math display">\[\begin{eqnarray}
    (1 - a_1 L - a_2 L^2) Z_t &amp; = &amp; (1 - g_1 L)(1 - g_2 L) Z_t \nonumber \\
    &amp; = &amp; a_0 + (1 - g_1 L)(1 - g_2 L) s_1 g^t_1 \nonumber \\
    &amp;  &amp; + (1 - g_1 L)(1 - g_2 L) s_2 g^t_2
    (\#eq:eqcaracteristica1)
\end{eqnarray}\]</span></p>
<p>Por lo tanto, buscamos que para que el proceso sea equivalente y podamos interpretar que la ecuación @ref(eq:SOLGEN2) sea una solución general deberá pasar lo siguiente:
<span class="math display">\[\begin{equation}
    (1 - g_1 L) (1 - g_2 L) s_1 g^t_1 + (1 - g_1 L) (1 - g_2 L) s_2 g^t_2 = 0
    (\#eq:eqcaracteristica2)
\end{equation}\]</span></p>
<p>O, escrito de otra forma:
<span class="math display">\[\begin{equation}
    (1 - g_1 L) s_1 g^t_1 = (1 - g_2 L) s_2 g^t_2 = 0
    (\#eq:eqcaracteristica3)
\end{equation}\]</span></p>
<p>Ahora determinemos cuáles son los valores <span class="math inline">\(g_1\)</span> y <span class="math inline">\(g_2\)</span> dados los valores <span class="math inline">\(a_1\)</span> y <span class="math inline">\(a_2\)</span> que nos permitan determinar si el proceso será convergente. Para ello debemos resolver la siguiente ecuación que se deriva de la ecuación @ref(eq:eqcaracteristica):</p>
<p><span class="math display">\[\begin{equation}
    1 - a_1 x - a_2 x^2 = (1 - g_1 x)(1 - g_2 x) = 0
    (\#eq:eqcaracteristica4)
\end{equation}\]</span></p>
<p>Donde, claramente existen dos raíces: <span class="math inline">\(x_1 = g^{-1}_1\)</span> y <span class="math inline">\(x_2 = g^{-1}_2\)</span>. Así, la solución estará dada por las raíces de la ecuación característica:</p>
<p><span class="math display">\[\begin{eqnarray}
    1 - a_1 x - a_2 x^2 = 0 \nonumber \\
    a_2 x^2 + a_1 x - 1 = 0
    (\#eq:POL2)
\end{eqnarray}\]</span></p>
<p>Cuya solución es:
<span class="math display">\[\begin{equation}
    x = \frac{- a_1 \pm \sqrt{a^2_1 + 4 a_2}}{2 a_2}
    (\#eq:eqcaracteristica5)
\end{equation}\]</span></p>
<p>Es importante distinguir tres diferentes casos en relación con las raíces que surgen como solución de la ecuación @ref(eq:POL2), estos son:</p>
<p><strong>Caso I</strong>. Si <span class="math inline">\(a^2_1 + 4 a_2 &gt; 0\)</span>, la ecuación @ref(eq:POL2) proporcionará dos valores de raíces reales y distintos, eso es <span class="math inline">\(x_1 = g^{-1}_1 \neq x_2 = g^{-1}_2\)</span>. Si por ahora suponemos que <span class="math inline">\(|{g_1} &lt; 1|\)</span> y que <span class="math inline">\(|{g_2} &lt; 1|\)</span>, entonces tendremos que:
<span class="math display">\[\begin{eqnarray}
    (1 - g_1 L)^{-1} (1 - g_2 L)^{-1} a_0 &amp; =&amp;  \left( \sum^{\infty}_{j = 0}{g^j_1 L^j} \right) \left( \sum^{\infty}_{j = 0}{g^j_2 L^j} \right) a_0 \nonumber \\
    &amp; = &amp; \left( \sum^{\infty}_{j = 0}{g^j_1} \right) \left( \sum^{\infty}_{j = 0}{g^j_2} \right) a_0 \nonumber \\
    &amp; = &amp; \frac{a_0}{(1 - g_1)(1 - g_2)} \nonumber \\
    &amp; = &amp; \frac{a_0}{1 - a_1 - a_2}
    (\#eq:eqcaracteristica6)
\end{eqnarray}\]</span></p>
<p>Esto último es el punto de equilibrio de la ecuación @ref(eq:SOLGEN2); considerando que <span class="math inline">\(|{g_1} &lt; 1|\)</span> y que <span class="math inline">\(|{g_2} &lt; 1|\)</span> –notemos que los demás casos son divergentes, ya que la suma anterior nno connvergería–. De esta forma la solución de la ecuación estará dada por:
<span class="math display">\[\begin{equation}
    \lim_{t \to \infty} Z_t = \frac{a_0}{1 - a_1 - a_2}
    (\#eq:Conver)
\end{equation}\]</span></p>
<p><strong>Caso II</strong>. Si <span class="math inline">\(a_1^2 + 4a_2 &lt; 0\)</span> en la ecuación @ref(eq:POL2), entonces las raíces serán números complejos conjugados, es decir:</p>
<p><span class="math display">\[\begin{equation}
g_i^{-1}=a \pm ib
(\#eq:Conver1)
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{eqnarray}
    g_i  =  u \pm iv
    (\#eq:Conver2)
\end{eqnarray}\]</span></p>
<p>Dichas raíces las podemos escribir en coordenadas polares como:
<span class="math display">\[\begin{eqnarray}
    g_1^{-1} = r e^{i \theta} = r (cos(\theta) + i sen(\theta))
    (\#eq:Conver3)
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
    g_2^{-1}  =  r e^{-i \theta} = r (cos(\theta) - i sen(\theta))
    (\#eq:Conver4)
\end{eqnarray}\]</span>
Donde: <span class="math inline">\(r = \sqrt{u^2 + v^2}\)</span>, a esta expresión también se le conoce como modulo. Alternativamente, podemos escribir que <span class="math inline">\(r = \sqrt{g_1 g_2}\)</span>. La única condición es que <span class="math inline">\(r &lt; 1\)</span> para que el proceso descrito en la ecuación @ref(eq:SOLGEN2) sea convergente.</p>
<p>Al igual que en el <strong>Caso I</strong>, el punto de equilibrio de la ecuación se debería ubicar al rededor @ref(eq:Conver), siempre que <span class="math inline">\(r &lt; 1\)</span>, por lo que el factor que determina la convergencia es el modulo, ya que si el modulo es mayor a 1, el proceso será divergente, pero si es menor a 1 convergerá a @ref(eq:Conver). Para ilustrar, el caso contrario es divergente puesto que representa trayentorias senoidales (oscilatorias) que sólo pueden converger si a medida que pasa el tiempo, las ondas son menos amplias.</p>
<p><strong>Caso III</strong>. Ahora revisemos el caso en el que <span class="math inline">\(a_1^2 + 4a_2 = 0\)</span>, de esta forma las raíces serán identicas:
<span class="math display">\[\begin{equation}
    g = g_1^{-1} = g_2^{-1} = \frac{-a_1}{2 a_2}
    (\#eq:Conver6)
\end{equation}\]</span></p>
<p>Así, el punto de equilibrio será dado por la solución descrita como:
<span class="math display">\[\begin{eqnarray}
    (1 - g L)^2 Z_t &amp; = &amp; a_0 \nonumber \\
    Z_t &amp; = &amp; \frac{a_0}{(1 - g L)^2} + s_1 g^t + s_2 t g^t \nonumber \\
    &amp; = &amp; a_0 \sum_{i = 0}^{\infty} (1 + i) g^j + s_1 g^t + s_2 t g^t
    (\#eq:Conver7)
\end{eqnarray}\]</span></p>
<p>Donde la expresión amnterior es resultado de considerar el siguiente procedimiento. Sea:
<span class="math display">\[\begin{eqnarray}
    f(g) &amp; = &amp; \frac{1}{(1 - g)} = \sum_{j = 0}^{\infty} g^j \nonumber
\end{eqnarray}\]</span></p>
<p>Por lo que si hacemos la primer derivada del la expresión anterior tenemos que:
<span class="math display">\[\begin{eqnarray}
    f&#39;(g) &amp; = &amp; \frac{1}{(1 - g)^2} \nonumber \\
    &amp; = &amp; \sum_{j = 0}^{\infty} j g^{j-1} \nonumber \\
    &amp; = &amp; 0 + g^0 + 2 g^1 + 3 g^2 + \ldots \nonumber \\
    &amp; = &amp; \sum_{j = 0}^{\infty} (1 + j) g^j \nonumber
\end{eqnarray}\]</span></p>
<p>Ahora veámos un ejemplo de una Ecuación Lineal en Diferencia de Segundo Orden. Supongamos la ecuación y el desarrollo siguientes:
<span class="math display">\[\begin{eqnarray}
    Z_t &amp; = &amp; 3 + 0.9 Z_{t-1} - 0.2 Z_{t-2} \nonumber \\
    (1 - 0.9 L + 0.2 L^2) Z_t &amp; = &amp; 3 \nonumber
\end{eqnarray}\]</span></p>
<p>La solución dada por una ecuación similar a la expresión @ref(eq:POL2), obtendríamos la solución dada por las ecuaciones equivalentes a:
<span class="math display">\[\begin{eqnarray}
    1 - 0.9 x + 0.2 x^2 = 0 \nonumber \\
    - 0.2 x^2 + 0.9 x - 1 = 0 \nonumber
\end{eqnarray}\]</span></p>
<p>De donde las raíces del polinomio característico <span class="math inline">\(x_1 = g_1^{-1}\)</span> y <span class="math inline">\(x_2 = g_2^{-1}\)</span> se obtienen de la expresión dada por:
<span class="math display">\[\begin{eqnarray}
    x &amp; = &amp;\frac{-0.9 \pm \sqrt{0.81 + (4)(-0.2)}}{(2)(-0.2)} \nonumber \\
    &amp; = &amp; \frac{0.9 \pm 0.1}{0.4} \nonumber
\end{eqnarray}\]</span></p>
<p>Dado que el componente <span class="math inline">\(a^2_1 + 4 a_2\)</span> es positivo, obtendremos dos raíces reales. Las raíces estarán dadas por <span class="math inline">\(x_1 = 2.5\)</span> y <span class="math inline">\(x_2 = 2.0\)</span>, de lo cual podemos determinar que <span class="math inline">\(g_1 = 0.4\)</span> y <span class="math inline">\(g_2 = 0.5\)</span>. De esta forma tenemos que <span class="math inline">\(|g_1| &lt; 1\)</span> y <span class="math inline">\(|g_2| &lt; 1\)</span>, así la ecuación converge a la expresión dada por las siguientes expresiones:
<span class="math display">\[\begin{eqnarray}
    Z_t &amp; = &amp; \frac{3}{1 - 0.9 L + 0.2 L^2} + s_1 (0.4)^t + s_2 (0.5)^t \nonumber \\
    &amp; = &amp; \frac{3}{1 - 0.9 + 0.2} + s_1 (0.4)^t + s_2 (0.5)^t \nonumber \\
    &amp; = &amp; \frac{3}{(1 - 0.4)(1 - 0.5)} + s_1 (0.4)^t + s_2 (0.5)^t \nonumber
\end{eqnarray}\]</span></p>
<p>Al final, la ecuación que describe la solución general será:
<span class="math display">\[\begin{equation}
    z_t = 10 + s_1 (0.4)^t + s_2 (0.5)^t
    (\#eq:Conver9)
\end{equation}\]</span></p>
<p>Para determinar los valores de <span class="math inline">\(s_1\)</span> y <span class="math inline">\(s_2\)</span> necesitamos obtener dos valores iniciales de la ecuación para lo cual iniciaremos como <span class="math inline">\(t = 0\)</span> y luego obtenemos el valor de <span class="math inline">\(t = 1\)</span>, consideremos el valor de <span class="math inline">\(Z_0 = 0\)</span> y <span class="math inline">\(Z_1 = 50\)</span>:
<span class="math display">\[\begin{eqnarray*}
    Z_0 &amp; = &amp; 10 + s_1(0.4)^0  + s_2(0.5)^0 \\
    0 &amp; = &amp; 10 + s_1 + s_2 \\
    Z_1 &amp; = &amp; 10 + s_1(0.4)^1  + s_2(0.5)^1 \\
    50 &amp; = &amp; 10 + 0.4 s_1 + 0.5 s_2
\end{eqnarray*}\]</span></p>
<p>Por lo que la solución es: <span class="math inline">\(s_1 = -450\)</span> y <span class="math inline">\(s_2 = 440\)</span>, de donde podemos expresar la ecuación como:
<span class="math display">\[\begin{equation}
    Z_t = 10 - 450(0.4)^t + 440(0.5)^t
(\#eq:Ejem01)
\end{equation}\]</span></p>
<p>La ecuación @ref(eq:Ejem01) anterior convergerá al valor de 10 cuando <span class="math inline">\(t \rightarrow \infty\)</span>. Para ilustrar la trayectoria de esta ecuación tomemos un cuadro similar al de los ejemplos anteriores. En el Cuadro @ref(tab:table2) y la Figura @ref(fig:fig23) mostramos los resultados de la trayectorua para 100 periodos.</p>
<p>Finalmente, discutiremos la solución para las Ecuaciones Lineales en Diferencia de Orden <span class="math inline">\(p\)</span>, donde <span class="math inline">\(p \geq 2\)</span>. En general una ecuación de este tipo se puede escribir como:
<span class="math display">\[\begin{equation}
    Z_t = a_0 + a_1 Z_{t-1} + a_2 Z_{t-2} + \ldots + a_p Z_{t-p}
    (\#eq:EDOP)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(t = \ldots, -2, -1, 0, 1, 2, \ldots\)</span> y <span class="math inline">\(a_p \neq 0\)</span>. La ecuación @ref(eq:EDOP) se puede escribir como:
<span class="math display">\[\begin{eqnarray}
    Z_t - a_1 Z_{t-1} - a_2 Z_{t-2} - \ldots - a_p Z_{t-p} &amp; = &amp; a_0 \nonumber \\
    Z_t - a_1 L Z_t - a_2 L^2 Z_t - \ldots - a_p L^p Z_t &amp; = &amp; a_0 \nonumber \\
    (1 - a_1 L - a_2 L^2 - \ldots - a_p L^p) Z_t &amp; = &amp; a_0
    (\#eq:EDOP2)
\end{eqnarray}\]</span></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>t <span class="ot">=</span> <span class="fu">ts</span>(<span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">100</span>))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>Zt<span class="ot">=</span><span class="dv">10-450</span><span class="sc">*</span>(<span class="fl">0.4</span><span class="sc">^</span>t)<span class="sc">+</span><span class="dv">440</span><span class="sc">*</span>(<span class="fl">0.5</span><span class="sc">^</span>t)</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>lista <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>, <span class="dv">97</span><span class="sc">:</span><span class="dv">101</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>t1 <span class="ot">=</span> t[lista]</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>Zt1<span class="ot">=</span>Zt[lista]</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>tabla1 <span class="ot">=</span> <span class="fu">data.frame</span>(Tiempo1, Zt1)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(tabla1) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Tiempo&quot;</span>, <span class="st">&quot;$Z_t =10-450(0.4)^t+440(0.5)^t$&quot;</span>)</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(tabla1, <span class="at">caption =</span> <span class="st">&quot;Un ejemplo de proceso de Ecuación de Segundo Orden convengente&quot;</span>, <span class="at">format =</span> <span class="st">&quot;pandoc&quot;</span>)<span class="sc">%&gt;%</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">10</span>)</span></code></pre></div>
<table>
<caption>(#tab:table2)Un ejemplo de proceso de Ecuación de Segundo Orden convengente</caption>
<thead>
<tr class="header">
<th align="right">Tiempo</th>
<th align="right"><span class="math inline">\(Z_t =10-450(0.4)^t+440(0.5)^t\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0</td>
<td align="right">0.00000</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="right">50.00000</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">48.00000</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="right">36.20000</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">25.98000</td>
</tr>
<tr class="even">
<td align="right">5</td>
<td align="right">19.14200</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">15.03180</td>
</tr>
<tr class="even">
<td align="right">7</td>
<td align="right">12.70022</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">11.42384</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">10.74141</td>
</tr>
<tr class="odd">
<td align="right">10</td>
<td align="right">10.38250</td>
</tr>
<tr class="even">
<td align="right">11</td>
<td align="right">10.19597</td>
</tr>
<tr class="odd">
<td align="right">12</td>
<td align="right">10.09987</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">10.05069</td>
</tr>
<tr class="odd">
<td align="right">14</td>
<td align="right">10.02565</td>
</tr>
<tr class="even">
<td align="right">15</td>
<td align="right">10.01294</td>
</tr>
<tr class="odd">
<td align="right">96</td>
<td align="right">10.00000</td>
</tr>
<tr class="even">
<td align="right">97</td>
<td align="right">10.00000</td>
</tr>
<tr class="odd">
<td align="right">98</td>
<td align="right">10.00000</td>
</tr>
<tr class="even">
<td align="right">99</td>
<td align="right">10.00000</td>
</tr>
<tr class="odd">
<td align="right">100</td>
<td align="right">10.00000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(,<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y=</span>Zt))<span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">col=</span><span class="st">&quot;green4&quot;</span>)<span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col=</span> <span class="st">&quot;green4&quot;</span>)<span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y=</span><span class="fu">expression</span>(Z[t]))</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="01-Elementos_Eq_Diff_files/figure-html/fig23-1.png" alt="Evolución del proceso dado por $Z_t =3+0.9Z_{t-1}-0.2Z_{t-2}$" width="672" />
<p class="caption">
(#fig:fig23)Evolución del proceso dado por <span class="math inline">\(Z_t =3+0.9Z_{t-1}-0.2Z_{t-2}\)</span>
</p>
</div>
<p>Por el Teorema Fundamental del Álgebra es posible escribir a la ecuación @ref(eq:EDOP2) como:
<span class="math display">\[\begin{eqnarray}
    (1 - g_1 L)(1 - g_1 L) \ldots (1 - g_p L) Z_t &amp; = &amp; a_0
    (\#eq:EDOP3)
\end{eqnarray}\]</span></p>
<p>Utilizando la ecuación @ref(eq:EDOP2) y la ecuación @ref(eq:EDOP3) tenemos que la solución general de una ecuación como la descrita en @ref(eq:EDOP) se puede escribir como:
<span class="math display">\[\begin{equation}
    Z_t  =  \frac{a_0}{1 - a_1 - a_2 - \ldots - a_p} + s_1 g^t_1 + s_2 g^t_2 + \ldots + s_p g^t_p \\
    (\#eq:EDOPGEN)
\end{equation}\]</span><br />
<span class="math display">\[\begin{eqnarray}
    Z_t &amp; = &amp; \frac{a_0}{(1 - g_1)(1 - g_1) \ldots (1 - g_p)} + s_1 g^t_1 + s_2 g^t_2 + \ldots + s_p g^t_p
    (\#eq:EDOPGEN2)
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(s_1\)</span>, <span class="math inline">\(s_2\)</span>, …, <span class="math inline">\(s_p\)</span> son cosntantes que se determinan utilizando <span class="math inline">\(p\)</span> valores partículares de <span class="math inline">\(Z_t\)</span>, y la solución general descrita en las ecuaciones @ref(eq:EDOPGEN) y @ref(eq:EDOPGEN2) implica encontrar <span class="math inline">\(p\)</span> raíces: <span class="math inline">\(x_1 = g^{-1}_1\)</span>, <span class="math inline">\(x_2 = g^{-1}_2\)</span>, …, <span class="math inline">\(x_p = g^{-1}_p\)</span> de los siguientes polinomios equivalentes:</p>
<p><span class="math display">\[\begin{eqnarray}
    (1 - g_1)(1 - g_1) \ldots (1 - g_p) = 0
    (\#eq:POLGEN1)
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
    1 - a_1 x - a_2 x^2 - \ldots - a_p x^p = 0
    (\#eq:POLGEN2)
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
    a_p x^p + \ldots + a_2 x^2 + a_1 x - 1 = 0
    (\#eq:POLGEN3)
\end{eqnarray}\]</span></p>
<p>Antes de plantear la solución general, analicemos una solución patícular cuando un conjunto de las <span class="math inline">\(p\)</span> raíces, digamos un total de <span class="math inline">\(m\)</span>, son iguales, es decir, cuando sucede que <span class="math inline">\(g_1 = g_2 = \ldots = g_m = g\)</span> (con <span class="math inline">\(1 &lt; m \leq p\)</span>). En este caso la solución general en la ecuación @ref(eq:EDOPGEN2) se escribe como:
<span class="math display">\[\begin{eqnarray}
    Z_t &amp; = &amp; \frac{a_0}{(1 - g)^m(1 - g_{m+1}) \ldots (1 - g_p)} \nonumber \\
    &amp; &amp; + s_1 g^t + s_2 t g^t + \ldots + s_m t^{m-1} g^t + s_{m+1} g^t_{m+1} + \ldots + s_{p} g^t_{p}
    (\#eq:EDOPGEN3)
\end{eqnarray}\]</span></p>
<p>Definamos:
<span class="math display">\[\begin{equation}
    f(g) = \frac{1}{1 - g} = \sum_{j = 0}^{\infty} g^j
    (\#eq:EDOPGEN4)
\end{equation}\]</span></p>
<p>Si retomamos el método descrito parráfos arriba tenemos las siguientes expresiones. Cuando <span class="math inline">\(m = 2\)</span>:
<span class="math display">\[\begin{equation}
    f&#39;(g) = \frac{1}{(1 - g)^2} = \sum_{j = 0}^{\infty} j g^{j-1} = \sum_{j = 0}^{\infty} (1 + j) g^j \nonumber
\end{equation}\]</span></p>
<p>En el otro extremo, cuando <span class="math inline">\(m = p\)</span>:
<span class="math display">\[\begin{equation}
    f^{(p-1)}(g) = \frac{p-1}{(1 - g)^p} = \sum_{j = 0}^{\infty} \frac{(p-1+j)(p-2+j) \ldots (2+j)(1+j)}{(p-1)!} g^j
    (\#eq:EDOPGEN5)
\end{equation}\]</span></p>
<p>Así, en el extremo cuando <span class="math inline">\(m = p\)</span> la solución general podría estar dada por:
<span class="math display">\[\begin{eqnarray}
    Z_t &amp; = &amp; a_0 \sum_{j = 0}^{\infty} \frac{(p-1+j)(p-2+j) \ldots (2+j)(1+j)}{(p-1)!} g^j \nonumber
    &amp; &amp; + g^t \sum_{i = 0}^p s_i t^{i-1}
    (\#eq:EDOPGEN6)
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(|{g} &lt; 1|\)</span>, <span class="math inline">\(t = \ldots, -2, -1, 0, 1, 2, \ldots\)</span>. Para finalizar esta sección, plantearemos la expresión de polinomio característico que nos permitirá hacer el análisis de convergencia de los procesos. Partamos de que la ecuación @ref(eq:POLGEN3) se puede escribir como:
<span class="math display">\[\begin{equation}
    (x^{-1})^p - a_1 (x^{-1})^{p-1} - a_2 (x^{-1})^{p-1} - \ldots - a_p = 0
    (\#eq:POLGEN55)
\end{equation}\]</span></p>
<p>La ecuación @ref(eq:POLGEN55) permite interpretar las raíces del polinomio característico de forma directa ya que <span class="math inline">\(x^{-1}_1 = g_1\)</span>, <span class="math inline">\(x^{-1}_2 = g_2\)</span>, …, <span class="math inline">\(x^{-1}_p = g_p\)</span>. Así, siempre que <span class="math inline">\(p \geq 1\)</span> en la ecuación @ref(eq:EDOP), diremos que el proceso descrito en esa ecuación dará como resultado un proceso convergente si se cumplen las dos condiciones @ref(eq:COND1) y @ref(eq:COND2):
<span class="math display">\[\begin{equation}
    |a_p| &lt; 1  
    (\#eq:COND1)
\end{equation}\]</span>
<span class="math display">\[\begin{equation}
    a_1 + a_2 + \ldots + a_p &lt; 1
    (\#eq:COND2)
\end{equation}\]</span></p>
<p>Alternativamente, cuando las raíces son reales lo anterior es equivalente a la expresión @ref(eq:COND3):</p>
<p><span class="math display">\[\begin{eqnarray}
    |g_i| &lt; 1
    (\#eq:COND3)
\end{eqnarray}\]</span></p>
<p>Para <span class="math inline">\(\forall i = 1, 2, \ldots, p\)</span>. Cuando la raíces son imaginarias, las dos condiciones @ref(eq:COND1) y @ref(eq:COND2) son equivalentes a la expresión @ref(eq:COND4):</p>
<p><span class="math display">\[\begin{eqnarray}
    \sqrt{g_i g_j} = \sqrt{u^2 + v^2} &lt; 1
    (\#eq:COND4)
\end{eqnarray}\]</span></p>
<p>Para <span class="math inline">\(\forall i \neq j\)</span> y <span class="math inline">\(i, j = 1, 2, \ldots, p\)</span>. Cuando <span class="math inline">\(g_1 = g_2 = \ldots = g_p = g\)</span>, la condición de la ecuación @ref(eq:COND3) se resume a que <span class="math inline">\(|g| &lt; 1\)</span>. En resumen, las condiciones descritas en las ecuaciones @ref(eq:COND3) y @ref(eq:COND4) se puden ilustrar con un circulo unitario como el de la Figura @ref(fig:fig24) en que sí las raíces se ubican dentro de éste, podemos decir que el proceso es convergente en el largo plazo.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.001</span>)</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">=</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> T) </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,y, <span class="at">type =</span> <span class="st">&quot;line&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">col=</span><span class="st">&quot;red4&quot;</span>)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> T) </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,<span class="sc">-</span>y, <span class="at">type =</span> <span class="st">&quot;line&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="at">col=</span><span class="st">&quot;red4&quot;</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> <span class="dv">0</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">0</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="01-Elementos_Eq_Diff_files/figure-html/fig24-1.png" alt="Circulo unitario en el que se cumple que $|g_i|&lt;1$ y $(g_i g_j)^{1/2} = (u^2 + v^2)^{1/2} &lt; 1$" width="384" />
<p class="caption">
(#fig:fig24)Circulo unitario en el que se cumple que <span class="math inline">\(|g_i|&lt;1\)</span> y <span class="math inline">\((g_i g_j)^{1/2} = (u^2 + v^2)^{1/2} &lt; 1\)</span>
</p>
</div>
</div>
</div>
<div id="operador-de-rezago-l" class="section level2" number="2.2">
<h2><span class="header-section-number">2.2</span> Operador de rezago L</h2>
<p>Denotemos, como se ha mencionado con anterioridad, con <span class="math inline">\(L\)</span> al operador de rezago, el cual nos permitirá construir una relación entre diferencias y medias móviles como se verá más adelante en los procesos univariados <span class="math inline">\(AR(p)\)</span>, <span class="math inline">\(MA(q)\)</span> y, en general, <span class="math inline">\(ARIMA(p, d, q)\)</span>. Sean <span class="math inline">\(X\)</span>, <span class="math inline">\(Y\)</span> o <span class="math inline">\(Z\)</span> variables con las que denotaremos a una serie de tiempo (note que hasta el momento no hemos definido qué es una serie de tiempo, no obstante no es necesario definirla para hacer uso del operador).</p>
<p>En esta sección resumiremos algunas propiedades usadas en el capítulo y en capítulos más adelante. Así, si a dicha serie le aplicamos el operador rezago antes definido, el resultado deberá ser que cada uno de los valores de la serie es retardado o regresado un período. Es decir:</p>
<p><span class="math display">\[\begin{equation}
    L Z_t = Z_{t-1}
    (\#eq:Lag1)
\end{equation}\]</span></p>
<p>De esta forma, si aplicamos el operador rezago <span class="math inline">\(L\)</span> a la nueva serie de tiempo dada por <span class="math inline">\(Z_{t-1}\)</span> podemos obtener <span class="math inline">\(Z_{t-2}\)</span>, haciendo uso de la ecuación @ref(eq:Lag1) podemos obtener:
<span class="math display">\[\begin{equation}
    L Z_{t-1} = L(L Z_t) = L^2 Z_t = Z_{t-2}
    (\#eq:Lag2)
\end{equation}\]</span></p>
<p>Mediante una generalización podemos obtener:
<span class="math display">\[\begin{equation}
    L^k Z_t = Z_{t-k}
    (\#eq:Lag3)
\end{equation}\]</span></p>
<p>Para <span class="math inline">\(k = \ldots, -2, -1, 0, 1, 2, \ldots\)</span>. Así, para <span class="math inline">\(k = 0\)</span> obtenemos la identidad dado que <span class="math inline">\(L^0 Z_t = Z_t\)</span>, de tal forma que siempre asumiremos que <span class="math inline">\(L^0 = 1\)</span>. En otro caso, cuando <span class="math inline">\(k &gt; 0\)</span> a la serie de tiempo a la cual se le aplique el operador rezago <span class="math inline">\(L\)</span> se le deberá aplicar un rezago de <span class="math inline">\(k\)</span> periodos a cada uno de los elementos de la serie. Por el contrario, cuando <span class="math inline">\(k &lt; 0\)</span> el operador rezago significa que se deberá adelantar <span class="math inline">\(|k|\)</span> veces a cada elemento de la serie. Por ejemplo, <span class="math inline">\(L^{-3} Z_t = Z_{t+3}\)</span>.</p>
<p>Las reglas descritas en lo subsecuente se mantienen indistintamene cuando aplican para el caso de rezagar como para cuando se adelanta una serie. Como primera propiedad tomemos a la siguiente propiedad:
<span class="math display">\[\begin{equation}
    L^{m} Z_{t-n} = L^{m} (L^{n} Z_{t}) = L^{m + n} Z_{t} = Z_{t-(n + m)}
    (\#eq:Lag4)
\end{equation}\]</span></p>
<p>De lo anterior podemos inferir el siguiente resultado:
<span class="math display">\[\begin{equation}
    \Delta Z_{t} = Z_{t} - Z_{t-1} = (1 - L) Z_{t}
    (\#eq:Lag5)
\end{equation}\]</span></p>
<p>En el caso de la diferencia de órden cuatro o cuarta diferencia se puede expresar como:
<span class="math display">\[\begin{equation}
    \Delta_{4} Z_{t} = Z_{t} - Z_{t-4} = (1 - L^4) Z_{t}
(\#eq:Diff4)
\end{equation}\]</span></p>
<p>Al respecto, vale la pena aclarar que en ocaciones se hará uso de una notación alternativa dada por: <span class="math inline">\(\Delta^k\)</span> o <span class="math inline">\(\Delta_k\)</span>, donde <span class="math inline">\(k = 1, 2, 3, \ldots\)</span>, indistintamente, ya que en ambos casos se referirá a una diferencia de orden <span class="math inline">\(k\)</span>. Esta notación resulta de gran utilidad cuando se quiere comparar periodos equivalentes como, por ejemplo, el mismo trimestre pero de un año anterior. De forma similar, para el caso de logarítmos podemos escribir a la ecuación @ref(eq:Diff4) como:
<span class="math display">\[\begin{equation}
    \Delta^{4} ln(Z_{t}) = \Delta_{4} ln(Z_{t}) = ln(Z_{t}) - ln(Z_{t-4}) = (1 - L^4) ln(Z_{t})
    (\#eq:Diff5)
\end{equation}\]</span></p>
<p>Para el caso de una serie de tiempo que se le ha transformado mediante medias móviles, digamos de <span class="math inline">\(4\)</span> periodos, podemos escribirla como:
<span class="math display">\[\begin{equation}
    Zs_{t} = \frac{1}{4}(Z_{t} + Z_{t-1} + Z_{t-2} + Z_{t-3}) = \frac{1}{4}(1 + L + L^2 + L^3)Z_{t}
    (\#eq:Diff6)
\end{equation}\]</span></p>
<p>Una generalización del anterior caso puede ser escrito como un polinomio de orden <span class="math inline">\(p\)</span> con el operador rezago <span class="math inline">\(L\)</span> dado como:
<span class="math display">\[\begin{eqnarray}
    \alpha(L) Z_{t} &amp; = &amp; (1 - \alpha_1 L - \alpha_2 L^2 - \ldots - \alpha_p L^p) Z_{t} \nonumber \\
    &amp; = &amp; Z_{t} - \alpha_1 Z_{t-1} - \alpha_2 Z_{t-2} - \ldots - \alpha_p Z_{t-p}
(\#eq:Ecp1)
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\alpha_i\)</span> puede ser remplazada por cualquier constante <span class="math inline">\(a_i\)</span>, con <span class="math inline">\(i = 1, 2, 3, \ldots\)</span>, para escribir ecuaciones como las anteriores. Adicionalmente, podemos decir que la ecuación @ref(eq:Ecp1) es una generalización del caso de medias móviles, el cual admite una poderación distinta para cada uno de los elementos rezagados.</p>
<p>Existe la posibilidad de operar más de un polinomio a la vez. Para múltiples polinomios (digamos, los polinomios <span class="math inline">\(\alpha(L)\)</span> y <span class="math inline">\(\beta(L)\)</span>) podemos escribir el siguiente resultado:
<span class="math display">\[\begin{equation}
    \alpha(L) \beta(L) = \beta(L) \alpha(L)
    (\#eq:Diff7)
\end{equation}\]</span></p>
<p>Tales polinomios del operador rezago también son llamados <em>filtros lineales</em>. A manera de ejemplo tomemos el siguiente caso de diferencias para una serie de <span class="math inline">\(Z_t\)</span>:
<span class="math display">\[\begin{equation}
    \Delta Z_{t} = (1 - L) Z_{t} = Z_{t} - Z_{t-1}
    (\#eq:Diff8)
\end{equation}\]</span></p>
<p>y un proceso de medias móviles para la misma serie de <span class="math inline">\(Z_t\)</span>:
<span class="math display">\[\begin{equation}
    Zs_{t} = \frac{1}{4}(1 + L^1 + L^2 + L^3) Z_{t} = \frac{1}{4}(Z_{t} + Z_{t-1} + Z_{t-2} + Z_{t-3})
    (\#eq:Diff9)
\end{equation}\]</span></p>
<p>De tal forma que el producto de ambos procesos se puede escribir como:
<span class="math display">\[\begin{equation}
(1 - L) \times \frac{1}{4}(1 + L^1 + L^2 + L^3) Z_{t} = \frac{1}{4}(1 - L^4) Z_{t}
(\#eq:Diff10)
\end{equation}\]</span></p>
<p>Es decir, que el producto de dos polinomios, uno de diferencias y otro más de medias móviles, resulta en uno de diferencias pero de mayor grado, en este caso de grado 4.</p>
<!--chapter:end:01-Elementos_Eq_Diff.Rmd-->
</div>
</div>
<div id="modelos-de-series-de-tiempo-estacionarias" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Modelos de Series de Tiempo Estacionarias</h1>
<div id="definición-de-ergodicidad-y-estacionariedad" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Definición de ergodicidad y estacionariedad</h2>
<p>A partir de esta sección introduciremos mayor formalidad matemática al análisis, por ello cambiaremos de notación y ocuparemos a <span class="math inline">\(X_t\)</span> en lugar de <span class="math inline">\(Z_t\)</span>. Con <span class="math inline">\(X_t\)</span> denotaremos a una serie de tiempo, ya que con <span class="math inline">\(Z_t\)</span> denotareemos a una variable, sin que ella fuera necesariamente una serie de tiempo. Asimismo, iniciaremos por establecer una serie de definiciones. De esta forma, definiremos a una serie de tiempo como un vector de variables aleatorias de dimensión <span class="math inline">\(T\)</span>, dado como:</p>
<p><span class="math display">\[\begin{equation}
    X_1, X_2, X_3, \ldots ,X_T
    (\#eq:Serie0)
\end{equation}\]</span></p>
<p>Cada una de las <span class="math inline">\(X_t\)</span> (<span class="math inline">\(t = 1, 2, \ldots, T\)</span>) consideradas como una variable aleatoria. Así, también podemos denotar a la serie de tiempo como:
<span class="math display">\[\begin{equation}
    \{ X_t \}^T_{t = 1}
    (\#eq:Serie)
\end{equation}\]</span></p>
<p>Es decir, definiremos a una serie de tiempo como una realización de un proceso estocástico –o un Proceso Generador de Datos (PGD). Consideremos una muestra de los múlples posibles resultados de muestras de tamaño <span class="math inline">\(T\)</span>, la colección dada por:
<span class="math display">\[\begin{equation}
    \{X^{(1)}_1, X^{(1)}_2, \ldots, X^{(1)}_T\}
    (\#eq:Serie1)
\end{equation}\]</span></p>
<p>es una de las tantas posibles resultantes del proceso estocástico o PGD. Eventualmente podríamos estar dispuestos a observar este proceso indefinidamente, de forma tal que estemos interesados en observar a la secuencia dada por <span class="math inline">\(\{ X^{(1)}_t \}^{\infty}_{t = 1}\)</span>, lo cual no dejaría se ser sólo una de las tantas realizaciones o secuencias del proceso estocástico original.</p>
<p>Tan solo para poner un ejemplo, podríamos observar las siguientes realizaciones del mismo PGD:
<span class="math display">\[\begin{eqnarray*}
    &amp; \{X^{(2)}_1, X^{(2)}_2, \ldots, X^{(2)}_T\} &amp; \\
    &amp; \{X^{(3)}_1, X^{(3)}_2, \ldots, X^{(3)}_T\} &amp; \\
    &amp; \{X^{(4)}_1, X^{(4)}_2, \ldots, X^{(4)}_T\} &amp; \\
    &amp; \vdots &amp; \\
    &amp; \{X^{(j)}_1, X^{(j)}_2, \ldots, X^{(j)}_T\} &amp;
\end{eqnarray*}\]</span></p>
<p>Donde <span class="math inline">\(j \in \mathbb{Z}\)</span>. En lo subsecuente, diremos que una serie de tiempo es una realización del proceso estocástico subyacente. Considerando, en consecuencia, al proceso estocástico con todas sus posibilidades de realización.</p>
<p>Para hacer más sencilla la notación no distinguiremos entre el proceso en sí mismo y una de sus realizaciones, es decir, siempre escribiremos a una serie de tiempo como la secuencia mostrada en la ecuación @ref(eq:Serie), o más precisamente como la siguiente realización:
<span class="math display">\[\begin{equation}
    \{ X_1, X_2, \ldots, X_T \}
    (\#eq:Serie2)
\end{equation}\]</span></p>
<p>O simplemente:
<span class="math display">\[\begin{equation}
    X_1, X_2, \ldots, X_T
    (\#eq:Serie3)
\end{equation}\]</span></p>
<p>El proceso estocástico de dimensión <span class="math inline">\(T\)</span> puede ser completamente descrito por su función de distribución multivaraida de dimensión <span class="math inline">\(T\)</span>. No obstante, esto no resulta ser práctico cuando se opere más adelante en el curso. Por ello, en el curso, y en general casi todos los textos lo hacen, sólo nos enfocaremos en sus primer y segundo momentos, es decir, en sus medias o valores esperados:
<span class="math display">\[\begin{equation*}
    \mathbb{E}[X_t]
\end{equation*}\]</span></p>
<p>Para <span class="math inline">\(t = 1, 2, \ldots, T\)</span>; o:
<span class="math display">\[\begin{equation*}
\left[
    \begin{array}{c}
    \mathbb{E}[X_1] \\
    \mathbb{E}[X_2] \\
    \vdots \\
    \mathbb{E}[X_T]
    \end{array}
\right]
\end{equation*}\]</span></p>
<p>o,
<span class="math display">\[\begin{equation*}
\left[
    \begin{array}{c}
    \mathbb{E}[X_1], \mathbb{E}[X_2], \ldots, \mathbb{E}[X_T]
    \end{array}
\right]
\end{equation*}\]</span></p>
<p>De sus variazas:
<span class="math display">\[\begin{equation*}
    Var[X_t] = \mathbb{E}[(X_t - \mathbb{E}[X_t])^2]
\end{equation*}\]</span></p>
<p>Para <span class="math inline">\(t = 1, 2, \ldots, T\)</span>, y de sus <span class="math inline">\(T(T-1)/2\)</span> covarianzas:
<span class="math display">\[\begin{equation*}
    Cov[X_t,X_s] = \mathbb{E}[(X_t - \mathbb{E}[X_t])(X_s - \mathbb{E}[X_s])]
\end{equation*}\]</span></p>
<p>Para <span class="math inline">\(t &lt; s\)</span>. Por lo tanto, en la forma matricial podemos escribir lo siguiente:
<span class="math display">\[\begin{equation*}
\left[
    \begin{array}{c c c c}
    Var[X_1] &amp; Cov[X_1,X_2] &amp; \cdots &amp; Cov[X_1,X_T] \\
    Cov[X_2,X_1] &amp; Var[X_2] &amp; \cdots &amp; Cov[X_2,X_T] \\
    \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
    Cov[X_T,X_1] &amp; Cov[X_T,X_2] &amp; \cdots &amp; Var[X_T] \\
    \end{array}
\right]
\end{equation*}\]</span></p>
<p><span class="math display">\[\begin{equation}
= \left[
    \begin{array}{c c c c}
    \sigma_1^2 &amp; \rho_{12} &amp; \cdots &amp; \rho_{1T} \\
    \rho_{21} &amp; \sigma_2^2 &amp; \cdots &amp; \rho_{2T} \\
    \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
    \rho_{T1} &amp; \rho_{T2} &amp; \cdots &amp; \sigma_T^2 \\
    \end{array}
\right]
    (\#eq:MATCOV)
\end{equation}\]</span></p>
<p>Donde es claro que en la matriz de la ecuación @ref(eq:MATCOV) existen <span class="math inline">\(T(T-1)/2\)</span> covarianzas distintas, ya que se cumple que <span class="math inline">\(Cov[X_t,X_s] = Cov[X_s,X_t]\)</span>, para <span class="math inline">\(t \neq s\)</span>.</p>
<p>A menudo, esas covarianzas son denominadas como autocovarianzas puesto que ellas son covarianzas entre variables aleatorias pertenecientes al mismo proceso estocástico pero en un momento <span class="math inline">\(t\)</span> diferente. Si el proceso estocástico tiene una distribución normal multivariada, su función de distribución estará totalmente descrita por sus momentos de primer y segundo orden.</p>
<p>Ahora introduciremos el concepto de ergodicidad, el cual indica que los momentos muestrales, los cuales son calculados en la base de una serie de tiempo con un número finito de observaciones, en la medida que <span class="math inline">\(T \rightarrow \infty\)</span> sus correspondientes momentos muestrales, tienden a los verdaderos valores poblacionales, los cuales definiremos como <span class="math inline">\(\mu\)</span>, para la media, y <span class="math inline">\(\sigma^2_X\)</span> para la varianza.</p>
<p>Este concepto sólo es cierto si asumimos que, por ejemplo, el valor esperado y la varianza son como se dice a continuación para todo <span class="math inline">\(t = 1, 2, \ldots, T\)</span>:</p>
<p><span class="math display">\[\begin{eqnarray}
    \mathbb{E}[X_t] = \mu_t = \mu \\
    \label{MEDIA}
    (\#eq:ESPERANZA)
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
    Var[X_t] = \sigma^2_X
    (\#eq:VARIANZA)
\end{eqnarray}\]</span></p>
<p>Mas formalmente, se dice que el PGD o el proceso estocástico es ergódico en la media si:</p>
<p><span class="math display">\[\begin{equation}
    \displaystyle\lim_{T \to \infty}{\mathbb{E} \left[ \left( \frac{1}{T} \sum^{T}_{t = 1} (X_t - \mu) \right) ^2 \right]} = 0
    (\#eq:LIM1)
\end{equation}\]</span></p>
<p>y ergódico en la varianza si:
<span class="math display">\[\begin{equation}
    \displaystyle\lim_{T \to \infty}{\mathbb{E} \left[ \left( \frac{1}{T} \sum^{T}_{t = 1} (X_t - \mu) ^2 - \sigma^2_X \right) ^2 \right]} = 0
    (\#eq:LIM2)
\end{equation}\]</span></p>
<p>Estas condiciones se les conoce como <em>propiedades de consistencia</em> para las variables aleatorias. Sin embargo, éstas no pueden ser probadas. Por ello se les denomina como un supuesto que pueden cumplir algunas de las series. Más importante aún: <strong>un proceso estocástico que tiende a estar en equilibrio estadístico en un orden ergódico, es estacionario</strong>.</p>
<p>Podemos distinguir dos tipos de estacionariedad. Si asumimos que la función común de distribución del proceso estocástico no cambia a lo largo del tiempo, se dice que el proceso es <em>estrictamente estacionario</em>. Como este concepto es dificil de aplicar en la práctica, solo consideraremos a la <em>estacionariedad débil</em> o estacionariedad en sus momentos.</p>
<p>Definiremos a la estacionariedad por sus momentos del correspondiente proceso estocástico dado por <span class="math inline">\(\{X_t\}\)</span>:</p>
<ol style="list-style-type: decimal">
<li><p><em>Estacionariedad en media</em>: Un proceso estocástico es estacionario en media si <span class="math inline">\(E[X_t] = \mu_t = \mu\)</span> es constante para todo <span class="math inline">\(t\)</span>.</p></li>
<li><p><em>Estacionariedad en varianza</em>: Un proceso estocástico es estacionario en varianza si <span class="math inline">\(Var[X_t] = \mathbb{E}[(X_t - \mu_t)^2] = \sigma^2_X = \gamma(0)\)</span> es constante y finita para todo <span class="math inline">\(t\)</span>.</p></li>
<li><p><em>Estacionariedad en covarianza</em>: Un proceso estocástico es estacionario en covarianza si <span class="math inline">\(Cov[X_t,X_s] = \mathbb{E}[(X_t - \mu_t)(X_s - \mu_s)] = \gamma(|s-t|)\)</span> es sólo una función del tiempo y de la distancia entre las dos variables aleatorias. Por lo que no depende del tiempo denotado por <span class="math inline">\(t\)</span> (no depende de la información contemporánea).</p></li>
<li><p><em>Estacionariedad débil</em>: Como la estacionariedad en varianza resulta de forma inmediata de la estacionariedad en covarianza cuando se asume que <span class="math inline">\(s = t\)</span>, un proceso estocástico es débilmente estacionario cuando es estacionario en media y covarianza.</p></li>
</ol>
<p>Puesto que resulta poco factible asumir una estacionariedad diferente a la débil, es adelante siempre que digamos que un proceso es estacionario se referirá al caso débil y sólo diremos que el proceso es estacionario, sin el apelativo de débil.</p>
<p>Ahora veamos un ejemplo de lo anterior. Supongamos una serie de tiempo denotada por: <span class="math inline">\(\{U_t\}^T_{t = 0}\)</span>. Decimos que el proceso estocástico <span class="math inline">\(\{U_t\}\)</span> es un <em>proceso estocástico puramente aleatorio</em> o es un <em>proceso estocástico de ruido blanco o caminata aleatoria</em>, si éste tiene las siguientes propiedades:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\mathbb{E}[U_t] = 0\)</span>, <span class="math inline">\(\forall t\)</span></li>
<li><span class="math inline">\(Var[U_t] = \mathbb{E}[(U_t - \mu_t)^2] = \mathbb{E}[(U_t - \mu)^2] = \mathbb{E}[(U_t)^2] = \sigma^2\)</span>, <span class="math inline">\(\forall t\)</span></li>
<li><span class="math inline">\(Cov[U_t,U_s] = \mathbb{E}[(U_t - \mu_t)(U_s - \mu_s)] = \mathbb{E}[(U_t - \mu)(U_s - \mu)] = \mathbb{E}[U_t U_s] = 0\)</span>, <span class="math inline">\(\forall t \neq s\)</span>.</li>
</ol>
<p>En otras palabras, un proceso <span class="math inline">\(U_t\)</span> es un ruido blanco si su valor promedio es cero (0), tiene una varianza finita y constante, y además no le importa la historia pasada, así su valor presente no se ve influenciado por sus valores pasados no importando respecto de que periodo se tome referencia.</p>
<p>En apariencia, por sus propiedades, este proceso es débilmente estacionario –o simplemente, estacionario–. Todas las variables aleatorias tienen una media de cero, una varianza <span class="math inline">\(\sigma^2\)</span> y no existe correlación entre ellas.</p>
<p>Ahora supongamos que definimos un nuevo proceso estocástico <span class="math inline">\(\{X_t\}\)</span> como:
<span class="math display">\[\begin{equation}
    X_t = \left\{ \begin{array}{l} U_0  \mbox{ para } t = 0 \\ X_{t-1} + U_t \mbox{ para } t = 1, 2, 3, \ldots \end{array}\right.
    (\#eq:em1)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\{ U_t \}\)</span> es un proceso puramente aleatorio. Este proceso estocástico, o caminata aleatoria sin tendencia (ajuste - drift), puede ser reescrito como:
<span class="math display">\[\begin{equation}
    X_t = \sum^t_{j = 0} U_j
    (\#eq:em2)
\end{equation}\]</span></p>
<p>Tratemos de dar más claridad al ejemplo, para ello asumamos que generamos a <span class="math inline">\(\{U_t\}\)</span> por medio del lanzamiento de una moneda. Donde obtenemos una cara con una probabilidad de <span class="math inline">\(0.5\)</span>, en cuyo caso decimos que la variable aleatoria <span class="math inline">\(U_t\)</span> tomará el valor de <span class="math inline">\(+1\)</span>, y una cruz con una probabilidad de <span class="math inline">\(0.5\)</span>, en cuyo caso decimos que la variable aleatoria <span class="math inline">\(U_t\)</span> toma el valor de <span class="math inline">\(-1\)</span>.</p>
<p>Este planteamiento cumple con las propiedas enunciadas ya que:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\mathbb{E}[U_t] = 0.5 \times -1 + 0.5 \times 1 = 0\)</span>, <span class="math inline">\(\forall t\)</span></li>
<li><span class="math inline">\(Var[U_t] = \mathbb{E}[(U_t - 0)^2] = \frac{1}{2}((-1)^2) + \frac{1}{2}((1)^2) = 1\)</span>, <span class="math inline">\(\forall t\)</span></li>
<li><span class="math inline">\(Cov[U_t,U_s] = \mathbb{E}[(U_t - 0)(U_s - 0)] = \mathbb{E}[U_t \cdot U_s] = 0\)</span>, <span class="math inline">\(\forall t \neq s\)</span>.</li>
</ol>
<p>Retomando a nuestro proceso <span class="math inline">\(X_t\)</span>, diremos que el caso de <span class="math inline">\(X_0 = 0\)</span>, para <span class="math inline">\(t = 0\)</span>. Si verificamos cúales son sus primeros y segundos momentos de <span class="math inline">\(\{X_t\}\)</span> tenemos:</p>
<p><span class="math display">\[\begin{equation}
    \mathbb{E}[X_t] = \mathbb{E}\left[ \sum^t_{j=1} U_j \right] = \sum^t_{j=1} \mathbb{E}[U_j] = 0
    (\#eq:em3)
\end{equation}\]</span></p>
<p>En cuanto a la varianza:
<span class="math display">\[\begin{eqnarray}
    Var[X_t] &amp; = &amp; Var \left[ \sum^t_{j=1} U_j \right] \nonumber \\
    &amp; = &amp; \sum^t_{j=1} Var[U_j] + 2 * \sum_{j \neq k} Cov[U_j,U_k] \nonumber \\
    &amp; = &amp; \sum^t_{j=1} 1 \nonumber \\
    &amp; = &amp; t
    (\#eq:em4)
\end{eqnarray}\]</span></p>
<p>Lo anterior, dado que hemos supuesto que en la caminata aleatoria todas la variables aleatorias son independientes, es decir, <span class="math inline">\(Cov[U_t,U_s] = E[U_t \cdot U_s] = 0\)</span>. Por su parte, la covarianza del proceso estocástico se puede ver como:
<span class="math display">\[\begin{eqnarray*}
    Cov[X_t,X_s] &amp; = &amp; \mathbb{E} \left[ \left( \sum^t_{j=1} U_j - 0 \right) \left( \sum^s_{i=1} U_i - 0 \right) \right] \\
    &amp; = &amp; \mathbb{E}[(U_1 + U_2 + \ldots + U_t)(U_1 + U_2 + \ldots + U_s)] \\
    &amp; = &amp; \sum^t_{j=1} \sum^s_{i=1} \mathbb{E}[U_j U_i] \\
    &amp; = &amp; \mathbb{E}[U^2_1] + \mathbb{E}[U^2_2] + \ldots + \mathbb{E}[U^2_k] \\
    &amp; = &amp; \sigma^2 + \sigma^2 + \ldots + \sigma^2 \\
    &amp; = &amp; 1 + 1 + 1 + 1 \\
    &amp; = &amp; min(t,s)
\end{eqnarray*}\]</span></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Utilizaremos una función guardada en un archivo a parte</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Llamamos a la función:</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;Caminata.R&quot;</span>)</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos argumentos de la función</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>Opciones <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">1</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>Soporte <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Vamos a réplicar el proceso con estos parámetros</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>Rango <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>Caminos <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>Caminos){</span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  TT <span class="ot">&lt;-</span> <span class="fu">data.matrix</span>(<span class="fu">data.frame</span>(<span class="fu">Caminata</span>(Opciones, Soporte)[<span class="dv">1</span>]))</span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  G_t <span class="ot">&lt;-</span> <span class="fu">data.matrix</span>(<span class="fu">data.frame</span>(<span class="fu">Caminata</span>(Opciones, Soporte)[<span class="dv">2</span>]))</span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(TT, G_t, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Ganancias&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span>Rango,Rango))</span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>  i <span class="ot">&lt;-</span> i <span class="sc">+</span><span class="dv">1</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="02-Modelos_STE_files/figure-html/fig31-1.png" alt="Ejemplo de 10 trayectorias de la caminata aleatoria, cuando sólo es posible cambios de +1 y -1$" width="672" />
<p class="caption">
(#fig:fig31)Ejemplo de 10 trayectorias de la caminata aleatoria, cuando sólo es posible cambios de +1 y -1$
</p>
</div>
<p>Así, el proceso estocástico dado por la caminata alaeatoria sin un término de ajuste es estacionario en media, pero no en varianza o en covarianza, y consecuentemente, en general no estacionario, condición que contraria al caso del proceso simple descrito en <span class="math inline">\(U_t\)</span>.</p>
<p>Es facil ver que muchas de las posibilidades de realización de este proceso estocástico (series de tiempo) pueden tomar cualquiera de las rutas consideradas en el Figura @ref(fig:fig31).</p>
</div>
<div id="función-de-autocorrelación" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Función de autocorrelación</h2>
<p>Para ampliar la discusión, es posible calcular la fuerza o intensidad de la dependencia de las variables aleatorias dentro de un proceso estocástico, ello mediante el uso de las autocovarianzas. Cuando las covarianzas son normalizadas respecto de la varianza, el resultado es un término que es independiente de las unidad de medida aplicada, y se conoce como la <em>función de autocorrelación</em>.</p>
<p>Para procesos estacionarios, dicha función de autocorrelación esta dada por:
<span class="math display">\[\begin{equation}
    \rho(\tau) = \frac{\mathbb{E}[(X_t - \mu)(X_{t+\tau} - \mu)]}{\mathbb{E}[(X_t - \mu)^2]} = \frac{\gamma(\tau)}{\gamma(0)}
    (\#eq:em5)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\tau = \ldots, -2, -1, 0, 1, 2, \ldots\)</span>. Dicha función tiene las siguientes propiedades:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\rho(0) = 1\)</span>. Es fácil demostrar que la función <span class="math inline">\(\rho(0)\)</span> es:</li>
</ol>
<p><span class="math display">\[\begin{equation}
    \rho(0) = \frac{\mathbb{E}[(X_t - \mu)(X_{t + 0} - \mu)]}{\mathbb{E}[(X_t - \mu)^2]} = \frac{\mathbb{E}[(X_t - \mu)^2]}{\mathbb{E}[(X_t - \mu)^2]} = 1
\end{equation}\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li><span class="math inline">\(\rho(\tau) = \rho(-\tau)\)</span>. Partiendo de la definción de <span class="math inline">\(\rho(\tau)\)</span> podemos ver que la distancia que existe entre <span class="math inline">\(t\)</span> y <span class="math inline">\(t + \tau\)</span> es <span class="math inline">\(\tau\)</span>, de esta forma la autocorrelación de la variable <span class="math inline">\(X\)</span> entre los periodos antes señalados debería ser la misma para el caso en que <span class="math inline">\(\rho(-\tau)\)</span>. Partamos de la ecuación para ver más claramente:</li>
</ol>
<p><span class="math display">\[\begin{equation}
    \rho(\tau) = \frac{\mathbb{E}[(X_t - \mu)(X_{t + \tau} - \mu)]}{\mathbb{E}[(X_t - \mu)^2]} = \frac{\mathbb{E}[(X_t - \mu)(X_{t - \tau} - \mu)]}{\mathbb{E}[(X_t - \mu)^2]} = \rho(-\tau)
\end{equation}\]</span></p>
<ol start="3" style="list-style-type: decimal">
<li><span class="math inline">\(\lvert\rho(\tau)\lvert \leq 1\)</span>, para todo <span class="math inline">\(\tau\)</span>.</li>
</ol>
<p>Derivado de las propiedades 1 y 2 antes descritas se puede concluir que sólo es necesario conocer la función de autocorrelación para el caso de <span class="math inline">\(\tau = 1, 2, 3, \ldots\)</span>, ya que de estos casos podemos derivar los valores de la función de autocorrelación complementarios de <span class="math inline">\(\tau = \ldots, -3, -2, -1\)</span>.</p>
<p>Partiendo de los supuestos de ergodicidad en relación a la media, varianza y covarianzas de un proceso estacionario, podemos estimar dichos paramétros con las siguientes formulaciones o propuestas de estimadores puntuales:
<span class="math display">\[\begin{equation}
    \hat{\mu} = \frac{1}{T} \sum^T_{t=1} X_t
    (\#eq:em6)
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
    \hat{\gamma}(0) = \frac{1}{T} \sum^T_{t=1} (X_t - \hat{\mu})^2 = \hat{\sigma}^2
    (\#eq:em7)
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
    \hat{\gamma}(\tau) = \frac{1}{T} \sum^{T - \tau}_{t=1} (X_t - \hat{\mu})(X_{t+\tau} - \hat{\mu}) \mbox{, para } \tau = 1, 2, \ldots, T-1
    (\#eq:em8)
\end{equation}\]</span></p>
<p>No hacemos la demostración en estas notas –sería deseable que el alumno revisará la afimación– pero estos últimos son estimadores consistentes de <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\gamma(0)\)</span> y <span class="math inline">\(\gamma(\tau)\)</span>. Por su parte, un estimador consistente de la función de autocorrelación estará dado por:
<span class="math display">\[\begin{equation}
\hat{\rho}(\tau) = \frac{\sum^{T - \tau}_{t=1} (X_t - \hat{\mu})(X_{t+\tau} - \hat{\mu})}{\sum^T_{t=1} (X_t - \hat{\mu})^2} = \frac{\hat{\gamma}(\tau)}{\hat{\gamma}(0)}
(\#eq:eqautocorr)
\end{equation}\]</span></p>
<p>El estimador de la ecuación @ref(eq:eqautocorr) es asintóticamente insesgado. Por ejemplo, para el caso de un proceso de ruido blanco o caminata aleatoria, su varianza puede ser aproximada por el valor dado <span class="math inline">\(1/T\)</span>. Ésta tiene, asintóticamente, una distribución normal. Dado esto, el intervalo de confianza al <span class="math inline">\(95\%\)</span> será el dado por <span class="math inline">\(\pm 2/\sqrt{T}\)</span>, en el cual se encuentra la mayoría de los coeficientes de autocorrelación estimados.</p>
<p>Ahora discutamos algunos ejemplos o aplicaciones. Cuando se realiza la evaluación de la estimación de un modelo de series de tiempo es importante saber si los residuales del modelo realmente tienen propiedades de un proceso puramente aleatorio, en partícular, si ellos no están correlacionados entre sí. Así, la hipotésis a probar será:
<span class="math display">\[\begin{equation}
    H_0 : \rho(\tau) = 0 \mbox{, para todo } \tau = 1, 2, \ldots, m \mbox{ y } m &lt; T
    (\#eq:eqautocorr1)
\end{equation}\]</span></p>
<p>Esta expresión se puede interpretar como una prueba respecto de si la correlación entre la información de periodos atrás es cero con la información contemporánea. Para hacer una pruena global de la hipotésis de sí un número <span class="math inline">\(m\)</span> de coeficientes de autocovarianzas son cero Box y Pierce (1970) desarrollarón la siguiente estadística:
<span class="math display">\[\begin{equation}
    Q^* = T \sum_{j = 1}^{m} \hat{\rho} (j)^2
    (\#eq:eqautocorr2)
\end{equation}\]</span></p>
<p>Bajo la hipotésis nula esta estadística se distribulle asintóticamente como una chi cuadrado (<span class="math inline">\(\chi^2\)</span>) con <span class="math inline">\(m-k\)</span> grados de libertad y con <span class="math inline">\(k\)</span> que representa al número de paramétros estimados.</p>
<p>Haciendo una aplicación estricta de la distribución de esta estadística, sabemos que esta se mantiene asintóticamente. Greta, Ljung y Box (1978) propusieron la siguiente modificación de la estadística para muestras pequeñas:
<span class="math display">\[\begin{equation}
    Q = T(T + 2) \sum_{j = 1}^{m} \frac{\hat{\rho} (j)^2}{T - j}
    (\#eq:eqautocorr3)
\end{equation}\]</span></p>
<p>La cual también se distribulle asintóticamente como <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(m-k\)</span> grados de libertad.</p>
<p>También es intuitivamente claro que la hipótesis nula de no autocorrelación de residuales debería ser rechazada si alguno de los valores <span class="math inline">\(\hat{\rho} (j)\)</span> es muy grande, es decir, si <span class="math inline">\(Q\)</span> o <span class="math inline">\(Q^*\)</span> es muy grande. O más precisamente, si estas estadísticas son más grandes que los correspondientes valores críticos de la distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(m-k\)</span> grados de libertad a algún grado dado de signficancia.</p>
<p>Una alternativa para esta prueba es una del tipo Multiplicadores de Lagrange (o LM) desarrollada por Breusch (1978) y Godfrey (1978). La cual, al igual que las estadísticas <span class="math inline">\(Q\)</span> y <span class="math inline">\(Q^*\)</span>, la hipotesis nula está dada por:</p>
<blockquote>
<p><span class="math inline">\(H_0\)</span>: Los residuales no están autocorrelacionados.</p>
</blockquote>
<blockquote>
<p><span class="math inline">\(H_a\)</span>: Los residuales muestran alguna acutocorrelación de forma autoregresiva o de medias móviles.</p>
</blockquote>
<p>La prueba consiste en realizar una regresión auxiliar en la cual los residuales se estiman en función de las variables explicativas del modelo original y en los residuales mismos pero rezagados hasta el término <span class="math inline">\(m\)</span> (regresión auxiliar). La prueba resulta en una estadìstica con una distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(m\)</span> grados de libertad la cual está dada por la expresión:</p>
<p><span class="math display">\[\begin{equation}
    LM = T \times R^2
    (\#eq:eqautocorr4)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(R^2\)</span> es el resultante de la regresión auxiliar y <span class="math inline">\(T\)</span> es el número de observaciones totales.</p>
<p>En comparación con una prueba Durbin - Watson que es comúnmente usada en la econometría tradicional, para probar autocorrelación de los residuales, las estadísticas <span class="math inline">\(Q\)</span>, <span class="math inline">\(Q^*\)</span> y <span class="math inline">\(LM\)</span> tienen las siguientes ventajas:</p>
<ol style="list-style-type: decimal">
<li>Permiten corroborar la existencia de autocorrelación para cualquier orden, y no solo para un primer orden (es decir, para cualquier valor de <span class="math inline">\(\tau = 1, 2, 3, \ldots\)</span>);</li>
<li>Los resultados se mantienen aún y cuando exista una probable variable endógena en forma rezagada, y</li>
<li>No depende del orden o la forma en que se acomoden las observaciones, algo que es muy probalble que ocurra en la econometría tradicional.</li>
</ol>
<p>El hecho de los residuales no estén autocorrelacionados no implica que estos sean independientes y normalmente distribuidos. La ausencia de autocorrelación no implica una independencia estocástica si las variables son normalmente distribuidas.</p>
<p>A menudo se asume que estos residuales están distribuidos normalmente, ya que la mayoría de las pruebas estadísticas tienen este supuesto detrás. No obstante, ello también depende de los otros momentos de la distribución, específicamente del tercer y cuarto momento. Los cuales expresan como:</p>
<p><span class="math display">\[\begin{equation*}
    \mathbb{E}[(X_t - \mathbb{E}[X_t])^i] \mbox{, } i = 3, 4
\end{equation*}\]</span></p>
<p>El tercer momento es necesario para determinar el sesgo, el cual esta dado como:</p>
<p><span class="math display">\[\begin{equation}
    \hat{S} = \frac{1}{T} \frac{\sum_{t = 1}^{T} (X_t - \hat{\mu})^3}{\sqrt{\hat{\gamma}(0)^3}}
    (\#eq:eqautocorr6)
\end{equation}\]</span></p>
<p>Para distribuciones simetricas (como en el caso de la distribución normal) el valor teórico para el sesgo es cero.</p>
<p>La curtosis, la cual esta dada en función del cuarto momento, se puede expresar como:
<span class="math display">\[\begin{equation}
    \hat{K} = \frac{1}{T} \frac{\sum_{t = 1}^{T} (X_t - \hat{\mu})^4}{\hat{\gamma}(0)^2}
    (\#eq:eqautocorr7)
\end{equation}\]</span></p>
<p>Para el caso de una distribución normal, esta estadística toma el valor de 3. Valores más grandes que 3 indican que la distribución tienen colas anchas. En tales casos se ubican a los datos financieros.</p>
<p>Usando el valor de las estadísticas para medir el sesgo y la curtosis, <span class="math inline">\(S\)</span> y <span class="math inline">\(K\)</span>, respectivamente, Jarque y Bera (1980) propusieron una prueba de normalidad, la cual puede ser aplicada a series de tiempo en niveles o en diferencias indistintamente. Dicha prueba se expresa como:
<span class="math display">\[\begin{equation}
    JB = \frac{T}{6} \left(\hat{S} + \frac{1}{4} (\hat{K} - 3)^2 \right)
    (\#eq:eqautocorr8)
\end{equation}\]</span></p>
<p>La cual tiene una distribución <span class="math inline">\(\chi^2\)</span> con <span class="math inline">\(2\)</span> grados de libertad y donde <span class="math inline">\(T\)</span> es el tamaño de la muestra. La hipótesis de que las observaciones están distribuidas de forma normal se rechaza si los valores de la estadística de prueba es más grande que los correspondientes valores criticos en tablas.</p>
<p>Veamos un ejemplo para ilustrar el uso de la función de autocorrelación. Tomemos como variable al número de pasajeros transportados por el sistema de transporte del metro de la CDMX.<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> Los datos empleados fueron tomados del INEGI y son una serie de tiempo en el periodo que va de enero de 2000 a junio de 2019, es decir, 234 observaciones. Como se puede apreciar en la Figura @ref(fig:fig32), el número de pasajeros por mes ha oscilado significativamente a lo largo de tiempo. Incluso podemos observar un cambio estructural de la serie entre 2011 y 2012. Asimismo, podemos ubicar una caida atípica que ocurrió en septiembre de 2017.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>Datos<span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;BD/Clase_03/Base_Transporte.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;Datos&quot;</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>Pax_Metro <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos<span class="sc">$</span>Pax_Metro, </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="dv">2000</span>, </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>Dat_Aereo <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos[<span class="fu">c</span>(<span class="st">&quot;Pax_Nal&quot;</span>, <span class="st">&quot;Pax_Int&quot;</span>, <span class="st">&quot;Vue_Nal&quot;</span>, <span class="st">&quot;Vue_Int&quot;</span>)], </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="dv">2000</span>, </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Datos, <span class="fu">aes</span>(<span class="at">x =</span> Periodo, <span class="at">y =</span> Pax_Metro)) <span class="sc">+</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="co">#geom_point(size = 1.0, color = &quot;darkblue&quot;) + </span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="co">#theme_bw() + </span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Tiempo&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Millones de pasajeros&quot;</span>) <span class="sc">+</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Pasajeros Transportados en el Metro de la CDMX&quot;</span>,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;(Ene-2000 a Jul-2021)&quot;</span>,</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Fuente: Elaboración propia con información del INEGI, </span><span class="sc">\n</span><span class="st">https://www.inegi.org.mx/app/indicadores/?tm=0&amp;t=1090&quot;</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span><span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="02-Modelos_STE_files/figure-html/fig32-1.png" alt="Evolución del número de pasajeros en el Metro de la CDMX, enero 2000 a junio de 2019" width="90%" />
<p class="caption">
(#fig:fig32)Evolución del número de pasajeros en el Metro de la CDMX, enero 2000 a junio de 2019
</p>
</div>
<p>A esta serie de tiempo le calculamos los pincipales estadísticos hasta ahora estudiados y obtenemos el Cuadro @ref(tab:foo). En dicho cuadro se destaca que se muestra la función de autocirrelación para los tres primeros rezagos. Para mayor detalle, en la Figura @ref(fig:fig33) se muestra la función de autocorrelación, en donde las bandas descritas por las líneas azules son el intervalo de confianza desntro de las cuales no se puede rechazar la hipotésis nula de que <span class="math inline">\(H_0: \hat{\rho}(p) = 0\)</span>, para todo <span class="math inline">\(\tau = 1, 2, \ldots, T-1\)</span>.</p>
<table>
<caption>(#tab:foo) Estadísticas descriptivas del número de pasajeros en el Metro de la CDMX, enero de 2000 a junio de 2019</caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Estadística</th>
<th align="center">Valor</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\mu} = \frac{1}{T} \sum^T_{t=1} X_t\)</span></td>
<td align="center">124.3000</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{\gamma}(0) = \frac{1}{T} \sum^T_{t=1} (X_t - \hat{\mu})^2\)</span></td>
<td align="center">103.6400</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\gamma}(1) = \frac{1}{T} \sum^{T - 1}_{t=1} (X_t - \hat{\mu})(X_{t+1} - \hat{\mu})\)</span></td>
<td align="center">63.1100</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{\gamma}(2) = \frac{1}{T} \sum^{T - 2}_{t=1} (X_t - \hat{\mu})(X_{t+2} - \hat{\mu})\)</span></td>
<td align="center">72.9100</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\gamma}(3) = \frac{1}{T} \sum^{T - 3}_{t=1} (X_t - \hat{\mu})(X_{t+3} - \hat{\mu})\)</span></td>
<td align="center">63.6900</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{\rho}(1) = \frac{\sum^{T - 1}_{t=1} (X_t - \hat{\mu})(X_{t+1} - \hat{\mu})}{\sum^T_{t=1} (X_t - \hat{\mu})^2} = \frac{\hat{\gamma}(1)}{\hat{\gamma}(0)}\)</span></td>
<td align="center">0.6089</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\rho}(2) = \frac{\sum^{T - 2}_{t=1} (X_t - \hat{\mu})(X_{t+2} - \hat{\mu})}{\sum^T_{t=1} (X_t - \hat{\mu})^2} = \frac{\hat{\gamma}(2)}{\hat{\gamma}(0)}\)</span></td>
<td align="center">0.7035</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{\rho}(3) = \frac{\sum^{T - 3}_{t=1} (X_t - \hat{\mu})(X_{t+3} - \hat{\mu})}{\sum^T_{t=1} (X_t - \hat{\mu})^2} = \frac{\hat{\gamma}(3)}{\hat{\gamma}(0)}\)</span></td>
<td align="center">0.6145</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(Q^* = T \sum_{j = 1}^{1} \hat{\rho} (j)^2\)</span></td>
<td align="center">86.7577</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(Q^* = T \sum_{j = 1}^{2} \hat{\rho} (j)^2\)</span></td>
<td align="center">290.9279</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(Pax_Metro, </span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">lag.max =</span> <span class="dv">150</span>, </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&#39;Resagos k en meses&#39;</span>, </span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&quot;Funcion de Autocorrelación del número de pasajeros del metro&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="02-Modelos_STE_files/figure-html/fig33-1.png" alt="Función de Autocorrelación: 150 rezagos del número de pasajeros en el Metro de la CCDMX, enero 2000 a junio de 2019" width="90%" />
<p class="caption">
(#fig:fig33)Función de Autocorrelación: 150 rezagos del número de pasajeros en el Metro de la CCDMX, enero 2000 a junio de 2019
</p>
</div>
<!--chapter:end:02-Modelos_STE.Rmd-->
</div>
</div>
<div id="procesos-estacionarios-univariados" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Procesos estacionarios univariados</h1>
<p>En este capítulo analizaremos el método o metodología de análisis de series de tiempo propuesto por Box y Jenkins (1970). Los modelos propuestos dentro de está metodología o conjunto de métodos se han vuelto indispensables para efectos de realizar pronósticos de corto plazo.</p>
<p>En este sentido, se analizarán los métodos más importantes en series de tiempo: Autoregresivos (AR) y de Medias Móviles (MA). Asimismo, se realizará un análisis de los procesos que resultan de la combinación de ambos, conocida como ARMA, los cuales son más comúnmente usados para realizar pronósticos.</p>
<div id="procesos-autoregresivos-ar" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Procesos Autoregresivos (AR)</h2>
<p>Los procesos autoregresivos tienen su origen en el trabajo de Cochrane y Orcutt de 1949, mediante el cual analizaron los residuales de una regresión clásica como un proceso autoregresivo. Puede consultarse el apéndice para la discusión del modelo de regresión clásica.</p>
<div id="ar1" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> AR(1)</h3>
<p>Como primer caso analizaremos al proceso autoregresivo de primer orden, <span class="math inline">\(AR(1)\)</span>, el cual podemos definir como una Ecuación Lineal en Diferencia Estocástica de Primer Orden. Diremos que una Ecuación Lineal en Diferencia de Primer Orden es estocástica si en su representación analítica considera un componente estocástico como en la ecuación @ref(eq:EDOEst) descrita a continuación:
<span class="math display">\[\begin{equation}
    X_t = a_0 + a_1 X_{t-1} + U_t
    (\#eq:EDOEst)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(a_0\)</span> es un término constante, <span class="math inline">\(U_t\)</span> es un proceso estacionario, con media cero (0), una varianza finita y constante (<span class="math inline">\(\sigma^2\)</span>) y una covarianza que depende de la distancia entre <span class="math inline">\(t\)</span> y cualquier <span class="math inline">\(t-s\)</span> (<span class="math inline">\(\gamma_s\)</span>)–que no depende de los valores pasados o futuros de la variable–, <span class="math inline">\(X_0\)</span> es el valor inicial de <span class="math inline">\(X_t\)</span>. No obstante, en general vamos a asumir que la covarianza será cero (0), por lo que tendremos un proceso puramente aleatorio. Considerando la ecuación @ref(eq:EDOEst) y un proceso de sustitución sucesivo podemos establecer lo siguiente, empezando con <span class="math inline">\(X_1\)</span>:
<span class="math display">\[\begin{eqnarray*}
    X_{1} &amp; = &amp; a_0 + a_1 X_{0} + U_{1}
\end{eqnarray*}\]</span></p>
<p>Para <span class="math inline">\(X_2\)</span>:
<span class="math display">\[\begin{eqnarray*}
X_{2} &amp; = &amp; a_0 + a_1 X_{1} + U_{2} \\
    &amp; = &amp; a_0 + a_1 (a_0 + a_1 X_{0} + U_{1}) + U_{2} \\
    &amp; = &amp; a_0 + a_1 a_0 + a_1^2 X_{0} + a_1 U_{1} + U_{2}
\end{eqnarray*}\]</span></p>
<p>Para <span class="math inline">\(X_3\)</span>:
<span class="math display">\[\begin{eqnarray*}
X_{3} &amp; = &amp; a_0 + \alpha X_{2} + U_{3} \\
    &amp; = &amp; a_0 + a_1 (a_0 + a_1 a_0 + a_1^2 X_{0} + a_1 U_{1} + U_{2}) + U_{3} \\
    &amp; = &amp; a_0 + a_1 a_0 + a_1^2 a_0 + a_1^3 X_{0} + a_1^2 U_{1} + a_1 U_{2} + U_{3}
\end{eqnarray*}\]</span></p>
<p>Así, para cualquier <span class="math inline">\(X_t\)</span>, <span class="math inline">\(t = 1, 2, 3, \ldots\)</span>, obtendríamos:
<span class="math display">\[\begin{eqnarray}
X_{t} &amp; = &amp; a_0 + a_1 X_{t - 1} + U_{t} \nonumber \\
    &amp; = &amp; a_0 + a_1 (a_0 + a_1 a_0 + a_1^2 a_0 + \ldots + a_1^{t-2} a_0 + a_1^{t-1} X_{0} \nonumber \\
    &amp;   &amp; + a_1^{t-2} U_{1} + \ldots + a_1 U_{t - 2} + U_{t - 1}) + U_{t} \nonumber \\
    &amp; = &amp; a_0 + a_1 a_0 + a_1^2 a_0 + a_1^3 a_0 + \ldots + a_1^{t-1} a_0 + a_1^{t} X_{0} \nonumber \\
    &amp;   &amp; + a_1^{t-1} U_{1} + \ldots a_1^2 U_{t - 2} + a_1 U_{t - 1} + U_{t} \nonumber \\
    &amp; = &amp; (1 + a_1 + a_1^2 + a_1^3 + \ldots + a_1^{t-1}) a_0 + a_1^{t} X_{0} \nonumber \\
    &amp;   &amp; + a_1^{t-1} U_{1} + \ldots + a_1^2 U_{t - 2} + a_1 U_{t - 1} + U_{t}  \nonumber\\
    &amp; = &amp; \frac{1 - a_1^t}{1 - a_1} a_0 + a_1^{t} X_{0} + \sum^{t-1}_{j = 0} a_1^{j} U_{t - j}
    (\#eq:EDOSSol)
\end{eqnarray}\]</span></p>
<p>De esta forma en la ecuación @ref(eq:EDOSSol) observamos un proceso que es explicado por dos partes: una que depende del tiempo y otra que depende de un proceso estocástico. Asimismo, debe notarse que la condición de convergencia es idéntica que en el caso de ecuaciones en diferencia estudiadas al inicio del curso: <span class="math inline">\(\lvert a_1 \lvert &lt; 1\)</span>, por lo que cuando <span class="math inline">\(t \to \infty\)</span>, la expresión @ref(eq:EDOSSol) será la siguiente:
<span class="math display">\[\begin{equation}
    X_t = \frac{1}{1 - a_1} a_0 + \sum^{\infty}_{j = 0} a_1^{j} U_{t - j}
    (\#eq:EDOSLP)
\end{equation}\]</span></p>
<p>Así, desaparece la parte dependiente del tiempo y únicamente prevalece la parte que es dependiente del proceso estocástico. Esta es la solución de largo plazo del proceso <span class="math inline">\(AR(1)\)</span>, la cual depende del proceso estocástico. Notemos, además, que esta solución implica que la variable o la serie de tiempo <span class="math inline">\(X_t\)</span> es tambien un proceso estocástico que hereda las propiedades de <span class="math inline">\(U_t\)</span>. Así, <span class="math inline">\(X_t\)</span> es también un proceso estocástico estacionario, como demostraremos más adelante.</p>
<p>Observemos que la ecuación @ref(eq:EDOSLP) se puede reescribir si consideramos la formulación que en la literatura se denomina como la descomposición de Wold, en la cual se define que es posible asumir que <span class="math inline">\(\psi_j = a_1^j\)</span> y se considera el caso en el cual <span class="math inline">\(\lvert a_1 \lvert&lt; 1\)</span>, de esta forma tendremos que por ejemplo cuando:
<span class="math display">\[\begin{equation*}
    \sum^{\infty}_{j = 0} \psi^2_j = \sum^{\infty}_{j = 0} a_1^{2j} = \frac{1}{1 - a_1^2}
\end{equation*}\]</span></p>
<p>Alternativamente y de forma similar a las ecuaciones en diferencia estudiadas previamente podemos escribir el proceso <span class="math inline">\(AR(1)\)</span> mediante el uso del operador rezago como:
<span class="math display">\[\begin{eqnarray}
    X_t &amp; = &amp; a_0 + a_1 L X_t + U_t \nonumber \\
    X_t - a_1 L X_t &amp; = &amp; a_0 + U_t \nonumber \\
    (1 - a_1 L) X_t &amp; = &amp; a_0 + U_t \nonumber \\
    X_t &amp; = &amp; \frac{a_0}{1 - a_1 L} + \frac{1}{1 - a_1 L} U_t
    (\#eq:AR1)
\end{eqnarray}\]</span></p>
<p>En esta última ecuación retomamos el siguiente término para reescribirlo como:
<span class="math display">\[\begin{equation}
    \frac{1}{1 - a_1 L} = 1 + a_1 L + a_1^2 L^2 + a_1^3 L^3 + \ldots
    (\#eq:AR2)
\end{equation}\]</span></p>
<p>Tomando este resultado para sustituirlo en ecuación @ref(eq:AR1), obtenemos la siguiente expresión:
<span class="math display">\[\begin{eqnarray}
X_t &amp; = &amp; (1 + a_1 L + a_1^2 L^2 + a_1^3 L^3 + \ldots) a_0 + (1 + a_1 L + a_1^2 L^2 + a_1^3 L^3 + \ldots) U_t \nonumber \\
    &amp; = &amp; (1 + a_1 + a_1^2 + a_1^3 + \ldots) a_0 + U_t + a_1 U_{t-1} + a_1^2 U_{t-2} + a_1^3 U_{t-3} + \ldots \nonumber \\
    &amp; = &amp; \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j}
    (\#eq:AR1Sol)
\end{eqnarray}\]</span></p>
<p>Donde la condición de convergencia y estabilidad del proceso descrito en esta ecuación es que <span class="math inline">\(\lvert a_1 \lvert &lt; 1\)</span>. Por lo que hemos demostrado que mediante el uso del operador de rezago es posible llegar al mismo resultado que obtuvimos mediante el procedimiento de sustituciones iterativas.</p>
<p>La ecuación @ref(eq:AR1Sol) se puede interpretar como sigue. La solución o trayectoria de equilibrio de un AR(1) se divide en dos partes. La primera es una constante que depende de los valores de <span class="math inline">\(a_0\)</span> y <span class="math inline">\(a_1\)</span>. La segunda parte es la suma ponderada de las desviaciones o errores observados y acumulados en el tiempo hasta el momento <span class="math inline">\(t\)</span>.</p>
<p>Ahora obtendremos los momentos que describen a la serie de tiempo cuando se trata de un porceso <span class="math inline">\(AR(1)\)</span>. Para ello debemos obtener la media, la varianza y las covarianzas de <span class="math inline">\(X_t\)</span>. Para los siguientes resultados debemos recordar y tener en mente que si <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio, entonces:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\mathbb{E}[U_t] = 0\)</span> para todo <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(Var[U_t] = \sigma^2\)</span> para todo <span class="math inline">\(t\)</span></li>
<li><span class="math inline">\(Cov[U_t, U_s] = 0\)</span> para todo <span class="math inline">\(t \neq s\)</span></li>
</ol>
<p>Dicho lo anterior y partiendo de la ecuación @ref(eq:AR1Sol), el primer momento o valor esperado de la serie de tiempo será el siguiente:
<span class="math display">\[\begin{eqnarray}
\mathbb{E}[X_t] &amp; = &amp; \mathbb{E} \left[ \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j} \right] \nonumber \\
    &amp; = &amp; \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j \mathbb{E}[U_{t-j}] \nonumber \\
    &amp; = &amp; \frac{a_0}{1 - a_1} = \mu
    (\#eq:AR1m1)
\end{eqnarray}\]</span></p>
<p>Respecto de la varianza podemos escribir la siguiente expresión a partir de la ecuación @ref(eq:AR1Sol):
<span class="math display">\[\begin{eqnarray}
Var[X_t] &amp; = &amp; \mathbb{E}[(X_t - \mu)^2] \nonumber \\
    &amp; = &amp; \mathbb{E} \left[ \left( \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j} - \frac{a_0}{1 - a_1} \right)^2 \right] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_{t} + a_1 U_{t-1} + a_1^2 U_{t-2} + a_1^3 U_{t-3} + \ldots)^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[U^2_{t} + a_1^2 U^2_{t-1} + a_1^4 U^2_{t-2} + a_1^6 U^2_{t-3} + \ldots \nonumber \\
    &amp;   &amp; + 2 a_1 U_t U_{t-1} + 2 a_1^2 U_t U_{t-2} + \ldots] \nonumber \\
    &amp; = &amp; \mathbb{E}[U^2_{t}] + a_1^2 \mathbb{E}[U^2_{t-1}] + a_1^4 \mathbb{E}[U^2_{t-2}] + a_1^6 \mathbb{E}[U^2_{t-3}] + \ldots \nonumber \\
    &amp; = &amp; \sigma^2 + a_1^2 \sigma^2 + a_1^4 \sigma^2 + a_1^6 \sigma^2 + \ldots \nonumber \\
    &amp; = &amp; \sigma^2 (1 + a_1^2 + a_1^4 + a_1^6 + \ldots) \nonumber \\
    &amp; = &amp; \sigma^2 \frac{1}{1 - a_1^2} = \gamma(0)
    (\#eq:AR1Var)
\end{eqnarray}\]</span></p>
<p>Previo a analizar la covarianza de la serie recordemos que para el proceso puramente aleatorio <span class="math inline">\(U_t\)</span> su varianza y covarianza puede verse como <span class="math inline">\(\mathbb{E}[U_t, U_s] = \sigma^2\)</span>, para <span class="math inline">\(t = s\)</span>, y <span class="math inline">\(\mathbb{E}[U_t, U_s] = 0\)</span>, para cualquier otro caso, respectivamente.</p>
<p>Dicho lo anterior, partiendo de la ecuación @ref(eq:AR1Sol) la covarianza de la serie estará dada por:
<span class="math display">\[\begin{eqnarray}
Cov(X_t, X_{t-\tau}) &amp; = &amp; \mathbb{E}[(X_t - \mu)(X_{t-\tau} - \mu)] \nonumber \\
    &amp; = &amp; \mathbb{E} \left[ \left( \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j} - \frac{a_0}{1 - a_1} \right) \right. \nonumber \\
    &amp;   &amp; \left. \times \left( \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-\tau-j} - \frac{a_0}{1 - a_1} \right) \right] \nonumber \\
    &amp; = &amp; a_1^{\tau} \mathbb{E}[U^2_{t-\tau} + a_1 U^2_{t-\tau-1} + a_1^2 U^2_{t-\tau-2} + a_1^3 U^2_{t-\tau-3} + \ldots] \nonumber \\
    &amp; = &amp; a_1^{\tau} \sigma^2 \frac{1}{1 - a_1^2} = \gamma(\tau)
    (\#eq:AR1Cov)
\end{eqnarray}\]</span></p>
<p>Notése que con estos resultados en las ecuaciones @ref(eq:AR1Var) y @ref(eq:AR1Cov) podemos construir la función de autocorrelación teórica como sigue:
<span class="math display">\[\begin{eqnarray}
\rho(\tau) &amp; = &amp; \frac{\gamma(\tau)}{\gamma(0)} \nonumber \\
    &amp; = &amp; a_1^\tau
    (\#eq:emi1)
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\tau = 1, 2, 3, \ldots\)</span> y <span class="math inline">\(\lvert a_1 \lvert &lt; 1\)</span>. Este último resultado significa que cuando el proceso autoregresivo es de orden 1 (es decir, AR(1)) la función de autocorrelación teóricamente es igual al parámetro <span class="math inline">\(a_1\)</span> elevado al número de rezagos considerados. No obstante, note que esto no significa que la autocorrelación observada sea como lo expresa en planteamiento anterior. Por el contrario, una observación sencilla mostraría que la autocorrelación observada sería ligeramente distinta a la autocorrelación teórica.</p>
<p>Ahora veámos algunos ejemplos. En el primer ejemplo simularemos una serie y mostraremos el analísis de un proceso construído considerando un proceso puramente aleatorio como componente <span class="math inline">\(U_t\)</span>.<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a> Por su parte, en un segundo ejemplo aplicaremos el análisis a una serie de tiempo de una variable económica observada.<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a></p>
<p>Para el primer ejemplo consideremos un proceso dado por la forma de un <span class="math inline">\(AR(1)\)</span> como en la ecuación @ref(eq:AR1) cuya solución esta dada por la ecuación @ref(eq:AR1Sol). En especifico, supongamos que el término o componente estocástico <span class="math inline">\(U_t\)</span> es una serie generada a partir de numeros aleatorios de una función normal con media <span class="math inline">\(0\)</span> y desviación estándar <span class="math inline">\(4\)</span>. Los detalles del proceso simulado se muestra en las siguientes gráficas.</p>
<p>La Figura @ref(fig:GAR1Real) ilustra el comportamiento que se debería observar en una serie considerando el procedimiento iterativo de construcción. Por su parte, la Figura @ref(fig:GAR1Teo) ilustra el proceso o trayectoria de la solución de la serie de tiempo. Finalmente, las Figuras @ref(fig:GAR1FACr) y @ref(fig:GAR1FACr) muestran el correlograma calculado considerando una función de autocorrelación aplicada al porceso real y una función de autocorrelación aplicada al proceso teórico, respectivamente.</p>
<p>Recordemos que una trayectoria de equilibrio o solución de un <span class="math inline">\(AR(1)\)</span> es como se muestra en la ecuación @ref(eq:AR1Sol). Así, nuestra serie simulada cumple con la característica de que los errores son más relevantes cuando la serie es corta. Por el contrario, los errores son menos relevantes, cuando la serie es muy larga. La Figura @ref(fig:GAR1Com) ilustra esta observación de la trayectoria de equilibrio.</p>
<p>Para el segundo ejemplo consideremos una aplicación a una serie de tiempo en especifico: Pasajeros transportados mensualmente en el Sistema de Transporte Colectivo Metro (pasajeros medidos en millones).<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(latex2exp)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Parametros:</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>a0 <span class="ot">&lt;-</span> <span class="dv">5</span>; a1 <span class="ot">&lt;-</span> <span class="fl">0.9</span>; X_0 <span class="ot">&lt;-</span> (a0<span class="sc">/</span>(<span class="dv">1</span> <span class="sc">-</span> a1)); T <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Definimos un data frame para almacenar el proceso, agregamos una columna para el tiempo</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>X_t <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Tiempo =</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span>T))</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a><span class="co">#  Parte estocastica de la serie de tiempo:</span></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12345</span>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregamos un término estocástico al data frame</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>X_t<span class="sc">$</span>U_t <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(T<span class="sc">+</span><span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">4</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregamos columnas con NA&#39;s para un proceso teorico y uno real</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>X_t<span class="sc">$</span>X_t <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>X_t<span class="sc">$</span>XR_t <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a><span class="co"># La serie teórica inicia en un valor inicial X_0</span></span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>X_t<span class="sc">$</span>X_t[<span class="dv">1</span>] <span class="ot">&lt;-</span> X_0</span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a><span class="co"># La serie real inicia en un valor inicial X_0</span></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>X_t<span class="sc">$</span>XR_t[<span class="dv">1</span>] <span class="ot">&lt;-</span> X_0</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Agregamos una columna para la función de Autocorrelación teórica:</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a>X_t<span class="sc">$</span>rho <span class="ot">&lt;-</span><span class="cn">NA</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>(T <span class="sc">+</span> <span class="dv">1</span>)) {</span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Real:</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a>  X_t<span class="sc">$</span>XR_t[i] <span class="ot">=</span> a0 <span class="sc">+</span> a1<span class="sc">*</span>X_t<span class="sc">$</span>XR_t[i<span class="dv">-1</span>] <span class="sc">+</span> X_t<span class="sc">$</span>U_t[i<span class="dv">-1</span>]</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Teórico:</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  X_t<span class="sc">$</span>X_t[i] <span class="ot">=</span> X_t<span class="sc">$</span>X_t[i<span class="dv">-1</span>] <span class="sc">+</span> (a1<span class="sc">^</span>(i<span class="dv">-1</span>))<span class="sc">*</span>X_t<span class="sc">$</span>U_t[i<span class="dv">-1</span>]</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Autocorrelación:</span></span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>  X_t<span class="sc">$</span>rho[i<span class="dv">-1</span>] <span class="ot">=</span> a1<span class="sc">^</span>(i<span class="dv">-1</span>)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/GAR1Real-1.png" alt="AR(1) considerando $X_t=5+0.9X_{t-1}+U_t$ ; $X_0=50$ y que $U_t$~$N(0, 4)$ y que $U_t \sim \mathcal{N}(0, 4)$" width="100%" />
<p class="caption">
(#fig:GAR1Real)AR(1) considerando <span class="math inline">\(X_t=5+0.9X_{t-1}+U_t\)</span> ; <span class="math inline">\(X_0=50\)</span> y que <span class="math inline">\(U_t\)</span>~<span class="math inline">\(N(0, 4)\)</span> y que <span class="math inline">\(U_t \sim \mathcal{N}(0, 4)\)</span>
</p>
</div>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> X_t, <span class="fu">aes</span>(<span class="at">x =</span> Tiempo, <span class="at">y =</span> X_t)) <span class="sc">+</span> </span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Tiempo&quot;</span>) <span class="sc">+</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">TeX</span>(<span class="st">&quot;$X_t$&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Comportamiento del Proceso Teórico&quot;</span>,</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Con un error con Distribución Normal (media = 0, desviación estándar = 4)&quot;</span>,</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Fuente: Elaboración propia.&quot;</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/GAR1Teo-1.png" alt="$X_t = \frac{5}{1 - 0.9} + \sum_{j = 0}^{t-1} 0.9^j U_{t-j}$, y que $U_t \sim \mathcal{N}(0, 4)$}" width="100%" />
<p class="caption">
(#fig:GAR1Teo)<span class="math inline">\(X_t = \frac{5}{1 - 0.9} + \sum_{j = 0}^{t-1} 0.9^j U_{t-j}\)</span>, y que <span class="math inline">\(U_t \sim \mathcal{N}(0, 4)\)</span>}
</p>
</div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(X_t<span class="sc">$</span>XR_t, <span class="at">lag.max =</span> <span class="dv">30</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Autocorrelacion&quot;</span>,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab=</span><span class="st">&quot;Rezagos&quot;</span>, </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">main=</span><span class="st">&quot;Funcion de Autocorrelacion Real&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/GAR1FACr-1.png" alt="Función de autocorrelación de un AR(1): $\rho(\tau)=\frac{\gamma(    au)}{\gamma(0)}$" width="100%" />
<p class="caption">
(#fig:GAR1FACr)Función de autocorrelación de un AR(1): <span class="math inline">\(\rho(\tau)=\frac{\gamma( au)}{\gamma(0)}\)</span>
</p>
</div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(X_t<span class="sc">$</span>rho[<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>], <span class="at">names.arg =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">border=</span><span class="st">&quot;blue&quot;</span>, <span class="at">density =</span> <span class="fu">c</span>(<span class="dv">10</span>,<span class="dv">20</span>), </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">ylab =</span> <span class="st">&quot;Autocorrelacion&quot;</span>, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">xlab=</span><span class="st">&quot;Rezagos&quot;</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">main=</span><span class="st">&quot;Funcion de Autocorrelacion Teórica&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/GAR1FACt-1.png" alt="Función de autocorrelación de un AR(1): $\rho(\tau)= a_1^\tau$" width="100%" />
<p class="caption">
(#fig:GAR1FACt)Función de autocorrelación de un AR(1): <span class="math inline">\(\rho(\tau)= a_1^\tau\)</span>
</p>
</div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> X_t, <span class="fu">aes</span>(<span class="at">x =</span> Tiempo)) <span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> XR_t), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;darkred&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> X_t), <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">color =</span> <span class="st">&quot;darkblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Tiempo&quot;</span>) <span class="sc">+</span> </span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">TeX</span>(<span class="st">&quot;$X_t$&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Comportamiento de los Procesos Real y Teórico&quot;</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;Con un error con Distribución Normal (media = 0, desviación estándar = 4)&quot;</span>,</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Fuente: Elaboración propia.&quot;</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  )</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/GAR1Com-1.png" alt="AR(1) considerando en conjunto $X_t = 5 + 0.9 X_{t-1} + U_t$; $X_0 = 50$ y $X_t = \frac{5}{1 - 0.9} + \sum_{j = 0}^{t-1} 0.9^j U_{t-j}$, y que $U_t \sim \mathcal{N}(0, 4)$" width="100%" />
<p class="caption">
(#fig:GAR1Com)AR(1) considerando en conjunto <span class="math inline">\(X_t = 5 + 0.9 X_{t-1} + U_t\)</span>; <span class="math inline">\(X_0 = 50\)</span> y <span class="math inline">\(X_t = \frac{5}{1 - 0.9} + \sum_{j = 0}^{t-1} 0.9^j U_{t-j}\)</span>, y que <span class="math inline">\(U_t \sim \mathcal{N}(0, 4)\)</span>
</p>
</div>
<p>A la serie se le aplicará una metodología de estimación dada por el método de Máxima Verosimilitud (ML, por sus siglás en inglés). Antes de realizar el proceso de estimación consideremos una transformación de diferencias logaritmicas, con el objeto de obtener una serie de tiempo expresada en tasas de crecimiento y con un comportamiento parecido a un proceso estacionario.<a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a></p>
<p>Así, para cada una de las series que analicemos en diferencias logaritmicas las expresaremos bajo la siguiente transformación: <span class="math display">\[\begin{equation*}
    DLX_t = log(X_t) - log(X_{t-k})
\end{equation*}\]</span></p>
<p>Donde <span class="math inline">\(k = 1, 2, 3, \ldots\)</span> y <span class="math inline">\(log(.)\)</span> es la función logaritmo natural. Esta expresión se pude interpretar como una tasa de crecimiento puesto que asumimos variaciones pequeñas para las cuales se cumple que: <span class="math inline">\(log(X_t) - log(X_{t-k}) \approx \frac{X_t - X_{t-k}}{X_t}\)</span>.</p>
<p>Primero, al realizar el análisis de una serie de tiempo deberemos decidir si éste se realizará para la serie en niveles o en diferencias. Por convención, decimos que la series esta en niveles si ésta se analiza sin heacerle ninguna transformación o si se analiza aplicando logarimos. Cuando la serie se analiza en diferencias significa que la diferencia se hace sin aplicar logaritmos o aplicando logaritmos. Sin embargo, lo común es hacer un análisis en logaritmos.</p>
<p>Para decidir cómo analizar la serie de pasajeros en el metro de la CDMX en la Figura @ref(fig:GPaxMetro) se muestra la gráfica de la serie en niveles (sin transformación logaritmica y con transformación logarítmica) y en diferencias logarítmicas mensuales (es decir, con <span class="math inline">\(k = 1\)</span>).</p>
<p>A continuación, estimaremos una <span class="math inline">\(AR(1)\)</span> para la serie en niveles bajo la transformación logaritmica (<span class="math inline">\(PaxLMetro_t\)</span>) y en diferencias logarítmitcas (<span class="math inline">\(PaxDLMetro_t\)</span>). Para el primer caso obtenemos el siguiente resultado:</p>
<p><span class="math display">\[\begin{eqnarray}
PaxLMetro_t  =  4.8190 &amp; + &amp; 0.5916 PaxLMetro_{t-1} \\
    (0.0105) &amp; + &amp; (0.0526) \\
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
\hat{\sigma}^2 &amp; = &amp; 0.004335  y  AIC  =  -602.73
\end{eqnarray}\]</span></p>
<p>Para el segundo caso obtenemos el siguiente resultado:</p>
<p><span class="math display">\[\begin{eqnarray}
PaxDLMetro_t  =  0.0007 &amp; - &amp; 0.6194 PaxDLMetro_{t-1} \\
    (0.0023) &amp; + &amp; (0.0511) \\
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
\hat{\sigma}^2 &amp; = &amp; 0.003344 &amp; y &amp; AIC &amp; = &amp; -660.53
\end{eqnarray}\]</span></p>
<p>En ambos casos observamos que el parámetro asociado al componente AR es significativo y cumple con la restricción de ser en valor absoluto menor a 1, por lo que la solución asociada al procesp será convergente. También en ambos casos se reporta la estadística o Criterio de Información de Akaike (AIC, por sus siglas en inglés), misma que más adelante discutiremos su importancia y aplicación.</p>
</div>
<div id="ar2" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> AR(2)</h3>
<p>Una vez analizado el caso de <span class="math inline">\(AR(1)\)</span> analizaremos el caso del <span class="math inline">\(AR(2)\)</span>. La ecuación generalizada del proceso autoregresivo de orden 2 (denotado como <span class="math inline">\(AR(2)\)</span>) puede ser escrito como:
<span class="math display">\[\begin{equation}
    X_t = a_0 + a_1 X_{t-1} + a_2 X_{t-2} + U_t
    (\#eq:AR2Eq)
\end{equation}\]</span></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>Datos <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;BD/Base_Transporte.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;Datos&quot;</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion a series de tiempo:</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Una serie - caso univariado:</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># En Niveles</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>Dat_Aereo <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos[<span class="fu">c</span>(<span class="st">&quot;Pax_Nal&quot;</span>, <span class="st">&quot;Pax_Int&quot;</span>, <span class="st">&quot;Vue_Nal&quot;</span>, <span class="st">&quot;Vue_Int&quot;</span>)], </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>                <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">7</span>), </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>Pax_Metro <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos<span class="sc">$</span>Pax_Metro, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">7</span>), </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="co"># En Logaritmos:</span></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>Dat_LAereo <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(Datos[<span class="fu">c</span>(<span class="st">&quot;Pax_Nal&quot;</span>, <span class="st">&quot;Pax_Int&quot;</span>, <span class="st">&quot;Vue_Nal&quot;</span>, <span class="st">&quot;Vue_Int&quot;</span>)]), </span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">7</span>), </span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>Pax_LMetro <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(Datos<span class="sc">$</span>Pax_Metro), <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">7</span>), </span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Diferencias mensuales:</span></span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>Pax_DLMetro <span class="ot">&lt;-</span> <span class="fu">ts</span>( <span class="fu">log</span>(Datos<span class="sc">$</span>Pax_Metro) <span class="sc">-</span> <span class="fu">lag</span>(<span class="fu">log</span>(Datos<span class="sc">$</span>Pax_Metro), <span class="at">k =</span> <span class="dv">1</span>),</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>                 <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a><span class="co">#Graficas</span></span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pax_Metro, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, </span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Pasajeros transportados (Millones) en el SCM&quot;</span>,</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pax_LMetro, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, </span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;LN Pasajeros transportados (Millones) en el SCM&quot;</span>,</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pax_DLMetro, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, </span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Diff LN Pasajeros transportados (Millones) en el SCM&quot;</span>, </span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pax_Metro, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Pasajeros transportados (Millones) en el SCM&quot;</span>,</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pax_LMetro, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;LN Pasajeros transportados (Millones) en el SCM&quot;</span>,</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pax_DLMetro, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, </span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Diff LN Pasajeros transportados (Millones) en el SCM&quot;</span>, </span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/GPaxMetro-1.png" alt="Pasajeros transportados (Millones) en el metro de la CDM en niveles y en diferencias logaritmicas." width="100%" />
<p class="caption">
(#fig:GPaxMetro)Pasajeros transportados (Millones) en el metro de la CDM en niveles y en diferencias logaritmicas.
</p>
</div>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>Donde <span class="math inline">\(U_t\)</span> denota un proceso puramente aleatorio con media cero (<span class="math inline">\(0\)</span>), varianza constante (<span class="math inline">\(\sigma^2\)</span>) y autocovarianza cero (<span class="math inline">\(Cov(U_t, U_s) = 0\)</span>, con <span class="math inline">\(t \neq s\)</span>), y un parametro <span class="math inline">\(a_2 \neq 0\)</span>. Así, utilizando el operador rezago podemos reescribir la ecuación @ref(eq:AR2Eq) como:
<span class="math display">\[\begin{eqnarray*}
    X_t - a_1 X_{t-1} - a_2 X_{t-2} &amp; = &amp; a_0 + U_t \\
    (1 - a_1 L^1 - a_2 L^2) X_t &amp; = &amp; a_0 + U_t
\end{eqnarray*}\]</span></p>
<p>Donde, vamos a denotar a <span class="math inline">\(\alpha (L) = (1 - a_1 L^1 - a_2 L^2)\)</span>, y lo llamaremos como un polinomio que depende del operador rezago y que es distinto de cero. De esta forma podemos reescribir a la ecuación @ref(eq:AR2Eq) como:
<span class="math display">\[\begin{equation}
    \alpha(L) X_t = a_0 + U_t
    (\#eq:AR2Eq1)
\end{equation}\]</span></p>
<p>Ahora, supongamos que existe el inverso multiplicativo del polinomio <span class="math inline">\(\alpha(L)\)</span>, el cual será denotado como: <span class="math inline">\(\alpha^{-1}(L)\)</span> y cumple con que:
<span class="math display">\[\begin{equation}
    \alpha^{-1}(L) \alpha(L) = 1   
      (\#eq:AR2Eq2)
\end{equation}\]</span></p>
<p>Así, podemos escribir la solución a la ecuación @ref(eq:AR2Eq) como:
<span class="math display">\[\begin{equation}
    X_t = \alpha^{-1}(L) \delta + \alpha^{-1}(L) U_t
\end{equation}\]</span></p>
<p>Si utilizamos el hecho que <span class="math inline">\(\alpha^{-1}(L)\)</span> se puede descomponer a través del procedimiento de Wold en un polinomio de forma similar el caso de <span class="math inline">\(AR(1)\)</span>, tenemos que:
<span class="math display">\[\begin{equation}
    \alpha^{-1}(L) = \psi_0 + \psi_1 L + \psi_2 L^2 + \ldots
      (\#eq:AR2Eq3)
\end{equation}\]</span></p>
<p>Por lo tanto, el inverso multiplicativo <span class="math inline">\(\alpha^{-1}(L)\)</span> se puede ver como:
<span class="math display">\[\begin{equation}
    1 = (1 - a_1 L^1 - a_2 L^2) (\psi_0 + \psi_1 L + \psi_2 L^2 + \ldots)
      (\#eq:InvAlpha)
\end{equation}\]</span></p>
<p>Desarrollando la ecuación @ref(eq:InvAlpha) tenemos la sigueinte expresión:</p>
<p><span class="math display">\[\begin{eqnarray}
    1 &amp; = &amp; \psi_0 &amp; + &amp; \psi_1 L &amp; + &amp; \psi_2 L^2 &amp; + &amp; \psi_3 L^3 &amp; + &amp; \ldots \\
     &amp;  &amp;  &amp; - &amp; a_1 \psi_0 L &amp; - &amp; a_1 \psi_1 L^2 &amp; - &amp; a_1 \psi_2 L^3 &amp; - &amp; \ldots \\
    &amp; &amp;  &amp;  &amp;  &amp; - &amp; a_2 \psi_0 L^2  &amp; - &amp; a_2 \psi_1 L^3 &amp; - &amp; \ldots
\end{eqnarray}\]</span></p>
<p>Ahora, podemos agrupar todos los términos en función del exponente asociado al operador rezago <span class="math inline">\(L\)</span>. La siguiente es una solución partícular y es una de las múltiples que podrían existir que cumpla con la ecuación @ref(eq:InvAlpha). Sin embargo, para efectos del análisis sólo necesitamos una de esas soluciones. Utilizaremos las siguientes condiciones que deben cumplirse en una de las posibles soluciones:</p>
<p><span class="math display">\[\begin{eqnarray}
    L^0 : &amp;   &amp; \Rightarrow &amp; \psi_0 = 1 \\
    L : &amp; \psi_1 - a_1 \psi_0 = 0 &amp; \Rightarrow &amp; \psi_1 = a_1$ \\
    L^2 : &amp; \psi_2 - a_1 \psi_1 - a_2 \psi_0 = 0 &amp; \Rightarrow &amp; \psi_2 = a^2_1 + a_2 \\
    L^3 : &amp; \psi_3 - a_1 \psi_2 - a_2 \psi_1 = 0 &amp; \Rightarrow &amp; \psi_3 = a^3_1 + 2 a_1 a_2$ \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots
\end{eqnarray}\]</span></p>
<p>De esta forma podemos observar que en el límite siempre obtendremos una ecuación del tipo <span class="math inline">\(\psi_j - a_1 \psi_{j-1} - a_2 \psi_{j-2} = 0\)</span> asociada a cada uno de los casos en que exista un <span class="math inline">\(L^j\)</span>, donde <span class="math inline">\(j \neq 0, 1\)</span>, y la cual siempre podremos resolver conociendo que las condiciones iniciales son: <span class="math inline">\(\psi_0 = 1\)</span> y <span class="math inline">\(\psi_1 = a_1\)</span>.</p>
<p>Así, de las relaciones antes mencionadas y considerando que <span class="math inline">\(\alpha^{-1} (L)\)</span> aplicada a una constante como <span class="math inline">\(a_0\)</span>, tendrá como resultado otra constante. De esta forma podemos escribir que la solución del proceso AR(2) en la ecuación @ref(eq:AR2Eq) será dada por una expresión como sigue:
<span class="math display">\[\begin{equation}
    X_t = \frac{\delta}{1 - a_1 - a_2} + \sum^{\infty}_{j = 0} \psi_{t - j} U_{t - j}
    (\#eq:AR2EqSol)
\end{equation}\]</span></p>
<p>Donde todos los parametros <span class="math inline">\(\psi_i\)</span> está determinado por los parámtros <span class="math inline">\(a_0\)</span>, <span class="math inline">\(a_1\)</span> y <span class="math inline">\(a_2\)</span>. En particular, <span class="math inline">\(\psi_0 = 1\)</span> y <span class="math inline">\(\psi_1 = a_1\)</span> como describimos anteriormente. Al igual que en el caso del <span class="math inline">\(AR(1)\)</span>, en la ecuación @ref(eq:AR2EqSol) las condiciones de estabilidad estarán dadas por las soluciones del siguiente polinomio característico:<a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>
<span class="math display">\[\begin{equation}
    \lambda^2 - \lambda a_1 - a_2 = 0
    (\#eq:AR2EqSol1)
\end{equation}\]</span></p>
<p>Así, la condición de estabilidad de la trayectoria es que <span class="math inline">\(\lvert\lambda_i\lvert &lt; 1\)</span>, para <span class="math inline">\(i = 1, 2\)</span>. Es decir, es necesario que cada una de las raíces sea, en valor absoluto, siempre menor que la unidad. Estas son las condiciones de estabilidad para el proceso <span class="math inline">\(AR(2)\)</span>.</p>
<p>Finalmente, al igual que en un <span class="math inline">\(AR(1)\)</span>, a continuación determinamos los momentos de una serie que sigue un proceso <span class="math inline">\(AR(2)\)</span>. Iniciamos con la determinación de la media de la serie:
<span class="math display">\[\begin{equation}
    \mathbb{E}[X_t] = \mu = \frac{a_0}{1 - a_1 - a_2}
    (\#eq:AR2EqSol2)
\end{equation}\]</span></p>
<p>Lo anterior es cierto puesto que <span class="math inline">\(\mathbb{E}[U_{t - i}] = 0\)</span>, para todo <span class="math inline">\(i = 0, 1, 2, \ldots\)</span>. Para determinar la varianza utilizaremos las siguientes relaciones basadas en el uso del valor esperado, varianza y covarianza de la serie. Adicionalmente, para simplificar el trabajo asumamos que <span class="math inline">\(a_0 = 0\)</span>, lo cual implica que <span class="math inline">\(\mu = 0\)</span>. Dicho lo anterior, partamos de:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[X_t X_{t - \tau}] &amp; = &amp; \mathbb{E}[(a_1 X_{t-1} + a_2 X_{t-2} + U_t) X_{t - \tau}]\\
    &amp; = &amp; a_1 \mathbb{E}[X_{t - 1} X_{t - \tau}] + a_2 \mathbb{E}[X_{t - 2} X_{t - \tau}] + \mathbb{E}[U_{t} X_{t - \tau}]
    (\#eq:AR2EqSol3)
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\tau = 0, 1, 2, 3, \ldots\)</span> y que <span class="math inline">\(\mathbb{E}[U_{t} X_{t - \tau}] = 0\)</span> para todo <span class="math inline">\(\tau \neq 0\)</span>.<a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a> Dicho esto, podemos derivar el valor del valor esperado para diferentes valores de <span class="math inline">\(\tau\)</span>:</p>
<p><span class="math display">\[\begin{eqnarray}
    \tau = 0: &amp; \gamma(0) &amp; = &amp; \alpha_1 \gamma(1) + \alpha_2 \gamma(2) + \sigma^2 \\
    \tau = 1: &amp; \gamma(1) &amp; = &amp; \alpha_1 \gamma(0) + \alpha_2 \gamma(1) \\
    \tau = 2: &amp; \gamma(2) &amp; = &amp; \alpha_1 \gamma(1) + \alpha_2 \gamma(0) \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots
\end{eqnarray}\]</span></p>
<p>Donde debe ser claro que <span class="math inline">\(\mathbb{E}[(X_{t} - \mu)(X_{t - \tau} - \mu)] = \mathbb{E}[X_{t} X_{t - \tau}] = \gamma(\tau)\)</span>. Así, en general cuando <span class="math inline">\(\tau \neq 0\)</span>:
<span class="math display">\[\begin{equation}
    \gamma(\tau) = a_1 \gamma(\tau - 1) + a_2 \gamma(\tau - 2)
\end{equation}\]</span></p>
<p>Realizando la sustitución recursiva y solucionando el sistema respectivo obtenemos que las varianza y covarianzas estaran determinadas por:
<span class="math display">\[\begin{equation}
    Var[X_t] = \gamma(0) = \frac{1 - a_2}{(1 + a_2)[(1 - a_2)^2 - a^2_1]} \sigma^2
    (\#eq:AR2EqSol5)
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
    \gamma(1) = \frac{a_1}{(1 + a_2)[(1 - a_2)^2 - a^2_1]} \sigma^2
    (\#eq:AR2EqSol6)
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
    \gamma(2) = \frac{a^2_1 + a_2 - a^2_2}{(1 + a_2)[(1 - a_2)^2 - a^2_1]} \sigma^2
    (\#eq:AR2EqSol7)
\end{equation}\]</span></p>
<p>Recordemos que las funciones de autocorrelación se obtienen de la división de cada unas de las funciones de covarianza (<span class="math inline">\(\gamma(\tau)\)</span>) por la varianza (<span class="math inline">\(\gamma(0)\)</span>). Así, podemos construir la siguiente expresión:
<span class="math display">\[\begin{equation}
    \rho(\tau) - a_1 \rho(\tau - 1) - a_2 \rho(\tau - 2) = 0
    (\#eq:AR2EqSol8)
\end{equation}\]</span></p>
<p>Ahora veámos un ejemplo. Utilizaremos la serie de Pasajeros en vuelos nacionales (en vuelos de salidas) para estimar un <span class="math inline">\(AR(2)\)</span> mediante el método de máxima verosimilitud (ML, por sus siglas en inglés). Antes de realizar el proceso de estimación consideremos una transformación de la serie en logaritmos y una más en diferencias logarítmicas; lo anterior con el objeto de obtener un conjunto de series de tiempo suavizada y expresada en tasas de crecimiento, con un comportamiento parecido a un proceso estacionario.</p>
<p>Así, para cada una de las series que analicemos en diferencias logarítmicas las expresaremos bajo la siguiente transformación:
<span class="math display">\[\begin{equation*}
    DLX_t = log(X_t) - log(X_{t-k})
\end{equation*}\]</span></p>
<p>Donde <span class="math inline">\(k = 1, 2, 3, \ldots\)</span> y <span class="math inline">\(log(.)\)</span> es la función logaritmo natural. Por convención, decimos que la serie está en niveles si ésta se analiza sin heacerle ninguna transformación o se analiza en logarimos. Cuando la serie se analiza en diferencias significa que la diferencia se hace sin aplicar logaritmos. Y cuando la serie analizada está en diferenncias logarítmicas también diremos que esta en diferencias. Sin embargo, lo común es hacer un análisis en logaritmos y en difereencias logarítmicas.</p>
<p>Primero, para decidir si se realizará un AR(2) para la serie en niveles o en diferencias analizaremos su gráfica. La serie en niveles, en niveles bajo una transformación logarítmica y en diferencias logarítmicas mensuales de los pasajeros en vuelos nacionales se muestra en la Figura @ref(fig:GPaxNal).</p>
<p>A continuación, estimaremos un <span class="math inline">\(AR(2)\)</span> para la serie en niveles bajo una transformación logarítmica (<span class="math inline">\(LPaxNal_t\)</span>) y en diferencias logarítmitcas (<span class="math inline">\(DLPax_Nal_t\)</span>). Para el primer caso obtenemos el siguiente resultado:</p>
<p><span class="math display">\[\begin{eqnarray}
    LPaxNal_t &amp; = &amp; 14.6267 &amp; + &amp; 0.7637  &amp; LPaxNal_{t-1} \\
    &amp;  &amp; (0.1816) &amp;  &amp; (0.0637) &amp; \\
    &amp;  &amp;  &amp; + &amp; 0.2025 &amp; LPaxNal_{t-2} \\
    &amp;  &amp;  &amp;  &amp; (0.0646) &amp;
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
\hat{\sigma}^2 &amp; = &amp; 0.01138 &amp; y &amp; AIC &amp; = &amp; -372.64
\end{eqnarray}\]</span></p>
<p>Para el segundo caso obtenemos el siguiente resultado:
<span class="math display">\[\begin{eqnarray}
    DLPaxNal_t &amp; = &amp; 0.0050 &amp; - &amp; 0.3205  &amp; DLPaxNal_{t-1} \\
    &amp;  &amp; (0.0036) &amp;  &amp; (0.0592) &amp; \\
    &amp;  &amp;  &amp; - &amp; 0.4242 &amp; DLPaxNal_{t-2} \\
    &amp;  &amp;  &amp;  &amp; (0.0591) &amp;
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
\hat{\sigma}^2 &amp; = &amp; 0.009378 &amp; y &amp; AIC &amp; = &amp; -418.3
\end{eqnarray}\]</span></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>Datos1 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;BD/Clase_06/Base_Transporte.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;Datos&quot;</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>Pax_Nal1 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos1<span class="sc">$</span>Pax_Nal, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>),</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">7</span>), </span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Logaritmos:</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>LPax_Nal1 <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(Datos1<span class="sc">$</span>Pax_Nal), </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>               <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>               <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">7</span>), </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>               <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Diferencias mensuales:</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>DLPax_Nal1 <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(Datos1<span class="sc">$</span>Pax_Nal) <span class="sc">-</span> <span class="fu">lag</span>(<span class="fu">log</span>(Datos1<span class="sc">$</span>Pax_Nal), <span class="at">k =</span> <span class="dv">1</span>),</span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">freq =</span> <span class="dv">12</span>)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pax_Nal1, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Pasajeros&quot;</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Pasajeros en vuelos nacionales de salida&quot;</span>,</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(LPax_Nal1, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;LN Pasajeros&quot;</span>,</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;LN Pasajeros en vuelos nacionales de salida&quot;</span>,</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(DLPax_Nal1, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;DLN Pasajeros&quot;</span>,</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Diff LN Pasajeros en vuelos nacionales de salida&quot;</span>, </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/GPaxNal-1.png" alt="Pasajeros transportados (Millones) en el metro de la CDM en niveles y en diferencias logaritmicas." width="100%" />
<p class="caption">
(#fig:GPaxNal)Pasajeros transportados (Millones) en el metro de la CDM en niveles y en diferencias logaritmicas.
</p>
</div>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>AR_LPax_Nal <span class="ot">&lt;-</span> <span class="fu">arima</span>(LPax_Nal1, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">method =</span> <span class="st">&quot;ML&quot;</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>AR_LPax_Nal</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; arima(x = LPax_Nal1, order = c(2, 0, 0), method = &quot;ML&quot;)</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          ar1      ar2  intercept</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       1.0290  -0.1521    14.6263</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s.e.  0.0613   0.0618     0.0857</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma^2 estimated as 0.03009:  log likelihood = 85.37,  aic = -162.74</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(AR_LPax_Nal$residuals, xlab = &quot;Tiempo&quot;, ylab = &quot;&quot;,main = &quot;Residuales del AR (2) para LN de pasajeros en vuelos nacionales de salida&quot;,col = &quot;darkgreen&quot;)</span></span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a><span class="co"># AR(2) en DIFERENCIAS:</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>AR_DLPax_Nal <span class="ot">&lt;-</span> <span class="fu">arima</span>(DLPax_Nal1, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">method =</span> <span class="st">&quot;ML&quot;</span>)</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>AR_DLPax_Nal</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; arima(x = DLPax_Nal1, order = c(2, 0, 0), method = &quot;ML&quot;)</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          ar1      ar2  intercept</span></span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       0.1132  -0.2794     0.0043</span></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s.e.  0.0598   0.0596     0.0092</span></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma^2 estimated as 0.02963:  log likelihood = 87.79,  aic = -167.57</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(AR_DLPax_Nal$residuals, xlab = &quot;Tiempo&quot;, ylab = &quot;&quot;,main = &quot;Residuales del AR (2) para DLN \nde pasajeros en vuelos nacionales de salida&quot;,col = &quot;darkred&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;BD/Clase_06/arroots.R&quot;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;BD/Clase_06/plot.armaroots.R&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.armaroots</span>(<span class="fu">arroots</span>(AR_LPax_Nal), </span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">main=</span><span class="st">&quot;Inverse AR roots of </span><span class="sc">\n</span><span class="st">AR(2): LN Pax Nal&quot;</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.armaroots</span>(<span class="fu">arroots</span>(AR_DLPax_Nal), </span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">main=</span><span class="st">&quot;Inverse AR roots of </span><span class="sc">\n</span><span class="st">AR(2): Diff LN Pax Nal&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/GRootsAR2-1.png" alt="Inverso de las Raíces del polinomio característico." width="100%" />
<p class="caption">
(#fig:GRootsAR2)Inverso de las Raíces del polinomio característico.
</p>
</div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>Para ambos casos entre parentésis indicamos los errores estándar y reportamos el estadístico de Akaike, AIC. Finalmente, podemos determinar si las soluciones serán convergentes, para ello en la Figura @ref(fig:GRootsAR2) mostramos las raíces asociadas a cada uno de los polinomios. De la inspección visual podemos concluir que ambas propuesta de AR(2) representan una solución convergente y estable.</p>
</div>
<div id="arp" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> AR(p)</h3>
<p>Veremos ahora una generalización de los procesos autoregresivos (AR). Esta generalización es conocida como un proceso <span class="math inline">\(AR(p)\)</span> y que puede ser descrito por la siguiente ecuación en diferencia estocástica:
<span class="math display">\[\begin{equation}
    X_t = a_0 + a_1 X_{t-1} + a_2 X_{t-2} + a_3 X_{t-3} + \ldots + a_p X_{t-p} + U_t
    (\#eq:ARpEq)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(a_p \neq 0\)</span>, y <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio con media cero (0), varianza constante (<span class="math inline">\(\sigma^2\)</span>) y covarianza cero (0). Usando el operador rezago, <span class="math inline">\(L^k\)</span>, para <span class="math inline">\(k = 0, 1, 2, \ldots, p\)</span>, obtenemos la siguiente expresión de la ecuación @ref(eq:ARpEq):
<span class="math display">\[\begin{equation}
    (1 - a_1 L - a_2 L^2 - a_3 L^3 - \ldots - a_p L^p) X_t = a_0 + U_t
    (\#eq:ARpEq1)
\end{equation}\]</span></p>
<p>Definamos el polinomio <span class="math inline">\(\alpha(L)\)</span> como:
<span class="math display">\[\begin{equation}
    \alpha(L) = 1 - a_1 L - a_2 L^2 - a_3 L^3 - \ldots - a_p L^p
    (\#eq:PolA)
\end{equation}\]</span></p>
<p>De forma similar que en los procesos <span class="math inline">\(AR(1)\)</span> y <span class="math inline">\(AR(2)\)</span>, las condiciones de estabilidad del proceso <span class="math inline">\(AR(p)\)</span> estarán dadas por la solución de la ecuación característica:
<span class="math display">\[\begin{equation}
    \lambda^p - a_1 \lambda^{p-1} - a_2 \lambda^{p-2} - a_3 \lambda^{p-3} - \ldots - a_p = 0
        (\#eq:PolA1)
\end{equation}\]</span></p>
<p>Así, solo si el polinomio anterior tiene raíces cuyo valor absoluto sea menor a uno (<span class="math inline">\(\lvert\lambda_i\lvert &lt; 1\)</span>) y si <span class="math inline">\(1 - a_1 L - a_2 L^2 - a_3 L^3 - \ldots - a_p L^p &lt; 1\)</span> podremos decir que el proceso es convergente y estable. Lo anterior significa que la ecuación @ref(eq:PolA) puede expresarse en términos de la descomposición de Wold o como la suma infinita de términos como:
<span class="math display">\[\begin{equation}
    \frac{1}{1 - a_1 L  - a_2 L^2 - a_3 L^3  - \ldots - a_p L^p} = \psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots
(\#eq:PolA2)
\end{equation}\]</span></p>
<p>Donde, por construcción de <span class="math inline">\(\alpha(L) \alpha^{-1}(L) = 1\)</span> implica que <span class="math inline">\(\psi_0 = 1\)</span>. De forma similar a los proceso AR(1) y AR(2), es posible determinar el valor de los coefieentes <span class="math inline">\(\psi_j\)</span> en términos de los coefientes <span class="math inline">\(a_i\)</span>. Así, la solución del proceso <span class="math inline">\(AR(p)\)</span> estará dada por:
<span class="math display">\[\begin{equation}
    X_t = \frac{a_0}{1 - a_1  - a_2 - a_3  - \ldots - a_p} + \sum^{\infty}_{j = 0} \psi_j U_{t-j}
    (\#eq:ARpEqSol)
\end{equation}\]</span></p>
<p>Considerando la solución de la ecuación @ref(eq:ARpEq) expresada en la ecuación @ref(eq:ARpEqSol) podemos determinar los momentos del proceso y que estarán dados por una media como:
<span class="math display">\[\begin{equation}
    \mathbb{E}[X_t] = \mu = \frac{a_o}{1 - a_1  - a_2 - a_3  - \ldots - a_p}
        (\#eq:ARpEqSol1)
\end{equation}\]</span></p>
<p>Lo anterior, considerado que <span class="math inline">\(\mathbb{E}[U_t] = 0\)</span>, para todo <span class="math inline">\(t\)</span>. Para determinar la varianza del proceso, sin pérdida de generalidad, podemos definir una ecuación: <span class="math inline">\(\gamma(\tau) = \mathbb{E}[X_{t - \tau} X_t]\)</span>, la cual (omitiendo la constante, ya que la correlación de una constante con cuaquier variable aleatoria que depende del tiempo es cero (0)) puede ser escrita como:
<span class="math display">\[\begin{equation}
    \gamma(\tau) = \mathbb{E}[(X_{t - \tau}) \cdot (a_1 X_{t-1} + a_2 X_{t-2} + a_3 X_{t-3} + \ldots + + a_p X_{t-p} + U_t)]
        (\#eq:ARpEqSol2)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\tau = 0, 1, 2, \ldots, p\)</span> y <span class="math inline">\(a_0 = 0\)</span>, lo que implica que <span class="math inline">\(\mu = 0\)</span>. De lo anterior obtenemos el siguiente conjunto de ecuaciones mediante sustituciones de los valores de <span class="math inline">\(\tau\)</span>:
<span class="math display">\[\begin{eqnarray}
    \gamma(0) &amp; = &amp; a_1 \gamma(1) + a_2 \gamma(2) + \ldots + a_p \gamma(p) + \sigma^2 \nonumber \\
    \gamma(1) &amp; = &amp; a_1 \gamma(0) + a_2 \gamma(1) + \ldots + a_p \gamma(p-1) \nonumber \\
    \vdots \nonumber \\
    \gamma(p) &amp; = &amp; a_1 \gamma(p-1) + a_2 \gamma(p-2) + \ldots + a_p \gamma(0) \nonumber
\end{eqnarray}\]</span></p>
<p>De esta forma, es fácil observar que la ecuación general para <span class="math inline">\(p &gt; 0\)</span> estará dada por:
<span class="math display">\[\begin{equation}
    \gamma(p) - a_1 \gamma(\tau - 1) - a_2 \gamma(\tau - 2) - \ldots - a_p \gamma(\tau - p) = 0
    (\#eq:Gammap)
\end{equation}\]</span></p>
<p>Dividiendo la ecuación @ref(eq:Gammap) por <span class="math inline">\(\gamma(0)\)</span>, se obtiene la siguiente ecuación:
<span class="math display">\[\begin{equation}
    \rho(p) - a_1 \rho(\tau - 1) + a_2 \rho(\tau - 2) + \ldots + a_p \rho(\tau - p) = 0
        (\#eq:Gammap1)
\end{equation}\]</span></p>
<p>Así, podemos escribir el siguiente sistema de ecuaciones:
<span class="math display">\[\begin{eqnarray}
    \rho(1) &amp; = &amp; a_1 + a_2 \rho(1) + a_3 \rho(2) + \ldots + a_p \rho(p-1) \nonumber \\
    \rho(2) &amp; = &amp; a_1 \rho(1) + a_2 + a_3 \rho(1) + \ldots + a_p \rho(p-2) \nonumber \\
    &amp; \vdots &amp; \nonumber \\
    \rho(p) &amp; = &amp; a_1 \rho(p-1) + a_2 \rho(p-2) + \ldots + a_p \nonumber
\end{eqnarray}\]</span></p>
<p>Lo anterior se puede expresar como un conjunto de vectores y matrices de la siguiente forma:
<span class="math display">\[\begin{equation}
    \left[
    \begin{array}{c}
        \rho(1) \\
        \rho(2) \\
        \vdots \\
        \rho(p)
    \end{array}
    \right]
    =
    \left[
    \begin{array}{c c c c}
        1 &amp; \rho(1) &amp; \ldots &amp; \rho(p - 1) \\
        \rho(1) &amp; 1 &amp; \ldots &amp; \rho(p - 2) \\
        \rho(2) &amp; \rho(1) &amp; \ldots &amp; \rho(p - 3) \\
        \vdots &amp; \vdots &amp; \ldots &amp; \vdots \\
        \rho(p - 1) &amp; \rho(p - 2) &amp; \ldots &amp; 1 \\
    \end{array}
    \right]
    \left[
    \begin{array}{c}
        a_1 \\
        a_2 \\
        a_3 \\
        \vdots \\
        a_p \\
    \end{array}
    \right]
(\#eq:Gammap2)
\end{equation}\]</span></p>
<p>De lo anterior podemos escribir la siguiente ecuación que es una forma alternativa para expresar los valores de los coefientes <span class="math inline">\(a_i\)</span> de la la solución del proceso <span class="math inline">\(AR(p)\)</span>:
<span class="math display">\[\begin{equation}
    \mathbf{\rho} = \mathbf{R} \mathbf{a}
  (\#eq:Gammap3)
\end{equation}\]</span></p>
<p>Es decir, podemos obtener la siguiente expresión:
<span class="math display">\[\begin{equation}
    \mathbf{a} = \mathbf{R}^{-1} \mathbf{\rho}
    (\#eq:Gammap4)
\end{equation}\]</span></p>
<p>Ahora veámos un ejemplo. Utilizaremos la serie de Pasajeros en vuelos internacionales de salida para estimar un <span class="math inline">\(AR(p)\)</span> mediante el método de máxima verosimilitud (ML). Antes de realizar el proceso de estimación consideremos una transformación de la serie en logaritmos y una más en diferencias logaritmicas; lo anterior con el objeto de obtener un conjunto de series de tiempo suavizada y expresada en tasas de crecimiento, con un comportamiento parecido a un proceso estacionario.</p>
<p>Primero, para decidir si se realizará un <span class="math inline">\(AR(p)\)</span> para la serie en niveles o en diferencias análizaremos su gráfica. La serie de e Pasajeros en vuelos internacionales de salidas se muestra en la Figura @ref(fig:GPaxInt). En está se muestra la gráfica de la serie en niveles (sin transformación logaritmica y con transformación logaritmica) y en diferencias logaritmicas mensuales (es decir, con diferencia respecto del mes inmediato anterior).</p>
<p>De la gráfica en la Figura @ref(fig:GPaxInt) observamos que quizá le mejor forma de estimar un AR(p) es mediante la serie en diferencias, ya que ésta es la que parece ser una serie estacionaria. A continuación, estimaremos una AR(4) para la serie en diferencias logarimitcas (<span class="math inline">\(DLPaxInt_t\)</span>):</p>
<p><span class="math display">\[\begin{eqnarray}
    DLPaxInt_t &amp; = &amp; 0.0050 &amp; - &amp; 0.2701  &amp; DLPaxInt_{t-1} \\
    &amp;  &amp; (0.0052) &amp;  &amp; (0.0655) &amp; \\
    &amp;  &amp;  &amp; - &amp; 0.4326 &amp; DLPaxNal_{t-2} \\
    &amp;  &amp;  &amp;  &amp; (0.0664) &amp; \\
    &amp;  &amp;  &amp; - &amp; 0.1956 &amp; DLPaxNal_{t-3} \\
    &amp;  &amp;  &amp;  &amp; (0.0664) &amp; \\
    &amp;  &amp;  &amp; - &amp; 0.0316 &amp; DLPaxNal_{t-4} \\
    &amp;  &amp;  &amp;  &amp; (0.0653) &amp;
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
\hat{\sigma}^2 &amp; = &amp; 0.02371 &amp; y &amp; AIC &amp; = &amp; -198.16
\end{eqnarray}\]</span></p>
<p>Entre parentésis indicamos los errores estándar y reportamos el estadístico de Akaike, AIC. Finalmente, podemos determinar si las soluciones serán convergentes, para ello en la Figura @ref(fig:GRootsARp) mostramos las raíces asociadas a cada uno de los polinomios. De la inspección visual podemos concluir que el AR(4) representan una solución convergente y estable.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>Datos2 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;BD/Clase_07/Base_Transporte.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;Datos&quot;</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;BD/Clase_07/arroots.R&quot;</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;BD/Clase_07/plot.armaroots.R&quot;</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion a series de tiempo:</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>Pax_Int2 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos2<span class="sc">$</span>Pax_Int, </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Logaritmos:</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>LPax_Int2 <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(Datos2<span class="sc">$</span>Pax_Int), </span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Diferencias mensuales:</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>DLPax_Int2 <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(Datos2<span class="sc">$</span>Pax_Int) <span class="sc">-</span> <span class="fu">lag</span>(<span class="fu">log</span>(Datos2<span class="sc">$</span>Pax_Int), <span class="at">k =</span> <span class="dv">1</span>),</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>))</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Pax_Int2, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Pasajeros&quot;</span>,</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Pasajeros en vuelos internacionales de salida&quot;</span>,</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(LPax_Int2, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;LN Pasajeros&quot;</span>,</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;LN Pasajeros en vuelos internacionales de salida&quot;</span>,</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(DLPax_Int2, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;DLN Pasajeros&quot;</span>,</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Diff LN Pasajeros en vuelos internacionales de salia&quot;</span>, </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkred&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/GPaxInt-1.png" alt="Pasajeros en vuelos internacionales de salida en niveles y en diferencias logaritmicas." width="100%" />
<p class="caption">
(#fig:GPaxInt)Pasajeros en vuelos internacionales de salida en niveles y en diferencias logaritmicas.
</p>
</div>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AR(p) en NIVELES:</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>AR_LPax_Int2 <span class="ot">&lt;-</span> <span class="fu">arima</span>(LPax_Int2, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">method =</span> <span class="st">&quot;ML&quot;</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>AR_LPax_Int2</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; arima(x = LPax_Int2, order = c(4, 0, 0), method = &quot;ML&quot;)</span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          ar1      ar2     ar3     ar4  intercept</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       0.9861  -0.2941  0.0726  0.0825    13.9419</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s.e.  0.0618   0.0870  0.0869  0.0619     0.1031</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma^2 estimated as 0.06747:  log likelihood = -19.04,  aic = 50.07</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(AR_LPax_Int$residuals)</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a><span class="co">#plot.armaroots(arroots(AR_LPax_Int), </span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>               <span class="co">#main=&quot;Inverse AR roots of \nAR(p): LN PAx Int&quot;)</span></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="co"># AR(p) en DIFERENCIAS:</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>AR_DLPax_Int2 <span class="ot">&lt;-</span> <span class="fu">arima</span>(DLPax_Int2, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">method =</span> <span class="st">&quot;ML&quot;</span>)</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>AR_DLPax_Int2</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; arima(x = DLPax_Int2, order = c(4, 0, 0), method = &quot;ML&quot;)</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          ar1      ar2      ar3      ar4  intercept</span></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       0.0441  -0.2426  -0.1457  -0.0483      0.004</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s.e.  0.0622   0.0615   0.0614   0.0620      0.012</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma^2 estimated as 0.07134:  log likelihood = -25.59,  aic = 63.17</span></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(AR_DLPax_Int$residuals, xlab = &quot;Tiempo&quot;, ylab = &quot;DLN Pasajeros&quot;,</span></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>     <span class="co">#main = &quot;Residuales de un AR(4) para pasajeros en vuelos internacionales de salida&quot;,</span></span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>     <span class="co">#col = &quot;darkblue&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.armaroots</span>(<span class="fu">arroots</span>(AR_DLPax_Int2),<span class="at">main=</span><span class="st">&quot;Inverse AR roots of </span><span class="sc">\n</span><span class="st">AR(p): Diff LN PAx Int&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/GRootsARp-1.png" alt="Inverso de las Raíces del polinomio característico." width="100%" />
<p class="caption">
(#fig:GRootsARp)Inverso de las Raíces del polinomio característico.
</p>
</div>
</div>
</div>
<div id="procesos-de-medias-móviles-ma" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Procesos de Medias Móviles (MA)</h2>
<div id="ma1" class="section level3" number="4.2.1">
<h3><span class="header-section-number">4.2.1</span> MA(1)</h3>
<p>Una vez planteado el proceso generalizado de <span class="math inline">\(AR(p)\)</span>, iniciamos el planteamiento de los proceso de medias móviles, denotados como <span class="math inline">\(MA(q)\)</span>. Iniciemos con el planteamiento del proceso <span class="math inline">\(MA(1)\)</span>, que se puede escribir como una ecuación como la siguiente:
<span class="math display">\[\begin{equation}
    X_t = \mu + U_t - b_1 U_{t-1}
    (\#eq:MA1Eq)
\end{equation}\]</span></p>
<p>O como:
<span class="math display">\[\begin{equation}
    X_t - \mu = (1 - b_1 L) U_{t}
    (\#eq:MA1Eq1)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio, es decir, con <span class="math inline">\(\mathbb{E}[U_t] = 0\)</span>, <span class="math inline">\(Var[U_t] = \sigma^2\)</span>, y <span class="math inline">\(Cov[U_t, U_s] = 0\)</span>. Así, un proceso <span class="math inline">\(MA(1)\)</span> puede verse como un proceso AR con una descomposición de Wold en la que <span class="math inline">\(\psi_0 = 1\)</span>, <span class="math inline">\(\psi_1 = - b_1\)</span> y <span class="math inline">\(\psi_j = 0\)</span> para todo <span class="math inline">\(j &gt; 1\)</span>.</p>
<p>Al igual que los procesos autoregresivos, determinaremos los momentos de un proceso <span class="math inline">\(MA(1)\)</span>. En el caso de la media observamos que será:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mu + \mathbb{E}[U_t] - b_1 \mathbb{E}[U_{t - 1}] \nonumber \\
    &amp; = &amp; \mu
    (\#eq:MA1Eq2)
\end{eqnarray}\]</span></p>
<p>Por su parte la varianza estará dada por:
<span class="math display">\[\begin{eqnarray}
    Var[X_t] &amp; = &amp; \mathbb{E}[(X_t - \mu)^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1})^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t^2 - 2 b_1 U_t U_{t-1} + b_1^2 U_{t - 1}^2] \nonumber \\
    &amp; = &amp;\mathbb{E}[U_t^2] - 2 b_1 \mathbb{E}[U_t U_{t-1}] + b_1^2 \mathbb{E}[U_{t - 1}^2]] \nonumber \\
    &amp; = &amp; \sigma^2 + b_1^2 \sigma^2 \nonumber \\
    &amp; = &amp; (1 + b_1^2) \sigma^2 = \gamma(0)
    (\#eq:MA1Eq3)
\end{eqnarray}\]</span></p>
<p>De esta forma, la varianza del proceso es constante en cualquier periodo <span class="math inline">\(t\)</span>. Para determinar la covarianza utilizaremos la siguiente ecuación:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[(x_t - \mu)(x_{t + \tau} - \mu)] &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1})(U_{t + \tau} - b_1 U_{t + \tau - 1})] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t U_{t + \tau} - b_1 U_t U_{t + \tau - 1} - b_1 U_{t - 1} U_{t + \tau} \nonumber \\
    &amp;   &amp; + b_1^2 U_{t - 1} U_{t + \tau - 1}] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t U_{t + \tau}] - b_1 \mathbb{E}[U_t U_{t + \tau - 1}] \nonumber \\
    &amp;   &amp; - b_1 \mathbb{E}[U_{t - 1} U_{t + \tau}] + b_1^2 \mathbb{E}[U_{t - 1} U_{t + \tau - 1}]
    (\#eq:MA1Cov)
\end{eqnarray}\]</span></p>
<p>Si hacemos sustituciones de diferentes valores de <span class="math inline">\(\tau\)</span> en la ecuación @ref(eq:MA1Cov) notaremos que la covarianza será distinta de cero únicamente para el caso de <span class="math inline">\(\tau = 1, -1\)</span>. En ambos casos tendremos como resultado:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[(x_t - \mu)(x_{t + 1} - \mu)] &amp; = &amp; \mathbb{E}[(x_t - \mu)(x_{t - 1} - \mu)] \nonumber \\
    &amp; = &amp; - b_1 \mathbb{E}[U_t U_{t}] \nonumber \\
    &amp; = &amp; - b_1 \mathbb{E}[U_{t - 1} U_{t - 1}] \nonumber \\
    &amp; = &amp; - b_1^2 \sigma^2 = \gamma(1)
        (\#eq:MA1Cov1)
\end{eqnarray}\]</span></p>
<p>De esta forma tendremos que las funciones de autocorrelación estarán dadas por los siguientes casos:
<span class="math display">\[\begin{eqnarray}
    \rho(0) &amp; = &amp; 1 \nonumber \\
    \rho(1) &amp; = &amp; \frac{- b_1}{1 + b_1^2} \nonumber \\
    \rho(\tau) &amp; = &amp; 0 \text{ para todo } \tau &gt; 1 \nonumber
\end{eqnarray}\]</span></p>
<p>Ahora regresando a la ecuación @ref(eq:MA1Eq),e su solución la podemos expresar como:
<span class="math display">\[\begin{eqnarray}
    U_ t &amp; = &amp; - \frac{\mu}{1 - b_1} + \frac{1}{1 - b_1 L} X_t \nonumber \\
    &amp; = &amp; - \frac{\mu}{1 - b_1} + X_t + b_1 X_{t-1} + b_1^2 X_{t-2} + \ldots \nonumber
\end{eqnarray}\]</span></p>
<p>Donde la condición para que se cumpla esta ecuación es que <span class="math inline">\(\lvert b_1 \lvert&lt; 1\)</span>. La manera de interpretar esta condición es como una condición de estabilidad de la solución y cómo una condición de invertibilidad. Notemos que un <span class="math inline">\(MA(1)\)</span> (y en general un <span class="math inline">\(MA(q)\)</span>) es equivalente a un <span class="math inline">\(AR(\infty)\)</span>, es decir, cuando se invierte un MA se genera un AR con infinitos rezagos.</p>
<p>En esta sección no desarrollaremos un ejemplo, primero explicaremos en qué consiste una modelación del tipo <span class="math inline">\(MA(q)\)</span> y después platearemos un ejemplo en concreto.</p>
</div>
<div id="maq" class="section level3" number="4.2.2">
<h3><span class="header-section-number">4.2.2</span> MA(q)</h3>
<p>En general, el proceso de medias móviles de orden <span class="math inline">\(q\)</span>, <span class="math inline">\(MA(q)\)</span>, puede ser escrito como:
<span class="math display">\[\begin{equation}
    X_t = \mu + U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q}
    (\#eq:MAqEQ)
\end{equation}\]</span></p>
<p>Podemos reescribir la ecuación @ref(eq:MAqEQ) utilizando el operador rezago, así tendrémos el proceso de <span class="math inline">\(MA(q)\)</span> como:
<span class="math display">\[\begin{eqnarray}
    X_t - \mu &amp; = &amp; (1 - b_1 L - b_2 L^2 - \ldots - b_q L^q) U_{t} \nonumber \\
    X_t - \mu &amp; = &amp; \beta(L) U_t
    (\#eq:MAqRed)
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio con <span class="math inline">\(\mathbb{E}[U_t] = 0\)</span>, <span class="math inline">\(Var[U_t] = \mathbb{E}[U_t^2] = 0\)</span> y <span class="math inline">\(Cov[U_t, U_s] = \mathbb{E}[U_t, U_s] = 0\)</span>, y <span class="math inline">\(\beta(L) = 1 - b_1 L - b_2 L^2 - \ldots - b_q L^q\)</span> es un polinomio del operador rezago <span class="math inline">\(L\)</span>. la ecuación @ref(eq:MAqRed) puede ser interpretada como un proceso <span class="math inline">\(AR(q)\)</span> sobre la serie <span class="math inline">\(U_t\)</span>.</p>
<p>Ahora determinemos los momentos de un proceso <span class="math inline">\(MA(q)\)</span>:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mathbb{E}[\mu + U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q}] \nonumber \\
    &amp; = &amp; \mu + \mathbb{E}[U_t] - b_1 \mathbb{E}[U_{t-1}] - b_2 \mathbb{E}[U_{t-2}] - \ldots - b_q \mathbb{E}[U_{t-q}] \nonumber \\
    &amp; = &amp; \mu
    (\#eq:MAqRed1)
\end{eqnarray}\]</span></p>
<p>En el caso de la varianza tenemos que se puede expresar como:
<span class="math display">\[\begin{eqnarray}
    Var[X_t] &amp; = &amp; \mathbb{E}[(X_t - \mu)^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q})^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t^2 + b_1^2 U_{t-1}^2 + b_2^2 U_{t-2}^2 + \ldots + b_q^2 U_{t-q}^2 \nonumber \\
    &amp;   &amp; - 2 b_1 U_t U_{t - 1} - \ldots - 2 b_{q - 1} b_q U_{t - q + 1} U_{t - q}] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t^2] + b_1^2 \mathbb{E}[U_{t-1}^2] + b_2^2 \mathbb{E}[U_{t-2}^2] + \ldots + b_q^2 \mathbb{E}[U_{t-q}^2] \nonumber \\
    &amp;   &amp; - 2 b_1 \mathbb{E}[U_t U_{t - 1}] - \ldots - 2 b_{q - 1} b_q \mathbb{E}[U_{t - q + 1} U_{t - q}] \nonumber \\
    &amp; = &amp; \sigma^2 + b^2_1 \sigma^2 + b^2_2 \sigma^2 + \ldots + b^2_q \sigma^2 \nonumber \\
    &amp; = &amp; (1 + b^2_1 + b^2_2 + \ldots + b^2_q) \sigma^2
    (\#eq:MAqRed2)
\end{eqnarray}\]</span></p>
<p>En el caso de las covarianzas podemos utilizar una idea similar al caso del <span class="math inline">\(AR(p)\)</span>, construir una expresión general para cualquier rezago <span class="math inline">\(\tau\)</span>:
<span class="math display">\[\begin{eqnarray}
    Cov[X_t, X_{t + \tau}] &amp; = &amp; \mathbb{E}[(X_t - \mu)(X_{t + \tau} - \mu)] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q}) \nonumber \\
    &amp;   &amp; (U_{t + \tau} - b_1 U_{t + \tau -1} - b_2 U_{t + \tau -2} - \ldots - b_q U_{t + \tau - q})] \nonumber
\end{eqnarray}\]</span></p>
<p>La expresión anterior se puede desarrollar para múltiples casos de <span class="math inline">\(\tau = 1, 2, \ldots, q\)</span>. De esta forma tenemos el siguiente sistema:
<span class="math display">\[\begin{eqnarray}
    \tau = 1 &amp; : &amp; \gamma(1) = (- b_1 + b_1 b_2 + \ldots + b_{q-1} b_q) \sigma^2 \nonumber \\
    \tau = 2 &amp; : &amp; \gamma(2) = (- b_2 + b_1 b_3 + \ldots + b_{q-2} b_q) \sigma^2 \nonumber \\
    &amp; \vdots &amp; \nonumber \\
    \tau = q &amp; : &amp; \gamma(q) = b_q \sigma^2 \nonumber
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\gamma(\tau) = 0\)</span> para todo <span class="math inline">\(\tau &gt; q\)</span>. Es decir, todas las autocovarianzas y autocorrelaciones con ordenes superiores a <span class="math inline">\(q\)</span> son cero (0). De esta forma, esta caracterítica teórica permite identificar el orden de <span class="math inline">\(MA(q)\)</span> visualizando la función de autocorrelación y verificando a partir de cual valor de rezago la autocorrelación es no significaiva.</p>
<p>Regresando al problema original que es el de determinar una solución para la eucación @ref(eq:MAq_EQ), tenemos que dicha solución estará dada por un <span class="math inline">\(AR(\infty)\)</span> en términos de <span class="math inline">\(U_t\)</span>:
<span class="math display">\[\begin{eqnarray}
    U_t &amp; = &amp; - \frac{\mu}{1 - b_1 - b_2 - \ldots - b_q} + \beta(L)^{-1} X_t \nonumber \\
    &amp;   &amp; - \frac{\mu}{1 - b_1 - b_2 - \ldots - b_q} + \sum_{j = 0}^{\infty} c_j X_{t-j}
    (\#eq:MAqEqSol)
\end{eqnarray}\]</span></p>
<p>Donde se cumple que: <span class="math inline">\(1 = (1 - b_1 L^1 - b_2 L^2 - \ldots - b_q L^q)(1 - c_1 L - c_2 L^2 - \ldots)\)</span> y los coeficientes <span class="math inline">\(c_j\)</span> se pueden determinar por un método de coeficientes indeterminados y en términos de los valores <span class="math inline">\(b_i\)</span>. De igual forma que en el caso de la ecuación @ref(eq:ARpEq), en la ecuación @ref(eq:MAqEqSol) se deben cumplir condiciones de estabilidad asociadas con las raíces del polinomio carácterististico dado por:
<span class="math display">\[\begin{equation}
    1 - b_1 x - b_2 x^2 - \ldots b_q x^q = 0
    (\#eq:MAqEqSol2)
\end{equation}\]</span></p>
<p>El cual debe cumplir que <span class="math inline">\(\lvert x_i \lvert &lt; 1\)</span> y que <span class="math inline">\(1 - b_1 - b_2 - \ldots b_q &lt; 1\)</span>.</p>
<p>Ahora veamos un ejemplo del proceso <span class="math inline">\(MA(q)\)</span>, para lo cual retomaremos la serie de Pasajeros transportados en el metro de la CDMX (<span class="math inline">\(PaxMetro\)</span>). Estimaremos el <span class="math inline">\(MA(q)\)</span> mediante el método de máxima verosimilitud (ML). Antes de realizar el proceso de estimación consideremos una transformación de la serie en logaritmos y una más en diferencias logaritmicas; lo anterior con el objeto de obtener un conjunto de series de tiempo suavizada y expresada en tasas de crecimiento, con un comportamiento parecido a un proceso estacionario.</p>
<p>La serie de Pasajeros transportados en el metro de la CDMX se muestra en la Figura @ref(fig:GPaxMetro) se muestra la gráfica de la serie en niveles (sin transformación logarítmica y con transformación logarítmica) y en diferencias logarítmicas mensuales (es decir, con una diferencia respecto del mes inmediato anterior). Utilizaremos la serie en diferencias, ya que es la que parece ser estacionaria. Esta serie tiene la peculiaridad de que tiene un salto a la baja y uno al alza entre septiembre de 2017 y octubre de 2017. Para controlar ese efecto, en nuestro modelo <span class="math inline">\(MA(q)\)</span> incluiremos dos variables dummies para dichos meses.</p>
<p>A continuación, estimaremos una <span class="math inline">\(MA(4)\)</span> para la serie en diferencias:</p>
<p><span class="math display">\[\begin{eqnarray}
    DLPaxMetro_t &amp; = &amp; 0.0000 &amp; - &amp; 0.7804  &amp; U_{t-1} \\
    &amp;  &amp; (0.0000) &amp;  &amp; (0.0661) &amp; \\
    &amp;  &amp;  &amp; + &amp; 0.3591 &amp; U_{t-2} \\
    &amp;  &amp;  &amp;  &amp; (0.0826) &amp; \\
    &amp;  &amp;  &amp; - &amp; 0.2775 &amp; U_{t-3} \\
    &amp;  &amp;  &amp;  &amp; (0.0908) &amp; \\
    &amp;  &amp;  &amp; - &amp; 0.1120 &amp; U_{t-4} \\
    &amp;  &amp;  &amp;  &amp; (0.0769) &amp; \\
    &amp;  &amp;  &amp; - &amp; 0.3789 &amp; DSep2017 \\
    &amp;  &amp;  &amp;  &amp; (0.0436) &amp; \\
    &amp;  &amp;  &amp; + &amp; 0.3695 &amp; DOct2017 \\
    &amp;  &amp;  &amp;  &amp; (0.0434) &amp;
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
    \hat{\sigma}^2 &amp; = &amp; 0.002176 &amp; y &amp; AIC &amp; = &amp; -749.94
\end{eqnarray}\]</span></p>
<p>Entre parentésis indicamos los errores estándar y al final reportamos el estadístico de Akaike, AIC. Finalmente, podemos determinar si la solución serán convergente, para ello en la Figura @ref(fig:GRootsMAq) mostramos las raíces asociadas a cada uno de los polinomios. De la inspección visual podemos concluir que ambas propuesta de AR(2) representan una solución convergente y estable.</p>
</div>
</div>
<div id="procesos-armap-q-y-arimap-d-q" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Procesos ARMA(p, q) y ARIMA(p, d, q)</h2>
<p>Hemos establecido algunas relaciones las de los porcesos AR y los procesos MA, es decir, cómo un <span class="math inline">\(MA(q)\)</span> de la serie <span class="math inline">\(X_t\)</span> puede ser reexpresada como un <span class="math inline">\(AR(\infty)\)</span> de la serie <span class="math inline">\(U_t\)</span>, y viceversa un <span class="math inline">\(AR(p)\)</span> de la serie <span class="math inline">\(X_t\)</span> puede ser reeexpresada como un <span class="math inline">\(MA(\infty)\)</span>.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>Datos3 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;BD/Clase_09/Base_Transporte_ARIMA.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;Datos&quot;</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;BD/Clase_09/maroots.R&quot;</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;BD/Clase_09/arroots.R&quot;</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;BD/Clase_09/plot.armaroots.R&quot;</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion a series de tiempo:</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>ax_Nal3 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos3<span class="sc">$</span>Pax_Nal, </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a>LPax_Nal3 <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(Datos3<span class="sc">$</span>Pax_Nal), </span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a>               <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a>DLPax_Nal3 <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(Datos3<span class="sc">$</span>Pax_Nal) <span class="sc">-</span> <span class="fu">lag</span>(<span class="fu">log</span>(Datos3<span class="sc">$</span>Pax_Nal), <span class="at">k =</span> <span class="dv">1</span>),</span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb30-18"><a href="#cb30-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb30-19"><a href="#cb30-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-20"><a href="#cb30-20" aria-hidden="true" tabindex="-1"></a>D_Feb2020   <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos3<span class="sc">$</span>D_Feb2020,</span>
<span id="cb30-21"><a href="#cb30-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb30-22"><a href="#cb30-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb30-23"><a href="#cb30-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-24"><a href="#cb30-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-25"><a href="#cb30-25" aria-hidden="true" tabindex="-1"></a>D_Mar2020   <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos3<span class="sc">$</span>D_Mar2020, </span>
<span id="cb30-26"><a href="#cb30-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb30-27"><a href="#cb30-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb30-28"><a href="#cb30-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-29"><a href="#cb30-29" aria-hidden="true" tabindex="-1"></a>D_Abr2020   <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos3<span class="sc">$</span>D_Abr2020, </span>
<span id="cb30-30"><a href="#cb30-30" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb30-31"><a href="#cb30-31" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb30-32"><a href="#cb30-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-33"><a href="#cb30-33" aria-hidden="true" tabindex="-1"></a>D_May2020   <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos3<span class="sc">$</span>D_May2020, </span>
<span id="cb30-34"><a href="#cb30-34" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb30-35"><a href="#cb30-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb30-36"><a href="#cb30-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-37"><a href="#cb30-37" aria-hidden="true" tabindex="-1"></a>D_Jun2020   <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos3<span class="sc">$</span>D_Jun2020, </span>
<span id="cb30-38"><a href="#cb30-38" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb30-39"><a href="#cb30-39" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb30-40"><a href="#cb30-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-41"><a href="#cb30-41" aria-hidden="true" tabindex="-1"></a>D_Jul2020 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos3<span class="sc">$</span>D_Jul2020, </span>
<span id="cb30-42"><a href="#cb30-42" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb30-43"><a href="#cb30-43" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb30-44"><a href="#cb30-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-45"><a href="#cb30-45" aria-hidden="true" tabindex="-1"></a>D_Ene2021 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos3<span class="sc">$</span>D_Ene2021, </span>
<span id="cb30-46"><a href="#cb30-46" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb30-47"><a href="#cb30-47" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb30-48"><a href="#cb30-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-49"><a href="#cb30-49" aria-hidden="true" tabindex="-1"></a>D_Mar2021 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos3<span class="sc">$</span>D_Mar2021, </span>
<span id="cb30-50"><a href="#cb30-50" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb30-51"><a href="#cb30-51" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb30-52"><a href="#cb30-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-53"><a href="#cb30-53" aria-hidden="true" tabindex="-1"></a>D_Ene <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos3<span class="sc">$</span>D_Ene, </span>
<span id="cb30-54"><a href="#cb30-54" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb30-55"><a href="#cb30-55" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb30-56"><a href="#cb30-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-57"><a href="#cb30-57" aria-hidden="true" tabindex="-1"></a>D_Feb <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos3<span class="sc">$</span>D_Feb, </span>
<span id="cb30-58"><a href="#cb30-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb30-59"><a href="#cb30-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb30-60"><a href="#cb30-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-61"><a href="#cb30-61" aria-hidden="true" tabindex="-1"></a>D_Jul <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos3<span class="sc">$</span>D_Jul, </span>
<span id="cb30-62"><a href="#cb30-62" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb30-63"><a href="#cb30-63" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb30-64"><a href="#cb30-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-65"><a href="#cb30-65" aria-hidden="true" tabindex="-1"></a>D_Dic <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos3<span class="sc">$</span>D_Dic, </span>
<span id="cb30-66"><a href="#cb30-66" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb30-67"><a href="#cb30-67" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="dv">12</span>)</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;imagenes/G_Roots_MAq.png&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="imagenes/G_Roots_MAq.png" alt="Inverso de las Raíces del polinomio característico." width="100%" />
<p class="caption">
(#fig:GRootsMAq)Inverso de las Raíces del polinomio característico.
</p>
</div>
<p>En este sentido, para cerrar esta sección veámos el caso de la especificación que conjunta ambos modelos en un modelo general conocido como <span class="math inline">\(ARMA(p, q)\)</span> o <span class="math inline">\(ARIMA(p, d, q)\)</span>. La diferencia entre el primero y el segundo es las veces que su tuvo que diferenciar la serie analizada, registro que se lleva en el índice <span class="math inline">\(d\)</span> de los paramétros dentro del concepto <span class="math inline">\(ARIMA(p, d, q)\)</span>. No obstante, en general nos referiremos al modelo como <span class="math inline">\(ARMA(p, q)\)</span> y dependerá del analista si modela la serie en niveles (por ejemplo, en logaritmos) o en diferencias logarítmicas (o diferencias sin logaritmos).</p>
<div id="arma1-1" class="section level3" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> ARMA(1, 1)</h3>
<p>Dicho lo anterior vamos a empezar con el análisis de un <span class="math inline">\(ARMA(1, 1)\)</span>. Un proceso <span class="math inline">\(ARMA(1, 1)\)</span> puede verse como:
<span class="math display">\[\begin{equation}
    X_t = \delta + a_1 X_{t - 1} + U_t - b_1 U_{t - 1}
    (\#eq:ARMA11Eq)
\end{equation}\]</span></p>
<p>Aplicando el operado rezago podemos rescribir la ecuación @ref(eq:ARMA11Eq) como:
<span class="math display">\[\begin{equation}
    (1 - a_1 L) X_t = \delta + (1 - b_1 L) U_t
     (\#eq:ARMA11Eq1)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso pueramente aleatorio como en los casos de <span class="math inline">\(AR(p)\)</span> y <span class="math inline">\(MA(q)\)</span>, y <span class="math inline">\(X_t\)</span> puede ser una serie en niveles o en diferencias (ambas, en términos logarítmicos).</p>
<p>Así, el modelo <span class="math inline">\(ARIMA (p, q)\)</span> también tiene una representación de Wold que estará dada por las siguientes expresiones:
<span class="math display">\[\begin{equation}
    X_t = \frac{\delta}{1 - a_1} + \frac{1 - b_1 L}{1 - a_1 L} U_t
    (\#eq:ARMA11Prev)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(a_1 \neq b_1\)</span>, puesto que en caso contrario <span class="math inline">\(X_t\)</span> sería un proceso puramente aleatorio con una media <span class="math inline">\(\mu = \frac{\delta}{1 - a_1}\)</span>. Así, podemos reescribir la descomposición de Wold a partir del componente de la ecuación @ref(eq:ARMA11Prev)
<span class="math display">\[\begin{equation}
    \frac{1 - b_1 L}{1 - a_1 L} = \psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots
    (\#eq:ARMA11EQWold)
\end{equation}\]</span></p>
<p>Está ecuación es equivalente a la expresión:
<span class="math display">\[\begin{eqnarray}
    (1 - b_1 L) &amp; = &amp; (1 - a_1 L)(\psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots) \nonumber \\
    &amp; = &amp; \psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots \nonumber \\
    &amp;   &amp; - a_1 \psi_0 L - a_1 \psi_1 L^2 - a_2 \psi_2 L^3 - a_1 \psi_3 L^4 - \ldots \nonumber
\end{eqnarray}\]</span></p>
<p>De esta forma podemos establecer el siguiente sistema de coeficientes indeterminados:
<span class="math display">\[\begin{eqnarray}
    L^0 : &amp;   &amp; \Rightarrow  &amp;  \psi_0 = 1  \\
     L^1 :  &amp;  \psi_1 - a_1 \psi_0 = - b_1  &amp;  \Rightarrow  &amp;  \psi_1 = a_1 - b_1  \\
     L^2 :  &amp;  \psi_2 - a_1 \psi_1 = 0  &amp;  \Rightarrow  &amp;  \psi_2 = a_1(a_1 - b_1)  \\
     L^3 :  &amp;  \psi_3 - a_1 \psi_2 = 0  &amp;  \Rightarrow  &amp;  \psi_3 = a^2_1(a_1 - b_1)  \\
     \vdots  &amp;  \vdots  &amp;  \vdots  &amp;  \vdots  \\
     L^j :  &amp;  \psi_j - a_1 \psi_{j - 1} = 0  &amp;  \Rightarrow  &amp;  \psi_j = a^{j - 1}_1(a_1 - b_1)
\end{eqnarray}\]</span></p>
<p>Así, la solución a la ecuación @ref(eq:ARMA11Eq) estará dada por la siguiente generalización:
<span class="math display">\[\begin{equation}
    X_t = \frac{\delta}{1 - a_1} + U_t + (a_1 - b_1) U_{t - 1} + a_1(a_1 - b_1) U_{t - 2} + a_1^2(a_1 - b_1) U_{t - 3} + \ldots
(\#eq:ARMA11Sol)
\end{equation}\]</span></p>
<p>En la ecuación @ref(eq:ARMA11Sol) las condiciones de estabilidad y de invertibilidad del sistema (de un MA a un AR, y viceversa) estarán dadas por: <span class="math inline">\(\lvert a_1 \lvert &lt; 1\)</span> y <span class="math inline">\(\lvert b_1 \lvert&lt; 1\)</span>. Adicionalmente, la ecuación @ref(eq:ARMA11Sol) expresa cómo una serie que tiene un comportamiento <span class="math inline">\(ARMA(1, 1)\)</span> es equivalente a una serie modelada bajo un <span class="math inline">\(MA(\infty)\)</span>.</p>
<p>Al igual que en los demás modelos, ahora determinaremos los momentos del proceso <span class="math inline">\(ARMA(1, 1)\)</span>. La media estará dada por:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mathbb{E}[\delta + a_1 X_{t-1} + U_t - b_1 U_{t-1}] \nonumber \\
    &amp; = &amp; \delta + a_1 \mathbb{E}[X_{t-1}] \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1} \nonumber \\
    &amp; = &amp; \mu
    (\#eq:ARMA11Sol1)
\end{eqnarray}\]</span></p>
<p>Donde hemos utilizado que <span class="math inline">\(\mathbb{E}[X_t] = \mathbb{E}[X_{t-1}] = \mu\)</span>. Es decir, la media de un <span class="math inline">\(ARMA(1, 1)\)</span> es idéntica a la de un <span class="math inline">\(AR(1)\)</span>.</p>
<p>Para determinar la varianza tomaremos una estrategía similar a los casos de <span class="math inline">\(AR(p)\)</span> y <span class="math inline">\(MA(q)\)</span>. Por lo que para todo <span class="math inline">\(\tau \geq 0\)</span>, y suponiendo por simplicidad que <span class="math inline">\(\delta = 0\)</span> (lo que implica que <span class="math inline">\(\mu = 0\)</span>) tendremos:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[X_{t-\tau} X_t] &amp; = &amp; \mathbb{E}[(X_{t-\tau}) \cdot (a_1 X_{t-1} + U_t - b_1 U_{t-1})] \nonumber \\
    &amp; = &amp; a_1 \mathbb{E}[X_{t-\tau} X_{t-1}] + \mathbb{E}[X_{t-\tau} U_t] - b_1 \mathbb{E}[X_{t-\tau} U_{t-1}]
    (\#eq:ARMA11Cov)
\end{eqnarray}\]</span></p>
<p>De la ecuación @ref(eq:ARMA11Cov) podemos determinar una expresión para el caso de <span class="math inline">\(\tau = 0\)</span>:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[X_{t} X_t] &amp; = &amp; \gamma(0) \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + \mathbb{E}[U_t X_t] - b_1 \mathbb{E}[X_t U_{t-1}] \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + \sigma^2 + b_1 \mathbb{E}[U_{t-1} (a_1 X_{t-1} + U_t - b_1 U_{t-1})] \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + \sigma^2 - b_1 a_1 \sigma^2 + b_1 \sigma^2 \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + (1 - b_1 (a_1 - b_1)) \sigma^2
        (\#eq:ARMA11Cov1)
\end{eqnarray}\]</span></p>
<p>Para el caso en que <span class="math inline">\(\tau = 1\)</span>:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[X_{t-1} X_t] &amp; = &amp; \gamma(1) \nonumber \\
    &amp; = &amp; a_1 \gamma(0) + \mathbb{E}[X_{t-1} U_t] - b_1 \mathbb{E}[X_{t-1} U_{t-1}] \nonumber \\
    &amp; = &amp; a_1 \gamma(0) - b_1 \sigma^2
        (\#eq:ARMA11Cov2)
\end{eqnarray}\]</span></p>
<p>Estas últimas expresiones podemos resolverlas como sistema para determinar los siguientes valores:
<span class="math display">\[\begin{eqnarray}
    \gamma(0) &amp; = &amp; \frac{1 + b_1^2 - 2 a_1 b_1}{1 - a_1^2} \sigma^2
    (\#eq:ARMA11Cov3)
\end{eqnarray}\]</span></p>
<p><span class="math display">\[\begin{eqnarray}
    \gamma(1) &amp; = &amp; \frac{(a_1 - b_1)(1 - a_1 b_1)}{1 - a_1^2} \sigma^2
    (\#eq:ARMA11Cov4)
\end{eqnarray}\]</span></p>
<p>En general para cualquier valor <span class="math inline">\(\tau \geq 2\)</span> tenemos que la autocovarianza y la función de autocorrelación serán:
<span class="math display">\[\begin{eqnarray}
    \gamma(\tau) = a_1 \gamma(\tau - 1) \\
    (\#eq:ARMA11Cov5)
    \end{eqnarray}\]</span></p>
<p><span class="math display">\[\begin{eqnarray}    
    \rho(\tau) = a_1 \rho(\tau - 1)
    (\#eq:ARMA11Cov6)
\end{eqnarray}\]</span></p>
<p>Por ejemplo, para el caso de <span class="math inline">\(\tau = 1\)</span> tendríamos:
<span class="math display">\[\begin{equation}
    \rho(1) = \frac{(a_1 - b_1)(1 - a_1 b_1)}{1 + b_1^2 - 2 a_1 b_1}
    (\#eq:ARMA11Cov7)
\end{equation}\]</span></p>
<p>De esta forma, la función de autocorrelación oscilará en razón de los valores que tome <span class="math inline">\(a_1\)</span> y <span class="math inline">\(b_1\)</span>.</p>
</div>
<div id="armap-q" class="section level3" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> ARMA(p, q)</h3>
<p>La especificación general de un <span class="math inline">\(ARMA(p, q)\)</span> (donde <span class="math inline">\(p, q \in \mathbb{N}\)</span>) puede ser descrita por la siguiente ecuación:
<span class="math display">\[\begin{eqnarray}
    X_t &amp; = &amp; \delta + a_1 X_{t - 1} + a_2 X_{t - 2} + \ldots + a_p X_{t - p} \nonumber \\
    &amp;   &amp; + U_t - b_1 U_{t - 1} - b_2  U_{t - 2} - \ldots - b_q  U_{t - q}
    (\#eq:ARMApqEq)
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio, y <span class="math inline">\(X_t\)</span> puede ser modelada en niveles o en diferencias (ya sea en logaritmos o sin transformación logarítmica).</p>
<p>Mediante el uso del operador rezago se puede escribir la ecuación @ref(eq:ARMApqEq) como:
<span class="math display">\[\begin{equation}
    (1 - a_1 L - a_2 L^2 - \ldots - a_p L^p) X_t = \delta + (1 - b_1 L - b_2 L^2 - \ldots - b_q L^q) U_t
    (\#eq:ARMApqEQLag)
\end{equation}\]</span></p>
<p>En la ecuación @ref(eq:ARMApqEQLag) definamos dos polinomios: <span class="math inline">\(\alpha(L) = (1 - a_1 L - a_2 L^2 - \ldots - a_p L^p)\)</span> y <span class="math inline">\(\beta(L) = (1 - b_1 L - b_2 L^2 - \ldots - b_q L^q)\)</span>. Así, podemos reescribir la ecuación @ref(eq:ARMApqEQLag) como:
<span class="math display">\[\begin{equation}
    \alpha(L) X_t = \delta + \beta(L) U_t
    (\#eq:ARMApqEQLag1)
\end{equation}\]</span></p>
<p>Asumiendo que existe el polinomio inverso tal que: <span class="math inline">\(\alpha(L)^{-1}\alpha(L) = 1\)</span>.La solución entonces puede ser escrita como:
<span class="math display">\[\begin{eqnarray}
    X_t &amp; = &amp; \alpha(L)^{-1} \delta + \alpha(L)^{-1} \beta(L) U_t \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} + \frac{\beta(L)}{\alpha(L)} U_t \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} + U_t + \psi_1 L U_t + \psi_2 L^2 U_t + \ldots
    (\#eq:ARMApqWold)
\end{eqnarray}\]</span></p>
<p>Donde la ecuación @ref(eq:ARMApqWold) nos permite interpretar que un ARMA(p, q) se puede reexpresar e interpreetar como un <span class="math inline">\(MA(\infty)\)</span> y donde las condiciones para la estabilidad de la solución y la invertibilidad es que las ráices de los polinomios característicos <span class="math inline">\(\alpha(L)\)</span> y <span class="math inline">\(\beta(L)\)</span> son en valor absoluto menores a 1.</p>
<p>Adicionalmente, la fracción en la ecuación @ref(eq:ARMApqWold) se puede descomponer como en la forma de Wold:
<span class="math display">\[\begin{equation}
    \frac{\beta(L)}{\alpha(L)} = 1 + \psi_1 L + \psi_2 L^2 + \ldots
    (\#eq:ARMApqWold1)
\end{equation}\]</span></p>
<p>Bajo los supuestos de estacionariedad del componente <span class="math inline">\(U_t\)</span>, los valores de la media y varianza de un proceso <span class="math inline">\(ARMA(p, q)\)</span> serán como describimos ahora. Para el caso de la media podemos partir de la ecuación @ref(eq:ARMApqWold) para generar:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mathbb{E}\left[ \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} + U_t + \psi_1 U_{t-1} + \psi_2 U_{t-2} + \ldots \right] \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} \nonumber \\
    &amp; = &amp; \mu
    (\#eq:ARMApqWold2)
\end{eqnarray}\]</span></p>
<p>Esta expresión indica que en general un proceso <span class="math inline">\(ARMA(p, q)\)</span> converge a una media idéntica a la de un porceso <span class="math inline">\(AR(p)\)</span>. Para determinar la varianza utilizaremos la misma estratégia que hemos utilizado para otros modelos <span class="math inline">\(AR(p)\)</span> y <span class="math inline">\(MA(q)\)</span>.</p>
<p>Sin pérdida de generalidad podemos asumir que <span class="math inline">\(\delta = 0\)</span>, lo que implica que <span class="math inline">\(\mu = 0\)</span>, de lo que podemos establecer una expresión de autocovarianzas para cualquier valor <span class="math inline">\(\tau = 0, 1, 2, \ldots\)</span>:
<span class="math display">\[\begin{eqnarray}
    \gamma(\tau) &amp; = &amp; \mathbb{E}[X_{t-\tau} X_t] \nonumber \\
    &amp; = &amp; \mathbb{E}[X_{t-\tau} (\delta + a_1 X_{t - 1} + a_2 X_{t - 2} + \ldots + a_p X_{t - p} \nonumber \\
    &amp;   &amp; + U_t - b_1 U_{t - 1} - b_2  U_{t - 2} - \ldots - b_q  U_{t - q})] \nonumber \\
    &amp; = &amp; a_1 \gamma(\tau - 1) + a_2 \gamma(\tau - 2) + \ldots + a_p \gamma(\tau - p) \nonumber \\
    &amp;   &amp; + \mathbb{E}[X_{t-\tau} U_{t}] - b_1  \mathbb{E}[X_{t-\tau} U_{t-1}] - \ldots  - b_q  \mathbb{E}[X_{t-\tau} U_{t-q}]
    (\#eq:ARMApqWold3)
\end{eqnarray}\]</span></p>
<p>Ahora veámos un ejemplo. Utilizaremos la serie de Pasajeros en vuelos nacionales de salida para estimar un <span class="math inline">\(ARMA(p, q)\)</span> mediante el método de máxima verosimilitud (ML). Antes de realizar el proceso de estimación consideremos una transformación de la serie en diferencias logaritmicas, ya que según la gráfica en la Figura @ref(fig:GPaxNal) esa es la que puede ser estacionaria.</p>
<p>A continuación, estimaremos una <span class="math inline">\(ARMA(1, 1)\)</span> para la serie en diferencias logarimitcas (<span class="math inline">\(DLPaxNal_t\)</span>). También incorporaremos al análisis variables exogénas tales como dummies de estacionalidad. En particular, utilizaremos los meses de enero, febrero, julio y diciembre. No debe pasar desapercibido que un análisis de estacionalidad más formal debeería considerar todos los meses para separar del término de error la parte que puedee ser explicada por los ciclos estacionales.</p>
<p>Así obtenemos el siguiente resultado:</p>
<p><span class="math display">\[\begin{eqnarray}
     DLPaxNal_t  &amp;  =  &amp;  -0.0025  &amp;  +  &amp;  0.6018   &amp;  DLPaxNal_{t-1}  \\
    &amp;  &amp;  (0.0045)  &amp;  &amp;  (0.0964)  &amp; \\
    &amp;  &amp;  &amp;  -  &amp;  0.9064  &amp;  U_{t-1}  \\
    &amp;  &amp;  &amp;  &amp;  (0.0397)  &amp; \\
    &amp;  &amp;  &amp;  -  &amp;  0.0867  &amp;  DEne_t  \\
    &amp;  &amp;  &amp;  &amp;  (0.0230)  &amp; \\
    &amp;  &amp;  &amp;  -  &amp;  0.0409  &amp;  DFeb_t  \\
    &amp;  &amp;  &amp;  &amp;  (0.0263)  &amp; \\
    &amp;  &amp;  &amp;  +  &amp;  0.1529  &amp;  DJul_t  \\
    &amp;  &amp;  &amp;  &amp;  (0.0245)  &amp; \\
    &amp;  &amp;  &amp;  +  &amp;  0.0628  &amp;  DDic_t  \\
    &amp;  &amp;  &amp;  &amp;  (0.0223)  &amp;
\end{eqnarray}\]</span></p>
<p><span class="math display">\[\begin{eqnarray}
    \hat{\sigma}^2 &amp; = &amp; 0.007096 &amp; y &amp; AIC &amp; = &amp; -475.12
\end{eqnarray}\]</span></p>
<p>Donde entre parentésis indicamos los errores estándar. Adicionalmente, reportamos el estadístico de Akaike (AIC). Finalmente, podemos determinar si las soluciones serán convergentes, para ello en la Figura @ref(fig:GRootsARMA11) mostramos las raíces asociadas a cada uno de los polinomios. De la inspección visual podemos concluir que tenemos una solución convergente y estable. Por su parte la Figura @ref(fig:GResidualsARMA11) muestra los residuales de la estimación del <span class="math inline">\(ARMA(1, 1)\)</span>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>Datos4 <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;BD/Clase_10.5/Base_Transporte_ARIMA.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;Datos&quot;</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Funciones que extrae y grafica las raices del polinomio caracteristico</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;BD/Clase_09/arroots.R&quot;</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;BD/Clase_09/maroots.R&quot;</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;BD/Clase_09/plot.armaroots.R&quot;</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion a series de tiempo:</span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>Pax_Nal4 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos4<span class="sc">$</span>Pax_Nal, </span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>LPax_Nal4 <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(Datos4<span class="sc">$</span>Pax_Nal), </span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a>               <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>               <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>DLPax_Nal4 <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(Datos4<span class="sc">$</span>Pax_Nal) <span class="sc">-</span> <span class="fu">lag</span>(<span class="fu">log</span>(Datos4<span class="sc">$</span>Pax_Nal), <span class="at">k =</span> <span class="dv">1</span>),</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>DLPax_Nal_S4 <span class="ot">&lt;-</span> <span class="fu">diff</span>(DLPax_Nal4, <span class="dv">12</span>)</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>D_Feb20204  <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos4<span class="sc">$</span>D_Feb2020,</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>D_Mar20204  <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos4<span class="sc">$</span>D_Mar2020, </span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>D_Abr20204  <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos4<span class="sc">$</span>D_Abr2020, </span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>D_May20204  <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos4<span class="sc">$</span>D_May2020, </span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-39"><a href="#cb32-39" aria-hidden="true" tabindex="-1"></a>D_Jun20204  <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos4<span class="sc">$</span>D_Jun2020, </span>
<span id="cb32-40"><a href="#cb32-40" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb32-41"><a href="#cb32-41" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb32-42"><a href="#cb32-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-43"><a href="#cb32-43" aria-hidden="true" tabindex="-1"></a>D_Jul20204 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos4<span class="sc">$</span>D_Jul2020, </span>
<span id="cb32-44"><a href="#cb32-44" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb32-45"><a href="#cb32-45" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb32-46"><a href="#cb32-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-47"><a href="#cb32-47" aria-hidden="true" tabindex="-1"></a>D_Ene20214 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos4<span class="sc">$</span>D_Ene2021, </span>
<span id="cb32-48"><a href="#cb32-48" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb32-49"><a href="#cb32-49" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb32-50"><a href="#cb32-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-51"><a href="#cb32-51" aria-hidden="true" tabindex="-1"></a>D_Mar20214 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos4<span class="sc">$</span>D_Mar2021, </span>
<span id="cb32-52"><a href="#cb32-52" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb32-53"><a href="#cb32-53" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb32-54"><a href="#cb32-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-55"><a href="#cb32-55" aria-hidden="true" tabindex="-1"></a>D_Ene4 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos4<span class="sc">$</span>D_Ene, </span>
<span id="cb32-56"><a href="#cb32-56" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb32-57"><a href="#cb32-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb32-58"><a href="#cb32-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-59"><a href="#cb32-59" aria-hidden="true" tabindex="-1"></a>D_Feb4 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos4<span class="sc">$</span>D_Feb, </span>
<span id="cb32-60"><a href="#cb32-60" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb32-61"><a href="#cb32-61" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb32-62"><a href="#cb32-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-63"><a href="#cb32-63" aria-hidden="true" tabindex="-1"></a>D_Jul4 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos4<span class="sc">$</span>D_Jul, </span>
<span id="cb32-64"><a href="#cb32-64" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb32-65"><a href="#cb32-65" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb32-66"><a href="#cb32-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-67"><a href="#cb32-67" aria-hidden="true" tabindex="-1"></a>D_Dic4 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos4<span class="sc">$</span>D_Dic, </span>
<span id="cb32-68"><a href="#cb32-68" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb32-69"><a href="#cb32-69" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb32-70"><a href="#cb32-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-71"><a href="#cb32-71" aria-hidden="true" tabindex="-1"></a><span class="co"># Funciones que determinan el rezago optimo (que minimiza el criterio de Akaike)</span></span>
<span id="cb32-72"><a href="#cb32-72" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;BD/Clase_10.5/Lag_Opt_ARIMA_Exog.R&quot;</span>)</span>
<span id="cb32-73"><a href="#cb32-73" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;BD/Clase_10.5/Lag_Opt_SARIMA_Exog.R&quot;</span>)</span>
<span id="cb32-74"><a href="#cb32-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-75"><a href="#cb32-75" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimacion de ARIMA(1, 1, 1)</span></span>
<span id="cb32-76"><a href="#cb32-76" aria-hidden="true" tabindex="-1"></a>ARMA_DLPax_Nal <span class="ot">&lt;-</span> <span class="fu">arima</span>(DLPax_Nal4, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>),</span>
<span id="cb32-77"><a href="#cb32-77" aria-hidden="true" tabindex="-1"></a>                        <span class="at">xreg =</span> <span class="fu">cbind</span>(D_Ene4, D_Feb4, D_Jul4, D_Dic4),</span>
<span id="cb32-78"><a href="#cb32-78" aria-hidden="true" tabindex="-1"></a>                        <span class="at">method =</span> <span class="st">&quot;ML&quot;</span>)</span>
<span id="cb32-79"><a href="#cb32-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-80"><a href="#cb32-80" aria-hidden="true" tabindex="-1"></a>ARMA_DLPax_Nal</span>
<span id="cb32-81"><a href="#cb32-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-82"><a href="#cb32-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb32-83"><a href="#cb32-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; arima(x = DLPax_Nal4, order = c(1, 0, 1), xreg = cbind(D_Ene4, D_Feb4, D_Jul4, </span></span>
<span id="cb32-84"><a href="#cb32-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     D_Dic4), method = &quot;ML&quot;)</span></span>
<span id="cb32-85"><a href="#cb32-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-86"><a href="#cb32-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb32-87"><a href="#cb32-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           ar1     ma1  intercept   D_Ene4   D_Feb4  D_Jul4</span></span>
<span id="cb32-88"><a href="#cb32-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       -0.5620  0.8029     0.0013  -0.0938  -0.1195  0.1855</span></span>
<span id="cb32-89"><a href="#cb32-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s.e.   0.1095  0.0725     0.0138   0.0383   0.0391  0.0343</span></span>
<span id="cb32-90"><a href="#cb32-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       D_Dic4</span></span>
<span id="cb32-91"><a href="#cb32-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       0.0643</span></span>
<span id="cb32-92"><a href="#cb32-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s.e.  0.0374</span></span>
<span id="cb32-93"><a href="#cb32-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb32-94"><a href="#cb32-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma^2 estimated as 0.02558:  log likelihood = 106.7,  aic = -197.41</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.armaroots</span>(<span class="fu">arroots</span>(ARMA_DLPax_Nal), </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>               <span class="at">main=</span><span class="st">&quot;Inverse AR roots of </span><span class="sc">\n</span><span class="st">AR(p): LN PAx Nal&quot;</span>)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.armaroots</span>(<span class="fu">maroots</span>(ARMA_DLPax_Nal), </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>               <span class="at">main=</span><span class="st">&quot;Inverse MA roots of </span><span class="sc">\n</span><span class="st">MA(q): LN PAx Nal&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/GRootsARMA11-1.png" alt="Inverso de las Raíces del polinomio característico de un ARMA(1,1)" width="100%" />
<p class="caption">
(#fig:GRootsARMA11)Inverso de las Raíces del polinomio característico de un ARMA(1,1)
</p>
</div>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<p>En lo que resta de este capítulo, utilizaremos la serie en diferencias logarítmicas de los pasajeros en vuelos nacionales de salida, <span class="math inline">\(DLPaxNal_t\)</span>, para discutir los ejemplos que ilustran cada uno de los puntos teóricos que a continuación exponemos.</p>
</div>
</div>
<div id="función-de-autocorrelación-parcial" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Función de Autocorrelación Parcial</h2>
<p>Ahora introduciremos el concepto de Función de Autocorrelación Parcial (PACF, por sus siglas en inglés). Primero, dadas las condiciones de estabilidad y de convergencia, si suponemos que un proceso AR, MA, ARMA o ARIMA tienen toda la información de los rezagos de la serie en conjunto y toda la información de los promedio móviles del término de error, resulta importante construir una métrica para distinguir el efecto de <span class="math inline">\(X_{t - \tau}\)</span> o el efecto de <span class="math inline">\(U_{t - \tau}\)</span> (para cualquier <span class="math inline">\(\tau\)</span>) sobre <span class="math inline">\(X_t\)</span> de forma individual.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ARMA_DLPax_Nal<span class="sc">$</span>residuals,</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Residuales de un ARIMA LN Pasajeros en vuelos nacionales de salida&quot;</span>,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>,</span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Residuals ARMA(1, 1)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/GResidualsARMA11-1.png" alt="Inverso de las Raíces del polinomio característico de un ARMA(1,1)" width="100%" />
<p class="caption">
(#fig:GResidualsARMA11)Inverso de las Raíces del polinomio característico de un ARMA(1,1)
</p>
</div>
<p>La idea es construir una métrica de la correlación que existe entre las diferentes varibles aleatorias, si para tal efecto se ha controlado el efecto del resto de la información. Así, podemos definir la ecuación que puede responder a este planteamiento como:
<span class="math display">\[\begin{equation}
    X_t = \phi_{k1} X_{t-1} + \phi_{k2} X_{t-2} + \ldots + \phi_{kk} X_{t-k} + U_t
    (\#eq:PACFEq)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\phi_{ki}\)</span> es el coeficiente de la variable dada con el rezago <span class="math inline">\(i\)</span> si el proceso tiene un órden <span class="math inline">\(k\)</span>. Así, los coeficientes <span class="math inline">\(\phi_{kk}\)</span> son los coeficientes de la autocorrelación parcial (considerando un proceso AR(k)). Observemos que la autocorrelaicón parcial mide la correlación entre <span class="math inline">\(X_t\)</span> y <span class="math inline">\(X_{t-k}\)</span> que se mantiene cuando el efecto de las variables <span class="math inline">\(X_{t-1}\)</span>, <span class="math inline">\(X_{t-2}\)</span>, <span class="math inline">\(\ldots\)</span> y <span class="math inline">\(X_{t-k-1}\)</span> en <span class="math inline">\(X_{t}\)</span> y <span class="math inline">\(X_{t-k}\)</span> ha sido eliminado.</p>
<p>Dada la expresión considerada en la ecuación @ref(eq:PACFEq), podemos resolver el problema de establecer el valor de cada <span class="math inline">\(\phi_{ki}\)</span> mediante la solución del sistema que se representa en lo siguiente:</p>
<table>
<caption>(#tab:foo1) Relación entre la Función de autocorrelación y la Función de autocorrelación parcial de una serie <span class="math inline">\(X_t\)</span>.</caption>
<colgroup>
<col width="33%" />
<col width="33%" />
<col width="33%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Modelo si:</th>
<th align="center">Función de autocorrelación</th>
<th align="center">Función de autocorrelación parcial</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(MA(q)\)</span></td>
<td align="center">Rompimientos en la función</td>
<td align="center">No hay rompimientos</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(AR(q)\)</span></td>
<td align="center">No hay rompimientos</td>
<td align="center">Rompimientos en la función</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[\begin{equation}
    \left[
    \begin{array}{c}
        \rho(1) \\
        \rho(2) \\
        \vdots \\
        \rho(k)
    \end{array}
    \right]
    =
    \left[
    \begin{array}{c c c c}
        1 &amp; \rho(1) &amp; \ldots &amp; \rho(k - 1)\\
        \rho(1) &amp; 1 &amp; \ldots &amp; \rho(k - 2)\\
        \rho(2) &amp; \rho(1) &amp; \ldots &amp; \rho(k - 3)\\
        \vdots &amp; \vdots &amp; \ldots &amp; \vdots\\
        \rho(k - 1) &amp; \rho(k - 2) &amp; \ldots &amp; 1\\
    \end{array}
    \right]
    \left[
    \begin{array}{c}
        \phi_{k1} \\
        \phi_{k2} \\
        \phi_{k3} \\
        \vdots \\
        \phi_{kk} \\
    \end{array}
    \right]
    (\#eq:PACFEq1)    
\end{equation}\]</span></p>
<p>Del cual se puede derivar una solución, resoviendo por el método de cramer, o cualquier otro método que consideremos y que permita calcular la solución de sistemas de ecuaciones.</p>
<p>Posterior al análisis analítico platearemos un enfoque para interpretar las funciones de autocorrelación y autocorrelación parcial. Este enfoque pretende aportar al principio de parcimonia, en el cual podemos identificar el número de parámetros que posiblemente puede describir mejor a la serie en un modelo ARMA(p, q).</p>
<p>En el Cuadro @ref(tab:foo1) se muestra un resumen de las caranterísticas que debemos observar para determinar el número de parámetros de cada uno de los componentes AR y MA. Lo anterior por observación de las funciones de autocorrelación y autocorrelación parcial. Este enfoque no es el más formal, más adelante implemtaremos uno más formal y que puede ser más claro de cómo determinar el númeto de parámetros.</p>
<p>Continuando con el ejemplo en la Figura @ref(fig:GACFPACF) mostramos tanto la Función de Autocorrelación como la Función de Autocorrelación Parcial. En esta identificamos que ambas gráficas muestran que el modelo que explica a la variable <span class="math inline">\(DLPaxNal_t\)</span> tiene tanto componentes AR como MA. Sin embargo, dado lo errático del comportamiento de ambas funciones, resulta complicado determinar cuál sería un buen número de parametros <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> a considerar en el <span class="math inline">\(ARMA(p,q)\)</span>. Por esta razón a continuación platearemos algunas pruebas más formales para determinar dichos parámetros.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(DLPax_Nal4[<span class="dv">2</span><span class="sc">:</span><span class="dv">234</span>], <span class="at">lag.max =</span> <span class="dv">24</span>,</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Rezagos&quot;</span>,</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="st">&quot;Diff LN Pasajeros Nacionales&quot;</span>)</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(DLPax_Nal4[<span class="dv">2</span><span class="sc">:</span><span class="dv">234</span>], <span class="at">lag.max =</span> <span class="dv">24</span>, </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&#39;Rezagos&#39;</span>,</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Diff LN Pasajeros Nacionales&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/GACFPACF-1.png" alt="Función de Autocorrelación y la Función de Autocorrelación Parcial de una serie $DLPaxNal_t$." width="100%" />
<p class="caption">
(#fig:GACFPACF)Función de Autocorrelación y la Función de Autocorrelación Parcial de una serie <span class="math inline">\(DLPaxNal_t\)</span>.
</p>
</div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
</div>
<div id="selección-de-las-constantes-p-q-d-en-un-arp-un-maq-un-armap-q-o-un-arimap-d-q" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> Selección de las constantes p, q, d en un AR(p), un MA(q), un ARMA(p, q) o un ARIMA(p, d, q)</h2>
<p>Respecto de cómo estimar un proceso ARMA(p, q) –en general utilizaremos este modelo para discutir, pero lo planteado en esta sección es igualmente aplicable en cualquier otro caso como aquellos modelos que incluyen variables exogénas– existen diversas formas de estimar los paramétros <span class="math inline">\(a_i\)</span> y <span class="math inline">\(b_i\)</span>: i) por máxima verosimilitd y ii) por mínimos cuadrados órdinarios. El primer caso requiere que conozcamos la distribución del proceso aleatorio <span class="math inline">\(U_t\)</span>. El segundo, por el contrario, no requiere el mismo supuesto. No obstante, para el curso utilizaremos el método de máxima verosimilitud.</p>
<p>Otra duda que debe quedar hasta el momento es ¿cómo determinar el orden <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> del proceso ARMA(p, q)? La manera más convencional y formal que existe para tal efecto es utilizar los criterios de información. Así, el orden se elije de acuerdo a aquel críterio de información que resulta ser el mínimo. En el caso de <span class="math inline">\(d\)</span> se selecciona revisando la gráfica que parezca más estacionaria–más adelante mostraremos un proceso más formal para su selección.</p>
<p>Los criterios de información más comunes son los siguientes:</p>
<ol style="list-style-type: decimal">
<li><p>FPE (Final Prediction Error):
<span class="math display">\[\begin{equation}
FPE = \frac{T+m}{T-m}\frac{1}{T}\sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2
(\#eq:ls1)
\end{equation}\]</span></p></li>
<li><p>Akaike:
<span class="math display">\[\begin{equation}
AIC = ln \left[ \frac{1}{T} \sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2 \right] + m \frac{2}{T}
     (\#eq:ls2)
\end{equation}\]</span></p></li>
<li><p>Schwarz:
<span class="math display">\[\begin{equation}
SC = ln \left[ \frac{1}{T} \sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2 \right] + m \frac{ln(T)}{T}
   (\#eq:ls3)
\end{equation}\]</span></p></li>
<li><p>Hannan - Quinn:
<span class="math display">\[\begin{equation}
HQ = ln \left[ \frac{1}{T} \sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2 \right] + m \frac{2 ln(ln(T))}{T}
   (\#eq:ls4)
\end{equation}\]</span></p></li>
</ol>
<p>Donde <span class="math inline">\(\hat{U}_t^{(p)}\)</span> son los residuales estimados mediante un proceso ARIMA y <span class="math inline">\(m\)</span> es el número de parametros estimados: <span class="math inline">\(m = p + q + 0 + 1\)</span> (ya que asumimos que <span class="math inline">\(d = 0\)</span>). Una propiedad que no se debe perder de vista es que los criterios de información cumplen la siguiente relación:
<span class="math display">\[\begin{equation}
    orden(SC) \leq orden(HQ) \leq orden(AIC)
    (\#eq:ls5)
\end{equation}\]</span></p>
<p>Por esta razón, durante el curso solo utilizaremos el criterio se Akaike para determinar el orden óptimo del proceso ARMA, ya que ello garantiza el orden más grande posible.</p>
<p>Ahora veamos un ejemplo de estimación del número de rezagos optimo de un <span class="math inline">\(ARMA(p, q)\)</span>. Retomemos la serie en diferencias logarítmicas de los pasajeros en vuelos nacionales de salidas, pero ahora incluiremos la variables exógenas de dummies estacionales: enero, febrero, julio y diciembre.</p>
<p>Como mencionamos, las gráficas de las funciones de autocorrelación permiten observar el valor de la correlación existente entre la variable en el momento <span class="math inline">\(t\)</span> con cada uno de los rezagos. Incluso la Función de Autocorrelación Parcial puede ayudar a determinar el número máximo de rezagos que se debe incluir en el proceso <span class="math inline">\(AR(p)\)</span>. No obstante, una métrica más formal es el uso de los criterios de información. En nuestro caso, dado lo discutido, sólo utilizareemos el criterio de Akaike.</p>
<table>
<caption>(#tab:SelecARMApq) Criterio de Akike para diferentes modelos <span class="math inline">\(ARMA(p, q)\)</span> de la serie <span class="math inline">\(DLPaxNal_t\)</span>.</caption>
<thead>
<tr class="header">
<th align="center">Modelo</th>
<th align="center">AR(p)</th>
<th align="center">MA(p)</th>
<th align="center">Akaike (AIC)</th>
<th align="center">Óptimo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">-475.1190</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">-473.4397</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">1</td>
<td align="center">3</td>
<td align="center">-483.1239</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="center">-482.4932</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">1</td>
<td align="center">5</td>
<td align="center">-506.9880</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">1</td>
<td align="center">6</td>
<td align="center">-533.9411</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">7</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">-473.4758</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="odd">
<td align="center">24</td>
<td align="center">4</td>
<td align="center">6</td>
<td align="center">-752.8996</td>
<td align="center">*</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="odd">
<td align="center">36</td>
<td align="center">6</td>
<td align="center">6</td>
<td align="center">-752.2632</td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>Al respecto, en el Cuadro @ref(tab:SelecARMApq) reportamos el criterio de Akaike que resultan de aplicar dicho criterio a los residuales resultantes de cada combinación de procesos <span class="math inline">\(ARMA(p, q)\)</span>. La forma de escoger será aquel modelo que reporta el criterio de Akaike menor. En la cuarta columna de la tabla se señala el valor del criterio de información que resulta ser el mínimo de todos los posibles.</p>
<p>El Cuadro @ref(tab:SelecARMApq) reporta los resultados para 36 diferentes modelos, todos incluyen variables exogenas. Como resultado del análisis concluimos que el modelo más adecuado es el 24, el cual considera un <span class="math inline">\(ARMA(4, 6)\)</span>, con variables dummies para controlar la estacionalidad de los meses de enero, febrero, julio y diciembre. En el Cuadro @ref(tab:ResultARMApq) mostramos los resutados del modelo.</p>
<p>No obstante, una inspección de los residuales del modelo nos permite sospechar que requiere de incluir un par de dummies más. Ambas, asociadas con la caída del transporte aéreo en 2009, principalmente asociado con la crisis mundial de ese año. La Figura @ref(fig:GResidualsARMA46) muestra los residuales mencionados.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Funciones que determinan el rezago optimo (que minimiza el criterio de Akaike)</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Esta es una prueba mas formar respecto de la meta inspeccion grafica</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">&quot;BD/Clase_09/Lag_Opt_ARIMA_Exog.R&quot;</span>)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimacion del proceso ARIMA(p, 1, q):</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a><span class="co">#CON variables exogenas:</span></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a><span class="fu">Lag_Opt_ARIMA_Exog</span>(<span class="at">p_max =</span> <span class="dv">6</span>, <span class="at">q_max =</span> <span class="dv">6</span>, </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">X_t =</span> DLPax_Nal4, </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Ex =</span> <span class="dv">1</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Z_t =</span> <span class="fu">cbind</span>(D_Ene4, D_Feb4, D_Jul4, D_Dic4) )</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; = Z_t, method = &quot;ML&quot;): possible convergence problem: optim</span></span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gave code = 1</span></span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; = Z_t, method = &quot;ML&quot;): possible convergence problem: optim</span></span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gave code = 1</span></span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span id="cb38-22"><a href="#cb38-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span id="cb38-23"><a href="#cb38-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; = Z_t, method = &quot;ML&quot;): possible convergence problem: optim</span></span>
<span id="cb38-24"><a href="#cb38-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gave code = 1</span></span>
<span id="cb38-25"><a href="#cb38-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-26"><a href="#cb38-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span id="cb38-27"><a href="#cb38-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; = Z_t, method = &quot;ML&quot;): possible convergence problem: optim</span></span>
<span id="cb38-28"><a href="#cb38-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gave code = 1</span></span>
<span id="cb38-29"><a href="#cb38-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Rezago p Rezago q       AIC Optimo</span></span>
<span id="cb38-30"><a href="#cb38-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]        1        1 -197.4050      0</span></span>
<span id="cb38-31"><a href="#cb38-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]        1        2 -225.1386      0</span></span>
<span id="cb38-32"><a href="#cb38-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]        1        3 -223.5953      0</span></span>
<span id="cb38-33"><a href="#cb38-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]        1        4 -220.5549      0</span></span>
<span id="cb38-34"><a href="#cb38-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]        1        5 -218.6917      0</span></span>
<span id="cb38-35"><a href="#cb38-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]        1        6 -231.4310      0</span></span>
<span id="cb38-36"><a href="#cb38-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,]        2        1 -220.2086      0</span></span>
<span id="cb38-37"><a href="#cb38-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]        2        2 -224.4070      0</span></span>
<span id="cb38-38"><a href="#cb38-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,]        2        3 -224.5471      0</span></span>
<span id="cb38-39"><a href="#cb38-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,]        2        4 -223.3335      0</span></span>
<span id="cb38-40"><a href="#cb38-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,]        2        5 -225.1568      0</span></span>
<span id="cb38-41"><a href="#cb38-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [12,]        2        6 -229.4401      0</span></span>
<span id="cb38-42"><a href="#cb38-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13,]        3        1 -222.6373      0</span></span>
<span id="cb38-43"><a href="#cb38-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [14,]        3        2 -224.7367      0</span></span>
<span id="cb38-44"><a href="#cb38-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [15,]        3        3 -220.9403      0</span></span>
<span id="cb38-45"><a href="#cb38-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16,]        3        4 -276.7301      1</span></span>
<span id="cb38-46"><a href="#cb38-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [17,]        3        5 -275.5672      0</span></span>
<span id="cb38-47"><a href="#cb38-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [18,]        3        6 -227.4626      0</span></span>
<span id="cb38-48"><a href="#cb38-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19,]        4        1 -221.3591      0</span></span>
<span id="cb38-49"><a href="#cb38-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [20,]        4        2 -222.9806      0</span></span>
<span id="cb38-50"><a href="#cb38-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [21,]        4        3 -243.7884      0</span></span>
<span id="cb38-51"><a href="#cb38-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [22,]        4        4 -243.9174      0</span></span>
<span id="cb38-52"><a href="#cb38-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [23,]        4        5 -244.1439      0</span></span>
<span id="cb38-53"><a href="#cb38-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [24,]        4        6 -271.5143      0</span></span>
<span id="cb38-54"><a href="#cb38-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [25,]        5        1 -220.0956      0</span></span>
<span id="cb38-55"><a href="#cb38-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [26,]        5        2 -221.8154      0</span></span>
<span id="cb38-56"><a href="#cb38-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [27,]        5        3 -272.1756      0</span></span>
<span id="cb38-57"><a href="#cb38-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [28,]        5        4 -245.4954      0</span></span>
<span id="cb38-58"><a href="#cb38-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [29,]        5        5 -243.5682      0</span></span>
<span id="cb38-59"><a href="#cb38-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [30,]        5        6 -269.1516      0</span></span>
<span id="cb38-60"><a href="#cb38-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [31,]        6        1 -227.5711      0</span></span>
<span id="cb38-61"><a href="#cb38-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [32,]        6        2 -226.2520      0</span></span>
<span id="cb38-62"><a href="#cb38-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [33,]        6        3 -273.6243      0</span></span>
<span id="cb38-63"><a href="#cb38-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [34,]        6        4 -270.1272      0</span></span>
<span id="cb38-64"><a href="#cb38-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [35,]        6        5 -270.0199      0</span></span>
<span id="cb38-65"><a href="#cb38-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [36,]        6        6 -269.4984      0</span></span>
<span id="cb38-66"><a href="#cb38-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-67"><a href="#cb38-67" aria-hidden="true" tabindex="-1"></a><span class="co">#SIN variables exogenas:</span></span>
<span id="cb38-68"><a href="#cb38-68" aria-hidden="true" tabindex="-1"></a><span class="fu">Lag_Opt_ARIMA_Exog</span>(<span class="at">p_max =</span> <span class="dv">6</span>, <span class="at">q_max =</span> <span class="dv">6</span>, </span>
<span id="cb38-69"><a href="#cb38-69" aria-hidden="true" tabindex="-1"></a>                   <span class="at">X_t =</span> DLPax_Nal4, </span>
<span id="cb38-70"><a href="#cb38-70" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Ex =</span> <span class="dv">0</span>,</span>
<span id="cb38-71"><a href="#cb38-71" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Z_t =</span> <span class="fu">cbind</span>(D_Ene4, D_Feb4, D_Jul4, D_Dic4))</span>
<span id="cb38-72"><a href="#cb38-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), method =</span></span>
<span id="cb38-73"><a href="#cb38-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &quot;ML&quot;): possible convergence problem: optim gave code = 1</span></span>
<span id="cb38-74"><a href="#cb38-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), method =</span></span>
<span id="cb38-75"><a href="#cb38-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &quot;ML&quot;): possible convergence problem: optim gave code = 1</span></span>
<span id="cb38-76"><a href="#cb38-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-77"><a href="#cb38-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), method =</span></span>
<span id="cb38-78"><a href="#cb38-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &quot;ML&quot;): possible convergence problem: optim gave code = 1</span></span>
<span id="cb38-79"><a href="#cb38-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-80"><a href="#cb38-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), method =</span></span>
<span id="cb38-81"><a href="#cb38-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &quot;ML&quot;): possible convergence problem: optim gave code = 1</span></span>
<span id="cb38-82"><a href="#cb38-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-83"><a href="#cb38-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), method =</span></span>
<span id="cb38-84"><a href="#cb38-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &quot;ML&quot;): possible convergence problem: optim gave code = 1</span></span>
<span id="cb38-85"><a href="#cb38-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-86"><a href="#cb38-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), method =</span></span>
<span id="cb38-87"><a href="#cb38-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &quot;ML&quot;): possible convergence problem: optim gave code = 1</span></span>
<span id="cb38-88"><a href="#cb38-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-89"><a href="#cb38-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), method =</span></span>
<span id="cb38-90"><a href="#cb38-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; &quot;ML&quot;): possible convergence problem: optim gave code = 1</span></span>
<span id="cb38-91"><a href="#cb38-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Rezago p Rezago q       AIC Optimo</span></span>
<span id="cb38-92"><a href="#cb38-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]        1        1 -158.4886      0</span></span>
<span id="cb38-93"><a href="#cb38-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]        1        2 -188.4346      0</span></span>
<span id="cb38-94"><a href="#cb38-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]        1        3 -187.4277      0</span></span>
<span id="cb38-95"><a href="#cb38-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]        1        4 -187.7574      0</span></span>
<span id="cb38-96"><a href="#cb38-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]        1        5 -186.0283      0</span></span>
<span id="cb38-97"><a href="#cb38-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]        1        6 -197.3958      0</span></span>
<span id="cb38-98"><a href="#cb38-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,]        2        1 -184.0936      0</span></span>
<span id="cb38-99"><a href="#cb38-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]        2        2 -189.0901      0</span></span>
<span id="cb38-100"><a href="#cb38-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,]        2        3 -188.0542      0</span></span>
<span id="cb38-101"><a href="#cb38-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,]        2        4 -186.0658      0</span></span>
<span id="cb38-102"><a href="#cb38-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,]        2        5 -190.3917      0</span></span>
<span id="cb38-103"><a href="#cb38-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [12,]        2        6 -195.4309      0</span></span>
<span id="cb38-104"><a href="#cb38-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13,]        3        1 -188.0653      0</span></span>
<span id="cb38-105"><a href="#cb38-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [14,]        3        2 -187.8864      0</span></span>
<span id="cb38-106"><a href="#cb38-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [15,]        3        3 -205.6144      0</span></span>
<span id="cb38-107"><a href="#cb38-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16,]        3        4 -241.7423      0</span></span>
<span id="cb38-108"><a href="#cb38-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [17,]        3        5 -241.5593      0</span></span>
<span id="cb38-109"><a href="#cb38-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [18,]        3        6 -247.4453      0</span></span>
<span id="cb38-110"><a href="#cb38-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19,]        4        1 -164.8898      0</span></span>
<span id="cb38-111"><a href="#cb38-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [20,]        4        2 -186.7417      0</span></span>
<span id="cb38-112"><a href="#cb38-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [21,]        4        3 -214.8872      0</span></span>
<span id="cb38-113"><a href="#cb38-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [22,]        4        4 -211.3784      0</span></span>
<span id="cb38-114"><a href="#cb38-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [23,]        4        5 -208.6211      0</span></span>
<span id="cb38-115"><a href="#cb38-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [24,]        4        6 -216.6316      0</span></span>
<span id="cb38-116"><a href="#cb38-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [25,]        5        1 -184.9023      0</span></span>
<span id="cb38-117"><a href="#cb38-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [26,]        5        2 -186.8473      0</span></span>
<span id="cb38-118"><a href="#cb38-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [27,]        5        3 -245.1477      0</span></span>
<span id="cb38-119"><a href="#cb38-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [28,]        5        4 -213.9622      0</span></span>
<span id="cb38-120"><a href="#cb38-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [29,]        5        5 -212.4953      0</span></span>
<span id="cb38-121"><a href="#cb38-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [30,]        5        6 -241.4802      0</span></span>
<span id="cb38-122"><a href="#cb38-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [31,]        6        1 -200.6707      0</span></span>
<span id="cb38-123"><a href="#cb38-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [32,]        6        2 -198.6868      0</span></span>
<span id="cb38-124"><a href="#cb38-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [33,]        6        3 -248.2317      0</span></span>
<span id="cb38-125"><a href="#cb38-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [34,]        6        4 -246.1741      0</span></span>
<span id="cb38-126"><a href="#cb38-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [35,]        6        5 -264.2011      0</span></span>
<span id="cb38-127"><a href="#cb38-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [36,]        6        6 -270.5896      1</span></span>
<span id="cb38-128"><a href="#cb38-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-129"><a href="#cb38-129" aria-hidden="true" tabindex="-1"></a><span class="co">#Estimacion:</span></span>
<span id="cb38-130"><a href="#cb38-130" aria-hidden="true" tabindex="-1"></a>ARMA_Ex_DLPax_Nal <span class="ot">&lt;-</span> <span class="fu">arima</span>(DLPax_Nal4, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">4</span>),</span>
<span id="cb38-131"><a href="#cb38-131" aria-hidden="true" tabindex="-1"></a>                           <span class="at">xreg =</span> <span class="fu">cbind</span>(D_Ene4, D_Feb4, D_Jul4, D_Dic4),</span>
<span id="cb38-132"><a href="#cb38-132" aria-hidden="true" tabindex="-1"></a>                           <span class="at">method =</span> <span class="st">&quot;ML&quot;</span>)</span>
<span id="cb38-133"><a href="#cb38-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-134"><a href="#cb38-134" aria-hidden="true" tabindex="-1"></a>ARMA_Ex_DLPax_Nal</span>
<span id="cb38-135"><a href="#cb38-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb38-136"><a href="#cb38-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb38-137"><a href="#cb38-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; arima(x = DLPax_Nal4, order = c(3, 0, 4), xreg = cbind(D_Ene4, D_Feb4, D_Jul4, </span></span>
<span id="cb38-138"><a href="#cb38-138" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     D_Dic4), method = &quot;ML&quot;)</span></span>
<span id="cb38-139"><a href="#cb38-139" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb38-140"><a href="#cb38-140" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb38-141"><a href="#cb38-141" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           ar1     ar2     ar3     ma1      ma2      ma3</span></span>
<span id="cb38-142"><a href="#cb38-142" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       -1.0454  0.1932  0.6873  1.3011  -0.2973  -1.4188</span></span>
<span id="cb38-143"><a href="#cb38-143" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s.e.   0.0504  0.0872  0.0504  0.0563   0.0499   0.0476</span></span>
<span id="cb38-144"><a href="#cb38-144" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           ma4  intercept   D_Ene4   D_Feb4  D_Jul4  D_Dic4</span></span>
<span id="cb38-145"><a href="#cb38-145" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       -0.5849    -0.0142  -0.1312  -0.0061  0.2910  0.0612</span></span>
<span id="cb38-146"><a href="#cb38-146" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s.e.   0.0564     0.0099   0.0412   0.0434  0.0514  0.0431</span></span>
<span id="cb38-147"><a href="#cb38-147" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb38-148"><a href="#cb38-148" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma^2 estimated as 0.01722:  log likelihood = 151.37,  aic = -276.73</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ARMA_Ex_DLPax_Nal<span class="sc">$</span>residuals, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Residuales ARMA Diff LN Pasajeros Nacionales&quot;</span>,</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/GResidualsARMA46-1.png" alt="Residuales del ARMA(4, 6) de una serie $DLPaxNal_t$." width="100%" />
<p class="caption">
(#fig:GResidualsARMA46)Residuales del ARMA(4, 6) de una serie <span class="math inline">\(DLPaxNal_t\)</span>.
</p>
</div>
<p>Una vez incluidas dos dummies más para mayo y junio de 2009, analizamos un total de 36 modelos ARMA y determinamos que el orden que minimizza el criterio de Akaike es un <span class="math inline">\(ARMA(4, 6)\)</span>. El Cuadro @ref(tab:ResultARMApq) muestra los resultados para este nuevo modelo. No lo motramos en esta sección, pero ambos modelos reportados tienen raices de sus respectivos polinomios característicos menores a 1 en valor absoluto. En la Figura @ref(fig:GResidualsARMA46D} mostramos los residuales ahora ajustados por las dummies de mayo y junio de 2009.</p>
</div>
<div id="pronósticos" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Pronósticos</h2>
<p>Para pronósticar el valor de la serie es necesario determinar cuál es el valor esperado de la serie en un momento <span class="math inline">\(t + \tau\)</span> condicional en que ésta se comporta como un <span class="math inline">\(AR(p)\)</span>, un <span class="math inline">\(MA(q)\)</span> o un <span class="math inline">\(ARMA(p, q)\)</span> y a que los valores antes de <span class="math inline">\(t\)</span> están dados. Por lo que el pronóstico de la serie estará dado por una expresión:</p>
<p><span class="math display">\[\begin{eqnarray}
    \mathbb{E}_t[X_{t+\tau}] = \delta + a_1 \mathbb{E}_t[X_{t+\tau-1}] + a_2 \mathbb{E}_t[X_{t+\tau-2}] + \ldots + + a_p \mathbb{E}_t[X_{t+\tau-p}]
    (\#eq:ARMApqFor)
\end{eqnarray}\]</span></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nueva Estimacion del proceso ARIMA(p, 1, q):</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="co">#CON variables exogenas rezagos optimos:</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">Lag_Opt_ARIMA_Exog</span>(<span class="at">p_max =</span> <span class="dv">6</span>, <span class="at">q_max =</span> <span class="dv">6</span>, </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">X_t =</span> DLPax_Nal4, </span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Ex =</span> <span class="dv">1</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Z_t =</span> <span class="fu">cbind</span>(D_Ene4, D_Feb4, D_Jul4, D_Dic4, D_Mar20204, D_Abr20204, D_Jun20204, D_Jul20204, D_Mar20214))</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; = Z_t, method = &quot;ML&quot;): possible convergence problem: optim</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gave code = 1</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; = Z_t, method = &quot;ML&quot;): possible convergence problem: optim</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gave code = 1</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; = Z_t, method = &quot;ML&quot;): possible convergence problem: optim</span></span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gave code = 1</span></span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; = Z_t, method = &quot;ML&quot;): possible convergence problem: optim</span></span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gave code = 1</span></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; = Z_t, method = &quot;ML&quot;): possible convergence problem: optim</span></span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gave code = 1</span></span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; = Z_t, method = &quot;ML&quot;): possible convergence problem: optim</span></span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gave code = 1</span></span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; = Z_t, method = &quot;ML&quot;): possible convergence problem: optim</span></span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gave code = 1</span></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-44"><a href="#cb40-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span id="cb40-45"><a href="#cb40-45" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; = Z_t, method = &quot;ML&quot;): possible convergence problem: optim</span></span>
<span id="cb40-46"><a href="#cb40-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gave code = 1</span></span>
<span id="cb40-47"><a href="#cb40-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       Rezago p Rezago q       AIC Optimo</span></span>
<span id="cb40-48"><a href="#cb40-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1,]        1        1 -515.9705      0</span></span>
<span id="cb40-49"><a href="#cb40-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [2,]        1        2 -515.2759      0</span></span>
<span id="cb40-50"><a href="#cb40-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [3,]        1        3 -526.1788      0</span></span>
<span id="cb40-51"><a href="#cb40-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [4,]        1        4 -544.6840      0</span></span>
<span id="cb40-52"><a href="#cb40-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5,]        1        5 -549.7059      0</span></span>
<span id="cb40-53"><a href="#cb40-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6,]        1        6 -566.3787      0</span></span>
<span id="cb40-54"><a href="#cb40-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [7,]        2        1 -515.6097      0</span></span>
<span id="cb40-55"><a href="#cb40-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [8,]        2        2 -523.5230      0</span></span>
<span id="cb40-56"><a href="#cb40-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9,]        2        3 -528.3379      0</span></span>
<span id="cb40-57"><a href="#cb40-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [10,]        2        4 -562.7803      0</span></span>
<span id="cb40-58"><a href="#cb40-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [11,]        2        5 -629.1112      0</span></span>
<span id="cb40-59"><a href="#cb40-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [12,]        2        6 -639.3428      0</span></span>
<span id="cb40-60"><a href="#cb40-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13,]        3        1 -493.0232      0</span></span>
<span id="cb40-61"><a href="#cb40-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [14,]        3        2 -521.5237      0</span></span>
<span id="cb40-62"><a href="#cb40-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [15,]        3        3 -540.6415      0</span></span>
<span id="cb40-63"><a href="#cb40-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [16,]        3        4 -627.6871      0</span></span>
<span id="cb40-64"><a href="#cb40-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [17,]        3        5 -638.1619      0</span></span>
<span id="cb40-65"><a href="#cb40-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [18,]        3        6 -642.3540      0</span></span>
<span id="cb40-66"><a href="#cb40-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [19,]        4        1 -491.1436      0</span></span>
<span id="cb40-67"><a href="#cb40-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [20,]        4        2 -616.1311      0</span></span>
<span id="cb40-68"><a href="#cb40-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [21,]        4        3 -541.0899      0</span></span>
<span id="cb40-69"><a href="#cb40-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [22,]        4        4 -751.3579      0</span></span>
<span id="cb40-70"><a href="#cb40-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [23,]        4        5 -749.8460      0</span></span>
<span id="cb40-71"><a href="#cb40-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [24,]        4        6 -750.2787      0</span></span>
<span id="cb40-72"><a href="#cb40-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [25,]        5        1 -580.2799      0</span></span>
<span id="cb40-73"><a href="#cb40-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [26,]        5        2 -572.7953      0</span></span>
<span id="cb40-74"><a href="#cb40-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [27,]        5        3 -678.9301      0</span></span>
<span id="cb40-75"><a href="#cb40-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [28,]        5        4 -747.5442      0</span></span>
<span id="cb40-76"><a href="#cb40-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [29,]        5        5 -689.7247      0</span></span>
<span id="cb40-77"><a href="#cb40-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [30,]        5        6 -678.0239      0</span></span>
<span id="cb40-78"><a href="#cb40-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [31,]        6        1 -661.8683      0</span></span>
<span id="cb40-79"><a href="#cb40-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [32,]        6        2 -663.5500      0</span></span>
<span id="cb40-80"><a href="#cb40-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [33,]        6        3 -661.5526      0</span></span>
<span id="cb40-81"><a href="#cb40-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [34,]        6        4 -680.3478      0</span></span>
<span id="cb40-82"><a href="#cb40-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [35,]        6        5 -696.3317      0</span></span>
<span id="cb40-83"><a href="#cb40-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [36,]        6        6 -764.4944      1</span></span>
<span id="cb40-84"><a href="#cb40-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-85"><a href="#cb40-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-86"><a href="#cb40-86" aria-hidden="true" tabindex="-1"></a>ARMA_Ex_DLPax_Nal_2 <span class="ot">&lt;-</span> <span class="fu">arima</span>(DLPax_Nal4, <span class="at">order =</span> <span class="fu">c</span>(<span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">6</span>),</span>
<span id="cb40-87"><a href="#cb40-87" aria-hidden="true" tabindex="-1"></a>                             <span class="at">xreg =</span> <span class="fu">cbind</span>(D_Ene4, D_Feb4, D_Jul4, D_Dic4, D_Mar20204, D_Abr20204, D_Jun20204, D_Jul20204, D_Mar20214),</span>
<span id="cb40-88"><a href="#cb40-88" aria-hidden="true" tabindex="-1"></a>                             <span class="at">method =</span> <span class="st">&quot;ML&quot;</span>)</span>
<span id="cb40-89"><a href="#cb40-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning in arima(DLPax_Nal4, order = c(6, 0, 6), xreg =</span></span>
<span id="cb40-90"><a href="#cb40-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; cbind(D_Ene4, D_Feb4, : possible convergence problem: optim</span></span>
<span id="cb40-91"><a href="#cb40-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; gave code = 1</span></span>
<span id="cb40-92"><a href="#cb40-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-93"><a href="#cb40-93" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimacion:</span></span>
<span id="cb40-94"><a href="#cb40-94" aria-hidden="true" tabindex="-1"></a>ARMA_Ex_DLPax_Nal_2</span>
<span id="cb40-95"><a href="#cb40-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb40-96"><a href="#cb40-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb40-97"><a href="#cb40-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; arima(x = DLPax_Nal4, order = c(6, 0, 6), xreg = cbind(D_Ene4, D_Feb4, D_Jul4, </span></span>
<span id="cb40-98"><a href="#cb40-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     D_Dic4, D_Mar20204, D_Abr20204, D_Jun20204, D_Jul20204, D_Mar20214), method = &quot;ML&quot;)</span></span>
<span id="cb40-99"><a href="#cb40-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb40-100"><a href="#cb40-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb40-101"><a href="#cb40-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          ar1     ar2     ar3     ar4     ar5      ar6</span></span>
<span id="cb40-102"><a href="#cb40-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       0.0033  0.0010  0.0056  0.0016  0.0079  -0.9948</span></span>
<span id="cb40-103"><a href="#cb40-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s.e.  0.0062  0.0062  0.0085  0.0063  0.0062   0.0037</span></span>
<span id="cb40-104"><a href="#cb40-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           ma1      ma2      ma3     ma4      ma5     ma6</span></span>
<span id="cb40-105"><a href="#cb40-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       -0.0527  -0.0989  -0.1029  0.0245  -0.0505  0.9383</span></span>
<span id="cb40-106"><a href="#cb40-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s.e.   0.0499   0.0305   0.0483  0.0344   0.0493  0.0377</span></span>
<span id="cb40-107"><a href="#cb40-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       intercept   D_Ene4   D_Feb4  D_Jul4  D_Dic4</span></span>
<span id="cb40-108"><a href="#cb40-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          0.0169  -0.0635  -0.1604  0.0946  0.0056</span></span>
<span id="cb40-109"><a href="#cb40-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s.e.     0.0040   0.0934   0.0172  0.0927  0.0175</span></span>
<span id="cb40-110"><a href="#cb40-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       D_Mar20204  D_Abr20204  D_Jun20204  D_Jul20204</span></span>
<span id="cb40-111"><a href="#cb40-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;          -0.4333     -1.9604      0.9050      0.5063</span></span>
<span id="cb40-112"><a href="#cb40-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s.e.      0.0497      0.0489      0.0519      0.0516</span></span>
<span id="cb40-113"><a href="#cb40-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;       D_Mar20214</span></span>
<span id="cb40-114"><a href="#cb40-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;           0.2198</span></span>
<span id="cb40-115"><a href="#cb40-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; s.e.      0.0504</span></span>
<span id="cb40-116"><a href="#cb40-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb40-117"><a href="#cb40-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; sigma^2 estimated as 0.002315:  log likelihood = 405.25,  aic = -764.49</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ARMA_Ex_DLPax_Nal_2<span class="sc">$</span>residuals, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Residuales ARMA Diff LN Pasajeros Nacionales&quot;</span>,</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkblue&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/GResidualsARMA46D-1.png" alt="Residuales del ARMA(4, 6) de una serie $DLPaxNal_t$." width="100%" />
<p class="caption">
(#fig:GResidualsARMA46D)Residuales del ARMA(4, 6) de una serie <span class="math inline">\(DLPaxNal_t\)</span>.
</p>
</div>
<p>Lo anterior para todo <span class="math inline">\(\tau = 0, 1, 2, \ldots\)</span> y considerando que los componentes MA(q) en la eucación @ref(eq:ARMApqFor) son cero dado que para todo valor <span class="math inline">\(t + \tau\)</span> es cierto que <span class="math inline">\(\mathbb{E}_t[U_{t+\tau}]\)</span>.</p>
<table>
<caption>(#tab:ResultARMApq) Criterio de Akike para diferentes modelos ARMA(p, q) de la serie <span class="math inline">\(DLPaxNal_t\)</span>. <em>Nota: El método de estimación fue máxima verosimilitud.</em></caption>
<thead>
<tr class="header">
<th align="center"></th>
<th align="center">Modelo 1</th>
<th align="center"></th>
<th align="center">Modelo 2</th>
<th align="center"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Variable</td>
<td align="center">Coeficiente</td>
<td align="center">Error Est.</td>
<td align="center">Coeficiente</td>
<td align="center">Error Est.</td>
</tr>
<tr class="even">
<td align="center">Constante</td>
<td align="center">0.0134</td>
<td align="center">0.0033</td>
<td align="center">0.0145</td>
<td align="center">0.0029</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLPaxNal_{t-1}\)</span></td>
<td align="center">0.0004</td>
<td align="center">0.0011</td>
<td align="center">0.0014</td>
<td align="center">0.0016</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLPaxNal_{t-2}\)</span></td>
<td align="center">0.9997</td>
<td align="center">0.0019</td>
<td align="center">0.9988</td>
<td align="center">0.0024</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLPaxNal_{t-3}\)</span></td>
<td align="center">0.0001</td>
<td align="center">0.0012</td>
<td align="center">0.0002</td>
<td align="center">0.0014</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLPaxNal_{t-4}\)</span></td>
<td align="center">-0.9997</td>
<td align="center">0.0004</td>
<td align="center">-0.9993</td>
<td align="center">0.0009</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{U}_{t-1}\)</span></td>
<td align="center">-0.2877</td>
<td align="center">0.0670</td>
<td align="center">-0.1472</td>
<td align="center">0.0633</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{U}_{t-2}\)</span></td>
<td align="center">-1.2028</td>
<td align="center">0.0608</td>
<td align="center">-1.3323</td>
<td align="center">0.0625</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{U}_{t-3}\)</span></td>
<td align="center">0.2302</td>
<td align="center">0.0765</td>
<td align="center">0.1201</td>
<td align="center">0.0756</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{U}_{t-4}\)</span></td>
<td align="center">1.2085</td>
<td align="center">0.0645</td>
<td align="center">1.3142</td>
<td align="center">0.0642</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{U}_{t-5}\)</span></td>
<td align="center">-0.2634</td>
<td align="center">0.0708</td>
<td align="center">-0.1034</td>
<td align="center">0.0717</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{U}_{t-6}\)</span></td>
<td align="center">-0.2171</td>
<td align="center">0.0606</td>
<td align="center">-0.3864</td>
<td align="center">0.0657</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DEne_{t}\)</span></td>
<td align="center">-0.2904</td>
<td align="center">0.0172</td>
<td align="center">-0.2865</td>
<td align="center">0.0156</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DFeb_{t}\)</span></td>
<td align="center">-0.1312</td>
<td align="center">0.0170</td>
<td align="center">-0.1273</td>
<td align="center">0.0140</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DJul_{t}\)</span></td>
<td align="center">0.3303</td>
<td align="center">0.0173</td>
<td align="center">0.3164</td>
<td align="center">0.0156</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(Dic_{t}\)</span></td>
<td align="center">-0.0118</td>
<td align="center">0.0169</td>
<td align="center">-0.0138</td>
<td align="center">0.0137</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DMay2009_{t}\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">-0.3378</td>
<td align="center">0.0360</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DJun2009_{t}\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0.2371</td>
<td align="center">0.0359</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\sigma}^2\)</span></td>
<td align="center">0.001841</td>
<td align="center"></td>
<td align="center">0.001283</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">AIC</td>
<td align="center">-752.9</td>
<td align="center"></td>
<td align="center">-835.73</td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>Continuando con el ejemplo, en la Figura @ref(fig:PaxNalf) mostramos el resultado del pronóstico de la serie a partir del modelo ARMA(4, 6) que hemos discutido anteriormente.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast:</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>Predict_Datos <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;BD/Clase_10/Predict_Base_Transporte_ARIMA.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;Datos&quot;</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Conversion a series de tiempo:</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>D_Mar2020_fP    <span class="ot">&lt;-</span> <span class="fu">ts</span>(Predict_Datos<span class="sc">$</span>D_Mar2020, </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">8</span>), </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>D_Abr2020_fP    <span class="ot">&lt;-</span> <span class="fu">ts</span>(Predict_Datos<span class="sc">$</span>D_Abr2020, </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">8</span>), </span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>D_Jun2020_fP    <span class="ot">&lt;-</span> <span class="fu">ts</span>(Predict_Datos<span class="sc">$</span>D_Jun2020, </span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">8</span>), </span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>D_Jul2020_fP <span class="ot">&lt;-</span> <span class="fu">ts</span>(Predict_Datos<span class="sc">$</span>D_Jul2020, </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">8</span>), </span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>D_Mar2021_fP <span class="ot">&lt;-</span> <span class="fu">ts</span>(Predict_Datos<span class="sc">$</span>D_Mar2021, </span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">8</span>), </span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>D_Ene_fP <span class="ot">&lt;-</span> <span class="fu">ts</span>(Predict_Datos<span class="sc">$</span>D_Ene, </span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">8</span>), </span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>D_Feb_fP <span class="ot">&lt;-</span> <span class="fu">ts</span>(Predict_Datos<span class="sc">$</span>D_Feb, </span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">8</span>), </span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>D_Jul_fP <span class="ot">&lt;-</span> <span class="fu">ts</span>(Predict_Datos<span class="sc">$</span>D_Jul, </span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">8</span>), </span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb42-36"><a href="#cb42-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-37"><a href="#cb42-37" aria-hidden="true" tabindex="-1"></a>D_Dic_fP <span class="ot">&lt;-</span> <span class="fu">ts</span>(Predict_Datos<span class="sc">$</span>D_Dic, </span>
<span id="cb42-38"><a href="#cb42-38" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">8</span>), </span>
<span id="cb42-39"><a href="#cb42-39" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb42-40"><a href="#cb42-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-41"><a href="#cb42-41" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediccion 2 años de la serie en diferencias:</span></span>
<span id="cb42-42"><a href="#cb42-42" aria-hidden="true" tabindex="-1"></a><span class="co"># Usando la estimacion del proceso ARIMA(p, 1, q):</span></span>
<span id="cb42-43"><a href="#cb42-43" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(ARMA_Ex_DLPax_Nal_2, <span class="at">n.ahead =</span> <span class="dv">24</span>, </span>
<span id="cb42-44"><a href="#cb42-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">newxreg =</span> <span class="fu">cbind</span>(D_Ene_fP, D_Feb_fP, D_Jul_fP, D_Dic_fP, </span>
<span id="cb42-45"><a href="#cb42-45" aria-hidden="true" tabindex="-1"></a>                        D_Mar2020_fP, D_Abr2020_fP, D_Jun2020_fP, D_Jul2020_fP, D_Mar2021_fP))</span>
<span id="cb42-46"><a href="#cb42-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $pred</span></span>
<span id="cb42-47"><a href="#cb42-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Jan          Feb          Mar          Apr</span></span>
<span id="cb42-48"><a href="#cb42-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021                                                    </span></span>
<span id="cb42-49"><a href="#cb42-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2022 -0.113805772 -0.162345095  0.143209830 -0.013117736</span></span>
<span id="cb42-50"><a href="#cb42-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2023 -0.112840693 -0.164880914  0.142135423 -0.013327904</span></span>
<span id="cb42-51"><a href="#cb42-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               May          Jun          Jul          Aug</span></span>
<span id="cb42-52"><a href="#cb42-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021                                         0.034506463</span></span>
<span id="cb42-53"><a href="#cb42-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2022  0.056486178  0.001136661  0.178229215  0.037070040</span></span>
<span id="cb42-54"><a href="#cb42-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2023  0.055930178  0.001792611  0.177247937             </span></span>
<span id="cb42-55"><a href="#cb42-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Sep          Oct          Nov          Dec</span></span>
<span id="cb42-56"><a href="#cb42-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021 -0.109937459  0.046817343 -0.022944168  0.038579201</span></span>
<span id="cb42-57"><a href="#cb42-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2022 -0.108866052  0.047031034 -0.022405053  0.037915211</span></span>
<span id="cb42-58"><a href="#cb42-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2023                                                    </span></span>
<span id="cb42-59"><a href="#cb42-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb42-60"><a href="#cb42-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $se</span></span>
<span id="cb42-61"><a href="#cb42-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Jan        Feb        Mar        Apr        May</span></span>
<span id="cb42-62"><a href="#cb42-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021                                                       </span></span>
<span id="cb42-63"><a href="#cb42-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2022 0.04899045 0.04910882 0.04916415 0.04935297 0.04957147</span></span>
<span id="cb42-64"><a href="#cb42-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2023 0.05023197 0.05035300 0.05040132 0.05057457 0.05078330</span></span>
<span id="cb42-65"><a href="#cb42-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Jun        Jul        Aug        Sep        Oct</span></span>
<span id="cb42-66"><a href="#cb42-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021                       0.04846132 0.04852048 0.04871765</span></span>
<span id="cb42-67"><a href="#cb42-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2022 0.04957786 0.04961940 0.04973912 0.04979084 0.04997169</span></span>
<span id="cb42-68"><a href="#cb42-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2023 0.05078908 0.05082888                                 </span></span>
<span id="cb42-69"><a href="#cb42-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             Nov        Dec</span></span>
<span id="cb42-70"><a href="#cb42-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021 0.04894129 0.04894801</span></span>
<span id="cb42-71"><a href="#cb42-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2022 0.05018523 0.05019131</span></span>
<span id="cb42-72"><a href="#cb42-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2023</span></span>
<span id="cb42-73"><a href="#cb42-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-74"><a href="#cb42-74" aria-hidden="true" tabindex="-1"></a>DLPax_Nal_f <span class="ot">&lt;-</span> <span class="fu">predict</span>(ARMA_Ex_DLPax_Nal_2, <span class="at">n.ahead =</span> <span class="dv">24</span>, </span>
<span id="cb42-75"><a href="#cb42-75" aria-hidden="true" tabindex="-1"></a>                      <span class="at">newxreg =</span> <span class="fu">cbind</span>(D_Ene_fP, D_Feb_fP, D_Jul_fP, D_Dic_fP, </span>
<span id="cb42-76"><a href="#cb42-76" aria-hidden="true" tabindex="-1"></a>                                      D_Mar2020_fP, D_Abr2020_fP, D_Jun2020_fP, D_Jul2020_fP, D_Mar2021_fP))</span>
<span id="cb42-77"><a href="#cb42-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-78"><a href="#cb42-78" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(DLPax_Nal_f)</span>
<span id="cb42-79"><a href="#cb42-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] &quot;pred&quot; &quot;se&quot;</span></span>
<span id="cb42-80"><a href="#cb42-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-81"><a href="#cb42-81" aria-hidden="true" tabindex="-1"></a><span class="co"># Prediccion de la serie original:</span></span>
<span id="cb42-82"><a href="#cb42-82" aria-hidden="true" tabindex="-1"></a>Pronostico_Arima <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;BD/Clase_10/Pronostico_Arima.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;Datos&quot;</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-83"><a href="#cb42-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-84"><a href="#cb42-84" aria-hidden="true" tabindex="-1"></a>Pronostico_Arima<span class="sc">$</span>Pax_Nal_f <span class="ot">&lt;-</span> Pronostico_Arima<span class="sc">$</span>Pax_Nal</span>
<span id="cb42-85"><a href="#cb42-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-86"><a href="#cb42-86" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">24</span>){</span>
<span id="cb42-87"><a href="#cb42-87" aria-hidden="true" tabindex="-1"></a>  Pronostico_Arima<span class="sc">$</span>Pax_Nal_f[<span class="dv">259</span> <span class="sc">+</span> i] <span class="ot">&lt;-</span> </span>
<span id="cb42-88"><a href="#cb42-88" aria-hidden="true" tabindex="-1"></a>    Pronostico_Arima<span class="sc">$</span>Pax_Nal_f[<span class="dv">259</span> <span class="sc">+</span> i <span class="sc">-</span> <span class="dv">1</span>]<span class="sc">*</span>(<span class="dv">1</span> <span class="sc">+</span> DLPax_Nal_f<span class="sc">$</span>pred[i])</span>
<span id="cb42-89"><a href="#cb42-89" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-90"><a href="#cb42-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-91"><a href="#cb42-91" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(Pronostico_Arima)</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> Pronostico_Arima, <span class="fu">aes</span>(<span class="at">x =</span> Periodo)) <span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Pax_Nal_f, <span class="at">color =</span> <span class="st">&quot;Pax_Nal_f&quot;</span>)) <span class="sc">+</span></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Pax_Nal, <span class="at">color =</span> <span class="st">&quot;Pax_Nal&quot;</span>)) <span class="sc">+</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">type =</span> <span class="st">&quot;qual&quot;</span>, <span class="at">palette =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.title =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">col =</span> <span class="fu">guide_legend</span>(<span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)) <span class="sc">+</span> </span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;Tiempo&quot;</span>) <span class="sc">+</span> </span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;Pasajeros&quot;</span>) <span class="sc">+</span> </span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">11</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb43-13"><a href="#cb43-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span> </span>
<span id="cb43-14"><a href="#cb43-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.caption =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">10</span>, <span class="at">hjust =</span> <span class="dv">0</span>)) <span class="sc">+</span></span>
<span id="cb43-15"><a href="#cb43-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>), <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb43-16"><a href="#cb43-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb43-17"><a href="#cb43-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">&quot;Pasajeros en vuelos nacionales (Salidas)&quot;</span>,</span>
<span id="cb43-18"><a href="#cb43-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">subtitle =</span> <span class="st">&quot;(Ene-2000 a Jun-2019)&quot;</span>,</span>
<span id="cb43-19"><a href="#cb43-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">caption =</span> <span class="st">&quot;Fuente: Elaboración propia&quot;</span></span>
<span id="cb43-20"><a href="#cb43-20" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb43-21"><a href="#cb43-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Warning: Removed 24 row(s) containing missing values</span></span>
<span id="cb43-22"><a href="#cb43-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; (geom_path).</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="03-PE_Univariados_files/figure-html/PaxNalf-1.png" alt="Pronóstico de la serie $PaxNAl_t$ a partir de una ARMA(4,6) en diferencias logaritmicas." width="100%" />
<p class="caption">
(#fig:PaxNalf)Pronóstico de la serie <span class="math inline">\(PaxNAl_t\)</span> a partir de una ARMA(4,6) en diferencias logaritmicas.
</p>
</div>
<!--chapter:end:03-PE_Univariados.Rmd-->
</div>
</div>
<div id="desestacionalización-y-filtrado-de-series" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Desestacionalización y filtrado de Series</h1>
<div id="motivación" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> Motivación</h2>
<p>Existen múltiples enfoques para la desestacionalización de series. Algunos modelos, por ejemplo, pueden estar basados en modelos ARIMA como un conjunto de dummies. No obstante, en el caso partícular que discutiremos en este curso, estará basado en un modelo ARIMA de la serie. Este enfoque está basado en el modelo X11 de la oficina del censo de Estados Unidos (Census Bureau) el cual es conocido como el modelo X13-ARIMA-SEATS.<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a> El modelo X13-ARIMA-SEATS es, como su nombre lo indica, la combinación de un modelo ARIMA con componentes estacionales (por la traducción literal de la palabra: seasonal).</p>
<p>Un modelo ARIMA estacional emplea la serie en diferencias y como regresores los valores rezagados de las diferencia de la serie tantas veces como procesos estacionales <span class="math inline">\(s\)</span> existan en ésta, con el objeto de remover los efectos aditivos de la estacionalidad. Sólo para entender qué significa este mecanismo, recordemos que cuando se utiliza la primera direncia de la serie respecto del periodo inmediato anterior se remueve la tendencia. Por su parte, cuando se incluye la diferencia respecto del mes <span class="math inline">\(s\)</span> se está en el caso en que se modela la serie como una media móvil en términos del rezago <span class="math inline">\(s\)</span>.</p>
<p>El modelo ARIMA estacional incluye como componentes autoregresivos y de medias móviles a los valores rezagados de la serie en el periodo <span class="math inline">\(s\)</span> en diferencias. El ARIMA(p, d, q)(P, D, Q) estacional puede ser expresado de la siguiente manera utilizando el operador rezago <span class="math inline">\(L\)</span>:
<span class="math display">\[\begin{equation}
    \Theta_P(L^s) \theta_p(L) (1 - L^s)^D (1 - L)^d X_t = \Psi_Q(L^s) \psi_q(L) U_t
    (\#eq:ARIMAseas)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\Theta_P(.)\)</span>, <span class="math inline">\(\theta_p(.)\)</span>, <span class="math inline">\(\Psi_Q(.)\)</span> y <span class="math inline">\(\psi_q(.)\)</span> son polinomios de <span class="math inline">\(L\)</span> de orden <span class="math inline">\(P\)</span>, <span class="math inline">\(p\)</span>, <span class="math inline">\(Q\)</span> y <span class="math inline">\(q\)</span> respectivamente. En general, la representación es de una serie no estacionaria, aunque si <span class="math inline">\(D = d = 0\)</span> y las raíces del polinomio carácteristico (de los polinomios del lado izquierdo de la ecuación @ref(eq:ARIMAseas) todas son más grandes que 1 en valor absoluto, el proceso modelado será estacionario.</p>
<p>Si bien es cierto que existen otras formas de modelar la desestacionalización, como la modelación en diferencias con dummies para identificar ciertos patrones regulares, en los algorimtos disponibles como el X11 o X13-ARIMA-SEATS se emplea la formulación de la ecuación @ref(eq:ARIMAseas). A continuación implementaremos la desestacionalización de una serie.</p>
<p>Como ejemplo utilizaremos la serie del Índice Nacional de Precios al Consumidor (INPC) en el periodo de enero de 2000 a julio de 2019. Utilizando el Scrip Clase 11, diponible en el repositorio de GitHub, podemos ver que la serie original del INPC y su ajuste estacional bajo una metodología X13-ARIMA-SEATS son como se muestra en la Figura @ref(fig:INPCAdj).</p>
<p>El mismo procesamiento puede ser seguido para todas las series que busquemos analizar. En particular, en adelante, además del INPC que incluimos en la lista, utilzaremos las siguientes series, así como su versión desestacionalizada:
- Índice Nacional de Precios al Consumidor (base 2QJul2018 = 100), <span class="math inline">\(INPC_t\)</span>.
- Tipo de Cambio FIX, <span class="math inline">\(TC_t\)</span>
- Tasa de rendimiento promedio mensual de los Cetes 28, en por ciento anual, <span class="math inline">\(CETE28_t\)</span>
- Indicador global de la actividad económica (base 2013 = 100), <span class="math inline">\(IGAE_t\)</span>
- Industrial Production Index o Índice de Producción Industrial de los Estados Unidos (base 2012 = 100), <span class="math inline">\(IPI_t\)</span></p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;ggplot2&quot;)</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;dplyr&quot;)</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;readxl&quot;)</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(stats)</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;seasonal&quot;)</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;seasonalview&quot;)</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;shiny&quot;)</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;TClass&quot;)</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;remotes&quot;)</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;dplyr&#39;</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:stats&#39;:</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     filter, lag</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following objects are masked from &#39;package:base&#39;:</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seasonal)</span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(seasonalview)</span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Attaching package: &#39;seasonalview&#39;</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; The following object is masked from &#39;package:seasonal&#39;:</span></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;     view</span></span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(shiny)</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Importamos Datos:</span></span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a><span class="co">#Los datos importados son:</span></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a><span class="co"># INPC: Indice Nacional de Precios al Consumidor (2QJul2018 = 100)</span></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="co"># TC: Tipo de Cambio FIX </span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="co"># CETE28: Tasa de rendimiento promedio mensual de los Cetes 28, en por ciento anual*# IGAE: Indicador global de la actividad económica (2013 = 100)</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a><span class="co"># IPI: Industrial Production Index (2012 = 100)</span></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a>Datos_deses <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;BD/Clase_11/Base_VAR.xlsx&quot;</span>, <span class="at">sheet =</span> <span class="st">&quot;Datos&quot;</span>, <span class="at">col_names =</span> <span class="cn">TRUE</span>)</span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a><span class="co"># Primer ejemplo:</span></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a>INPC <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos_deses<span class="sc">$</span>INPC, </span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a>           <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a>           <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="co"># Desestacionalizacion (forma complicada):</span></span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a>Seas_INPC <span class="ot">&lt;-</span> <span class="fu">seas</span>(INPC)</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(Seas_INPC)</span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;series&quot;      &quot;udg&quot;         &quot;data&quot;        &quot;err&quot;        </span></span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [5] &quot;est&quot;         &quot;model&quot;       &quot;fivebestmdl&quot; &quot;wdir&quot;       </span></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [9] &quot;iofile&quot;      &quot;call&quot;        &quot;list&quot;        &quot;x&quot;          </span></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [13] &quot;spc&quot;</span></span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(Seas_INPC)</span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; seas(x = INPC)</span></span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Coefficients:</span></span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AO2002.Jan         0.004619   0.001079   4.280 1.87e-05 ***</span></span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; LS2017.Jan         0.011927   0.001804   6.611 3.81e-11 ***</span></span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AO2020.Apr        -0.006200   0.001083  -5.723 1.05e-08 ***</span></span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MA-Nonseasonal-01 -0.462302   0.054407  -8.497  &lt; 2e-16 ***</span></span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; MA-Seasonal-12     0.784240   0.040881  19.183  &lt; 2e-16 ***</span></span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SEATS adj.  ARIMA: (0 1 1)(0 1 1)  Obs.: 259  Transform: log</span></span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AICc: -180.5, BIC: -159.8  QS (no seasonality in final):    0  </span></span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Box-Ljung (no autocorr.): 23.65   Shapiro (normality): 0.9831 **</span></span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a><span class="fu">final</span>(Seas_INPC)</span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Jan       Feb       Mar       Apr       May</span></span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2000  44.77029  45.18403  45.40234  45.70368  46.08070</span></span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2001  48.39654  48.38881  48.65881  48.95142  49.29006</span></span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2002  50.71225  50.70179  50.92105  51.25509  51.60943</span></span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2003  53.31609  53.48246  53.77800  53.94089  54.05056</span></span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2004  55.54334  55.88971  56.03962  56.21125  56.38531</span></span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2005  58.05282  58.26189  58.48581  58.79626  58.99578</span></span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2006  60.31635  60.42680  60.46618  60.67856  60.78415</span></span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2007  62.70196  62.89541  62.99002  63.10118  63.19887</span></span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2008  65.01709  65.22681  65.64787  65.96965  66.33437</span></span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2009  69.08646  69.25034  69.58933  70.03565  70.30536</span></span>
<span id="cb44-90"><a href="#cb44-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2010  72.15127  72.56587  73.02022  73.02491  73.06952</span></span>
<span id="cb44-91"><a href="#cb44-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011  74.86517  75.13956  75.23038  75.48953  75.45523</span></span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012  77.88882  78.03832  78.03412  78.08142  78.36672</span></span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013  80.43511  80.81548  81.35072  81.71941  81.99156</span></span>
<span id="cb44-94"><a href="#cb44-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2014  84.04428  84.23918  84.41483  84.59701  84.87807</span></span>
<span id="cb44-95"><a href="#cb44-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2015  86.63243  86.77474  87.07291  87.20811  87.32823</span></span>
<span id="cb44-96"><a href="#cb44-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2016  88.90614  89.26620  89.34757  89.44196  89.59871</span></span>
<span id="cb44-97"><a href="#cb44-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2017  93.11384  93.62242  94.14690  94.66363  95.12087</span></span>
<span id="cb44-98"><a href="#cb44-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2018  98.28379  98.63525  98.90946  98.99765  99.41535</span></span>
<span id="cb44-99"><a href="#cb44-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2019 102.58552 102.53864 102.88957 103.37936 103.66756</span></span>
<span id="cb44-100"><a href="#cb44-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2020 105.92752 106.33873 106.24531 105.61243 106.60476</span></span>
<span id="cb44-101"><a href="#cb44-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021 109.70405 110.36088 111.21655 112.03885 112.87386</span></span>
<span id="cb44-102"><a href="#cb44-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Jun       Jul       Aug       Sep       Oct</span></span>
<span id="cb44-103"><a href="#cb44-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2000  46.42157  46.69961  46.94796  47.16362  47.45045</span></span>
<span id="cb44-104"><a href="#cb44-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2001  49.48158  49.45252  49.73396  50.05702  50.24097</span></span>
<span id="cb44-105"><a href="#cb44-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2002  51.94236  52.18259  52.36916  52.53823  52.72274</span></span>
<span id="cb44-106"><a href="#cb44-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2003  54.18788  54.34573  54.49561  54.66727  54.81421</span></span>
<span id="cb44-107"><a href="#cb44-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2004  56.57944  56.79298  57.12822  57.43813  57.77350</span></span>
<span id="cb44-108"><a href="#cb44-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2005  59.05133  59.33307  59.38990  59.46232  59.54214</span></span>
<span id="cb44-109"><a href="#cb44-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2006  60.95215  61.15781  61.45478  61.90260  62.09959</span></span>
<span id="cb44-110"><a href="#cb44-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2007  63.39157  63.68921  63.93606  64.26552  64.43308</span></span>
<span id="cb44-111"><a href="#cb44-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2008  66.72845  67.12236  67.50312  67.80588  68.17087</span></span>
<span id="cb44-112"><a href="#cb44-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2009  70.56076  70.77126  70.94118  71.15129  71.25491</span></span>
<span id="cb44-113"><a href="#cb44-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2010  73.17567  73.34645  73.55578  73.80811  74.13190</span></span>
<span id="cb44-114"><a href="#cb44-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011  75.57749  75.94343  76.07298  76.14170  76.50837</span></span>
<span id="cb44-115"><a href="#cb44-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012  78.84734  79.29152  79.53788  79.77728  80.02172</span></span>
<span id="cb44-116"><a href="#cb44-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013  82.06220  82.04215  82.28146  82.48604  82.70823</span></span>
<span id="cb44-117"><a href="#cb44-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2014  85.13828  85.37364  85.68228  85.95862  86.24939</span></span>
<span id="cb44-118"><a href="#cb44-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2015  87.57860  87.69859  87.88463  88.11900  88.37916</span></span>
<span id="cb44-119"><a href="#cb44-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2016  89.79442  90.00801  90.26224  90.73091  91.08230</span></span>
<span id="cb44-120"><a href="#cb44-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2017  95.45046  95.77245  96.24606  96.48198  96.88011</span></span>
<span id="cb44-121"><a href="#cb44-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2018  99.87640 100.34917 100.93781 101.31323 101.62119</span></span>
<span id="cb44-122"><a href="#cb44-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2019 103.79846 104.10668 104.10498 104.34324 104.68334</span></span>
<span id="cb44-123"><a href="#cb44-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2020 107.23615 107.84074 108.28547 108.51181 108.94882</span></span>
<span id="cb44-124"><a href="#cb44-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021 113.51893 114.07876                              </span></span>
<span id="cb44-125"><a href="#cb44-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Nov       Dec</span></span>
<span id="cb44-126"><a href="#cb44-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2000  47.71179  48.17650</span></span>
<span id="cb44-127"><a href="#cb44-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2001  50.27430  50.29634</span></span>
<span id="cb44-128"><a href="#cb44-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2002  52.97261  53.15249</span></span>
<span id="cb44-129"><a href="#cb44-129" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2003  55.07420  55.25544</span></span>
<span id="cb44-130"><a href="#cb44-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2004  58.05206  58.10890</span></span>
<span id="cb44-131"><a href="#cb44-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2005  59.74558  60.03535</span></span>
<span id="cb44-132"><a href="#cb44-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2006  62.18779  62.46086</span></span>
<span id="cb44-133"><a href="#cb44-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2007  64.63223  64.80593</span></span>
<span id="cb44-134"><a href="#cb44-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2008  68.66243  69.03189</span></span>
<span id="cb44-135"><a href="#cb44-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2009  71.32529  71.50399</span></span>
<span id="cb44-136"><a href="#cb44-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2010  74.40086  74.64066</span></span>
<span id="cb44-137"><a href="#cb44-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011  76.99023  77.48331</span></span>
<span id="cb44-138"><a href="#cb44-138" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012  80.20706  80.25132</span></span>
<span id="cb44-139"><a href="#cb44-139" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013  83.10867  83.43538</span></span>
<span id="cb44-140"><a href="#cb44-140" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2014  86.56489  86.83237</span></span>
<span id="cb44-141"><a href="#cb44-141" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2015  88.48548  88.68687</span></span>
<span id="cb44-142"><a href="#cb44-142" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2016  91.41636  91.67473</span></span>
<span id="cb44-143"><a href="#cb44-143" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2017  97.48690  97.88655</span></span>
<span id="cb44-144"><a href="#cb44-144" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2018 102.09704 102.62583</span></span>
<span id="cb44-145"><a href="#cb44-145" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2019 105.16079 105.56388</span></span>
<span id="cb44-146"><a href="#cb44-146" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2020 108.69159 108.93224</span></span>
<span id="cb44-147"><a href="#cb44-147" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021</span></span>
<span id="cb44-148"><a href="#cb44-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-149"><a href="#cb44-149" aria-hidden="true" tabindex="-1"></a>INPC_Ad <span class="ot">&lt;-</span> <span class="fu">final</span>(Seas_INPC)</span>
<span id="cb44-150"><a href="#cb44-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-151"><a href="#cb44-151" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb44-152"><a href="#cb44-152" aria-hidden="true" tabindex="-1"></a><span class="fu">original</span>(Seas_INPC)</span>
<span id="cb44-153"><a href="#cb44-153" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Jan       Feb       Mar       Apr       May</span></span>
<span id="cb44-154"><a href="#cb44-154" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2000  44.93083  45.32938  45.58068  45.84002  46.01138</span></span>
<span id="cb44-155"><a href="#cb44-155" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2001  48.57548  48.54333  48.85089  49.09731  49.20997</span></span>
<span id="cb44-156"><a href="#cb44-156" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2002  50.90047  50.86775  51.12795  51.40724  51.51143</span></span>
<span id="cb44-157"><a href="#cb44-157" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2003  53.52544  53.67412  54.01293  54.10514  53.93056</span></span>
<span id="cb44-158"><a href="#cb44-158" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2004  55.77432  56.10795  56.29807  56.38303  56.24160</span></span>
<span id="cb44-159"><a href="#cb44-159" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2005  58.30916  58.50343  58.76712  58.97642  58.82825</span></span>
<span id="cb44-160"><a href="#cb44-160" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2006  60.60363  60.69636  60.77251  60.86162  60.59067</span></span>
<span id="cb44-161"><a href="#cb44-161" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2007  63.01621  63.19235  63.32911  63.29129  62.98253</span></span>
<span id="cb44-162"><a href="#cb44-162" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2008  65.35056  65.54483  66.01989  66.17013  66.09864</span></span>
<span id="cb44-163"><a href="#cb44-163" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2009  69.45615  69.60949  70.00995  70.25499  70.05036</span></span>
<span id="cb44-164"><a href="#cb44-164" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2010  72.55205  72.97167  73.48973  73.25557  72.79398</span></span>
<span id="cb44-165"><a href="#cb44-165" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011  75.29599  75.57846  75.72345  75.71744  75.15926</span></span>
<span id="cb44-166"><a href="#cb44-166" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012  78.34305  78.50231  78.54739  78.30098  78.05382</span></span>
<span id="cb44-167"><a href="#cb44-167" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013  80.89278  81.29094  81.88743  81.94152  81.66882</span></span>
<span id="cb44-168"><a href="#cb44-168" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2014  84.51905  84.73316  84.96529  84.80678  84.53558</span></span>
<span id="cb44-169"><a href="#cb44-169" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2015  87.11010  87.27538  87.63072  87.40384  86.96737</span></span>
<span id="cb44-170"><a href="#cb44-170" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2016  89.38638  89.77778  89.91000  89.62528  89.22562</span></span>
<span id="cb44-171"><a href="#cb44-171" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2017  93.60388  94.14478  94.72249  94.83893  94.72549</span></span>
<span id="cb44-172"><a href="#cb44-172" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2018  98.79500  99.17137  99.49216  99.15485  98.99408</span></span>
<span id="cb44-173"><a href="#cb44-173" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2019 103.10800 103.07900 103.47600 103.53100 103.23300</span></span>
<span id="cb44-174"><a href="#cb44-174" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2020 106.44700 106.88900 106.83800 105.75500 106.16200</span></span>
<span id="cb44-175"><a href="#cb44-175" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021 110.21000 110.90700 111.82400 112.19000 112.41900</span></span>
<span id="cb44-176"><a href="#cb44-176" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Jun       Jul       Aug       Sep       Oct</span></span>
<span id="cb44-177"><a href="#cb44-177" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2000  46.28392  46.46447  46.71979  47.06107  47.38514</span></span>
<span id="cb44-178"><a href="#cb44-178" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2001  49.32636  49.19820  49.48969  49.95038  50.17614</span></span>
<span id="cb44-179"><a href="#cb44-179" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2002  51.76259  51.91118  52.10856  52.42198  52.65304</span></span>
<span id="cb44-180"><a href="#cb44-180" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2003  53.97511  54.05334  54.21549  54.53824  54.73821</span></span>
<span id="cb44-181"><a href="#cb44-181" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2004  56.33174  56.47939  56.82804  57.29792  57.69475</span></span>
<span id="cb44-182"><a href="#cb44-182" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2005  58.77178  59.00180  59.07225  59.30901  59.45458</span></span>
<span id="cb44-183"><a href="#cb44-183" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2006  60.64300  60.80929  61.11961  61.73661  62.00652</span></span>
<span id="cb44-184"><a href="#cb44-184" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2007  63.05817  63.32601  63.58400  64.07770  64.32740</span></span>
<span id="cb44-185"><a href="#cb44-185" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2008  66.37217  66.74206  67.12749  67.58494  68.04549</span></span>
<span id="cb44-186"><a href="#cb44-186" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2009  70.17935  70.37052  70.53888  70.89272  71.10719</span></span>
<span id="cb44-187"><a href="#cb44-187" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2010  72.77118  72.92919  73.13175  73.51511  73.96893</span></span>
<span id="cb44-188"><a href="#cb44-188" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011  75.15551  75.51611  75.63555  75.82111  76.33271</span></span>
<span id="cb44-189"><a href="#cb44-189" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012  78.41367  78.85390  79.09054  79.43912  79.84104</span></span>
<span id="cb44-190"><a href="#cb44-190" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013  81.61924  81.59219  81.82433  82.13234  82.52299</span></span>
<span id="cb44-191"><a href="#cb44-191" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2014  84.68207  84.91496  85.21997  85.59634  86.06963</span></span>
<span id="cb44-192"><a href="#cb44-192" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2015  87.11311  87.24082  87.42488  87.75242  88.20392</span></span>
<span id="cb44-193"><a href="#cb44-193" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2016  89.32403  89.55691  89.80933  90.35774  90.90615</span></span>
<span id="cb44-194"><a href="#cb44-194" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2017  94.96364  95.32274  95.79377  96.09351  96.69827</span></span>
<span id="cb44-195"><a href="#cb44-195" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2018  99.37646  99.90910 100.49200 100.91700 101.44000</span></span>
<span id="cb44-196"><a href="#cb44-196" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2019 103.29900 103.68700 103.67000 103.94200 104.50300</span></span>
<span id="cb44-197"><a href="#cb44-197" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2020 106.74300 107.44400 107.86700 108.11400 108.77400</span></span>
<span id="cb44-198"><a href="#cb44-198" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021 113.01800 113.68200                              </span></span>
<span id="cb44-199"><a href="#cb44-199" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Nov       Dec</span></span>
<span id="cb44-200"><a href="#cb44-200" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2000  47.79029  48.30767</span></span>
<span id="cb44-201"><a href="#cb44-201" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2001  50.36515  50.43490</span></span>
<span id="cb44-202"><a href="#cb44-202" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2002  53.07888  53.30993</span></span>
<span id="cb44-203"><a href="#cb44-203" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2003  55.19254  55.42981</span></span>
<span id="cb44-204"><a href="#cb44-204" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2004  58.18690  58.30709</span></span>
<span id="cb44-205"><a href="#cb44-205" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2005  59.88249  60.25031</span></span>
<span id="cb44-206"><a href="#cb44-206" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2006  62.33186  62.69242</span></span>
<span id="cb44-207"><a href="#cb44-207" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2007  64.78122  65.04906</span></span>
<span id="cb44-208"><a href="#cb44-208" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2008  68.81894  69.29555</span></span>
<span id="cb44-209"><a href="#cb44-209" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2009  71.47605  71.77186</span></span>
<span id="cb44-210"><a href="#cb44-210" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2010  74.56158  74.93095</span></span>
<span id="cb44-211"><a href="#cb44-211" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011  77.15833  77.79238</span></span>
<span id="cb44-212"><a href="#cb44-212" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012  80.38344  80.56824</span></span>
<span id="cb44-213"><a href="#cb44-213" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013  83.29227  83.77006</span></span>
<span id="cb44-214"><a href="#cb44-214" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2014  86.76378  87.18898</span></span>
<span id="cb44-215"><a href="#cb44-215" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2015  88.68547  89.04682</span></span>
<span id="cb44-216"><a href="#cb44-216" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2016  91.61683  92.03903</span></span>
<span id="cb44-217"><a href="#cb44-217" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2017  97.69517  98.27288</span></span>
<span id="cb44-218"><a href="#cb44-218" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2018 102.30300 103.02000</span></span>
<span id="cb44-219"><a href="#cb44-219" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2019 105.34600 105.93400</span></span>
<span id="cb44-220"><a href="#cb44-220" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2020 108.85600 109.27100</span></span>
<span id="cb44-221"><a href="#cb44-221" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021</span></span>
<span id="cb44-222"><a href="#cb44-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-223"><a href="#cb44-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-224"><a href="#cb44-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-225"><a href="#cb44-225" aria-hidden="true" tabindex="-1"></a><span class="co"># Forma Facil:</span></span>
<span id="cb44-226"><a href="#cb44-226" aria-hidden="true" tabindex="-1"></a><span class="co">#runApp(view(Seas_INPC))</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="04-Desestacionalizacion_Filtros_files/figure-html/INPCAdj-1.png" alt="Índice Nacional de Precios al Consumidor ($INPC_t$) y su serie desestacionalizada utilizando un proceso X13-ARIMA-SEATS." width="100%" />
<p class="caption">
(#fig:INPCAdj)Índice Nacional de Precios al Consumidor (<span class="math inline">\(INPC_t\)</span>) y su serie desestacionalizada utilizando un proceso X13-ARIMA-SEATS.
</p>
</div>
</div>
<div id="filtro-hodrick-prescott" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> Filtro Hodrick-Prescott</h2>
<p>Como último tema de los procesos univariados y que no necesariamente aplican a series estacionarias, a continuación desarrollaremos el procedimiento conocido como filtro de Hodrick y Prescott (1997). El trabajo de estos autores era determinar una técnica de regresión que permitiera utilizar series agregadas o macroeconómicas para separarlas en dos componentes: uno de ciclo de negocios y otro de tendencia. En su trabajo orignal Hodrick y Prescott (1997) utilizaron datos trimestrales de alguna series como el Gross Domestic Product (GNP, por sus siglas enn Inglés), los agregados montearios M1, empleo, etc., de los Estados Unidos que fueron observados posteriormente a la Segunda Guerra Mundial.</p>
<p>El marco conceptual de Hodrick y Prescott (1997) parte de suponer una serie <span class="math inline">\(X_t\)</span> que se puede descomponer en la suma de componente de crecimiento tendencial, <span class="math inline">\(g_t\)</span>, y su componente de ciclio de negocios, <span class="math inline">\(c_t\)</span>, de esta forma para <span class="math inline">\(t = 1, 2, \ldots, T\)</span> tenemos que:
<span class="math display">\[\begin{equation}
    X_t = g_t + c_t
    (\#eq:HPEq)
\end{equation}\]</span></p>
<p>En la ecuación @ref(eq:HPEq) se asume que el ajuste de la ruta seguida por <span class="math inline">\(g_t\)</span> es resultado de la suma de los cuadrados de su segunda diferencia. En esa misma ecuación sumiremos que <span class="math inline">\(c_t\)</span> son las desviaciones de <span class="math inline">\(g_t\)</span>, las cuales en el largo plazo tienen una media igual a cero (0). Por esta razón, se suele decir que el filtro de Hodrick y Prescott represeta una una descomposición de la serie en su componente de crecimiento natural y de sus desviaciones transitorias que en promedio son cero, en el largo plazo.</p>
<p>Estas consideraciones que hemos mencionado señalan que el procesimiento de Hodrick y Prescott (1997) implican resolver el siguiente problema minimización para determinar cada uno de los componentes en que <span class="math inline">\(X_t\)</span> se puede descomponer:
<span class="math display">\[\begin{equation}
    \min_{\{ g_t \}^T_{t = -1} } \left[ \sum^T_{t = 1} c^2_t + \lambda \sum^T_{t = 1} [ \Delta g_t - \Delta g_{t-1}]^2 \right]
        (\#eq:HPEq1)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\Delta g_t = g_t - g_{t-1}\)</span> y <span class="math inline">\(\Delta g_{t-1} = g_{t-1} - g_{t-2}\)</span>; <span class="math inline">\(c_t = X_t - g_t\)</span>, y el parámetro <span class="math inline">\(\lambda\)</span> es un número positivo que penaliza la variabilidad en el crecimiento de las series. De acuerdo con el trabajo de Hodrick y Prescott (1997) la constante <span class="math inline">\(\lambda\)</span> debe tomar valores especificos de acuerdo con la periodicidad de la series. Así, <span class="math inline">\(\lambda\)</span> será:</p>
<ul>
<li>100 si la serie es de datos anuales</li>
<li>1,600 si la serie es de datos trimestrales</li>
<li>14,400 si la serie es de datos mensuales</li>
</ul>
<p>Método tradicional de HP consiste en minimizar la serie <span class="math inline">\(\{ \tau_t \}_{t=-1}^T\)</span>:</p>
<p><span class="math display">\[\sum_{t=1}^T (y_t - \tau_t)^2 + \lambda \sum_{t=1}^{T} [(\tau_{t} - \tau_{t-1}) - (\tau_{t-1} - \tau_{t-2})]^2\]</span></p>
<p>Donde <span class="math inline">\(\lambda\)</span> es una parámetro fijo (determinado ex-ante) y <span class="math inline">\(\tau_t\)</span> es un componente de tendencia de <span class="math inline">\(y_t\)</span>.</p>
<p>Sin pérdida de generalidad, asumiremos que <span class="math inline">\(\tau_{-1}\)</span> y <span class="math inline">\(\tau_{0}\)</span> son cero (0). De esta manera, la forma matricial del filtro HP es:
<span class="math display">\[(Y - G)&#39;(Y - G) + \lambda G&#39; K&#39; K G\]</span></p>
<p>La derivada de los anteriores:
<span class="math display">\[-2 Y + 2 G + \lambda 2 K&#39; K G = 0\]</span></p>
<p>Despejando:
<span class="math display">\[G_{hp} = [I_T + \lambda K&#39; K]^{-1} Y\]</span></p>
<p>Donde <span class="math inline">\(G\)</span> es el vector de tendencia, <span class="math inline">\(Y\)</span> es el vector de la serie de datos, <span class="math inline">\(\lambda\)</span> es la constante tradicional, y <span class="math inline">\(K\)</span> es de dimensión <span class="math inline">\(T \times T\)</span> y está dada por la expresión:</p>
<p><span class="math display">\[K =
\begin{pmatrix}
1 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 \\
-2 &amp; 1 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 \\
1 &amp; -2 &amp; 1 &amp; 0 &amp; \ldots &amp; 0 \\
0 &amp; 1 &amp; -2 &amp; 1 &amp; \ldots &amp; 0 \\
\vdots &amp; \vdots &amp;  \vdots &amp;  \vdots &amp;  \vdots &amp;  \vdots \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 1 \\
\end{pmatrix}
\]</span></p>
<p>Así:</p>
<p><span class="math display">\[K&#39; =
\begin{pmatrix}
1 &amp; -2 &amp; 1 &amp; 0 &amp; \ldots &amp; 0 \\
0 &amp; 1 &amp; -2 &amp; 1 &amp; \ldots &amp; 0 \\
0 &amp; 0 &amp; 1 &amp; -2 &amp; \ldots &amp; 0 \\
0 &amp; 0 &amp; 0 &amp; 1 &amp; \ldots &amp; 0 \\
\vdots &amp; \vdots &amp;  \vdots &amp;  \vdots &amp;  \vdots &amp;  \vdots \\
0 &amp; 0 &amp; 0 &amp; 0 &amp; \ldots &amp; 1 \\
\end{pmatrix}
\]</span></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;ggplot2&quot;)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;dplyr&quot;)</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;readxl&quot;)</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(stats)</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;mFilter&quot;)</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mFilter)</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Importamos Datos desde un archivo de R:</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="co">#Los datos &quot;cargados&quot; son los originales y los ajustados por estacionalidad. Los cuales son:</span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="co">#* INPC: Indice Nacional de Precios al Consumidor (2QJul2018 = 100)</span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="co">#* TC: Tipo de Cambio FIX </span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="co">#* CETE28: Tasa de rendimiento promedio mensual de los Cetes 28, en por ciento anual</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="co">#* IGAE: Indicador global de la actividad económica (2013 = 100)</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="co">#* IPI: Industrial Production Index (2012 = 100)</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;BD/Clase_11/Datos_Ad.RData&quot;</span>)</span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-29"><a href="#cb45-29" aria-hidden="true" tabindex="-1"></a>INPC_HP <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>INPC_Ad, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb45-30"><a href="#cb45-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-31"><a href="#cb45-31" aria-hidden="true" tabindex="-1"></a>TC <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>TC_Ad, <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb45-32"><a href="#cb45-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-33"><a href="#cb45-33" aria-hidden="true" tabindex="-1"></a><span class="do">## Filtro Hodrick-Prescott:</span></span>
<span id="cb45-34"><a href="#cb45-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-35"><a href="#cb45-35" aria-hidden="true" tabindex="-1"></a><span class="do">### INPC:</span></span>
<span id="cb45-36"><a href="#cb45-36" aria-hidden="true" tabindex="-1"></a><span class="co">#?hpfilter</span></span>
<span id="cb45-37"><a href="#cb45-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-38"><a href="#cb45-38" aria-hidden="true" tabindex="-1"></a>INPC_hpf <span class="ot">&lt;-</span> <span class="fu">hpfilter</span>(INPC, <span class="at">freq =</span> <span class="dv">14400</span>)</span>
<span id="cb45-39"><a href="#cb45-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-40"><a href="#cb45-40" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(INPC_hpf)</span>
<span id="cb45-41"><a href="#cb45-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [1] &quot;cycle&quot;   &quot;trend&quot;   &quot;fmatrix&quot; &quot;title&quot;   &quot;xname&quot;  </span></span>
<span id="cb45-42"><a href="#cb45-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;  [6] &quot;call&quot;    &quot;type&quot;    &quot;lambda&quot;  &quot;method&quot;  &quot;x&quot;</span></span>
<span id="cb45-43"><a href="#cb45-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-44"><a href="#cb45-44" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb45-45"><a href="#cb45-45" aria-hidden="true" tabindex="-1"></a>INPC_hpf<span class="sc">$</span>cycle</span>
<span id="cb45-46"><a href="#cb45-46" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Jan          Feb          Mar          Apr</span></span>
<span id="cb45-47"><a href="#cb45-47" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2000 -0.369995465 -0.204781721 -0.186791284 -0.160699237</span></span>
<span id="cb45-48"><a href="#cb45-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2001  0.491509101  0.231668069  0.312644248  0.333628596</span></span>
<span id="cb45-49"><a href="#cb45-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2002  0.158359973 -0.088834879 -0.042095361  0.024731472</span></span>
<span id="cb45-50"><a href="#cb45-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2003  0.274385097  0.220277762  0.357200149  0.248370572</span></span>
<span id="cb45-51"><a href="#cb45-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2004  0.133596492  0.271391596  0.266227824  0.156446397</span></span>
<span id="cb45-52"><a href="#cb45-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2005  0.353845486  0.358862377  0.433730438  0.454517921</span></span>
<span id="cb45-53"><a href="#cb45-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2006  0.371800378  0.270140468  0.150457395  0.042085487</span></span>
<span id="cb45-54"><a href="#cb45-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2007  0.318418692  0.272948983  0.185261500 -0.079965538</span></span>
<span id="cb45-55"><a href="#cb45-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2008 -0.210169454 -0.273903265 -0.059220058 -0.171510017</span></span>
<span id="cb45-56"><a href="#cb45-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2009  0.699236223  0.584232203  0.717372055  0.696292454</span></span>
<span id="cb45-57"><a href="#cb45-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2010  0.663445825  0.832260274  1.101207256  0.619570294</span></span>
<span id="cb45-58"><a href="#cb45-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011  0.480043782  0.523426357  0.429572575  0.184783802</span></span>
<span id="cb45-59"><a href="#cb45-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012  0.639598468  0.554912267  0.355701224 -0.135328774</span></span>
<span id="cb45-60"><a href="#cb45-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013  0.243888923  0.396636329  0.748177918  0.557842172</span></span>
<span id="cb45-61"><a href="#cb45-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2014  0.958465086  0.934013767  0.928454894  0.533042168</span></span>
<span id="cb45-62"><a href="#cb45-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2015  0.713644671  0.640638229  0.756187115  0.287584986</span></span>
<span id="cb45-63"><a href="#cb45-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2016 -0.066111238  0.041374008 -0.116181201 -0.696785201</span></span>
<span id="cb45-64"><a href="#cb45-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2017  0.333265420  0.519162662  0.738165583  0.492725577</span></span>
<span id="cb45-65"><a href="#cb45-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2018  1.123948014  1.131474928  1.084873169  0.381819264</span></span>
<span id="cb45-66"><a href="#cb45-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2019  1.131318081  0.756941561  0.810348698  0.523253973</span></span>
<span id="cb45-67"><a href="#cb45-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2020  0.371739118  0.469219371  0.072193469 -1.358587671</span></span>
<span id="cb45-68"><a href="#cb45-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021 -0.128049234  0.201907470  0.750955110  0.748376942</span></span>
<span id="cb45-69"><a href="#cb45-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               May          Jun          Jul          Aug</span></span>
<span id="cb45-70"><a href="#cb45-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2000 -0.222464694 -0.182867609 -0.235003486 -0.212012132</span></span>
<span id="cb45-71"><a href="#cb45-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2001  0.222016360  0.115293619 -0.234850969 -0.164243748</span></span>
<span id="cb45-72"><a href="#cb45-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2002 -0.082549510 -0.041897157 -0.102845584 -0.114055000</span></span>
<span id="cb45-73"><a href="#cb45-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2003 -0.126500461 -0.281581688 -0.402428066 -0.438864993</span></span>
<span id="cb45-74"><a href="#cb45-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2004 -0.179191953 -0.282751358 -0.328312508 -0.172365454</span></span>
<span id="cb45-75"><a href="#cb45-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2005  0.118015956 -0.126799889 -0.085327242 -0.203790926</span></span>
<span id="cb45-76"><a href="#cb45-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2006 -0.428178375 -0.577230234 -0.614540398 -0.510201089</span></span>
<span id="cb45-77"><a href="#cb45-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2007 -0.619214781 -0.777264325 -0.746387263 -0.728647713</span></span>
<span id="cb45-78"><a href="#cb45-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2008 -0.507458213 -0.500077808 -0.397766722 -0.281037148</span></span>
<span id="cb45-79"><a href="#cb45-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2009  0.226851260  0.092413978  0.021568361 -0.070602259</span></span>
<span id="cb45-80"><a href="#cb45-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2010 -0.088013559 -0.355518277 -0.441120723 -0.481232069</span></span>
<span id="cb45-81"><a href="#cb45-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011 -0.612311426 -0.855343408 -0.734553919 -0.855565336</span></span>
<span id="cb45-82"><a href="#cb45-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012 -0.627470545 -0.512978505 -0.318451500 -0.327794750</span></span>
<span id="cb45-83"><a href="#cb45-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013  0.041241618 -0.251742959 -0.521731636 -0.532100007</span></span>
<span id="cb45-84"><a href="#cb45-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2014  0.025603817 -0.063649951 -0.066189704  0.003542410</span></span>
<span id="cb45-85"><a href="#cb45-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2015 -0.393024017 -0.494322722 -0.617025665 -0.687194052</span></span>
<span id="cb45-86"><a href="#cb45-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2016 -1.398672260 -1.609015258 -1.691508944 -1.761073330</span></span>
<span id="cb45-87"><a href="#cb45-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2017  0.014700777 -0.113998904 -0.123567571 -0.022570414</span></span>
<span id="cb45-88"><a href="#cb45-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2018 -0.142947597 -0.122741741  0.049620433  0.274252050</span></span>
<span id="cb45-89"><a href="#cb45-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2019 -0.115684406 -0.389844570 -0.341596615 -0.698283565</span></span>
<span id="cb45-90"><a href="#cb45-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2020 -1.301378144 -1.072337698 -0.725535708 -0.658967082</span></span>
<span id="cb45-91"><a href="#cb45-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021  0.608404074  0.838215643  1.132948535             </span></span>
<span id="cb45-92"><a href="#cb45-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               Sep          Oct          Nov          Dec</span></span>
<span id="cb45-93"><a href="#cb45-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2000 -0.102590031 -0.009804947  0.164784483  0.452452299</span></span>
<span id="cb45-94"><a href="#cb45-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2001  0.076660243  0.083712374  0.055103689 -0.091703579</span></span>
<span id="cb45-95"><a href="#cb45-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2002 -0.008263469  0.016120866  0.236268433  0.262610542</span></span>
<span id="cb45-96"><a href="#cb45-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2003 -0.314265925 -0.312022839 -0.054984887 -0.014556554</span></span>
<span id="cb45-97"><a href="#cb45-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2004  0.105338549  0.310570219  0.611731956  0.541551594</span></span>
<span id="cb45-98"><a href="#cb45-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2005 -0.156504840 -0.201099726  0.035793536  0.211609037</span></span>
<span id="cb45-99"><a href="#cb45-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2006 -0.101638853 -0.042697807  0.069095994  0.213490457</span></span>
<span id="cb45-100"><a href="#cb45-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2007 -0.478454962 -0.475448693 -0.271395366 -0.256242421</span></span>
<span id="cb45-101"><a href="#cb45-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2008 -0.093089657  0.097524697  0.600960326  0.807816866</span></span>
<span id="cb45-102"><a href="#cb45-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2009  0.024201957 -0.018793254  0.094194169  0.135784587</span></span>
<span id="cb45-103"><a href="#cb45-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2010 -0.339736855 -0.127077202  0.225055362  0.354474134</span></span>
<span id="cb45-104"><a href="#cb45-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011 -0.911182025 -0.641478939 -0.058417752  0.332512408</span></span>
<span id="cb45-105"><a href="#cb45-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012 -0.225399361 -0.069754674  0.226409619  0.165143675</span></span>
<span id="cb45-106"><a href="#cb45-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013 -0.466133438 -0.317018340  0.211325244  0.448893287</span></span>
<span id="cb45-107"><a href="#cb45-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2014  0.144633839  0.382463784  0.840814404  1.029674297</span></span>
<span id="cb45-108"><a href="#cb45-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2015 -0.618073241 -0.429539870 -0.215801653 -0.127377476</span></span>
<span id="cb45-109"><a href="#cb45-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2016 -1.541111965 -1.327358097 -0.957173954 -0.880849589</span></span>
<span id="cb45-110"><a href="#cb45-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2017 -0.093771040  0.139581509  0.765096705  0.971883324</span></span>
<span id="cb45-111"><a href="#cb45-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2018  0.343076789  0.512068283  1.023275341  1.390711211</span></span>
<span id="cb45-112"><a href="#cb45-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2019 -0.766224721 -0.545690894 -0.043899684  0.201969206</span></span>
<span id="cb45-113"><a href="#cb45-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2020 -0.770576342 -0.471262251 -0.751870056 -0.701212281</span></span>
<span id="cb45-114"><a href="#cb45-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021</span></span>
<span id="cb45-115"><a href="#cb45-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-116"><a href="#cb45-116" aria-hidden="true" tabindex="-1"></a>INPC_hpf<span class="sc">$</span>trend</span>
<span id="cb45-117"><a href="#cb45-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Jan       Feb       Mar       Apr       May</span></span>
<span id="cb45-118"><a href="#cb45-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2000  45.30083  45.53416  45.76747  46.00072  46.23384</span></span>
<span id="cb45-119"><a href="#cb45-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2001  48.08397  48.31166  48.53824  48.76368  48.98795</span></span>
<span id="cb45-120"><a href="#cb45-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2002  50.74211  50.95658  51.17004  51.38250  51.59398</span></span>
<span id="cb45-121"><a href="#cb45-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2003  53.25106  53.45384  53.65573  53.85677  54.05706</span></span>
<span id="cb45-122"><a href="#cb45-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2004  55.64072  55.83655  56.03184  56.22659  56.42079</span></span>
<span id="cb45-123"><a href="#cb45-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2005  57.95531  58.14457  58.33339  58.52190  58.71024</span></span>
<span id="cb45-124"><a href="#cb45-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2006  60.23183  60.42622  60.62205  60.81953  61.01885</span></span>
<span id="cb45-125"><a href="#cb45-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2007  62.69779  62.91940  63.14385  63.37126  63.60175</span></span>
<span id="cb45-126"><a href="#cb45-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2008  65.56073  65.81874  66.07911  66.34164  66.60609</span></span>
<span id="cb45-127"><a href="#cb45-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2009  68.75691  69.02526  69.29258  69.55870  69.82351</span></span>
<span id="cb45-128"><a href="#cb45-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2010  71.88860  72.13941  72.38852  72.63599  72.88199</span></span>
<span id="cb45-129"><a href="#cb45-129" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011  74.81595  75.05503  75.29388  75.53266  75.77158</span></span>
<span id="cb45-130"><a href="#cb45-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012  77.70345  77.94740  78.19169  78.43631  78.68129</span></span>
<span id="cb45-131"><a href="#cb45-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013  80.64889  80.89431  81.13926  81.38368  81.62758</span></span>
<span id="cb45-132"><a href="#cb45-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2014  83.56059  83.79914  84.03684  84.27374  84.50998</span></span>
<span id="cb45-133"><a href="#cb45-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2015  86.39646  86.63474  86.87453  87.11626  87.36039</span></span>
<span id="cb45-134"><a href="#cb45-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2016  89.45249  89.73641  90.02618  90.32206  90.62429</span></span>
<span id="cb45-135"><a href="#cb45-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2017  93.27062  93.62562  93.98432  94.34621  94.71079</span></span>
<span id="cb45-136"><a href="#cb45-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2018  97.67105  98.03990  98.40728  98.77303  99.13703</span></span>
<span id="cb45-137"><a href="#cb45-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2019 101.97668 102.32206 102.66565 103.00775 103.34868</span></span>
<span id="cb45-138"><a href="#cb45-138" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2020 106.07526 106.41978 106.76581 107.11359 107.46338</span></span>
<span id="cb45-139"><a href="#cb45-139" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021 110.33805 110.70509 111.07304 111.44162 111.81060</span></span>
<span id="cb45-140"><a href="#cb45-140" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Jun       Jul       Aug       Sep       Oct</span></span>
<span id="cb45-141"><a href="#cb45-141" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2000  46.46679  46.69947  46.93180  47.16366  47.39494</span></span>
<span id="cb45-142"><a href="#cb45-142" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2001  49.21107  49.43305  49.65393  49.87372  50.09242</span></span>
<span id="cb45-143"><a href="#cb45-143" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2002  51.80448  52.01403  52.22262  52.43025  52.63692</span></span>
<span id="cb45-144"><a href="#cb45-144" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2003  54.25669  54.45577  54.65435  54.85250  55.05023</span></span>
<span id="cb45-145"><a href="#cb45-145" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2004  56.61450  56.80770  57.00041  57.19258  57.38418</span></span>
<span id="cb45-146"><a href="#cb45-146" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2005  58.89858  59.08713  59.27605  59.46551  59.65568</span></span>
<span id="cb45-147"><a href="#cb45-147" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2006  61.22023  61.42383  61.62981  61.83825  62.04922</span></span>
<span id="cb45-148"><a href="#cb45-148" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2007  63.83543  64.07239  64.31264  64.55616  64.80285</span></span>
<span id="cb45-149"><a href="#cb45-149" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2008  66.87225  67.13983  67.40853  67.67802  67.94796</span></span>
<span id="cb45-150"><a href="#cb45-150" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2009  70.08694  70.34895  70.60949  70.86851  71.12598</span></span>
<span id="cb45-151"><a href="#cb45-151" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2010  73.12670  73.37031  73.61298  73.85485  74.09600</span></span>
<span id="cb45-152"><a href="#cb45-152" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011  76.01085  76.25066  76.49112  76.73230  76.97419</span></span>
<span id="cb45-153"><a href="#cb45-153" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012  78.92665  79.17235  79.41833  79.66452  79.91079</span></span>
<span id="cb45-154"><a href="#cb45-154" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013  81.87098  82.11392  82.35643  82.59847  82.84001</span></span>
<span id="cb45-155"><a href="#cb45-155" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2014  84.74572  84.98115  85.21642  85.45171  85.68716</span></span>
<span id="cb45-156"><a href="#cb45-156" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2015  87.60743  87.85785  88.11207  88.37049  88.63346</span></span>
<span id="cb45-157"><a href="#cb45-157" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2016  90.93304  91.24842  91.57041  91.89886  92.23351</span></span>
<span id="cb45-158"><a href="#cb45-158" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2017  95.07764  95.44630  95.81634  96.18729  96.55869</span></span>
<span id="cb45-159"><a href="#cb45-159" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2018  99.49921  99.85948 100.21775 100.57392 100.92793</span></span>
<span id="cb45-160"><a href="#cb45-160" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2019 103.68884 104.02860 104.36828 104.70822 105.04869</span></span>
<span id="cb45-161"><a href="#cb45-161" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2020 107.81534 108.16954 108.52597 108.88458 109.24526</span></span>
<span id="cb45-162"><a href="#cb45-162" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021 112.17978 112.54905                              </span></span>
<span id="cb45-163"><a href="#cb45-163" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Nov       Dec</span></span>
<span id="cb45-164"><a href="#cb45-164" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2000  47.62550  47.85522</span></span>
<span id="cb45-165"><a href="#cb45-165" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2001  50.31005  50.52660</span></span>
<span id="cb45-166"><a href="#cb45-166" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2002  52.84261  53.04732</span></span>
<span id="cb45-167"><a href="#cb45-167" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2003  55.24753  55.44437</span></span>
<span id="cb45-168"><a href="#cb45-168" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2004  57.57517  57.76554</span></span>
<span id="cb45-169"><a href="#cb45-169" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2005  59.84670  60.03870</span></span>
<span id="cb45-170"><a href="#cb45-170" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2006  62.26276  62.47893</span></span>
<span id="cb45-171"><a href="#cb45-171" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2007  65.05262  65.30530</span></span>
<span id="cb45-172"><a href="#cb45-172" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2008  68.21798  68.48774</span></span>
<span id="cb45-173"><a href="#cb45-173" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2009  71.38185  71.63607</span></span>
<span id="cb45-174"><a href="#cb45-174" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2010  74.33653  74.57648</span></span>
<span id="cb45-175"><a href="#cb45-175" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011  77.21675  77.45987</span></span>
<span id="cb45-176"><a href="#cb45-176" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012  80.15703  80.40310</span></span>
<span id="cb45-177"><a href="#cb45-177" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013  83.08094  83.32116</span></span>
<span id="cb45-178"><a href="#cb45-178" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2014  85.92296  86.15931</span></span>
<span id="cb45-179"><a href="#cb45-179" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2015  88.90127  89.17420</span></span>
<span id="cb45-180"><a href="#cb45-180" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2016  92.57401  92.91988</span></span>
<span id="cb45-181"><a href="#cb45-181" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2017  96.93008  97.30100</span></span>
<span id="cb45-182"><a href="#cb45-182" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2018 101.27972 101.62929</span></span>
<span id="cb45-183"><a href="#cb45-183" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2019 105.38990 105.73203</span></span>
<span id="cb45-184"><a href="#cb45-184" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2020 109.60787 109.97221</span></span>
<span id="cb45-185"><a href="#cb45-185" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021</span></span>
<span id="cb45-186"><a href="#cb45-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-187"><a href="#cb45-187" aria-hidden="true" tabindex="-1"></a>INPC_hpf<span class="sc">$</span>lambda</span>
<span id="cb45-188"><a href="#cb45-188" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; [1] 14400</span></span>
<span id="cb45-189"><a href="#cb45-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-190"><a href="#cb45-190" aria-hidden="true" tabindex="-1"></a>INPC_hpf<span class="sc">$</span>x</span>
<span id="cb45-191"><a href="#cb45-191" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Jan       Feb       Mar       Apr       May</span></span>
<span id="cb45-192"><a href="#cb45-192" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2000  44.93083  45.32938  45.58068  45.84002  46.01138</span></span>
<span id="cb45-193"><a href="#cb45-193" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2001  48.57548  48.54333  48.85089  49.09731  49.20997</span></span>
<span id="cb45-194"><a href="#cb45-194" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2002  50.90047  50.86775  51.12795  51.40724  51.51143</span></span>
<span id="cb45-195"><a href="#cb45-195" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2003  53.52544  53.67412  54.01293  54.10514  53.93056</span></span>
<span id="cb45-196"><a href="#cb45-196" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2004  55.77432  56.10795  56.29807  56.38303  56.24160</span></span>
<span id="cb45-197"><a href="#cb45-197" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2005  58.30916  58.50343  58.76712  58.97642  58.82825</span></span>
<span id="cb45-198"><a href="#cb45-198" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2006  60.60363  60.69636  60.77251  60.86162  60.59067</span></span>
<span id="cb45-199"><a href="#cb45-199" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2007  63.01621  63.19235  63.32911  63.29129  62.98253</span></span>
<span id="cb45-200"><a href="#cb45-200" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2008  65.35056  65.54483  66.01989  66.17013  66.09864</span></span>
<span id="cb45-201"><a href="#cb45-201" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2009  69.45615  69.60949  70.00995  70.25499  70.05036</span></span>
<span id="cb45-202"><a href="#cb45-202" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2010  72.55205  72.97167  73.48973  73.25557  72.79398</span></span>
<span id="cb45-203"><a href="#cb45-203" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011  75.29599  75.57846  75.72345  75.71744  75.15926</span></span>
<span id="cb45-204"><a href="#cb45-204" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012  78.34305  78.50231  78.54739  78.30098  78.05382</span></span>
<span id="cb45-205"><a href="#cb45-205" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013  80.89278  81.29094  81.88743  81.94152  81.66882</span></span>
<span id="cb45-206"><a href="#cb45-206" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2014  84.51905  84.73316  84.96529  84.80678  84.53558</span></span>
<span id="cb45-207"><a href="#cb45-207" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2015  87.11010  87.27538  87.63072  87.40384  86.96737</span></span>
<span id="cb45-208"><a href="#cb45-208" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2016  89.38638  89.77778  89.91000  89.62528  89.22562</span></span>
<span id="cb45-209"><a href="#cb45-209" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2017  93.60388  94.14478  94.72249  94.83893  94.72549</span></span>
<span id="cb45-210"><a href="#cb45-210" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2018  98.79500  99.17137  99.49216  99.15485  98.99408</span></span>
<span id="cb45-211"><a href="#cb45-211" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2019 103.10800 103.07900 103.47600 103.53100 103.23300</span></span>
<span id="cb45-212"><a href="#cb45-212" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2020 106.44700 106.88900 106.83800 105.75500 106.16200</span></span>
<span id="cb45-213"><a href="#cb45-213" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021 110.21000 110.90700 111.82400 112.19000 112.41900</span></span>
<span id="cb45-214"><a href="#cb45-214" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Jun       Jul       Aug       Sep       Oct</span></span>
<span id="cb45-215"><a href="#cb45-215" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2000  46.28392  46.46447  46.71979  47.06107  47.38514</span></span>
<span id="cb45-216"><a href="#cb45-216" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2001  49.32636  49.19820  49.48969  49.95038  50.17614</span></span>
<span id="cb45-217"><a href="#cb45-217" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2002  51.76259  51.91118  52.10856  52.42198  52.65304</span></span>
<span id="cb45-218"><a href="#cb45-218" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2003  53.97511  54.05334  54.21549  54.53824  54.73821</span></span>
<span id="cb45-219"><a href="#cb45-219" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2004  56.33174  56.47939  56.82804  57.29792  57.69475</span></span>
<span id="cb45-220"><a href="#cb45-220" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2005  58.77178  59.00180  59.07225  59.30901  59.45458</span></span>
<span id="cb45-221"><a href="#cb45-221" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2006  60.64300  60.80929  61.11961  61.73661  62.00652</span></span>
<span id="cb45-222"><a href="#cb45-222" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2007  63.05817  63.32601  63.58400  64.07770  64.32740</span></span>
<span id="cb45-223"><a href="#cb45-223" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2008  66.37217  66.74206  67.12749  67.58494  68.04549</span></span>
<span id="cb45-224"><a href="#cb45-224" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2009  70.17935  70.37052  70.53888  70.89272  71.10719</span></span>
<span id="cb45-225"><a href="#cb45-225" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2010  72.77118  72.92919  73.13175  73.51511  73.96893</span></span>
<span id="cb45-226"><a href="#cb45-226" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011  75.15551  75.51611  75.63555  75.82111  76.33271</span></span>
<span id="cb45-227"><a href="#cb45-227" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012  78.41367  78.85390  79.09054  79.43912  79.84104</span></span>
<span id="cb45-228"><a href="#cb45-228" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013  81.61924  81.59219  81.82433  82.13234  82.52299</span></span>
<span id="cb45-229"><a href="#cb45-229" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2014  84.68207  84.91496  85.21997  85.59634  86.06963</span></span>
<span id="cb45-230"><a href="#cb45-230" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2015  87.11311  87.24082  87.42488  87.75242  88.20392</span></span>
<span id="cb45-231"><a href="#cb45-231" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2016  89.32403  89.55691  89.80933  90.35774  90.90615</span></span>
<span id="cb45-232"><a href="#cb45-232" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2017  94.96364  95.32274  95.79377  96.09351  96.69827</span></span>
<span id="cb45-233"><a href="#cb45-233" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2018  99.37646  99.90910 100.49200 100.91700 101.44000</span></span>
<span id="cb45-234"><a href="#cb45-234" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2019 103.29900 103.68700 103.67000 103.94200 104.50300</span></span>
<span id="cb45-235"><a href="#cb45-235" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2020 106.74300 107.44400 107.86700 108.11400 108.77400</span></span>
<span id="cb45-236"><a href="#cb45-236" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021 113.01800 113.68200                              </span></span>
<span id="cb45-237"><a href="#cb45-237" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;            Nov       Dec</span></span>
<span id="cb45-238"><a href="#cb45-238" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2000  47.79029  48.30767</span></span>
<span id="cb45-239"><a href="#cb45-239" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2001  50.36515  50.43490</span></span>
<span id="cb45-240"><a href="#cb45-240" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2002  53.07888  53.30993</span></span>
<span id="cb45-241"><a href="#cb45-241" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2003  55.19254  55.42981</span></span>
<span id="cb45-242"><a href="#cb45-242" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2004  58.18690  58.30709</span></span>
<span id="cb45-243"><a href="#cb45-243" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2005  59.88249  60.25031</span></span>
<span id="cb45-244"><a href="#cb45-244" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2006  62.33186  62.69242</span></span>
<span id="cb45-245"><a href="#cb45-245" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2007  64.78122  65.04906</span></span>
<span id="cb45-246"><a href="#cb45-246" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2008  68.81894  69.29555</span></span>
<span id="cb45-247"><a href="#cb45-247" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2009  71.47605  71.77186</span></span>
<span id="cb45-248"><a href="#cb45-248" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2010  74.56158  74.93095</span></span>
<span id="cb45-249"><a href="#cb45-249" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2011  77.15833  77.79238</span></span>
<span id="cb45-250"><a href="#cb45-250" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2012  80.38344  80.56824</span></span>
<span id="cb45-251"><a href="#cb45-251" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2013  83.29227  83.77006</span></span>
<span id="cb45-252"><a href="#cb45-252" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2014  86.76378  87.18898</span></span>
<span id="cb45-253"><a href="#cb45-253" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2015  88.68547  89.04682</span></span>
<span id="cb45-254"><a href="#cb45-254" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2016  91.61683  92.03903</span></span>
<span id="cb45-255"><a href="#cb45-255" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2017  97.69517  98.27288</span></span>
<span id="cb45-256"><a href="#cb45-256" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2018 102.30300 103.02000</span></span>
<span id="cb45-257"><a href="#cb45-257" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2019 105.34600 105.93400</span></span>
<span id="cb45-258"><a href="#cb45-258" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2020 108.85600 109.27100</span></span>
<span id="cb45-259"><a href="#cb45-259" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 2021</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="04-Desestacionalizacion_Filtros_files/figure-html/INPCHP-1.png" alt="Descomposición del Índice Nacional de Precios al Consumidor ($INPC_t$) en su tendencia o trayectoria de largo plazo y su ciclo de corto plazo utilizando un filtro Hodrick y Prescott (1997)." width="100%" />
<p class="caption">
(#fig:INPCHP)Descomposición del Índice Nacional de Precios al Consumidor (<span class="math inline">\(INPC_t\)</span>) en su tendencia o trayectoria de largo plazo y su ciclo de corto plazo utilizando un filtro Hodrick y Prescott (1997).
</p>
</div>
<p>En resumen, podemos decir que el filtro de Hodrick y Prescott (1997) es un algoritmo que mimiza las distancias o variaciones de la trayectoria de largo plazo. De esta forma, determina una trayectoria estable de largo plazo, por lo que las desviaciones respecto de esta trayectoria serán componentes de ciclos de negocio o cambios transitorios (tanto positivos como negativos).</p>
<p>A contiuación, ilustraremos el filtro de Hodrick y Prescott (1997) para dos series desestacionalizadas: <span class="math inline">\(INPC_t\)</span> y <span class="math inline">\(TC_t\)</span>. Las Figura @ref(fig:INPCHP) y Figura @ref(fig:TCHP) muestran los resultados de la implementación del filtro.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>TC_hpf <span class="ot">&lt;-</span> <span class="fu">hpfilter</span>(TC, <span class="at">freq =</span> <span class="dv">14400</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(TC_hpf)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="04-Desestacionalizacion_Filtros_files/figure-html/TCHP-1.png" alt="Descomposición del Tipo de Cambio FIX ($TC_t$) en su tendencia o trayectoria de largo plazo y su ciclo de corto plazo utilizando un filtro Hodrick y Prescott (1997)." width="100%" />
<p class="caption">
(#fig:TCHP)Descomposición del Tipo de Cambio FIX (<span class="math inline">\(TC_t\)</span>) en su tendencia o trayectoria de largo plazo y su ciclo de corto plazo utilizando un filtro Hodrick y Prescott (1997).
</p>
</div>
<!--chapter:end:04-Desestacionalizacion_Filtros.Rmd-->
</div>
</div>
<div id="procesos-basados-en-vectores-autoregresivos" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Procesos Basados en Vectores Autoregresivos</h1>
<p>PBVA</p>
<p>En este capítulo romperemos el supuesto de que el análisis es univariado, ya que introduciremos la posibilidad de que los procesos generadores de datos compartan información entre dos o más series. Como primer aproximación desarrollaremos el concepto de Causalidad de Granger. Mediante esta metodología discutiremos cuando dos series se causan estadísticamente. Posteriormente, introduciremos una técnica más sofisticada conocida como la metodología de Vectores Autoregresivos (VAR), la cual es una generalización de los procesos AR que analizamos al principio del curso.</p>
<div id="causalidad-de-granger" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Causalidad de Granger</h2>
<p>Hasta ahora hemos supuesto que una serie puede ser explicada únicamente con la información contenida en ella misma. No obstante, en adelante trataremos de analizar el caso en el que buscamos determinar relaciones entre variables y cómo el comportamiento de una serie influye en las demás. Algunas relaciones más importantes son las llamadas causalidad. En este caso analizaremos el procedimiento de Granger (1969), conocido como causalidad de Granger. En adelante asumiremos que las series involucradas son debílmente estacionarias.</p>
<p>Sean <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span> dos series debílmente estacionarias. Definamos a <span class="math inline">\(I_t\)</span> un conjunto de toda la información disponible hasta el momento <span class="math inline">\(t\)</span>. Asimismo, digamos que <span class="math inline">\(\overline{X}_t\)</span> y <span class="math inline">\(\overline{Y}_t\)</span> son los conjuntos de toda la información disponible (actual y pasada) de <span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span>, respectivamente. Es decir:</p>
<p><span class="math display">\[\begin{eqnarray}
    \overline{X}_t &amp; := &amp; \{ X_t, X_{t-1}, X_{t-2}, \ldots \}
    (\#eq:PBVA)
\end{eqnarray}\]</span></p>
<p><span class="math display">\[\begin{eqnarray}
    \overline{Y}_t &amp; := &amp; \{ Y_t, Y_{t-1}, Y_{t-2}, \ldots \} \\
        (\#eq:PBVA1)
\end{eqnarray}\]</span></p>
<p><span class="math display">\[\begin{eqnarray}
    I_t &amp; := &amp; \overline{X}_t + \overline{Y}_t
        (\#eq:PBVA2)
\end{eqnarray}\]</span></p>
<p>Adicionalmnete, definamos <span class="math inline">\(\sigma^2(.)\)</span> como la varianza del término de error estimado de una regresión dada. Dicho lo anterior, decimos que:</p>
<ol style="list-style-type: decimal">
<li>Existe Causalidad de Granger o <span class="math inline">\(X\)</span> causa a <span class="math inline">\(Y\)</span> si y solo si, una regresión lineal da como resultado que:</li>
</ol>
<p><span class="math display">\[\begin{equation}
\sigma^2 (Y_{t+1} | I_t) &lt; \sigma^2 (Y_{t+1} | I_t - X_t)        (\#eq:PBVA3)
\end{equation}\]</span></p>
<p>Es decir, que la variabilidad del término de error de una regresión lineal de <span class="math inline">\(Y\)</span> sobre el conjunto de toda la información aplicada a un pronóstico de <span class="math inline">\(Y_{t+1}\)</span> es MENOR que la variabilidad del término de error de una regresión lineal de <span class="math inline">\(Y\)</span> sobre el conjunto de la información de <span class="math inline">\(Y\)</span> aplicada a un pronóstico de <span class="math inline">\(Y_{t+1}\)</span>.</p>
<ol start="2" style="list-style-type: decimal">
<li>Existe Causalidad de Granger Instantanéa <span class="math inline">\(X\)</span> causa de forma instantanéa a <span class="math inline">\(Y\)</span> si y solo si, una regresión lineal da como resultado:
<span class="math display">\[\begin{equation}
    \sigma^2 (Y_{t+1} | \{ I_t, X_{t+1} \}) &lt; \sigma^2 (Y_{t+1} | I_t)
        (\#eq:PBVA4)
\end{equation}\]</span></li>
</ol>
<p>La definción anterior aplica de igual forma si se reemplaza a <span class="math inline">\(X\)</span> por <span class="math inline">\(Y\)</span> y a <span class="math inline">\(Y\)</span> por <span class="math inline">\(X\)</span>, respectivamente. De acuerdo a la definición anterior, existen 5 diferentes posibilidades de relaciones causales entre las dos series:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(X\)</span> y <span class="math inline">\(Y\)</span> son independientes: <span class="math inline">\((X, Y)\)</span>;</li>
<li>Existe solo causalidad instantanéa: <span class="math inline">\((X - Y)\)</span>;</li>
<li><span class="math inline">\(X\)</span> causa a <span class="math inline">\(Y\)</span>: <span class="math inline">\((X \longrightarrow Y)\)</span>;</li>
<li><span class="math inline">\(Y\)</span> causa a <span class="math inline">\(X\)</span>: <span class="math inline">\((X \longleftarrow Y)\)</span>, y</li>
<li>Ambas series se causan: <span class="math inline">\((X \longleftrightarrow Y)\)</span>.</li>
</ol>
<p>Por lo anterior, representaremos mediante una <span class="math inline">\(AR(p)\)</span> con variables exógenas lo siguiente:
<span class="math display">\[\begin{equation}
    A(L)
    \begin{bmatrix}
    Y_t \\ X_t
    \end{bmatrix}
    =
    \begin{bmatrix}
    a_{11}(L) &amp; a_{12}(L) \\ a_{21}(L) &amp; a_{22}(L)
    \end{bmatrix}
    \begin{bmatrix}
    Y_t \\ X_t
    \end{bmatrix}
    =
    \begin{bmatrix}
    V_t \\ U_t
    \end{bmatrix}
    (\#eq:GrangerEq)
\end{equation}\]</span></p>
<p>O en su versión <span class="math inline">\(MA(q)\)</span> con variables exógenas:</p>
<p><span class="math display">\[\begin{equation}
    \begin{bmatrix}
    Y_t \\ X_t
    \end{bmatrix}
    =
    B(L)
    \begin{bmatrix}
    V_t \\ U_t
    \end{bmatrix}
    =
    \begin{bmatrix}
    b_{11}(L) &amp; b_{12}(L) \\ b_{21}(L) &amp; b_{22}(L)
    \end{bmatrix}
    \begin{bmatrix}
    V_t \\ U_t
    \end{bmatrix}
        (\#eq:GrangerEq2)
\end{equation}\]</span></p>
<p>Para determinar el test de causalidad utilizaremos una especificación similar a la de la ecuación @ref(eq:GrangerEq). Para probar si <span class="math inline">\(X\)</span> causa a <span class="math inline">\(Y\)</span> consideraremos la siguiente regresión:
<span class="math display">\[\begin{equation}
    Y_t = \alpha_0 + \sum^{k_1}_{k = 1} a^k_{11} Y_{t-k} + \sum^{k_2}_{k = k_0} a^k_{12} X_{t-k} + U_{1,t}
            (\#eq:GrangerEq3)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(k_0 = 1\)</span> y, en general, se asume que <span class="math inline">\(k_1 = k_2\)</span>. Asimismo, el valor de estas constantes se puede determinar con el cirterio de Akaike (o cualquier otro criterio de información). No obstante, algunos autores sugieren que una buena práctica es considerar valores de <span class="math inline">\(k_1\)</span> y <span class="math inline">\(k_2\)</span> 4, 8, 12 y 16.</p>
<p>Dicho lo anterior, el test de causalidad de Granger se establece con una prueba F (similar a la definiada en el Apéndice de estas notas), en la cual se prueba la siguiente hipótesis nula:
<span class="math display">\[\begin{equation}
    H_0: a^1_{12} = a^2_{12} = \ldots = a^{k2}_{12} = 0
            (\#eq:GrangerEq4)
\end{equation}\]</span></p>
<p>Ahora veámos un ejemplo. Consideremos como variables analizadas al Índice Nacional de Precios al Consumidor (<span class="math inline">\(INPC_t\)</span>), al Tipo de Cambio (<span class="math inline">\(TDC_t\)</span>) y al rendimiento anual de los Cetes a 28 días (<span class="math inline">\(CETE28_t\)</span>), todas desestacionalizadas para el periodo de enero de 2000 a julio de 2019. Dado que la metodología de Granger supone que las series son estacionarias, utilizaremos las diferencias logaritmicas de cada una de las tres series (es decir, utilizaremos una transformación del tipo <span class="math inline">\(ln(X_t) - ln(X_{t-1})\)</span>). La Figura @ref(fig:DLGranger) muestra las series en su transformación de diferencias logarítmicas.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co">#DEPENDENCIAS</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Importamos Datos desde un archivo de R:</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Los datos &quot;cargados&quot; son los originales y los ajustados por estacionalidad. Los cuales son:</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="co">#* INPC: Indice Nacional de Precios al Consumidor (2QJul2018 = 100)</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="co">#* TC: Tipo de Cambio FIX </span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="co">#* CETE28: Tasa de rendimiento promedio mensual de los Cetes 28, en por ciento anual</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="co">#* IGAE: Indicador global de la actividad económica (2013 = 100)</span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="co">#* IPI: Industrial Production Index (2012 = 100)</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;BD/Clase_13/Datos_Ad.RData&quot;</span>)</span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a><span class="do">## Conversion a series de tiempo:</span></span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>INPC_G <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>INPC_Ad, </span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>           <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>           <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a>DLINPC_G <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(Datos_Ad<span class="sc">$</span>INPC_Ad) <span class="sc">-</span> <span class="fu">lag</span>(<span class="fu">log</span>(Datos_Ad<span class="sc">$</span>INPC_Ad), <span class="at">k =</span> <span class="dv">1</span>), </span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a>             <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a>             <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>TC_G <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>TC_Ad, </span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a>         <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a>         <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>DLTC_G <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(Datos_Ad<span class="sc">$</span>TC_Ad) <span class="sc">-</span> <span class="fu">lag</span>(<span class="fu">log</span>(Datos_Ad<span class="sc">$</span>TC_Ad), <span class="at">k =</span> <span class="dv">1</span>), </span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>           <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>           <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>CETE28_G <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos_Ad<span class="sc">$</span>CETE28_Ad, </span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>             <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a>             <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>DLCETE28_G <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(Datos_Ad<span class="sc">$</span>CETE28_Ad) <span class="sc">-</span> <span class="fu">lag</span>(<span class="fu">log</span>(Datos_Ad<span class="sc">$</span>CETE28_Ad), <span class="at">k =</span> <span class="dv">1</span>), </span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a>               <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a>               <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>DLIGAE_G <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(Datos_Ad<span class="sc">$</span>IGAE_Ad) <span class="sc">-</span> <span class="fu">lag</span>(<span class="fu">log</span>(Datos_Ad<span class="sc">$</span>IGAE_Ad), <span class="at">k =</span> <span class="dv">1</span>), </span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>             <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>             <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a>DLIPI_G <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">log</span>(Datos_Ad<span class="sc">$</span>IPI_Ad) <span class="sc">-</span> <span class="fu">lag</span>(<span class="fu">log</span>(Datos_Ad<span class="sc">$</span>IPI_Ad), <span class="at">k =</span> <span class="dv">1</span>), </span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a><span class="do">## Graficas:</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="05-VAR_files/figure-html/DLGranger-1.png" alt="Series en diferencias logarítmicas dadas por las siguientes expresiones: $DLINPC_t = ln(DLINPC_t) - ln(DLINPC_{t-1})$, $DLTC_t = ln(TC_t) - ln(TC_{t-1})$ y $DLCETE28_t = ln(CETE28_t) - ln(CETE28_{t-1})$." width="100%" />
<p class="caption">
(#fig:DLGranger)Series en diferencias logarítmicas dadas por las siguientes expresiones: <span class="math inline">\(DLINPC_t = ln(DLINPC_t) - ln(DLINPC_{t-1})\)</span>, <span class="math inline">\(DLTC_t = ln(TC_t) - ln(TC_{t-1})\)</span> y <span class="math inline">\(DLCETE28_t = ln(CETE28_t) - ln(CETE28_{t-1})\)</span>.
</p>
</div>
<p>Por simplicidad, en el Cuadro @ref(tab:Granger01) se muestra el resultado de aplicar el test de Granger a diferentes especificaciones, con rezagos 4, 8, 12 y 16, sólo para la serie de Tipo de Cambio en diferencias logarítmicas. En cada una de las pruebas se compara el modelo considerado como regresor a la variable que es candidata de causar, respecto del modelo si considerar a dicha variable.</p>
<table>
<caption>(#tab:Granger01) Prueba de si <span class="math inline">\(DLINPC_t\)</span> Granger causa a <span class="math inline">\(DLTC_t\)</span>. <em>Notas: *** significancia al 0.001%, ** significancia al 0.01% y* significancia 0.05%</em></caption>
<thead>
<tr class="header">
<th align="center">Rezagos</th>
<th align="center">Estadiística F</th>
<th align="center">Probabilidad (<span class="math inline">\(&gt;\)</span>F)</th>
<th align="center">Significancia</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">4</td>
<td align="center">3.2621</td>
<td align="center">0.01265</td>
<td align="center">*</td>
</tr>
<tr class="even">
<td align="center">8</td>
<td align="center">1.9079</td>
<td align="center">0.06030</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">12</td>
<td align="center">2.2577</td>
<td align="center">0.01067</td>
<td align="center">*</td>
</tr>
<tr class="even">
<td align="center">16</td>
<td align="center">1.6735</td>
<td align="center">0.05495</td>
<td align="center">*</td>
</tr>
</tbody>
</table>
<p>De acuerdo con el Cuadro @ref(tab:Granger01), podemos concluir que existe información estadísticamente significativa para concluir que la inflación causa a la tasa de depreciación cambiaria, ambas medidas como las diferencias logaritmicas. El resto de los resultados para las otras combinaciones de causalidad se encuentran en el Scrip llamado Clase 13 ubicado en el repositorio de GitHub.</p>
</div>
<div id="definición-y-representación-del-sistema-o-modelo-varp" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Definición y representación del Sistema o Modelo VAR(p)</h2>
<p>En esta sección ampliaremos la discusión planteada en el apartado anterior. En el sentido de que en la sección pasada nuestra discusión se limito al análisis de causalidad entre dos variables a la vez, que si bien es posible extenderlo a más variables es un procedimiento limitado a casos particulares por las siguientes razones.</p>
<p>El procediento de causalidad de Granger supone que es posible identificar un sistema de ecuaciones que debe conformarse una vez que se ha identificado el sentido de la causalidad. Así, el proceso anterior necesita del conocimiento previo de las relaciones que existen entre las varibles.</p>
<p>Adicionalmente, no resuleve el problema más general qué esta relacionado con cómo identificar la causalidad cuando se tienen múltiples variables con múltiples sentidos de causalidad. En esta sección analizaremos una mejor aproximación al probelma de cómo identificar la causalidad múltiple. Por lo tanto, como mécanismo para solucionar el problema planteado, analizaremos el caso de un Sistema o Modelo de Vectores Autoregresivos conocido como VAR.</p>
<p>El primer supuesto del que partiremos es que existe algún grado de endogenidad entre las variables considerdas en el análisis. Adicionalmente, el segundo supuesto que estableceremos es que requerimos que las variables que tengamos consideradas sean estacionarias.</p>
<p>Por lo anterior diremos que un VAR es un procedimiento que sigue fundado en el supuesto de que las variables consideredas son estacionarias, sin que hasta el momento hallamos podido establecer un mécanismo de detección de dicha estacionariedad. Así, hasta este momento del curso hemos pasado de modelo univariados a modelo múltivariados, pero no hemos podido dejar de asumir que las series son estacionarias.</p>
<p>Ahora bien, iniciaremos con el establecimiento de la representación del proceso. Digamos que tenemos un proceso estocástico <span class="math inline">\(\mathbf{X}\)</span> estacionario de dimensión <span class="math inline">\(k\)</span>. De esta forma la expresión reducida del modelo o el proceso <span class="math inline">\(VAR(p)\)</span> estará dado por:</p>
<p><span class="math display">\[\begin{equation}
    \mathbf{X}_t = \mathbf{\delta} + A_1 \mathbf{X}_{t-1} + A_2 \mathbf{X}_{t-2} + \ldots + A_p \mathbf{X}_{t-p} + \mathbf{U}_{t}
    (\#eq:VARp)
\end{equation}\]</span></p>
<p>Donde cada uno de las <span class="math inline">\(A_i\)</span>, <span class="math inline">\(i = 1, 2, \ldots, p\)</span>, son matrices cuadradas de dimensión <span class="math inline">\(k\)</span> y <span class="math inline">\(\mathbf{U}_t\)</span> representa un vector de dimensión <span class="math inline">\(k \times 1\)</span> con los residuales en el momento del tiempo <span class="math inline">\(t\)</span> que son un proceso pueramente aleatorio. También se incorpora un vector de términos constantes denominado como <span class="math inline">\(\mathbf{\delta}\)</span>, el cual es de dimensión <span class="math inline">\(k \times 1\)</span>.</p>
<p>Así, la ecuación @ref(eq:VARp) supone la siguiente estructura de vectores:
<span class="math display">\[\begin{equation*}
    \mathbf{X}_t =
    \begin{bmatrix}
    X_{1t} \\ X_{2t} \\ \vdots \\ X_{kt}
    \end{bmatrix}
\end{equation*}\]</span></p>
<p>Para cualquier <span class="math inline">\(i = 1, 2, \ldots, p\)</span>:
<span class="math display">\[\begin{equation*}
    \mathbf{X}_{t-i} =
    \begin{bmatrix}
    X_{1t-i} \\ X_{2t-i} \\ \vdots \\ X_{kt-i}
    \end{bmatrix}
\end{equation*}\]</span></p>
<p><span class="math display">\[\begin{equation*}
    \mathbf{\delta} =
    \begin{bmatrix}
    \delta_{1} \\ \delta_{2} \\ \vdots \\ \delta_{k}
    \end{bmatrix}
\end{equation*}\]</span></p>
<p>También, la ecuación @ref(eq:VARp) supone que cada matriz <span class="math inline">\(A_i\)</span>, <span class="math inline">\(i = 1, 2, \ldots, p\)</span>, esta definida de la siguiente forma:
<span class="math display">\[\begin{equation*}
    \mathbf{A}_i =
    \begin{bmatrix}
    a^{(i)}_{11} &amp; a^{(i)}_{12} &amp; \ldots &amp; a^{(i)}_{1k} \\ a^{(i)}_{21} &amp; a^{(i)}_{22} &amp; \ldots &amp; a^{(i)}_{2k} \\ \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\ a^{(i)}_{k1} &amp; a^{(i)}_{k2} &amp; \ldots &amp; a^{(i)}_{kk}
    \end{bmatrix}
\end{equation*}\]</span></p>
<p>Retomando la ecuación @ref(eq:VARp) y considerando que podemos ocupar el operador rezago <span class="math inline">\(L^j\)</span> de forma analóga al caso del modelo <span class="math inline">\(AR(p)\)</span>, pero aplicado a un vector, tenemos las siguientes ecuaciones:</p>
<p><span class="math display">\[\begin{eqnarray}
    \mathbf{X}_t - A_1 \mathbf{X}_{t-1} - A_2 \mathbf{X}_{t-2} - \ldots - A_p \mathbf{X}_{t-p} &amp; = &amp; \mathbf{\delta} + \mathbf{U}_{t} \nonumber \\
    \mathbf{X}_t - A_1 L \mathbf{X}_{t} - A_2 L^2 \mathbf{X}_{t} - \ldots - A_p L^p \mathbf{X}_{t-p} &amp; = &amp; \mathbf{\delta} + \mathbf{U}_{t} \nonumber \\
    (I_k - A_1 L - A_2 L^2 - \ldots - A_p L^p) \mathbf{X}_t &amp; = &amp; \mathbf{\delta} + \mathbf{U}_{t} \nonumber \\
    \mathbf{A}(L) \mathbf{X}_t &amp; = &amp; \mathbf{\delta} + \mathbf{U}_{t}
    (\#eq:ARCorto)
\end{eqnarray}\]</span></p>
<p>Adicionalmente, requeriremos que dado que <span class="math inline">\(\mathbf{U}_t\)</span> es un proceso pueramente aleatorio, este debe cumplir con las siguientes condiciones:
1. El valor esperado del término de erros es cero:
<span class="math display">\[\begin{equation}
        \mathbb{E}[\mathbf{U}_t] = 0
            (\#eq:ARCorto1)
    \end{equation}\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li><p>Existe una matriz de varianzas y covarianzas entre los términos de error contemporáneos dada por:
<span class="math display">\[\begin{eqnarray}
     \mathbb{E}[\mathbf{U}_t \mathbf{U}_t&#39;]
     &amp; = &amp;
     \mathbb{E} \left[
     \begin{bmatrix}
     U^{(t)}_{1} \\ U^{(t)}_{2} \\ \vdots \\ U^{(t)}_{k}
     \end{bmatrix}
     \begin{bmatrix}
     U^{(t)}_{1} &amp; U^{(t)}_{2} &amp; \ldots &amp; U^{(t)}_{k}
     \end{bmatrix}
     \right] \nonumber \\
     &amp; = &amp; \mathbb{E}
     \begin{bmatrix}
     U^{(t)}_{1} U^{(t)}_{1} &amp; U^{(t)}_{1} U^{(t)}_{2} &amp; \ldots &amp; U^{(t)}_{1} U^{(t)}_{k} \\
     U^{(t)}_{2} U^{(t)}_{1} &amp; U^{(t)}_{2} U^{(t)}_{2} &amp; \ldots &amp; U^{(t)}_{2} U^{(t)}_{k} \\
     \vdots &amp; \vdots &amp; \ldots &amp; \vdots \\
     U^{(t)}_{k} U^{(t)}_{1} &amp; U^{(t)}_{k} U^{(t)}_{2} &amp; \ldots &amp; U^{(t)}_{k} U^{(t)}_{k}
     \end{bmatrix} \nonumber \\
     &amp; = &amp; \begin{bmatrix}
     \sigma^2_1 &amp; \rho_{12} &amp; \ldots &amp; \rho_{1k} \\
     \rho_{21} &amp; \sigma^2_2 &amp; \ldots &amp; \rho_{2k} \\
     \vdots &amp; \vdots &amp; \ldots &amp; \vdots \\
     \rho_{k1} &amp; \rho_{k2} &amp; \ldots &amp; \sigma^2_k
     \end{bmatrix} \nonumber \\
     &amp; = &amp; \mathbf{\Sigma}_{UU}
     (\#eq:SigmaVAR)
\end{eqnarray}\]</span></p></li>
<li><p>La matriz de varianzas y covarianzas no comtemporáneas es nula. Es decir, que para todo <span class="math inline">\(t \neq s\)</span>:
<span class="math display">\[\begin{eqnarray}
     \mathbb{E} [\mathbf{U}_t \mathbf{U}_s&#39;]
     &amp; = &amp;
     \mathbb{E} \left[
     \begin{bmatrix}
     U^{(t)}_{1} \\ U^{(t)}_{2} \\ \vdots \\ U^{(t)}_{k}
     \end{bmatrix}
     \begin{bmatrix}
     U^{(s)}_{1} &amp; U^{(s)}_{2} &amp; \ldots &amp; U^{(s)}_{k}
     \end{bmatrix}
     \right] \nonumber \\
     &amp; =  &amp; \mathbb{E}
     \begin{bmatrix}
     U^{(t)}_{1} U^{(s)}_{1} &amp; U^{(t)}_{1} U^{(s)}_{2} &amp; \ldots &amp; U^{(t)}_{1} U^{(s)}_{k} \\
     U^{(t)}_{2} U^{(s)}_{1} &amp; U^{(t)}_{2} U^{(s)}_{2} &amp; \ldots &amp; U^{(t)}_{2} U^{(s)}_{k} \\
     \vdots &amp; \vdots &amp; \ldots &amp; \vdots \\
     U^{(t)}_{k} U^{(s)}_{1} &amp; U^{(t)}_{k} U^{(s)}_{2} &amp; \ldots &amp; U^{(t)}_{k} U^{(s)}_{k}
     \end{bmatrix} \nonumber \\
     &amp; = &amp; \mathbf{0}
     (\#eq:RhoVAR)
\end{eqnarray}\]</span></p></li>
</ol>
<p>Las ecuaciones @ref(eq:SigmaVAR) y @ref(eq:RhoVAR) significan que los residuales <span class="math inline">\(\mathbf{U}_t\)</span> pueden estar correlacionados entre ellos solo en el caso de que la información sea contemporánea, pero no tienen información en común entre residuales de otros periodos.</p>
<p>Al igual que en el caso del modelo o especificación <span class="math inline">\(AR(p)\)</span> en la especificación del modelo <span class="math inline">\(VAR(p)\)</span> existen condiciones de estabilidad. Dichas condiciones están dadas por lo siguiente, definamos el siguiente polinomio que resulta de tomar la matriz <span class="math inline">\(\mathbf{A}(L)\)</span> en la ecuación @ref(eq:ARCorto1):</p>
<p><span class="math display">\[\begin{equation}
    Det[I_t - A_1 z - A_2 z^2 - \ldots - A_p z^p] \neq 0
            (\#eq:RhoVAR1)
\end{equation}\]</span></p>
<p>Donde las raíces del polinomio cumplen que <span class="math inline">\(|z| \leq 1\)</span>, es decir, se ubican dentro del circulo unitario.</p>
<p>La ecuación @ref(eq:ARCorto1) puede ser rexpresada en una forma similar al un proceso de MA. Al respecto, de forma similar a la siguiente ecuación podemos construir un modelo <span class="math inline">\(VARMA(p,q)\)</span>, el cual no estudiamos es este curso.</p>
<p>Reromando el primer planteamiento, podemos escribir:
<span class="math display">\[\begin{eqnarray}
    \mathbf{X}_t &amp; = &amp; \mathbf{A}^{-1}(L) \delta + \mathbf{A}^{-1}(L) \mathbf{U}_t \nonumber \\
    &amp; = &amp; \mu + \beta(L) \mathbf{U}_t
    (\#eq:VARMAq)
\end{eqnarray}\]</span></p>
<p>Por el lado de las matrices que representan la autocovarianza, estás resultan de resolver lo siguiente:
<span class="math display">\[\begin{equation}
    \Gamma_X(\tau) = E[(\mathbf{X}_t - \mu)(\mathbf{X}_{t-\tau} - \mu)&#39;]
        (\#eq:VARMAq1)
\end{equation}\]</span></p>
<p>Ahora, sin pérdida de generalidad digamos que la especificación VAR(p) en la ecuación @ref(eq:VARp) no tiene constante, por lo que <span class="math inline">\(\delta = 0\)</span>, lo que implica que <span class="math inline">\(\mu = 0\)</span>. De esta forma las matrices de autocovarianza resultan de:
<span class="math display">\[\begin{eqnarray*}
    \Gamma_X(\tau) &amp; = &amp; E[(\mathbf{X}_t)(\mathbf{X}_{t-\tau})&#39;] \\
    &amp; = &amp; A_1 E[(\mathbf{X}_{t-1})(\mathbf{X}_{t-\tau})&#39;] + A_2 E[(\mathbf{X}_{t-2})(\mathbf{X}_{t-\tau})&#39;] \\
    &amp;   &amp; + \ldots + A_p E[(\mathbf{X}_{t-p})(\mathbf{X}_{t-\tau})&#39;] + E[(\mathbf{U}_t(\mathbf{X}_{t-\tau})&#39;]
\end{eqnarray*}\]</span></p>
<p>Finalmente, al igual que en el caso <span class="math inline">\(AR(p)\)</span> requerimos de una métrica que nos permita determinar el número de rezagos óptimo <span class="math inline">\(p\)</span> en el <span class="math inline">\(VAR(p)\)</span>. Así, establecemos criterios de información similares a los del <span class="math inline">\(AR(p)\)</span> dados por:</p>
<p>1.Final Prediction Error (FPE):
<span class="math display">\[\begin{equation}
        FPE(p) = \left[ \frac{T + kp + 1}{T - kp - 1} \right]^k |\mathbf{\Sigma}_{\hat{U}\hat{U}}(p)|
(\#eq:lst1)
\end{equation}\]</span></p>
<ol start="2" style="list-style-type: decimal">
<li><p>Akaike Criterion (AIC):
<span class="math display">\[\begin{equation}
     AIC(p) = ln|\mathbf{\Sigma}_{\hat{U}\hat{U}}(p)| + (k + p k^2) \frac{2}{T}
(\#eq:lst2)
\end{equation}\]</span></p></li>
<li><p>Hannan - Quinn Criterion (HQ):
<span class="math display">\[\begin{equation}
     HQ(p) = ln|\mathbf{\Sigma}_{\hat{U}\hat{U}}(p)| + (k + p k^2) \frac{2ln(ln(2))}{T}
(\#eq:lst3)
     \end{equation}\]</span></p></li>
<li><p>Schwartz Criterion (SC):
<span class="math display">\[\begin{equation}
     SC(p) = ln|\mathbf{\Sigma}_{\hat{U}\hat{U}}(p)| + (k + p k^2) \frac{ln(T)}{T}
(\#eq:lst4)
     \end{equation}\]</span></p></li>
</ol>
<p>Donde la matriz de varianzas y covarianzas contemporáneas estará dada por:
<span class="math display">\[\begin{equation*}
            \mathbf{\Sigma}_{\hat{U}\hat{U}}(p) = \mathbb{E} \left[
            \begin{bmatrix}
            U^{(t)}_{1} \\ U^{(t)}_{2} \\ \vdots \\ U^{(t)}_{k}
            \end{bmatrix}
            \begin{bmatrix}
            U^{(t)}_{1} &amp; U^{(t)}_{2} &amp; \ldots &amp; U^{(t)}_{k}
            \end{bmatrix}
            \right]
        \end{equation*}\]</span></p>
<p>Ahora veámos un ejemplo de estimación de <span class="math inline">\(VAR(p)\)</span>. Para el ejemplo utilizaremos las series de INPC, Tipo de CAmbio, rendimiento de los Cetes a 28 días, el IGAE y el Índice de Producción Industrial de los Estados Unidos, todas desestacionalizadas y para el período de enero de 2000 a julio de 2019. Dado que el supuesto estacionariedad sigue presente en nuestro análisis, emplearemos cada una de las series en su versión de diferencias logaritmicas. La Figura @ref(fig:VARDLSeries) muestra las series referidas.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>Datos_G <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(DLINPC_G, DLTC_G, DLCETE28_G))</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>Datos_G <span class="ot">&lt;-</span> <span class="fu">cbind</span>(Datos_Ad[<span class="st">&quot;FECHA&quot;</span>], Datos_G)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>Datos_G2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(DLINPC_G, DLTC_G, DLCETE28_G, DLIGAE_G, DLIPI_G))</span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>Datos_G2 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos_G2[<span class="dv">2</span> <span class="sc">:</span> <span class="dv">259</span>, ], </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2</span>), <span class="at">freq =</span> <span class="dv">12</span>)</span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Datos_G2, <span class="at">plot.type =</span> <span class="st">&quot;s&quot;</span>, </span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;purple&quot;</span>), </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Series en Diferencias logaritmicas&quot;</span>, </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Variacion&quot;</span>)</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomright&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;INPC&quot;</span>, <span class="st">&quot;TC&quot;</span>, <span class="st">&quot;CETES28&quot;</span>, <span class="st">&quot;IGAE&quot;</span>, <span class="st">&quot;IPI&quot;</span>),</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">lty =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">1</span>, </span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;darkblue&quot;</span>, <span class="st">&quot;darkred&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;purple&quot;</span>))</span></code></pre></div>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(Datos_G2, <span class="at">plot.type =</span> <span class="st">&quot;m&quot;</span>, </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Series en Diferencias logaritmicas&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Tiempo&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="05-VAR_files/figure-html/VARDLSeries-1.png" alt="Series en diferencias logarítmicas, enero de 2000 a julio de 201p" width="100%" />
<p class="caption">
(#fig:VARDLSeries)Series en diferencias logarítmicas, enero de 2000 a julio de 201p
</p>
</div>
<p>Dicho lo anterior, a continuación mostraremos la tabla que resume el valor de los distintos criterios de información una especificación de un <span class="math inline">\(VAR(p)\)</span> con constante. Notése que es posible especificar un <span class="math inline">\(VAR(p)\)</span> con tendencia, caso que no aplica hasta este momento, ya que nuestro análisis de estacionariedad es claro respecto a la media constante (más adelante relajaremos este supuesto), lo cual elimina la poisiblidad de incluir una tendencia.</p>
<p>En el Cuadro @ref(tab:SelectVAR) reportamos los resultados de aplicar una prueba de criterios de información para diferentes valores de reagos. Del cual se concluye que el número óptimo de residuales es 2 (según el crietrio AIC y el FPE) y 1 (según el criterio HQ y el SC). Recordemos que es común que el criterio AIC siempre reporte el mayor valor de rezagos, por lo que es una buena práctica utilizarlo como referente principal.</p>
<table>
<caption>(#tab:SelectVAR) Criterios de información para diferentes especificaciones de modelos VAR(p) con término constante de la series <span class="math inline">\(DLINPC_t\)</span>, <span class="math inline">\(DLTC_t\)</span>, <span class="math inline">\(DLCETE28_t\)</span>, <span class="math inline">\(DLIGAE_t\)</span> y <span class="math inline">\(DLIPI_t\)</span>. <em>Nota: Se reporta el valor de los criterios de información.</em></caption>
<thead>
<tr class="header">
<th align="center">Rezagos</th>
<th align="center">AIC</th>
<th align="center">HQ</th>
<th align="center">SC</th>
<th align="center">FPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">-4.636412e+01</td>
<td align="center">-4.617847e+01</td>
<td align="center">-4.590430e+01</td>
<td align="center">7.317262e-21</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">-4.639541e+01</td>
<td align="center">-4.605506e+01</td>
<td align="center">-4.555241e+01</td>
<td align="center">7.094216e-21</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">-4.635305e+01</td>
<td align="center">-4.585799e+01</td>
<td align="center">-4.512686e+01</td>
<td align="center">7.407479e-21</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
</tr>
</tbody>
</table>
<p>De esta forma, justificamos la estimación de un <span class="math inline">\(VAR(2)\)</span>. Los resultados del mismo se repotartan en los siguientes cuadros, en los que se reporta el resultado de una de las ecuaciones. Los resultados restantes se encuentran en el Scrip Clase 14 que se encuentra en repositorio de GitHub. Primero mostraremos los resutlados de las raíces del polinomio caracteristico en el Cuadro @ref(tab:RootsVAR), seguido de un cuadro para la ecuación del IGAE en el Cuadro @ref(tab:IGAEVAR)(por simplicidad se omiten las otras cuatro ecuaciones del VAR(2)), y del Cuadro @ref(tab:SigmaVARp) con la matriz <span class="math inline">\(\mathbf{\Sigma}_{\hat{U}\hat{U}}\)</span> estimada del VAR.</p>
<table>
<caption>(#tab:RootsVAR) Raíces del polinomio característico de un VAR(2).</caption>
<tbody>
<tr class="odd">
<td align="center">0.7452</td>
<td align="center">0.4403</td>
<td align="center">0.4403</td>
<td align="center">0.3503</td>
<td align="center">0.3503</td>
</tr>
<tr class="even">
<td align="center">0.3342</td>
<td align="center">0.3342</td>
<td align="center">0.3339</td>
<td align="center">0.3339</td>
<td align="center">0.06951</td>
</tr>
</tbody>
</table>
<table>
<caption>(#tab:IGAEVAR) Criterios de información para diferentes especificaciones de modelos VAR(p) con término constante de la series <span class="math inline">\(DLINPC_t\)</span>, <span class="math inline">\(DLTC_t\)</span>, <span class="math inline">\(DLCETE28_t\)</span>, <span class="math inline">\(DLIGAE_t\)</span> y <span class="math inline">\(DLIPI_t\)</span>. <em>Nota: *** significancia al 0.001%, ** significancia al 0.01%, significancia 0.05%</em></caption>
<thead>
<tr class="header">
<th align="center">Variable</th>
<th align="center">Coeficiente</th>
<th align="center">Error Est.</th>
<th align="center">Estad. t</th>
<th align="center">Prob.(<span class="math inline">\(&gt;\)</span> t)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(DLTC_{t-1}\)</span></td>
<td align="center">0.0022016</td>
<td align="center">0.0152876</td>
<td align="center">0.144</td>
<td align="center">0.885620</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLINPC_{t-1}\)</span></td>
<td align="center">-0.2584978</td>
<td align="center">0.1658396</td>
<td align="center">-1.559</td>
<td align="center">0.120493</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLCETE28_{t-1}\)</span></td>
<td align="center">0.0009547</td>
<td align="center">0.0049115</td>
<td align="center">0.194</td>
<td align="center">0.846054</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLIGAE_{t-1}\)</span></td>
<td align="center">-0.2351453</td>
<td align="center">0.0699797</td>
<td align="center">-3.360</td>
<td align="center">0.000917 ***</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLIPI_{t-1}\)</span></td>
<td align="center">0.2442406</td>
<td align="center">0.0600502</td>
<td align="center">4.067</td>
<td align="center">6.62e-05 ***</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLINPC_{t-2}\)</span></td>
<td align="center">-0.0775039</td>
<td align="center">0.1694809</td>
<td align="center">-0.457</td>
<td align="center">0.647904</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLTC_{t-2}\)</span></td>
<td align="center">-0.0413316</td>
<td align="center">0.0144650</td>
<td align="center">-2.857</td>
<td align="center">0.004680 **</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLCETE28_{t-2}\)</span></td>
<td align="center">0.0005341</td>
<td align="center">0.0048058</td>
<td align="center">0.111</td>
<td align="center">0.911612</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLIGAE_{t-2}\)</span></td>
<td align="center">-0.0646890</td>
<td align="center">0.0693711</td>
<td align="center">-0.933</td>
<td align="center">0.352092</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLIPI_{t-2}\)</span></td>
<td align="center">0.1796286</td>
<td align="center">0.0620861</td>
<td align="center">2.893</td>
<td align="center">0.004195 **</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\delta_4\)</span></td>
<td align="center">0.0030377</td>
<td align="center">0.0008077</td>
<td align="center">3.761</td>
<td align="center">0.000217 ***</td>
</tr>
</tbody>
</table>
<table>
<caption>(#tab:SigmaVARp) Matriz <span class="math inline">\(\mathbf{\Sigma}_{\hat{U}\hat{U}}\)</span> estimada del VAR(2).</caption>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\(DLINPC_t\)</span></th>
<th align="center"><span class="math inline">\(DLTC_t\)</span></th>
<th align="center"><span class="math inline">\(DLCE28_t\)</span></th>
<th align="center"><span class="math inline">\(DLIGAE_t\)</span></th>
<th align="center"><span class="math inline">\(DLIGAE_t\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(DLINPC_t\)</span></td>
<td align="center">3.95e-06</td>
<td align="center">3.19e-06</td>
<td align="center">-1.83e-06</td>
<td align="center">-5.29-07</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLTC_t\)</span></td>
<td align="center">3.19e-06</td>
<td align="center">5.04e-04</td>
<td align="center">4.27e-04</td>
<td align="center">9.81e-06</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLCE28_t\)</span></td>
<td align="center">-1.83e-06</td>
<td align="center">4.27e-04</td>
<td align="center">4.63e-03</td>
<td align="center">1.26e-05</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLIGAE_t\)</span></td>
<td align="center">-5.29e-07</td>
<td align="center">9.81e-06</td>
<td align="center">1.26e-05</td>
<td align="center">2.43e-05</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLIGAE_t\)</span></td>
<td align="center">1.34e-06</td>
<td align="center">1.61e-05</td>
<td align="center">2.76e-05</td>
<td align="center">8.75e-06</td>
</tr>
</tbody>
</table>
<p>Finalmente, en el Cuadro @ref(tab:DiagnosVAR) reportamos las pruebas de diagnóstico del VAR(2). Incluímos las pruebas de normalidad, autocorrelación parcial y de heterocedásticidad.</p>
<table>
<caption>(#tab:DiagnosVAR) Pruebas de diagnóstico sobre los residuales del VAR(2).</caption>
<colgroup>
<col width="25%" />
<col width="25%" />
<col width="25%" />
<col width="25%" />
</colgroup>
<thead>
<tr class="header">
<th align="center">Estadística (rezagos)</th>
<th align="center">Coeficiente</th>
<th align="center">p-value</th>
<th align="center">Conclusión</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Correlación Serial (<span class="math inline">\(\chi^2 (2)\)</span>)</td>
<td align="center">59.436</td>
<td align="center">0.1696</td>
<td align="center">Existe auto-correlación serial</td>
</tr>
<tr class="even">
<td align="center">Correlación Serial (<span class="math inline">\(\chi^2 (4)\)</span>)</td>
<td align="center">127.17</td>
<td align="center">0.03461</td>
<td align="center">No existe auto-correlación serial</td>
</tr>
<tr class="odd">
<td align="center">Correlación Serial (<span class="math inline">\(\chi^2 (6)\)</span>)</td>
<td align="center">183.14</td>
<td align="center">0.03393</td>
<td align="center">No existe auto-correlación serial</td>
</tr>
<tr class="even">
<td align="center">Normalidad - JB (<span class="math inline">\(\chi^2\)</span>)</td>
<td align="center">2335</td>
<td align="center">0.0000</td>
<td align="center">Los residuales no son normales</td>
</tr>
<tr class="odd">
<td align="center">ARCH (<span class="math inline">\(\chi^2 (2)\)</span>)</td>
<td align="center">691.58</td>
<td align="center">0.0000</td>
<td align="center">Los residuales no son homocedásticos</td>
</tr>
</tbody>
</table>
</div>
<div id="análisis-de-impulso-respuesta" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Análisis de Impulso-Respuesta</h2>
<p>Una de las grandes ventajas que aporta el análisis de los modelos VAR es el análisis de Impulso-Respuesta. Dicho análisis busca cuantificar el efecto que tiene en <span class="math inline">\(\mathbf{X}_t\)</span> una innovación o cambio en los residuales de cualquiera de las variables en un momento definido. Partamos dela ecuación @ref(eq:VARMAq) de forma que tenemos:</p>
<p><span class="math display">\[\begin{eqnarray}
    \mathbf{X}_t &amp; = &amp; \mathbf{A}^{-1}(L) \delta + \mathbf{A}^{-1}(L) \mathbf{U}_t \nonumber \\
    &amp; = &amp; \mu + \mathbf{B}(L) \mathbf{U}_t \nonumber \\
    &amp; = &amp; \mu + \Psi_0 \mathbf{U}_t + \Psi_1 \mathbf{U}_{t-1} + \Psi_2 \mathbf{U}_{t-2} + \Psi_3 \mathbf{U}_{t-3} + \ldots
(\#eq:lst66)
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\Psi_0 = I\)</span> y cada una de las <span class="math inline">\(\Psi_i = - \mathbf{B}_i\)</span>, <span class="math inline">\(i = 1, 2, \ldots\)</span>. De esta forma se verifica el efecto que tiene en <span class="math inline">\(\mathbf{X}_t\)</span> cada las innovaciones pasadas. Por lo que el análisis de Impulso-Respuesta cuantifica el efecto de cada una de esas matrices en las que hemos descompuesto a <span class="math inline">\(\mathbf{B}(L)\)</span>.</p>
<p>Retomando el modelo <span class="math inline">\(VAR(2)\)</span> anteriormente estimado, en el Cuadro @ref(tab:IRVARTC) reportamos las gráficas de Impulso-respuesta de la serie <span class="math inline">\(DLTC_t\)</span> ante cambios en los residuales del resto de las series y de la propia serie.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dependencias</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(strucchange)</span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(urca)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vars)</span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-13"><a href="#cb51-13" aria-hidden="true" tabindex="-1"></a><span class="co">#Datos</span></span>
<span id="cb51-14"><a href="#cb51-14" aria-hidden="true" tabindex="-1"></a>Datos_G3 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">cbind</span>(DLINPC_G, DLTC_G, DLCETE28_G, DLIGAE_G, DLIPI_G))</span>
<span id="cb51-15"><a href="#cb51-15" aria-hidden="true" tabindex="-1"></a>Datos_G3 <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos_G3[<span class="dv">2</span> <span class="sc">:</span> <span class="dv">259</span>, ], </span>
<span id="cb51-16"><a href="#cb51-16" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">2</span>), <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb51-17"><a href="#cb51-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-18"><a href="#cb51-18" aria-hidden="true" tabindex="-1"></a><span class="do">## VAR Estimación:</span></span>
<span id="cb51-19"><a href="#cb51-19" aria-hidden="true" tabindex="-1"></a><span class="fu">VARselect</span>(Datos_G3, <span class="at">lag.max =</span> <span class="dv">12</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb51-20"><a href="#cb51-20" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $selection</span></span>
<span id="cb51-21"><a href="#cb51-21" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC(n)  HQ(n)  SC(n) FPE(n) </span></span>
<span id="cb51-22"><a href="#cb51-22" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;      2      1      1      2 </span></span>
<span id="cb51-23"><a href="#cb51-23" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-24"><a href="#cb51-24" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; $criteria</span></span>
<span id="cb51-25"><a href="#cb51-25" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    1             2             3</span></span>
<span id="cb51-26"><a href="#cb51-26" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC(n) -4.195465e+01 -4.198941e+01 -4.195421e+01</span></span>
<span id="cb51-27"><a href="#cb51-27" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HQ(n)  -4.178252e+01 -4.167385e+01 -4.149521e+01</span></span>
<span id="cb51-28"><a href="#cb51-28" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SC(n)  -4.152717e+01 -4.120570e+01 -4.081426e+01</span></span>
<span id="cb51-29"><a href="#cb51-29" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FPE(n)  6.016568e-19  5.812443e-19  6.024461e-19</span></span>
<span id="cb51-30"><a href="#cb51-30" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    4             5             6</span></span>
<span id="cb51-31"><a href="#cb51-31" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC(n) -4.186713e+01 -4.181541e+01 -4.179207e+01</span></span>
<span id="cb51-32"><a href="#cb51-32" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HQ(n)  -4.126469e+01 -4.106953e+01 -4.090275e+01</span></span>
<span id="cb51-33"><a href="#cb51-33" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SC(n)  -4.037095e+01 -3.996300e+01 -3.958342e+01</span></span>
<span id="cb51-34"><a href="#cb51-34" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FPE(n)  6.580247e-19  6.942566e-19  7.126238e-19</span></span>
<span id="cb51-35"><a href="#cb51-35" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                    7             8             9</span></span>
<span id="cb51-36"><a href="#cb51-36" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC(n) -4.183689e+01 -4.183860e+01 -4.181243e+01</span></span>
<span id="cb51-37"><a href="#cb51-37" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HQ(n)  -4.080413e+01 -4.066240e+01 -4.049279e+01</span></span>
<span id="cb51-38"><a href="#cb51-38" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SC(n)  -3.927201e+01 -3.891749e+01 -3.853508e+01</span></span>
<span id="cb51-39"><a href="#cb51-39" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FPE(n)  6.840149e-19  6.863474e-19  7.091908e-19</span></span>
<span id="cb51-40"><a href="#cb51-40" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                   10            11            12</span></span>
<span id="cb51-41"><a href="#cb51-41" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; AIC(n) -4.169621e+01 -4.167191e+01 -4.160623e+01</span></span>
<span id="cb51-42"><a href="#cb51-42" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; HQ(n)  -4.023314e+01 -4.006540e+01 -3.985628e+01</span></span>
<span id="cb51-43"><a href="#cb51-43" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; SC(n)  -3.806263e+01 -3.768211e+01 -3.726019e+01</span></span>
<span id="cb51-44"><a href="#cb51-44" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; FPE(n)  8.031729e-19  8.312778e-19  8.986015e-19</span></span>
<span id="cb51-45"><a href="#cb51-45" aria-hidden="true" tabindex="-1"></a>VAR_p <span class="ot">&lt;-</span> <span class="fu">VAR</span>(Datos_G3, <span class="at">p =</span> <span class="dv">2</span>, <span class="at">type =</span> <span class="st">&quot;const&quot;</span>)</span>
<span id="cb51-46"><a href="#cb51-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-47"><a href="#cb51-47" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(VAR_p)</span>
<span id="cb51-48"><a href="#cb51-48" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-49"><a href="#cb51-49" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; VAR Estimation Results:</span></span>
<span id="cb51-50"><a href="#cb51-50" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ========================= </span></span>
<span id="cb51-51"><a href="#cb51-51" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Endogenous variables: DLINPC_G, DLTC_G, DLCETE28_G, DLIGAE_G, DLIPI_G </span></span>
<span id="cb51-52"><a href="#cb51-52" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Deterministic variables: const </span></span>
<span id="cb51-53"><a href="#cb51-53" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Sample size: 256 </span></span>
<span id="cb51-54"><a href="#cb51-54" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Log Likelihood: 3617.305 </span></span>
<span id="cb51-55"><a href="#cb51-55" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Roots of the characteristic polynomial:</span></span>
<span id="cb51-56"><a href="#cb51-56" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0.4932 0.4932 0.4905 0.4905 0.4585 0.4585 0.4046 0.4046 0.2654 0.2654</span></span>
<span id="cb51-57"><a href="#cb51-57" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Call:</span></span>
<span id="cb51-58"><a href="#cb51-58" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; VAR(y = Datos_G3, p = 2, type = &quot;const&quot;)</span></span>
<span id="cb51-59"><a href="#cb51-59" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-60"><a href="#cb51-60" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-61"><a href="#cb51-61" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimation results for equation DLINPC_G: </span></span>
<span id="cb51-62"><a href="#cb51-62" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ========================================= </span></span>
<span id="cb51-63"><a href="#cb51-63" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLINPC_G = DLINPC_G.l1 + DLTC_G.l1 + DLCETE28_G.l1 + DLIGAE_G.l1 + DLIPI_G.l1 + DLINPC_G.l2 + DLTC_G.l2 + DLCETE28_G.l2 + DLIGAE_G.l2 + DLIPI_G.l2 + const </span></span>
<span id="cb51-64"><a href="#cb51-64" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-65"><a href="#cb51-65" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                 Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb51-66"><a href="#cb51-66" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLINPC_G.l1    0.3794127  0.0660203   5.747 2.69e-08 ***</span></span>
<span id="cb51-67"><a href="#cb51-67" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLTC_G.l1      0.0036715  0.0052749   0.696    0.487    </span></span>
<span id="cb51-68"><a href="#cb51-68" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLCETE28_G.l1 -0.0003844  0.0020534  -0.187    0.852    </span></span>
<span id="cb51-69"><a href="#cb51-69" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIGAE_G.l1    0.0042967  0.0176732   0.243    0.808    </span></span>
<span id="cb51-70"><a href="#cb51-70" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIPI_G.l1    -0.0154936  0.0105907  -1.463    0.145    </span></span>
<span id="cb51-71"><a href="#cb51-71" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLINPC_G.l2   -0.0408406  0.0667181  -0.612    0.541    </span></span>
<span id="cb51-72"><a href="#cb51-72" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLTC_G.l2      0.0057580  0.0051995   1.107    0.269    </span></span>
<span id="cb51-73"><a href="#cb51-73" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLCETE28_G.l2  0.0015534  0.0020603   0.754    0.452    </span></span>
<span id="cb51-74"><a href="#cb51-74" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIGAE_G.l2   -0.0059282  0.0170903  -0.347    0.729    </span></span>
<span id="cb51-75"><a href="#cb51-75" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIPI_G.l2     0.0042370  0.0105063   0.403    0.687    </span></span>
<span id="cb51-76"><a href="#cb51-76" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; const          0.0023632  0.0003116   7.583 6.97e-13 ***</span></span>
<span id="cb51-77"><a href="#cb51-77" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb51-78"><a href="#cb51-78" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb51-79"><a href="#cb51-79" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb51-80"><a href="#cb51-80" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-81"><a href="#cb51-81" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-82"><a href="#cb51-82" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.002139 on 245 degrees of freedom</span></span>
<span id="cb51-83"><a href="#cb51-83" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-Squared: 0.1493,  Adjusted R-squared: 0.1146 </span></span>
<span id="cb51-84"><a href="#cb51-84" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic:   4.3 on 10 and 245 DF,  p-value: 1.531e-05 </span></span>
<span id="cb51-85"><a href="#cb51-85" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-86"><a href="#cb51-86" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-87"><a href="#cb51-87" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimation results for equation DLTC_G: </span></span>
<span id="cb51-88"><a href="#cb51-88" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ======================================= </span></span>
<span id="cb51-89"><a href="#cb51-89" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLTC_G = DLINPC_G.l1 + DLTC_G.l1 + DLCETE28_G.l1 + DLIGAE_G.l1 + DLIPI_G.l1 + DLINPC_G.l2 + DLTC_G.l2 + DLCETE28_G.l2 + DLIGAE_G.l2 + DLIPI_G.l2 + const </span></span>
<span id="cb51-90"><a href="#cb51-90" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-91"><a href="#cb51-91" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span id="cb51-92"><a href="#cb51-92" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLINPC_G.l1   -3.221572   0.887833  -3.629 0.000347 ***</span></span>
<span id="cb51-93"><a href="#cb51-93" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLTC_G.l1      0.284813   0.070937   4.015 7.91e-05 ***</span></span>
<span id="cb51-94"><a href="#cb51-94" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLCETE28_G.l1 -0.038985   0.027613  -1.412 0.159270    </span></span>
<span id="cb51-95"><a href="#cb51-95" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIGAE_G.l1   -0.035047   0.237666  -0.147 0.882889    </span></span>
<span id="cb51-96"><a href="#cb51-96" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIPI_G.l1     0.207555   0.142422   1.457 0.146309    </span></span>
<span id="cb51-97"><a href="#cb51-97" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLINPC_G.l2    1.185665   0.897215   1.321 0.187569    </span></span>
<span id="cb51-98"><a href="#cb51-98" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLTC_G.l2     -0.186162   0.069922  -2.662 0.008271 ** </span></span>
<span id="cb51-99"><a href="#cb51-99" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLCETE28_G.l2  0.034580   0.027707   1.248 0.213211    </span></span>
<span id="cb51-100"><a href="#cb51-100" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIGAE_G.l2   -0.287855   0.229828  -1.252 0.211590    </span></span>
<span id="cb51-101"><a href="#cb51-101" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIPI_G.l2     0.046610   0.141287   0.330 0.741761    </span></span>
<span id="cb51-102"><a href="#cb51-102" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; const          0.010145   0.004191   2.421 0.016220 *  </span></span>
<span id="cb51-103"><a href="#cb51-103" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb51-104"><a href="#cb51-104" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb51-105"><a href="#cb51-105" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb51-106"><a href="#cb51-106" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-107"><a href="#cb51-107" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-108"><a href="#cb51-108" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.02877 on 245 degrees of freedom</span></span>
<span id="cb51-109"><a href="#cb51-109" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-Squared: 0.1237,  Adjusted R-squared: 0.08789 </span></span>
<span id="cb51-110"><a href="#cb51-110" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 3.457 on 10 and 245 DF,  p-value: 0.0002874 </span></span>
<span id="cb51-111"><a href="#cb51-111" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-112"><a href="#cb51-112" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-113"><a href="#cb51-113" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimation results for equation DLCETE28_G: </span></span>
<span id="cb51-114"><a href="#cb51-114" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; =========================================== </span></span>
<span id="cb51-115"><a href="#cb51-115" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLCETE28_G = DLINPC_G.l1 + DLTC_G.l1 + DLCETE28_G.l1 + DLIGAE_G.l1 + DLIPI_G.l1 + DLINPC_G.l2 + DLTC_G.l2 + DLCETE28_G.l2 + DLIGAE_G.l2 + DLIPI_G.l2 + const </span></span>
<span id="cb51-116"><a href="#cb51-116" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-117"><a href="#cb51-117" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb51-118"><a href="#cb51-118" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLINPC_G.l1    3.547010   2.044696   1.735   0.0840 .</span></span>
<span id="cb51-119"><a href="#cb51-119" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLTC_G.l1      0.106557   0.163369   0.652   0.5149  </span></span>
<span id="cb51-120"><a href="#cb51-120" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLCETE28_G.l1  0.106108   0.063594   1.669   0.0965 .</span></span>
<span id="cb51-121"><a href="#cb51-121" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIGAE_G.l1   -0.124387   0.547350  -0.227   0.8204  </span></span>
<span id="cb51-122"><a href="#cb51-122" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIPI_G.l1     0.269513   0.328001   0.822   0.4121  </span></span>
<span id="cb51-123"><a href="#cb51-123" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLINPC_G.l2   -3.562148   2.066305  -1.724   0.0860 .</span></span>
<span id="cb51-124"><a href="#cb51-124" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLTC_G.l2      0.128717   0.161031   0.799   0.4249  </span></span>
<span id="cb51-125"><a href="#cb51-125" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLCETE28_G.l2  0.038798   0.063810   0.608   0.5437  </span></span>
<span id="cb51-126"><a href="#cb51-126" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIGAE_G.l2    0.870921   0.529299   1.645   0.1012  </span></span>
<span id="cb51-127"><a href="#cb51-127" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIPI_G.l2    -0.116675   0.325388  -0.359   0.7202  </span></span>
<span id="cb51-128"><a href="#cb51-128" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; const         -0.005317   0.009652  -0.551   0.5822  </span></span>
<span id="cb51-129"><a href="#cb51-129" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb51-130"><a href="#cb51-130" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb51-131"><a href="#cb51-131" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb51-132"><a href="#cb51-132" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-133"><a href="#cb51-133" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-134"><a href="#cb51-134" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.06626 on 245 degrees of freedom</span></span>
<span id="cb51-135"><a href="#cb51-135" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-Squared: 0.06876, Adjusted R-squared: 0.03075 </span></span>
<span id="cb51-136"><a href="#cb51-136" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 1.809 on 10 and 245 DF,  p-value: 0.05961 </span></span>
<span id="cb51-137"><a href="#cb51-137" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-138"><a href="#cb51-138" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-139"><a href="#cb51-139" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimation results for equation DLIGAE_G: </span></span>
<span id="cb51-140"><a href="#cb51-140" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ========================================= </span></span>
<span id="cb51-141"><a href="#cb51-141" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIGAE_G = DLINPC_G.l1 + DLTC_G.l1 + DLCETE28_G.l1 + DLIGAE_G.l1 + DLIPI_G.l1 + DLINPC_G.l2 + DLTC_G.l2 + DLCETE28_G.l2 + DLIGAE_G.l2 + DLIPI_G.l2 + const </span></span>
<span id="cb51-142"><a href="#cb51-142" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-143"><a href="#cb51-143" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb51-144"><a href="#cb51-144" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLINPC_G.l1    1.184559   0.461082   2.569   0.0108 *</span></span>
<span id="cb51-145"><a href="#cb51-145" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLTC_G.l1     -0.063718   0.036840  -1.730   0.0850 .</span></span>
<span id="cb51-146"><a href="#cb51-146" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLCETE28_G.l1  0.008687   0.014341   0.606   0.5452  </span></span>
<span id="cb51-147"><a href="#cb51-147" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIGAE_G.l1   -0.184057   0.123428  -1.491   0.1372  </span></span>
<span id="cb51-148"><a href="#cb51-148" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIPI_G.l1     0.135931   0.073965   1.838   0.0673 .</span></span>
<span id="cb51-149"><a href="#cb51-149" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLINPC_G.l2   -1.042586   0.465955  -2.238   0.0262 *</span></span>
<span id="cb51-150"><a href="#cb51-150" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLTC_G.l2      0.022293   0.036313   0.614   0.5398  </span></span>
<span id="cb51-151"><a href="#cb51-151" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLCETE28_G.l2 -0.018839   0.014389  -1.309   0.1917  </span></span>
<span id="cb51-152"><a href="#cb51-152" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIGAE_G.l2   -0.272896   0.119358  -2.286   0.0231 *</span></span>
<span id="cb51-153"><a href="#cb51-153" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIPI_G.l2     0.132921   0.073375   1.812   0.0713 .</span></span>
<span id="cb51-154"><a href="#cb51-154" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; const          0.001485   0.002176   0.682   0.4958  </span></span>
<span id="cb51-155"><a href="#cb51-155" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb51-156"><a href="#cb51-156" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb51-157"><a href="#cb51-157" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb51-158"><a href="#cb51-158" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-159"><a href="#cb51-159" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-160"><a href="#cb51-160" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.01494 on 245 degrees of freedom</span></span>
<span id="cb51-161"><a href="#cb51-161" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-Squared: 0.1046,  Adjusted R-squared: 0.06802 </span></span>
<span id="cb51-162"><a href="#cb51-162" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 2.861 on 10 and 245 DF,  p-value: 0.002173 </span></span>
<span id="cb51-163"><a href="#cb51-163" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-164"><a href="#cb51-164" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-165"><a href="#cb51-165" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Estimation results for equation DLIPI_G: </span></span>
<span id="cb51-166"><a href="#cb51-166" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ======================================== </span></span>
<span id="cb51-167"><a href="#cb51-167" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIPI_G = DLINPC_G.l1 + DLTC_G.l1 + DLCETE28_G.l1 + DLIGAE_G.l1 + DLIPI_G.l1 + DLINPC_G.l2 + DLTC_G.l2 + DLCETE28_G.l2 + DLIGAE_G.l2 + DLIPI_G.l2 + const </span></span>
<span id="cb51-168"><a href="#cb51-168" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-169"><a href="#cb51-169" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;                Estimate Std. Error t value Pr(&gt;|t|)  </span></span>
<span id="cb51-170"><a href="#cb51-170" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLINPC_G.l1    2.061526   0.801864   2.571   0.0107 *</span></span>
<span id="cb51-171"><a href="#cb51-171" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLTC_G.l1     -0.081057   0.064068  -1.265   0.2070  </span></span>
<span id="cb51-172"><a href="#cb51-172" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLCETE28_G.l1 -0.005573   0.024940  -0.223   0.8234  </span></span>
<span id="cb51-173"><a href="#cb51-173" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIGAE_G.l1    0.454249   0.214653   2.116   0.0353 *</span></span>
<span id="cb51-174"><a href="#cb51-174" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIPI_G.l1    -0.270920   0.128631  -2.106   0.0362 *</span></span>
<span id="cb51-175"><a href="#cb51-175" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLINPC_G.l2   -1.639854   0.810338  -2.024   0.0441 *</span></span>
<span id="cb51-176"><a href="#cb51-176" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLTC_G.l2      0.066871   0.063151   1.059   0.2907  </span></span>
<span id="cb51-177"><a href="#cb51-177" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLCETE28_G.l2 -0.026739   0.025024  -1.069   0.2863  </span></span>
<span id="cb51-178"><a href="#cb51-178" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIGAE_G.l2   -0.196948   0.207574  -0.949   0.3437  </span></span>
<span id="cb51-179"><a href="#cb51-179" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIPI_G.l2    -0.013132   0.127607  -0.103   0.9181  </span></span>
<span id="cb51-180"><a href="#cb51-180" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; const         -0.001787   0.003785  -0.472   0.6373  </span></span>
<span id="cb51-181"><a href="#cb51-181" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; ---</span></span>
<span id="cb51-182"><a href="#cb51-182" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Signif. codes:  </span></span>
<span id="cb51-183"><a href="#cb51-183" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</span></span>
<span id="cb51-184"><a href="#cb51-184" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-185"><a href="#cb51-185" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-186"><a href="#cb51-186" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Residual standard error: 0.02598 on 245 degrees of freedom</span></span>
<span id="cb51-187"><a href="#cb51-187" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Multiple R-Squared: 0.09088, Adjusted R-squared: 0.05377 </span></span>
<span id="cb51-188"><a href="#cb51-188" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; F-statistic: 2.449 on 10 and 245 DF,  p-value: 0.008383 </span></span>
<span id="cb51-189"><a href="#cb51-189" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-190"><a href="#cb51-190" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-191"><a href="#cb51-191" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-192"><a href="#cb51-192" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Covariance matrix of residuals:</span></span>
<span id="cb51-193"><a href="#cb51-193" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;              DLINPC_G     DLTC_G DLCETE28_G   DLIGAE_G</span></span>
<span id="cb51-194"><a href="#cb51-194" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLINPC_G    4.577e-06 -3.256e-06  4.284e-07  6.192e-06</span></span>
<span id="cb51-195"><a href="#cb51-195" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLTC_G     -3.256e-06  8.276e-04  3.273e-04 -1.598e-04</span></span>
<span id="cb51-196"><a href="#cb51-196" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLCETE28_G  4.284e-07  3.273e-04  4.390e-03  7.695e-05</span></span>
<span id="cb51-197"><a href="#cb51-197" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIGAE_G    6.192e-06 -1.598e-04  7.695e-05  2.232e-04</span></span>
<span id="cb51-198"><a href="#cb51-198" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIPI_G     1.433e-05 -3.145e-04  1.211e-04  3.354e-04</span></span>
<span id="cb51-199"><a href="#cb51-199" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;               DLIPI_G</span></span>
<span id="cb51-200"><a href="#cb51-200" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLINPC_G    1.433e-05</span></span>
<span id="cb51-201"><a href="#cb51-201" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLTC_G     -3.145e-04</span></span>
<span id="cb51-202"><a href="#cb51-202" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLCETE28_G  1.211e-04</span></span>
<span id="cb51-203"><a href="#cb51-203" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIGAE_G    3.354e-04</span></span>
<span id="cb51-204"><a href="#cb51-204" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIPI_G     6.751e-04</span></span>
<span id="cb51-205"><a href="#cb51-205" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; </span></span>
<span id="cb51-206"><a href="#cb51-206" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; Correlation matrix of residuals:</span></span>
<span id="cb51-207"><a href="#cb51-207" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt;             DLINPC_G   DLTC_G DLCETE28_G DLIGAE_G  DLIPI_G</span></span>
<span id="cb51-208"><a href="#cb51-208" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLINPC_G    1.000000 -0.05291   0.003022  0.19372  0.25782</span></span>
<span id="cb51-209"><a href="#cb51-209" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLTC_G     -0.052911  1.00000   0.171697 -0.37187 -0.42073</span></span>
<span id="cb51-210"><a href="#cb51-210" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLCETE28_G  0.003022  0.17170   1.000000  0.07774  0.07033</span></span>
<span id="cb51-211"><a href="#cb51-211" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIGAE_G    0.193715 -0.37187   0.077740  1.00000  0.86403</span></span>
<span id="cb51-212"><a href="#cb51-212" aria-hidden="true" tabindex="-1"></a><span class="co">#&gt; DLIPI_G     0.257823 -0.42073   0.070327  0.86403  1.00000</span></span>
<span id="cb51-213"><a href="#cb51-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-214"><a href="#cb51-214" aria-hidden="true" tabindex="-1"></a><span class="co">#Impulse response</span></span>
<span id="cb51-215"><a href="#cb51-215" aria-hidden="true" tabindex="-1"></a>IR_DLINPC <span class="ot">&lt;-</span> <span class="fu">irf</span>(VAR_p, <span class="at">n.ahead =</span> <span class="dv">12</span>, <span class="at">boot =</span> <span class="cn">TRUE</span>, </span>
<span id="cb51-216"><a href="#cb51-216" aria-hidden="true" tabindex="-1"></a>                 <span class="at">ci =</span> <span class="fl">0.95</span>, <span class="at">response =</span> <span class="st">&quot;DLINPC_G&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Al correr esta línea de codigo se obtienen los </span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="co">#plots correspondientes a la tabla 6.7</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="co">#plot(IR_DLINPC)</span></span></code></pre></div>
<table>
<caption>(#tab:IRVARTC) Gráficas de Impulso-respuesta de la serie <span class="math inline">\(DLTC_t\)</span> ante cambios en los residuales del resto de las series y de la propia serie.</caption>
<colgroup>
<col width="50%" />
<col width="50%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="center"><img src="imagenes/IR_DLTC_1.png" width="350" /></td>
<td align="center"><img src="imagenes/IR_DLTC_2.png" width="350" /></td>
</tr>
<tr class="even">
<td align="center"><img src="imagenes/IR_DLTC_3.png" width="350" /></td>
<td align="center"><img src="imagenes/IR_DLTC_4.png" width="350" /></td>
</tr>
<tr class="odd">
<td align="center"><img src="imagenes/IR_DLTC_5.png" width="350" /></td>
<td align="center"></td>
</tr>
</tbody>
</table>
<p>Los resultados muestran que la respuesta de <span class="math inline">\(DLTC_t\)</span> ante impulsos en los términos de error fue estadísticamente significativo sólo para alguunos de los casos y en periodos cortos de tiempo. El resto de los resultados de Impulso-Respuesta se encuentra en el Scrip llamado Clase 15 que se ubica en el repositorio de GitHub.</p>
<!--chapter:end:05-VAR.Rmd-->
</div>
</div>
<div id="procesos-no-estacionarios" class="section level1" number="7">
<h1><span class="header-section-number">7</span> Procesos No Estacionarios</h1>
<div id="definición-y-formas-de-no-estacionariedad" class="section level2" number="7.1">
<h2><span class="header-section-number">7.1</span> Definición y formas de No Estacionariedad</h2>
<p>Hasta ahora hemos planteado una serie de ténicas de regresión que aplican sólo a procesos o series estacionarias. En esta sección relajaremos la definición de estacionariedad y plantearemos pruebas para determinar cuando una serie es estacionaria bajo tres diferentes especificiones: (1) estacionariedad al rededor de una tendencia determinística; (2) estacionariedad al rededor de una media, y (3) estacionariedad al rededor del cero.</p>
<p>A continuación discutiremos cómo es posible que una serie sea estacionaria al rededor de una tendencia determinística. Diremos que una tendencia es determinística si ésta puede ser aproximada o modelada por un polinomio en función de <span class="math inline">\(t\)</span>, la cual incluye posibles transformaciones logarítmicas.</p>
<p>Bajo este enfoque, el proceso está lejos de cumplir con la defición de estacionariedad que hemos establecido en capítulos previos, pero relajaremos el supuesto y reconoceremos que una serie puede ser estacionaria en varianza bajo una tendencia determinística. Así, diremos que la serie será descrita por una ecuación dada por:
<span class="math display">\[\begin{equation}
    Y_t = \sum^m_{j = 0} \delta_j t^j + X_t
    (\#eq:YTrend)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(X_t\)</span> es un proceso <span class="math inline">\(ARMA(p, q)\)</span> con media cero, que se puede ver como:
<span class="math display">\[\begin{equation}
    \alpha(L) X_t = \beta(L) U_t
        (\#eq:YTrend1)
\end{equation}\]</span></p>
<p>Entonces, los momentos y variaza de la ecuación @ref(eq:YTrend) estaran dados por:
<span class="math display">\[\begin{equation}
    \mathbb{E}[Y_t] = \sum^m_{j = 0} \delta_j t^j = \mu_t
        (\#eq:ETrend)
\end{equation}\]</span></p>
<p>Dada la ecuación (@ref(eq:ETrend) podemos plantear la siguiente ecuación de covarainzas:
<span class="math display">\[\begin{eqnarray}
    \mathbb{E}[(Y_t - \mu_t) \cdot (Y_{t+\tau} - \mu_{t+\tau})] &amp; = &amp; \mathbb{E}[X_t \cdot X_{t+\tau}] \nonumber \\
    &amp; = &amp; \gamma_X(\tau)
            (\#eq:CovTrend)
\end{eqnarray}\]</span></p>
<p>Utilizando el resultado de la ecuación @ref(eq:CovTrend) podemos establecer que:
<span class="math display">\[\begin{equation}
    \mathbb{E}[(Y_t - \mu_t)^2] = \mathbb{E}[X_t^2] = \sigma_X^2
(\#eq:VarTrend)
\end{equation}\]</span></p>
<p>Así, las ecuaciones @ref(eq:ETrend) y @ref(eq:VarTrend) significan que el proceso descrito por la ecuación @ref(eq:YTrend) es estacionario pero en varianza. De esta forma a partir de este momento diremos que una serie será estacionaria al rededor de una tendencia determinística si cumple con las condiciones establecidas en las ecuaciones @ref(eq:ETrend), @ref(eq:VarTrend) y @ref(eq:YTrend).</p>
<p>Dicho lo anterior estudiaremos el concepto de raíz unitaria de un proceso estocástico o de una serie de tiempo. Partamos de platear que un proceso AR(1) tiene raíz unitaria cuando el cual el coeficiente <span class="math inline">\(a_1 = 1\)</span>, es decir:
<span class="math display">\[\begin{equation}
    Y_t = Y_{t-1} + U_t
    (\#eq:UR1)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso pueramente aleatorio con media cero, varianza constante y autocovarianza cero (0), al cual nos referiremos simplemente como ruido blanco. Supongamos ahora que incluímos un término constante en la ecuación @ref(eq:UR1), de forma que tenemos:
<span class="math display">\[\begin{equation}
    Y_t = \delta + Y_{t-1} + U_t
    (\#eq:UR2)
\end{equation}\]</span></p>
<p>Tomando a la ecuación @ref(eq:UR2) y suponiendo que existe un valor inicial <span class="math inline">\(Y_0\)</span> de la serie podemos plantear la sguiente secuencia de expresiones:
<span class="math display">\[\begin{eqnarray*}
    Y_1 &amp; = &amp; \delta + Y_0 + U_1 \\
    Y_2 &amp; = &amp; \delta + Y_1 + U_2 \\
    &amp; = &amp; \delta + (\delta + Y_0 + U_1) + U_2 \\
    &amp; = &amp; 2 \times \delta + Y_0 + U_1 + U_2
\end{eqnarray*}\]</span></p>
<p>Si repitieramos la sustitución sucesiva anterior hasta el momento <span class="math inline">\(t\)</span> encontrariamos que la ecuación de la solución general que describe a un <span class="math inline">\(AR(1)\)</span> con término constante que tiene raíz unitaria es de la forma:
<span class="math display">\[\begin{equation}
    Y_t = t \delta + Y_0 + \sum_{i=1}^t U_i
    (\#eq:UR3)
\end{equation}\]</span></p>
<p>La ecuación @ref(eq:UR3) es equivalente a la ecuación @ref(eq:YTrend). A la ecuación @ref(eq:UR3) también se le conoce como proceso con Drift o con término constante, indistintamente, ya que el componente de Drift suele asociarse a la posibilidad de incorporar el efecto de los residuales pasados, lo cual es posible simplemente agregando una constante.s</p>
<p>Si revisamos el comportamiento de sus momentos y varianza de la ecuación @ref(eq:UR3) encontramos que:
<span class="math display">\[\begin{eqnarray*}
    \mathbb{E}[Y_t] &amp; = &amp; Y_0 + \delta t = \mu_t \\
    Var[Y_t] &amp; = &amp; t \sigma^2 = \gamma(0, t) \\
    Cov(Y_t, Y_{t+\tau}) &amp; = &amp; (t - \tau) \sigma^2 = \gamma(t, \tau)
\end{eqnarray*}\]</span></p>
<p>De esta forma, la ecuación @ref(eq:UR3) no describe un proceso estacionario, sólo podría ser estacionario si <span class="math inline">\(t = 1\)</span>, en cualquier otro caso sería no estacionario en varianza. Ahora hagamos un resumen y acordemos notación que se utilizará en esta sección. Supongamos un proceso o serie de tiempo que es decrito por la siguiente ecuación:
<span class="math display">\[\begin{equation}
    Y_t = \delta + Y_{t-1} + X_t
    (\#eq:UR4)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(X_t\)</span> es un <span class="math inline">\(ARMA(p, q)\)</span> con media cero. Si definimos a <span class="math inline">\(\Delta Y_t = Y_t - Y_{t-1}\)</span>, entonces la ecuación @ref(eq:UR4) la podemos escribir como:
<span class="math display">\[\begin{equation}
    \Delta Y_t = \delta + X_t
    (\#eq:UR5)
\end{equation}\]</span></p>
<p>A la ecuación @ref(eq:UR5) la denominaremos como un proceso estacionario en diferencias o simplemente como un proceso integrado. Así utilizaremos la siguiente definición.</p>
<p>Sea un proceso estocástico <span class="math inline">\(Y\)</span>, decimos que este es integrado de orden <span class="math inline">\(d\)</span>, <span class="math inline">\(I(d)\)</span>, si este puede transformarse a uno estacionacionario, que sea invertible, mediante la diferenciación del mismo <span class="math inline">\(d\)</span>-veces, es decir:
<span class="math display">\[\begin{equation}
    (1 - L)^d Y_t = \delta + X_t
    (\#eq:UR6)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(X_t\)</span> es un proceso <span class="math inline">\(ARMA(p, q)\)</span>. De lo cual se infiere que en la ecuación @ref(eq:UR6) <span class="math inline">\(Y_t\)</span> será una <span class="math inline">\(ARIMA(p, d, q)\)</span>, el cual contiene <span class="math inline">\(d\)</span> raíces unitarias. A estos procesos también se les conoce como procesos con tendencia estocástica.</p>
<p>Dada la discusión annterior, a continuación platearemos un resumen de cuales son los dos casos a los cuales nos referiremos como procesos que no son estacionarios en media, pero que si lo son en varianza. Estos casos son:
<span class="math display">\[\begin{eqnarray}
    Y_t &amp; = &amp; Y_0 + \delta t + U_t \\
        (\#eq:ARR1)
\end{eqnarray}\]</span></p>
<p><span class="math display">\[\begin{eqnarray}
    Y_t &amp; = &amp; Y_0 + \delta + \sum_{i = 1}^t U_t
            (\#eq:ARR2)
\end{eqnarray}\]</span></p>
<p>Ambos casos no son estacionarios en media, pero si lo son en varianza. De ambos podemos decir que los choques o innovaciones del término de error tienen un efecto transitorio en el primero, pero permanentes en el segundo.</p>
</div>
<div id="pruebas-de-raíces-unitarias" class="section level2" number="7.2">
<h2><span class="header-section-number">7.2</span> Pruebas de Raíces Unitarias</h2>
<p>En esta sección plantearemos una serie de pruebas estadísticas para determinar cuando una serie puede ser estacionaria bajo tres posibles casos: (1) estacionariedad al rededor de una tendencia determinística; (2) estacionariedad al rededor de una media, y (3) estacionariedad al rededor del cero.</p>
</div>
<div id="dickey---fuller-df" class="section level2" number="7.3">
<h2><span class="header-section-number">7.3</span> Dickey - Fuller (DF)</h2>
<p>Partamos de una forma del proceso <span class="math inline">\(Y_t\)</span> dada por:
<span class="math display">\[\begin{equation}
    Y_t = \sum_{j = 0}^m \delta_j t^j + X_t
(\#eq:URDFG)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(X_t\)</span> es un <span class="math inline">\(ARMA(p, q)\)</span> con media cero. Esta prueba asume que <span class="math inline">\(m = 1\)</span>, por lo que utilizaremos un modelo del tipo:
<span class="math display">\[\begin{equation}
    Y_t = \alpha + \delta t + \rho Y_{t-1} + U_t
    (\#eq:URDF)
\end{equation}\]</span></p>
<p>Si, el <span class="math inline">\(AR(1)\)</span> planteado tiene raíz unitaria, es decir, <span class="math inline">\(\rho = 1\)</span>, entonces tendríamos:
<span class="math display">\[\begin{eqnarray*}
    Y_t &amp; = &amp; \alpha + \delta t + Y_{t-1} + U_t \\
    \Delta Y_t &amp; = &amp; \alpha + \delta t + U_t
\end{eqnarray*}\]</span></p>
<p>De esta forma, para determinar si una serie tiene raíz unitaria basta con probar la hipótesis nula de que <span class="math inline">\(H_0 : \rho = 1\)</span>, junto con las diferentes combinaciones que impliquen restricciones respecto a <span class="math inline">\(\delta\)</span> y <span class="math inline">\(\alpha\)</span>.</p>
<p>En resumen, la prueba DF consiste en asumir un modelo general dado por la ecuación @ref(eq:URDF) y probar tres especificaciones distintas que serían válidas bajo <span class="math inline">\(H_0 : \rho = 1\)</span>:</p>
<ol style="list-style-type: decimal">
<li><p>Modelo A: con intercepto y tendencia:
<span class="math display">\[\begin{equation*}
     \Delta Y_t = \alpha + \delta t + \beta Y_{t-1} + U_t
\end{equation*}\]</span>
Buscamos probar si <span class="math inline">\(H_0 : \beta = \rho - 1 = 0\)</span> contra <span class="math inline">\(H_a : \beta &lt; 0\)</span>, por lo que es una prueba de una cola. Otra forma de decirlo, es probamos si el proceso tiene raíz unitaria contra si el proceso es estacionario al rededor de una tendencia determinística.</p></li>
<li><p>Modelo B: con intercepto:
<span class="math display">\[\begin{equation*}
     \Delta Y_t = \alpha + \beta Y_{t-1} + U_t
\end{equation*}\]</span>
Buscamos probar si <span class="math inline">\(H_0 : \beta = \rho - 1 = 0\)</span> contra <span class="math inline">\(H_a : \beta &lt; 0\)</span>, por lo que es una prueba de una cola. Otra forma de decirlo, es probamos si el proceso tiene raíz unitaria contra si el proceso es estacionario al rededor de una constante.</p></li>
<li><p>Modelo C: sin intercepto y tendencia:
<span class="math display">\[\begin{equation*}
     \Delta Y_t = \beta Y_{t-1} + U_t
\end{equation*}\]</span>
Buscamos probar si <span class="math inline">\(H_0 : \beta = \rho - 1 = 0\)</span> contra <span class="math inline">\(H_a : \beta &lt; 0\)</span>, por lo que es una prueba de una cola. Otra forma de decirlo, es probamos si el proceso tiene raíz unitaria contra si el proceso es estacionario sin considerar una constante o una tendencia determinística, es decir, es un proceso puramente aleatorio.</p></li>
</ol>
<div id="dickey---fuller-aumentada-adf" class="section level3" number="7.3.1">
<h3><span class="header-section-number">7.3.1</span> Dickey - Fuller Aumentada (ADF)</h3>
<p>A diferencia de un modelo AR(1) para el caso de una prueba DF como en la ecuación @ref(eq:URDF), en una prueba ADF se asume que el proceso es un AR(p) de la forma (por simplicidad hemos omitido el término constante y el término de tendencia determinística):</p>
<p><span class="math display">\[\begin{equation}
    Y_t = a_1 Y_{t-1} + a_2 Y_{t-2} + \ldots + a_p Y_{t-p} + U_t
    (\#eq:URADF)
\end{equation}\]</span></p>
<p>Haciendo una sustitución de términos similar a las que hemos planteado en otras secciones podemos reexpresar la ecuación @ref(eq:URADF) en su versión en diferencias siguiendo el proceso:
<span class="math display">\[\begin{equation}
    Y_t = \rho Y_{t-1} + \theta_1 \Delta Y_{t-1} + \theta_2 \Delta Y_{t-2} + \ldots + + \theta_{p-1} \Delta Y_{t-p+1} + U_t
                (\#eq:ARR3)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\rho = \theta_0 = \sum_{j = 1}^p a_j\)</span>, <span class="math inline">\(\theta_i = - \sum_{j = i + 1}^p a_j\)</span>, <span class="math inline">\(i = 1, 2, \ldots, p-1\)</span>. Así, si el proceso AR(p) tiene raíz unitaria entonces ceremos que:
<span class="math display">\[\begin{eqnarray*}
    1 - a_1 - a_2 - \ldots - a_p &amp; = &amp; 0 \\
    \rho &amp; = &amp; 1
\end{eqnarray*}\]</span></p>
<p>De donde podemos establecer que el modelo general de una prueba ADF será:
<span class="math display">\[\begin{equation}
    \Delta Y_{t-1} = \alpha + \beta t + (\rho - 1) Y_{t-1} + \theta_1 \Delta Y_{t-1} + \theta_2 \Delta Y_{t-2} + \ldots + \theta_k \Delta Y_{t-k} + U_t
            (\#eq:ARR4)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio y <span class="math inline">\(k\)</span> es elegido de tal manera que los residuales sean un proceso puramente aleatorio. En resumen, la prueba DF consiste en asumir un modelo general dado por la ecuación @ref(eq:URADF), que incluya constante y tendencia, y probar tres especificaciones distintas que serían válidas bajo <span class="math inline">\(H_0 : \rho = 1\)</span>:</p>
<ol style="list-style-type: decimal">
<li><p>Modelo A: con intercepto y tendencia:
<span class="math display">\[\begin{equation*}
     \Delta Y_t = \alpha + \delta t + \beta Y_{t-1} + \theta_1 \Delta Y_{t-1} + \theta_2 \Delta Y_{t-2} + \ldots + \theta_{p-1} \Delta Y_{t-p+1} + U_t
\end{equation*}\]</span>
Buscamos probar si <span class="math inline">\(H_0 : \beta = \rho - 1 = 0\)</span> contra <span class="math inline">\(H_a : \beta &lt; 0\)</span>, por lo que es una prueba de una cola. Otra forma de decirlo, es probamos si el proceso tiene raíz unitaria contra si el proceso es estacionario al rededor de una tendencia determinística.</p></li>
<li><p>Modelo B: con intercepto:
<span class="math display">\[\begin{equation*}
     \Delta Y_t = \alpha + \beta Y_{t-1} + \theta_1 \Delta Y_{t-1} + \theta_2 \Delta Y_{t-2} + \ldots + \theta_{p-1} \Delta Y_{t-p+1} + U_t
\end{equation*}\]</span>
Buscamos probar si <span class="math inline">\(H_0 : \beta = \rho - 1 = 0\)</span> contra <span class="math inline">\(H_a : \beta &lt; 0\)</span>, por lo que es una prueba de una cola. Otra forma de decirlo, es probamos si el proceso tiene raíz unitaria contra si el proceso es estacionario al rededor de una constante.</p></li>
<li><p>Modelo C: sin intercepto y tendencia:
<span class="math display">\[\begin{equation*}
     \Delta Y_t = \beta Y_{t-1} + \theta_1 \Delta Y_{t-1} + \theta_2 \Delta Y_{t-2} + \ldots + \theta_{p-1} \Delta Y_{t-p+1} + U_t
\end{equation*}\]</span>
Buscamos probar si <span class="math inline">\(H_0 : \beta = \rho - 1 = 0\)</span> contra <span class="math inline">\(H_a : \beta &lt; 0\)</span>, por lo que es una prueba de una cola. Otra forma de decirlo, es probamos si el proceso tiene raíz unitaria contra si el proceso es estacionario sin considerar una constante o una tendencia determinística, es decir, es un proceso puramente aleatorio.</p></li>
</ol>
</div>
<div id="phillips---perron-pp" class="section level3" number="7.3.2">
<h3><span class="header-section-number">7.3.2</span> Phillips - Perron (PP)</h3>
<p>Una tercera prueba es la de PP, la cual también está basada en una AR(1) dado por la ecuación:
<span class="math display">\[\begin{equation}
    Y_t = d \eta + \rho Y_{t-1} + U_t
    (\#eq:URPP)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(d\)</span> incluye a cualquiera de los componentes determinísticos como constante y tendencia. Al igual que los casos pasados, la hipótesis a probar era <span class="math inline">\(H_0 : \rho = 1\)</span> contra la alternativa <span class="math inline">\(H_a : |{\rho}| &lt; 1\)</span>, y asumimos una estructura MA(q) es el término de error de la forma <span class="math inline">\(U_t = \psi(L) \varepsilon_t = \psi_0 \varepsilon_t + \psi_1 \varepsilon_{t-1} + \ldots + \psi_p \varepsilon_{t-p}\)</span>, con <span class="math inline">\(\varepsilon_t\)</span> es un ruido blanco con media cero y varianza <span class="math inline">\(\sigma^2\)</span>. En este modelo se elige el valor <span class="math inline">\(p\)</span> que hace que el componente sea un MA(p). Las tablas estadísticas de PP para esta prueba pueden utilizar una estadística <span class="math inline">\(Z_\tau\)</span> o <span class="math inline">\(Z_\rho\)</span>, las cuales se pueden emplear indistintamente.</p>
<p>En resumen, la prueba PP consiste en asumir un modelo general dado por la ecuación @ref(eq:URPP) y probar dos especificaciones distintas que serían válidas bajo <span class="math inline">\(H_0 : \rho = 1\)</span>, ambas considerando un compenente Drift:</p>
<ol style="list-style-type: decimal">
<li><p>Modelo A: con intercepto y tendencia:
<span class="math display">\[\begin{equation*}
     Y_t = \alpha + \delta t + \rho Y_{t-1} + U_t
\end{equation*}\]</span>
Buscamos probar si <span class="math inline">\(H_0 : \rho = 1\)</span> contra <span class="math inline">\(H_a : |{\rho}| &lt; 1\)</span>, por lo que es una prueba de una cola. Otra forma de decirlo, es probamos si el proceso tiene raíz unitaria contra si el proceso es estacionario al rededor de una tendencia determinística.</p></li>
<li><p>Modelo B: con intercepto:
<span class="math display">\[\begin{equation*}
     Y_t = \alpha + \rho Y_{t-1} + U_t
\end{equation*}\]</span>
Buscamos probar si <span class="math inline">\(H_0 : \rho = 1\)</span> contra <span class="math inline">\(H_a : |{\rho}| &lt; 1\)</span>, por lo que es una prueba de una cola. Otra forma de decirlo, es probamos si el proceso tiene raíz unitaria contra si el proceso es estacionario al rededor de una constante.</p></li>
</ol>
</div>
<div id="kwiatkowsky---phillips---schmidt---shin-kpss" class="section level3" number="7.3.3">
<h3><span class="header-section-number">7.3.3</span> Kwiatkowsky - Phillips - Schmidt - Shin (KPSS)</h3>
<p>La prueba KPSS considera que el proceso es estacionario bajo la hipótesis nula, lo cual hace una diferencia respecto de las anteriores pruebas. El modelo considerado es:
<span class="math display">\[\begin{equation}
    Y_t = \delta t + \xi_t + U_t
                (\#eq:ARR5)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso estacionario y <span class="math inline">\(\xi_t\)</span> es un ruido blanco descrito por la forma: <span class="math inline">\(\xi_t = \xi_{t-1} + \varepsilon_t\)</span>, donde <span class="math inline">\(\varepsilon_t\)</span> es un proceso normalmente distribuido con media cero y varianza <span class="math inline">\(\sigma^2_\varepsilon\)</span>.</p>
<p>Así, bajo la hipótesis nula <span class="math inline">\(H_0 : \sigma^2_\varepsilon = 0\)</span>, <span class="math inline">\(\xi\)</span> se vuelve una constante y el proceso puede tener una tendencia estacionaria. Dado el planteamiento de la prueba, los valores críticos al 95% son:</p>
<ol style="list-style-type: decimal">
<li>0.146, para un modelo con tendencia</li>
<li>0.463, para un modelo con constante</li>
</ol>
</div>
<div id="ejemplo-con-aplicación-de-todas-las-pruebas-de-raíces-unitarias" class="section level3" number="7.3.4">
<h3><span class="header-section-number">7.3.4</span> Ejemplo con aplicación de todas las pruebas de raíces unitarias</h3>
<p>A continuación, mostraremos como ejemplo la aplicación de las pruebas de raíces unitarias a la serie de Tipo de Cambio en forma logaritmica y de diferencias logaritmicas. Asumamos que determinamos el valor de los rezagos de la prueba con el criterio de <span class="math inline">\(p = int\{ 4 (T/100)^{1/4} \}\)</span>. En la práctica, existen otras formas de determinar el valor de <span class="math inline">\(p\)</span>, como el criterio de AIC, pero es decisión del investigador cual usar.</p>
<p>En el Cuadro @ref(tab:ResultUR) mostramos los resultados de aplicar las pruebas de raíces unitarias a la serie <span class="math inline">\(LTC_t\)</span>, considerando <span class="math inline">\(p = int \{ 4 (234/100)^{(1/4)} \} = 4\)</span> para aquellas pruebas que requieren de rezagos: ADF, PP y KPSS. Los raultados para todos los modelos se ubican en el Scrip Clase 16 en el GitHub.</p>
<table>
<caption>(#tab:ResultUR) Pruebas de Raíces Unitarias para la serie <span class="math inline">\(LTC_t\)</span> utilizando 4 rezagos. <strong>Nota: (1) Entre parentésis se indica el modelo utilizado que es aquel más probable de ser aceptado. (2) * Indica el rechazo de <span class="math inline">\(H_0\)</span> al 5%. Los valores criticos para los modelos A, B y C para las pruebas DF y ADF son:-3.43, -2.88 y -1.95, respectivamente. Los valores criticos para prueba PP son: -3.430186 y -2.873954, y los valores criticos para prueba KPSS son: 0.146 y 0.463, para los modelos A y B, respectivamente.</strong></caption>
<thead>
<tr class="header">
<th align="center">Variable</th>
<th align="center">Dickey-Fuller</th>
<th align="center">DF Aumentada</th>
<th align="center">Phillips-Perron</th>
<th align="center">KPSS</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(LTC_t\)</span></td>
<td align="center">-2.534(A)*</td>
<td align="center">-2.534(A)*</td>
<td align="center">-2.4971(A)*</td>
<td align="center">0.5095(A)</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\Delta LTC_t\)</span></td>
<td align="center">-11.6643(C)</td>
<td align="center">-6.5746(C)</td>
<td align="center">-11.6183(C)</td>
<td align="center">0.0611(B)*</td>
</tr>
</tbody>
</table>
<!--chapter:end:06-No_Estacionarios.Rmd-->
</div>
</div>
</div>
<div id="cointegración" class="section level1" number="8">
<h1><span class="header-section-number">8</span> Cointegración</h1>
<p>Hasta ahora en el curso hemos usado el supuesto de que las series son estacionarias para el conjunto de técnicas <span class="math inline">\(ARMA(p,q)\)</span> y <span class="math inline">\(VAR(p)\)</span>. No obstante, dado que relajamos el supuesto de estacionariedad (incluyendo la estacionariedad en varianza) y que establecimos una serie de pruebas para determinar cuando una serie es estadísticamente estacionaria, ahora podemos plantear una técnica llamada Cointegración. Para esta técnica consideraremos sólo series que son <span class="math inline">\(I(1)\)</span> y reconoceremos que se originó con los trabajos de Engle y Granger (1987), Stock (1987) y Johansen (1988).</p>
<div id="definición-y-propiedades-del-proceso-de-cointegración" class="section level2" number="8.1">
<h2><span class="header-section-number">8.1</span> Definición y propiedades del proceso de cointegración</h2>
<p>Cointegración puede ser caracterizada o definida en palabras sencillas como que dos o más variables tienen una relación común estable en el largo plazo. Es decir, estas no suelen tomar caminos o trayectorias diferentes, excepto por periodos de tiempo transitorios y eventuales. A continuación, utilizaremos la definición de Engle y Grnager (1984) de cointegración.</p>
<p>Sea <span class="math inline">\(\mathbf{Y}\)</span> un vector de k-series de tiempo, decimos que los elementos en <span class="math inline">\(\mathbf{Y}\)</span> están cointegrados en un orden (d, c), es decir, <span class="math inline">\(\mathbf{Y} \sim CI(d, c)\)</span>, si todos los elementos de <span class="math inline">\(\mathbf{Y}\)</span> son series integradas de orden d, I(d), y si existe al menos una combinación lineal no trivial <span class="math inline">\(\mathbf{Z}\)</span> de esas variables que es de orden I(d - c), donde <span class="math inline">\(d \geq c &gt; 0\)</span>, si y sólo si:
<span class="math display">\[\begin{equation}
    \boldsymbol{\beta}_i&#39; \mathbf{Y}_t = \mathbf{Y}_{it} \sim I(d-c)
    (\#eq:em1)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(i = 1, 2, \ldots, r\)</span> y <span class="math inline">\(r &lt; k\)</span>.</p>
<p>A los diferentes vectores <span class="math inline">\(\boldsymbol{\beta}_i\)</span> se les denomina como vectores de cointegración. El rango de la matriz de vectores de cointegración <span class="math inline">\(r\)</span> es el número de vectores de cointegración linealmente independientes. En general diremos que los vectores de la matriz de cointegración <span class="math inline">\(\boldsymbol{\beta}\)</span> tendrá la forma de:
<span class="math display">\[\begin{equation}
    \boldsymbol{\beta}&#39; \mathbf{Y}_t = \mathbf{Z}_t
        (\#eq:em2)
\end{equation}\]</span></p>
<p>Antes de continuar hagamos algunas observaciones. Si todas las variables de <span class="math inline">\(\mathbf{Y}\)</span> son I(1) y <span class="math inline">\(0 \leq r &lt; k\)</span>, diremos que las series no cointegran si <span class="math inline">\(r = 0\)</span>. Si esto pasa, entonces, como demostraremos más adelante, la mejor opción será estimar un modelo VAR(p) en diferencias. Adicionalmente, asumiremos que <span class="math inline">\(c = d = 1\)</span>, por lo que la relación de cointegración, en su caso, generará combinaciones lineales <span class="math inline">\(\mathbf{Z}\)</span> estacionarias.</p>
</div>
<div id="cointegración-para-modelos-de-más-de-una-ecuación-o-para-modelos-basados-en-vectores-autoregresivos" class="section level2" number="8.2">
<h2><span class="header-section-number">8.2</span> Cointegración para modelos de más de una ecuación o para modelos basados en Vectores Autoregresivos</h2>
<p>Sean <span class="math inline">\(Y_1, Y_2, \ldots, Y_k\)</span> son series que forman <span class="math inline">\(\mathbf{Y}\)</span> y que todas son I(1), entonces los siguientes casos son posibles:</p>
<ol style="list-style-type: decimal">
<li>Si <span class="math inline">\(r = 1\)</span> entonces se trata de un caso de cointegración de Granger.</li>
<li>Si <span class="math inline">\(r \geq 1\)</span> entonces se trata de un caso de cointegración múltiple de Johansen.</li>
</ol>
<p>Por lo anterior, en este curso analizaremos el caso de Cointegración de Johansen. Ahora plantearemos la forma de estimar el proceso de cointgración. El primer paso para ello es determinar un modelo VAR(p) con las k-series no estacionarias (series en niveles). Alegimos el valor de <span class="math inline">\(p\)</span> mediante el uso de los criterios de información. De esta forma tendremos una especificación similar a:
<span class="math display">\[\begin{equation}
    \mathbf{Y}_t = \sum_{j=1}^p \mathbf{A}_j \mathbf{Y}_{t-j} + \mathbf{D}_t + \mathbf{U}_t
        (\#eq:VARCI)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\mathbf{U}_t\)</span> es un término de error k-dimensional puramente aleatorio; <span class="math inline">\(\mathbf{D}_t\)</span> contiene los compeoentes deterministicos de constante y tendencia, y <span class="math inline">\(\mathbf{A}_i\)</span>, <span class="math inline">\(i = 1, 2, \ldots, p\)</span>, son matrices de <span class="math inline">\(k \times k\)</span> coeficientes. Notemos que el VAR(p) involucrado en este caso, a diferencia del VAR anteriormente estudiado, puede incluir un término de tendencia. Esto en razón de que hemos relajado el concepto de estacionariedad.</p>
<p>Si reescribimos la ecuación @ref(eq:VARCI) en su forma de Vector Corrector de Errores (VEC, por sus siglas en inglés) tenemos:
<span class="math display">\[\begin{eqnarray}
    \mathbf{Y}_t - \mathbf{Y}_{t-1} &amp; = &amp; \Delta \mathbf{Y}_t \nonumber \\
    &amp; = &amp; \sum_{j=1}^p \mathbf{A}_j \mathbf{Y}_{t-j} + \mathbf{D}_t - \mathbf{Y}_{t-1} + \mathbf{U}_t \nonumber \\
    &amp; = &amp; (\mathbf{A}_1 - \mathbf{I}) \mathbf{Y}_{t-1} + \mathbf{A}_2 \mathbf{Y}_{t-2} + \ldots + \mathbf{A}_p \mathbf{Y}_{t-p} + \mathbf{D}_t + \mathbf{U}_t \nonumber \\
    &amp; = &amp; \left( \sum_{j=1}^{p} \mathbf{A}_j - \mathbf{I} \right) \mathbf{Y}_{t-1} + \sum_{j=1}^{p-1} \mathbf{A}^*_j \Delta \mathbf{Y}_{t-j} + \mathbf{D}_t \mathbf{U}_t \nonumber \\
    &amp; = &amp; - \left( \mathbf{I} - \sum_{j=1}^{p} \mathbf{A}_j \right) \mathbf{Y}_{t-1} + \sum_{j=1}^{p-1} \mathbf{A}^*_j \Delta \mathbf{Y}_{t-j} + \mathbf{D}_t \mathbf{U}_t \nonumber \\
    \Delta \mathbf{Y}_t &amp; = &amp; - \Pi \mathbf{Y}_{t-1} + \sum_{j=1}^{p-1} \mathbf{A}^*_j \Delta \mathbf{Y}_{t-j} + \mathbf{D}_t + \mathbf{U}_t
    (\#eq:VARVEC)
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\mathbf{A}_j^* = - \sum_{i=j+1}^p \mathbf{A}_i\)</span>, <span class="math inline">\(i = 1, 2, \ldots, p-1\)</span>, y la matriz <span class="math inline">\(\Pi\)</span> representa todas las relaciones de largo plazo entre las variables, por lo que la matriz es de rango completo <span class="math inline">\(k \times k\)</span>. Por lo tanto, tenemos que dicha matriz en la ecuación @ref(eq:VARVEC) se puede factorizar como:
<span class="math display">\[\begin{equation}
    \Pi_{(k \times k)} = \Gamma_{(k \times r)} \boldsymbol{\beta}_{(r \times k)}&#39;
    (\#eq:PiMatrix)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\boldsymbol{\beta}_{(r \times k)}&#39; \mathbf{Y}_{t-1}\)</span> son <span class="math inline">\(r\)</span> combinaciones linealmente independientes que son estacionarias.</p>
<p>Dada la ecuación @ref(eq:VARVEC) podemos establecer la aproximación de Johansen (1988) que se realiza mediante una estimación por Máxima Verosimilitud de la ecuación:
<span class="math display">\[\begin{equation}
    \Delta \mathbf{Y}_t + \Gamma \boldsymbol{\beta}&#39; \mathbf{Y}_{t-1} = \sum_{j=1}^{p-1} \mathbf{A}^*_j \Delta \mathbf{Y}_{t-j} + \mathbf{D}_t + \mathbf{U}_t
        (\#eq:PiMatrix1)
\end{equation}\]</span></p>
<p>Donde una vez estimado el sistema:
<span class="math display">\[\begin{equation}
    \boldsymbol{\beta} = [v_1, v_2, \ldots, v_r]
        (\#eq:PiMatrix2)
\end{equation}\]</span></p>
<p>Cada <span class="math inline">\(v_i\)</span>, <span class="math inline">\(i = 1, 2, \ldots, r\)</span>, es un vector propio que asociado a los <span class="math inline">\(r\)</span> valores propios positivos, mismos que estás asociados con la prueba de hipótesis de cointegración. Dicha hipótesis está basada en dos estadísticas con las que se determina el rango <span class="math inline">\(r\)</span> de <span class="math inline">\(\Pi\)</span>:</p>
<ol style="list-style-type: decimal">
<li>Prueba de Traza:</li>
</ol>
<blockquote>
<p><span class="math inline">\(H_0 :\)</span> Existen al menos <span class="math inline">\(r\)</span> valores propios positivos o Existen al menos <span class="math inline">\(r\)</span> relaciones de largo plazo estacionarias.</p>
</blockquote>
<ol start="2" style="list-style-type: decimal">
<li>Prueba del valor propio máximo o <span class="math inline">\(\lambda_{max}\)</span>:</li>
</ol>
<blockquote>
<p><span class="math inline">\(H_0 :\)</span> Existen <span class="math inline">\(r\)</span> valores propios positivos o Existen <span class="math inline">\(r\)</span> relaciones de largo plazo estacionarias.</p>
</blockquote>
</div>
<div id="ejemplo-de-cointegración" class="section level2" number="8.3">
<h2><span class="header-section-number">8.3</span> Ejemplo de cointegración</h2>
<p>Para ejemplificar el procedimiento de cointegración utilizaremos las series de INPC, Tipo de Cambio, rendimiento de los Cetes a 28 días, IGAE e Índice de Producción Industrial de Estados Unidos. Quizá el marco teórico de la relación entre las variables no sea del todo correcta, pero dejando de lado ese problema estimaremos si las 5 series cointegran.</p>
<p>En el Scrip Clase 17 de la capeta de GoogleDrive se encuentra el desarrollo de este ejemplo. Por principio, probaremos que todas las series son I(1), lo cual es cierto (ver Scrip para mayores detalles). En la Figura @ref(fig:GCointegracion) se muestran las series en niveles y en diferencias, con lo cual ilustramos como es viable que las series sean I(1).</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Dependencias</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(strucchange)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zoo)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sandwich)</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(urca)</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vars)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Importamos Datos desde un archivo de R:</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a><span class="co">#Los datos &quot;cargados&quot; son los originales y los ajustados por estacionalidad. Los cuales son:</span></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="co">#* INPC: Indice Nacional de Precios al Consumidor (2QJul2018 = 100)</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a><span class="co">#* TC: Tipo de Cambio FIX </span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a><span class="co">#* CETE28: Tasa de rendimiento promedio mensual de los Cetes 28, en por ciento anual</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a><span class="co">#* IGAE: Indicador global de la actividad económica (2013 = 100)</span></span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a><span class="co">#* IPI: Industrial Production Index (2012 = 100)</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;BD/Clase_17/Datos_Ad.RData&quot;</span>)</span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a><span class="do">## Conversion a series de tiempo:</span></span>
<span id="cb53-24"><a href="#cb53-24" aria-hidden="true" tabindex="-1"></a>Datos_co <span class="ot">&lt;-</span> <span class="fu">ts</span>(Datos_Ad[<span class="dv">7</span><span class="sc">:</span> <span class="dv">11</span>], </span>
<span id="cb53-25"><a href="#cb53-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb53-26"><a href="#cb53-26" aria-hidden="true" tabindex="-1"></a>            <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">7</span>), </span>
<span id="cb53-27"><a href="#cb53-27" aria-hidden="true" tabindex="-1"></a>            <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb53-28"><a href="#cb53-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-29"><a href="#cb53-29" aria-hidden="true" tabindex="-1"></a>LDatos <span class="ot">&lt;-</span> <span class="fu">log</span>(Datos_co)</span>
<span id="cb53-30"><a href="#cb53-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-31"><a href="#cb53-31" aria-hidden="true" tabindex="-1"></a>DLDatos <span class="ot">&lt;-</span> <span class="fu">diff</span>(<span class="fu">log</span>(Datos_co, <span class="at">base =</span> <span class="fu">exp</span>(<span class="dv">1</span>)), </span>
<span id="cb53-32"><a href="#cb53-32" aria-hidden="true" tabindex="-1"></a>                <span class="at">lag =</span> <span class="dv">1</span>, </span>
<span id="cb53-33"><a href="#cb53-33" aria-hidden="true" tabindex="-1"></a>                <span class="at">differences =</span> <span class="dv">1</span>)</span>
<span id="cb53-34"><a href="#cb53-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-35"><a href="#cb53-35" aria-hidden="true" tabindex="-1"></a><span class="co"># Gráficas</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="07-Cointegracion_files/figure-html/GCointegracion-1.png" alt="Series en niveles (logatirmos) y en diferencias logarítmicas para la prueba de Cointegración." width="100%" />
<p class="caption">
(#fig:GCointegracion)Series en niveles (logatirmos) y en diferencias logarítmicas para la prueba de Cointegración.
</p>
</div>
<p>Posteriormente, determinamos cuál es el orden adecuado de un VAR(p) en niveles. En el Cuadro @ref(tab:SelectVARVEC) mostramos los resultados de los criterios de información para determinar el número de rezagos óptimos, el cual resultó en <span class="math inline">\(p = 3\)</span> para los criterios AIC y FPE, <span class="math inline">\(p = 2\)</span> para el criterio HQ y <span class="math inline">\(p = 1\)</span> para el citerio SC. Por lo tanto decidiremos utilizar un VAR(3) con tendencia y constante.</p>
<table>
<caption>(#tab:SelectVARVEC) Criterios de información para diferentes especificaciones de modelos VAR(p) con término constante y tendencia de la series <span class="math inline">\(LINPC_t\)</span>, <span class="math inline">\(LTC_t\)</span>, <span class="math inline">\(LCETE28_t\)</span>, <span class="math inline">\(LIGAE_t\)</span> y <span class="math inline">\(LIPI_t\)</span>. <strong>Se reporta el valor de los criterios de información.</strong></caption>
<thead>
<tr class="header">
<th align="center">Rezagos</th>
<th align="center">AIC</th>
<th align="center">HQ</th>
<th align="center">SC</th>
<th align="center">FPE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">-4.606707e+01</td>
<td align="center">-4.585260e+01</td>
<td align="center">-4.553568e+01</td>
<td align="center">9.848467e-21</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">-4.643287e+01</td>
<td align="center">-4.606521e+01</td>
<td align="center">-4.552191e+01</td>
<td align="center">6.834064e-21</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">-4.647783e+01</td>
<td align="center">-4.595697e+01</td>
<td align="center">-4.518730e+01</td>
<td align="center">6.539757e-21</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">-4.645834e+01</td>
<td align="center">-4.578428e+01</td>
<td align="center">-4.478824e+01</td>
<td align="center">6.679778e-21</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
</tr>
</tbody>
</table>
<p>El mismo número de rezagos los utilizaremos para probar la Cointegración ya sea por una estadística de la Traza o por una de el máximo valor propio. En el Scrip llamado Clase 18 que se encuentra en la carpeta de GoogleDrive se ubican todos los resultados citados acontinuación. Derivado de la exploración de los resultados sólo matraremos uno de los caso en que las series cointegran y sólo para el caso de la prueba de la traza. En el Cuadro @ref(tab:TrazaTest) reportamos los resultados del Test de Cointegración para un modelo con 3 rezagos.</p>
<table>
<caption>(#tab:TrazaTest) Criterios de información para diferentes especificaciones de modelos VAR(p) con tendencia de la series <span class="math inline">\(LINPC_t\)</span>, <span class="math inline">\(LTC_t\)</span>, <span class="math inline">\(LCETE28_t\)</span>, <span class="math inline">\(LIGAE_t\)</span> y <span class="math inline">\(LIPI_t\)</span>.</caption>
<thead>
<tr class="header">
<th align="center">r <span class="math inline">\(\leq\)</span></th>
<th align="center">Estadística</th>
<th align="center">10%</th>
<th align="center">5%</th>
<th align="center">1%</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">4</td>
<td align="center">3.38</td>
<td align="center">10.49</td>
<td align="center">12.25</td>
<td align="center">16.26</td>
</tr>
<tr class="even">
<td align="center">3</td>
<td align="center">17.09</td>
<td align="center">22.76</td>
<td align="center">25.32</td>
<td align="center">30.45</td>
</tr>
<tr class="odd">
<td align="center">2</td>
<td align="center">31.66</td>
<td align="center">39.06</td>
<td align="center">42.44</td>
<td align="center">48.45</td>
</tr>
<tr class="even">
<td align="center">1</td>
<td align="center">56.88</td>
<td align="center">59.14</td>
<td align="center">62.99</td>
<td align="center">70.05</td>
</tr>
<tr class="odd">
<td align="center">0</td>
<td align="center">89.69</td>
<td align="center">83.20</td>
<td align="center">87.31</td>
<td align="center">96.58</td>
</tr>
</tbody>
</table>
<p>Los resutados del Cuadro @ref(tab:TrazaTest) indican que acptamos la hipótesis nula para el caso de <span class="math inline">\(r \leq 1\)</span> al <span class="math inline">\(5\%\)</span>, por lo que podemos concluir que existe evidencia estadística para probar que existen al menos 1 vector de cointegración. Por lo que dicho vector es:
<span class="math display">\[\begin{equation}
    \boldsymbol{\beta} = \left[
    \begin{matrix}
    1.00000000 \\
    0.151162436 \\
    -0.042650912 \\
    0.163804862 \\
    0.229295743 \\
    -0.004350646 \\
    \end{matrix} \right]
            (\#eq:PiMatrix29)
\end{equation}\]</span></p>
<p>Donde el vector esta normalizado para la serie <span class="math inline">\(LINPC_t\)</span>, por lo que concluímos que la relación de largo plazo que encontramos cointegra estará dada por:
<span class="math display">\[\begin{eqnarray*}
    LINPC_t &amp; = &amp; -0.151162436 LTC_t + 0.042650912 LCETE28_t \\
    &amp;  &amp; - 0.163804862 LIGAE_t - 0.229295743 LIPI_t \\
    &amp;  &amp; + 0.004350646 t
\end{eqnarray*}\]</span></p>
<p>Considerando lo anterior, podemos determinar <span class="math inline">\(\hat{U}_t\)</span> para esta ecuación de cointegración. En la Figura @ref(fig:GUCointegration) mostramos los residuales estimados. Derivado de la impección visual parecería que estos no son estacionarios, condición que debería ser cierta. De esta forma, una prueba deseable es aplicar todas la pruebas de raíces unitarias a esta serie para mostrar que es I(0). En el Scrip llamado Clase 18 en la carpeta de GoogleDrive se muestran algunas pruebas sobre esta serie y se encuentra que es posible que no sea estacionaria.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuales:</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>TT <span class="ot">&lt;-</span> <span class="fu">ts</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">259</span>), </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">start =</span> <span class="fu">c</span>(<span class="dv">2000</span>, <span class="dv">1</span>), </span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">end =</span> <span class="fu">c</span>(<span class="dv">2021</span>, <span class="dv">7</span>), </span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">freq =</span> <span class="dv">12</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> LDatos[ , <span class="dv">1</span>] <span class="sc">+</span> <span class="fl">0.7559141</span><span class="sc">*</span>LDatos[ , <span class="dv">2</span>] <span class="sc">-</span> <span class="fl">0.3623270</span><span class="sc">*</span>LDatos[ , <span class="dv">3</span>] <span class="sc">-</span> <span class="fl">5.0035388</span><span class="sc">*</span>LDatos[ , <span class="dv">4</span>] <span class="sc">+</span> <span class="fl">4.2690269</span><span class="sc">*</span>LDatos[ , <span class="dv">5</span>] <span class="sc">-</span> <span class="fl">3.2113796</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="07-Cointegracion_files/figure-html/GUCointegration-1.png" alt="Series en niveles (logatirmos) y en diferencias logarítmicas para la prueba de Cointegración." width="100%" />
<p class="caption">
(#fig:GUCointegration)Series en niveles (logatirmos) y en diferencias logarítmicas para la prueba de Cointegración.
</p>
</div>
<!--chapter:end:07-Cointegracion.Rmd-->
</div>
</div>
<div id="modelos-univariados-y-multivariados-de-volatilidad" class="section level1" number="9">
<h1><span class="header-section-number">9</span> Modelos Univariados y Multivariados de Volatilidad</h1>
<div id="modelos-arch-y-garch-univariados" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Modelos ARCH y GARCH Univariados</h2>
<p>Estos modelos de Heterocedásticidad Condicional Autoregresiva (ARCH, por sus siglas en inglés) y modelos Heterocedásticidad Condicional Autoregresiva Generalizados (GARCH, por sus siglas en inglés) tienen la característica de modelar situaciones como las que ilustra la Figutra @ref(fig:GARCHReturn). Es decir: 1) existen zonas donde la variación de los datos es mayor y zonas donde la variación es más estable –a estas situaciones se les conoce como de variabilidad por clúster–, y 2) los datos corresponden a innformación de alta frecuencia.</p>
<div class="figure" style="text-align: center">
<img src="imagenes/G_ARCH_Return.png" alt="Rendimientos (diferenccias logarítmicas) de tres acciones seleccionadas: Apple, Pfizer, Tesla, enero 2011 a noviembre de 2020" width="100%" />
<p class="caption">
(#fig:GARCHReturn)Rendimientos (diferenccias logarítmicas) de tres acciones seleccionadas: Apple, Pfizer, Tesla, enero 2011 a noviembre de 2020
</p>
</div>
<p>Para plantear el modelo supongamos –por simplicidad– que hemos construido y estimado un modelo AR(1). Es decir, asumamos que el proceso subyacente para la media condicional está dada por:
<span class="math display">\[\begin{equation}
    X_t = a_0 + a_1 X_{t-1} + U_t
    (\#eq:em1)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(|a_1|&lt; 1\)</span> para garantizar la convergencia del proceso en el largo plazo, en el cual:
<span class="math display">\[\begin{eqnarray*}
    \mathbb{E}[X_t] &amp; = &amp; \frac{a_0 }{1 - a_1} = \mu \\
    Var[X_t] &amp; = &amp; \frac{\sigma^2}{1 - a_1^2}
\end{eqnarray*}\]</span></p>
<p>Ahora, supongamos que este tipo de modelos pueden ser extendidos y generalizados a un modelo ARMA(p, q), que incluya otras variables exogénas. Denotemos a como <span class="math inline">\(\mathbf{Z}_t\)</span> al conjunto que incluye los componentes AR, MA y variables exogénas que pueden explicar a <span class="math inline">\(X_t\)</span> de forma que el proceso estará dado por:
<span class="math display">\[\begin{equation}
    X_t = \mathbf{Z}_t \boldsymbol{\beta} + U_t
        (\#eq:em2)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso estacionario que representa el error asociado a un proceso ARMA(p, q) y donde siguen diendo válidos los supuestos:
<span class="math display">\[\begin{eqnarray*}
    \mathbb{E}[U_t] &amp; = &amp; 0 \\
    Var[U_t^2] &amp; = &amp; \sigma^2
\end{eqnarray*}\]</span></p>
<p>No obstante, en este caso podemos suponer que existe autocorrelación en el término de error que puede ser capturada por un porceso similar a uno de medias móviles (MA) dado por:
<span class="math display">\[\begin{equation}
    U_t^2 = \gamma_0 + \gamma_1 U_{t-1}^2 + \gamma_2 U_{t-2}^2 + \ldots + \gamma_q U_{t-q}^2 + \nu_t
        (\#eq:em3)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\nu_t\)</span> es un ruido blanco y <span class="math inline">\(U_{t-i} = X_{t-i} - \mathbf{Z}_{t-i} \boldsymbol{\beta}\)</span>, $i = 1, 2 ,$. Si bien los procesos son estacionarios por los supuestos antes enunciados, la varianza condicional estará dada por:
<span class="math display">\[\begin{eqnarray*}
    \sigma^2_{t | t-1} &amp; = &amp; Var[ U_t | \Omega_{t-1} ] \\
    &amp; = &amp; \mathbb{E}[ U^2_t | \Omega_{t-1} ]
\end{eqnarray*}\]</span></p>
<p>Donde <span class="math inline">\(\Omega_{t-1} = \{U_{t-1}, U_{t-2}, \ldots \}\)</span> es el conjunto de toda la información pasada de <span class="math inline">\(U_t\)</span> y observada hasta el momento <span class="math inline">\(t-1\)</span>, por lo que:
<span class="math display">\[\begin{equation*}
    U_t | \Omega_{t-1} \sim \mathbb{D}(0, \sigma^2_{t | t-1})
\end{equation*}\]</span></p>
<p>Así, de forma similar a un proceso MA(q) podemos decir que la varianza condicional tendrá efectos ARCH de orden <span class="math inline">\(q\)</span> (ARCH(q)) cuando:
<span class="math display">\[\begin{equation}
    \sigma^2_{t | t-1} = \gamma_0 + \gamma_1 U_{t-1}^2 + \gamma_2 U_{t-2}^2 + \ldots + \gamma_q U_{t-q}^2
        (\#eq:ARCHEffect)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\mathbb{E}[\nu_t] = 0\)</span> y <span class="math inline">\(\gamma_0\)</span> y <span class="math inline">\(\gamma_i \geq 0\)</span>, para <span class="math inline">\(i = 1, 2, \ldots, q-1\)</span> y <span class="math inline">\(\gamma_q &gt; 0\)</span>. Estas condiciones son necesarias para garantizar que la varianza sea positiva. En general, la varianza condicional se expresa de la forma <span class="math inline">\(\sigma^2_{t | t-1}\)</span>, no obstante, para facilitar la notación, nos referiremos en cada caso a esta simplemente como <span class="math inline">\(\sigma^2_{t}\)</span>.</p>
<p>Podemos generalizar está situación si asumimos a la varianza condicional como dependiente de lo valores de la varianza rezagados, es decir, como si fuera un proceso AR de orden <span class="math inline">\(p\)</span> para la varianza y juntandolo con la ecuación @ref(eq:ARCHEffect). Bollerslev (1986) y Taylor (1986) generalizaron el problema de heterocedásticidad condicional. El modelo se conoce como GARCH(p, q), el cual se especifica como:
<span class="math display">\[\begin{equation}
    \sigma^2_t = \gamma_0 + \gamma_1 U_{t-1}^2 + \gamma_2 U_{t-2}^2 + \ldots + \gamma_q U_{t-q}^2 + \beta_1 \sigma^2_{t-1} + \beta_2 \sigma^2_{t-2} + \ldots + \beta_p \sigma^2_{t-p}
    (\#eq:GARCHEffect)
\end{equation}\]</span></p>
<p>Donde las condiciones de no negatividad son que <span class="math inline">\(\gamma_0 &gt; 0\)</span>, <span class="math inline">\(\gamma_i \geq 0\)</span>, <span class="math inline">\(i = 1, 2, \ldots, q-1\)</span>, <span class="math inline">\(\beta_j \geq 0\)</span>, <span class="math inline">\(j = 1, 2, \ldots, p-1\)</span>, <span class="math inline">\(\gamma_q &gt; 0\)</span> y <span class="math inline">\(\beta_p &gt; 0\)</span>. Además, otra condición de convergencia es que:
<span class="math display">\[\begin{equation*}
    \gamma_1 + \ldots + \gamma_q + \beta_1 + \ldots + \beta_p &lt; 1
\end{equation*}\]</span></p>
<p>Usando el operador rezago <span class="math inline">\(L\)</span> en la ecuación @ref(eq:GARCHEffect) podemos obtener:
<span class="math display">\[\begin{equation}
    \sigma^2_t = \gamma_0 + \alpha(L) U_t^2 + \beta(L) \sigma^2_t
        (\#eq:GARCHEffectL)
\end{equation}\]</span></p>
<p>De donde podemos establecer:
<span class="math display">\[\begin{equation}
    \sigma^2_t = \frac{\gamma_0}{1 - \beta(L)} + \frac{\alpha(L)}{1 - \beta(L)} U_t^2         (\#eq:em4)
\end{equation}\]</span></p>
<p>Por lo que la ecuación @ref(eq:GARCHEffect) del GARCH(p, q) representa un ARCH(<span class="math inline">\(\infty\)</span>):
<span class="math display">\[\begin{equation}
    \sigma^2_t = \frac{a_0}{1 - b_1 - b_2 - \ldots - b_p} + \sum_{i = 1}^\infty U_{t-i}^2
            (\#eq:em5)
\end{equation}\]</span></p>
</div>
<div id="modelos-arch-y-garch-multivariados" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Modelos ARCH y GARCH Multivariados</h2>
<p>De forma similar a los modelo univariados, los modelos multivariados de heterocedásticidad condicional asumen una estructura de la media condicional. En este caso, descrita por un VAR(p) cuyo proceso estocástico <span class="math inline">\(\mathbf{X}\)</span> es estacionario de dimensión <span class="math inline">\(k\)</span>. De esta forma la expresión reducida del modelo o el proceso VAR(p) estará dado por:
<span class="math display">\[\begin{equation}
    \mathbf{X}_t = \mathbf{\delta} + A_1 \mathbf{X}_{t-1} + A_2 \mathbf{X}_{t-2} + \ldots + A_p \mathbf{X}_{t-p} + \mathbf{U}_{t}
            (\#eq:em6)
\end{equation}\]</span></p>
<p>Donde cada uno de las <span class="math inline">\(A_i\)</span>, <span class="math inline">\(i = 1, 2, \ldots, p\)</span>, son matrices cuadradas de dimensión <span class="math inline">\(k\)</span> y <span class="math inline">\(\mathbf{U}_t\)</span> representa un vector de dimensión <span class="math inline">\(k \times 1\)</span> con los residuales en el momento del tiempo <span class="math inline">\(t\)</span> que son un proceso pueramente aleatorio. También se incorpora un vector de términos constantes denominado como <span class="math inline">\(\mathbf{\delta}\)</span>, el cual es de dimensión <span class="math inline">\(k \times 1\)</span> –es este caso también es posible incorporar procesos determinas adicionales–.</p>
<p>Así, suponemos que el término de error tendra estructura de vector:
<span class="math display">\[\begin{equation*}
    \mathbf{U}_t =
    \begin{bmatrix}
    U_{1t} \\ U_{2t} \\ \vdots \\ U_{Kt}
    \end{bmatrix}
\end{equation*}\]</span></p>
<p>De forma que diremos que:
<span class="math display">\[\begin{equation*}
    \mathbf{U}_t | \Omega_{t-1} \sim (0, \Sigma_{t | t-1})
\end{equation*}\]</span></p>
<p>Dicho lo anterior, entonces, el mode ARCH(q) multivariado será descrito por:
<span class="math display">\[\begin{equation}
    Vech(\Sigma_{t | t-1}) = \boldsymbol{\gamma}_0 + \Gamma_1 Vech(\mathbf{U}_{t-1} \mathbf{U}_{t-1}&#39;) + \ldots + \Gamma_q Vech(\mathbf{U}_{t-q} \mathbf{U}_{t-q}&#39;)
    (\#eq:MARCH)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(Vech\)</span> es un operador que apila en un vector la parte superior de la matriz a la cual se le aplique, <span class="math inline">\(\boldsymbol{\gamma}_0\)</span> es un vector de cosntantes, <span class="math inline">\(\Gamma_i\)</span>, <span class="math inline">\(i = 1, 2, \ldots\)</span> son matrices de coeficientes asociados a la estimación.</p>
<p>Para ilustrar la ecuación @ref(eq:MARCH), tomemos un ejemplo de <span class="math inline">\(K = 2\)</span>, de esta forma tenemos que un M-ARCH(1) será:
<span class="math display">\[\begin{equation*}
    \Sigma_{t | t-1} =
    \begin{bmatrix}
    \sigma^2_{1, t | t-1} &amp; \sigma_{12, t | t-1} \\ \sigma_{21, t | t-1} &amp; \sigma^2_{2, t | t-1}
    \end{bmatrix} =
    \begin{bmatrix}
    \sigma_{11, t} &amp; \sigma_{12, t} \\ \sigma_{21, t} &amp; \sigma_{22, t}
    \end{bmatrix} =
    \Sigma_{t}
\end{equation*}\]</span></p>
<p>Donde hemos simplificado la notación de la varianzas y la condición de que están en función de <span class="math inline">\(t-1\)</span>. Así,
<span class="math display">\[\begin{equation*}
    Vech(\Sigma_{t}) =
    Vech \begin{bmatrix}
    \sigma_{11, t} &amp; \sigma_{12, t} \\ \sigma_{21, t} &amp; \sigma_{22, t}
    \end{bmatrix} =
    \begin{bmatrix}
    \sigma_{11, t} \\ \sigma_{12, t} \\ \sigma_{22, t}
    \end{bmatrix}
\end{equation*}\]</span></p>
<p>De esta forma, podemos establecer el modelo M-ARCH(1) con <span class="math inline">\(K = 2\)</span> será de la forma:
<span class="math display">\[\begin{equation*}
    \begin{bmatrix}
    \sigma_{11, t} \\ \sigma_{12, t} \\ \sigma_{22, t}
    \end{bmatrix} =
    \begin{bmatrix}
    \gamma_{10} \\ \gamma_{20} \\ \gamma_{30}
    \end{bmatrix} +
    \begin{bmatrix}
    \gamma_{11} &amp; \gamma_{12} &amp; \gamma_{13} \\ \gamma_{21} &amp; \gamma_{22} &amp; \gamma_{23} \\ \gamma_{31} &amp; \gamma_{32} &amp; \gamma_{33}
    \end{bmatrix}
    \begin{bmatrix}
    U^2_{1, t-1} \\ U_{1, t-1} U_{2, t-1} \\ U^2_{2, t-1}
    \end{bmatrix}
\end{equation*}\]</span></p>
<p>Como notarán este tipo de procedimientos implica la estimación de muchos paramétros. En este circunstacia, se suelen estimar modelos restringidos para reducir el número de coeficientes estimados. por ejemplo, podríamos querer estimar un caso como:
<span class="math display">\[\begin{equation*}
    \begin{bmatrix}
    \sigma_{11, t} \\ \sigma_{12, t} \\ \sigma_{22, t}
    \end{bmatrix} =
    \begin{bmatrix}
    \gamma_{10} \\ \gamma_{20} \\ \gamma_{30}
    \end{bmatrix} +
    \begin{bmatrix}
    \gamma_{11} &amp; 0 &amp; 0 \\ 0 &amp; \gamma_{22} &amp; 0 \\ 0 &amp; 0 &amp; \gamma_{33}
    \end{bmatrix}
    \begin{bmatrix}
    U^2_{1, t-1} \\ U_{1, t-1} U_{2, t-1} \\ U^2_{2, t-1}
    \end{bmatrix}
\end{equation*}\]</span></p>
<p>Finalmente y de forma analóga al caso univariado, podemos plantear un modelo M-GARCH(p, q) como:
<span class="math display">\[\begin{equation}
    Vech(\Sigma_{t | t-1}) = \boldsymbol{\gamma}_0 + \sum_{j = 1}^q \Gamma_j Vech(\mathbf{U}_{t-j} \mathbf{U}_{t-j}&#39;) + \sum_{m = 1}^p \mathbf{G}_m Vech(\Sigma_{t-m | t-m-1})
    (\#eq:MGARCH)
\end{equation}\]</span></p>
<p>Donde cada una de las <span class="math inline">\(\mathbf{G}_m\)</span> es una matriz de coeficientes. Para ilustrar este caso retomemos el ejemplo anterior pera ahora para un modelo M-GARCH(1, 1) con <span class="math inline">\(K = 2\)</span> de formaque tendríamos:
<span class="math display">\[\begin{equation*}
    \begin{bmatrix}
    \sigma_{11, t} \\ \sigma_{12, t} \\ \sigma_{22, t}
    \end{bmatrix} =
    \begin{bmatrix}
    \gamma_{10} \\ \gamma_{20} \\ \gamma_{30}
    \end{bmatrix} +
    \begin{bmatrix}
    \gamma_{11} &amp; \gamma_{12} &amp; \gamma_{13} \\ \gamma_{21} &amp; \gamma_{22} &amp; \gamma_{23} \\ \gamma_{31} &amp; \gamma_{32} &amp; \gamma_{33}
    \end{bmatrix}
    \begin{bmatrix}
    U^2_{1, t-1} \\ U_{1, t-1} U_{2, t-1} \\ U^2_{2, t-1}
    \end{bmatrix} +
    \begin{bmatrix}
    g_{11} &amp; g_{12} &amp; g_{13} \\ g_{21} &amp; g_{22} &amp; g_{23} \\ g_{31} &amp; g_{32} &amp; g_{33}
    \end{bmatrix}
    \begin{bmatrix}
    \sigma_{11, t-1} \\ \sigma_{12, t-1} \\ \sigma_{22, t-1}
    \end{bmatrix}
\end{equation*}\]</span></p>
</div>
<div id="pruebas-para-detectar-efectos-arch" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Pruebas para detectar efectos ARCH</h2>
<p>La prueba que mostraremos es conocida como una ARCH-LM, la cual está basada en una regresión de los residuales estimados de un modelo VAR(p) o cualquier otra estimación que deseemos probar, con el objeto de determinar si existen efectos ARCH –esta prueba se puede simplificar para el caso univariado–.</p>
<p>Partamos de platear:
<span class="math display">\[\begin{equation}
    Vech(\hat{\mathbf{U}}_t \hat{\mathbf{U}}_t&#39;) = \mathbf{B}_0 + \mathbf{B}_1 Vech(\hat{\mathbf{U}}_{t-1} \hat{\mathbf{U}}_{t-1}&#39;) + \ldots + \mathbf{B}_q Vech(\hat{\mathbf{U}}_{t-q} \hat{\mathbf{U}}_{t-q}&#39;) + \varepsilon_t
    (\#eq:ARCHLM)
\end{equation}\]</span></p>
<p>Dada la estimación en la ecuación @ref(eq:ARCHLM), plantemos la estructura de hipótesis dada por:
<span class="math display">\[\begin{eqnarray*}
    H_0 &amp; : &amp; \mathbf{B}_1 = \mathbf{B}_2 = \ldots = \mathbf{B}_q = 0 \\
    H_a &amp; : &amp; No H_0    
\end{eqnarray*}\]</span></p>
<p>La estadística de prueba será determinada por:
<span class="math display">\[\begin{equation}
    LM_{M-ARCH} = \frac{1}{2} T K (K + 1) - Traza \left( \hat{\Sigma}_{ARCH} \hat{\Sigma}^{-1}_{0} \right) \sim \chi^2_{[q K^2 (K + 1)^2 / 4]}
                (\#eq:em7)
\end{equation}\]</span></p>
<p>Donde la matriz <span class="math inline">\(\hat{\Sigma}_{ARCH}\)</span> es calcula de acuerdo con la ecuación @ref(eq:ARCH-LM) y la matriz <span class="math inline">\(\hat{\Sigma}_{0}\)</span> sin considerar una estructura dada para los errores.</p>
<!--chapter:end:08-Modelos_Volatilidad.Rmd-->
</div>
</div>
<div id="modelos-adrl" class="section level1" number="10">
<h1><span class="header-section-number">10</span> Modelos ADRL</h1>
<div id="teoría" class="section level2" number="10.1">
<h2><span class="header-section-number">10.1</span> Teoría</h2>
<p>Una vez que hemos analizado diversas técnicas de series de tiempo, el problema consiste en seleccionar el modelo correcto. La Figura @ref(fig:TimeSeriesModels) muestra un esquema o diagrama de cómo podríamos proceder para seleccionar el modelo correcto.</p>
<div class="figure" style="text-align: center">
<img src="imagenes/TimeSeries_Models.png" alt="Method selection for time series data. OLS: Ordinary least squares; VAR: Vector autoregressive; ARDL: Autoregressive distributed lags; ECM: Error correction models, retomado de: Shrestha y Bhatta (2018)" width="100%" />
<p class="caption">
(#fig:TimeSeriesModels)Method selection for time series data. OLS: Ordinary least squares; VAR: Vector autoregressive; ARDL: Autoregressive distributed lags; ECM: Error correction models, retomado de: Shrestha y Bhatta (2018)
</p>
</div>
<p>En este caso incorporaremos a los modelos autogregressive distributed lag models (ARDL, por sus siglas en inglés). En estos casos el procedimiento de Johansen no podría aplicarse directamennte cuando las variables incluidas son de un orden mixto o cuando simplemente todas no son estacionarias. Un modelo ARDL está basado en procedimientos de MCO.</p>
<p>Este tipo de modelos toma suficientes rezagos para capturar el mecanismo generador de datos. También es posible llegar a una especificación del mecanismo corrector de errores a partir de una trasformación lineal del ARDL.</p>
<p>Consideremos la siguiente ecuación:
<span class="math display">\[\begin{equation}
    Y_t = \alpha + \delta X_t + \gamma Z_t + U_t
    (\#eq:EqARDL)
\end{equation}\]</span></p>
<p>Dada la ecuación @ref(eq:EqARDL) podemos establecer su forma de mecanismo corrector de errores en forma ARDL dada por:
<span class="math display">\[\begin{eqnarray*}
    \Delta Y_t &amp; = &amp; \alpha + \sum_{i = 1}^p \beta_i \Delta Y_{t-i} + \sum_{i = 1}^p \delta_i \Delta X_{t-i} + \sum_{i = 1}^p \gamma_i \Delta Z_{t-i} \\
    &amp;  &amp; + \lambda_1 Y_{t-1} + \lambda_2 X_{t-1} + \lambda_3 Z_{t-1} + U_t
\end{eqnarray*}\]</span></p>
<p>Donde los coeficientes <span class="math inline">\(\beta_i\)</span>, <span class="math inline">\(\delta_i\)</span>, <span class="math inline">\(\gamma_i\)</span> representan la dinámica de corto plazo y las <span class="math inline">\(\lambda\)</span>’s la dinámica de largo plazo.</p>
<p>La hipótesis nula (<span class="math inline">\(H_0\)</span>) es que las <span class="math inline">\(\lambda_1 + \lambda_2 + \lambda_3 = 0\)</span>, es decir, que no existe relación de largo plazo.</p>
<p>En la práctica estimamos una especificación con rezafos distribuidos:
<span class="math display">\[\begin{equation}
    Y_t = \alpha + \sum_{i = 1}^p \beta_i Y_{t-i} + \sum_{i = 1}^p \delta_i X_{t-i} + \sum_{i = 1}^p \gamma_i Z_{t-i} + U_t
    (\#eq:em1)
\end{equation}\]</span></p>
<p>Además de verificar si las series involucradas son estacionarias y decidir el número de reagos <span class="math inline">\(p\)</span> mediante criterios de información.</p>
</div>
<div id="ejemplo" class="section level2" number="10.2">
<h2><span class="header-section-number">10.2</span> Ejemplo</h2>
<!--chapter:end:09-ADRL.Rmd-->
</div>
</div>
<div id="modelos-de-datos-panel" class="section level1" number="11">
<h1><span class="header-section-number">11</span> Modelos de Datos Panel</h1>
<div id="motivación-1" class="section level2" number="11.1">
<h2><span class="header-section-number">11.1</span> Motivación</h2>
<p>Denotemos con <span class="math inline">\(Y_{it}\)</span> el componente o individuo <span class="math inline">\(i\)</span>, <span class="math inline">\(i = 1, 2, \ldots, N\)</span> en el tiempo <span class="math inline">\(t\)</span>, <span class="math inline">\(t = 1, 2, \ldots, T\)</span>. Típicamente las series de tiempo en forma de panel se caracterizan por ser de dimensión de individuos corta y de dimensión temporar larga.</p>
<p>En general, escribiremos:
<span class="math display">\[\begin{equation}
    Y_{it} = \alpha_i + \beta_i X_{it} + U_{it}
    (\#eq:emq1)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\alpha_i\)</span> es un efecto fijo especificado como:
<span class="math display">\[\begin{equation}
    \alpha_i = \beta_0 + \gamma_i Z_i
        (\#eq:emq2)
\end{equation}\]</span></p>
</div>
<div id="pruebas-de-raíces-unitarias-en-panel" class="section level2" number="11.2">
<h2><span class="header-section-number">11.2</span> Pruebas de Raíces Unitarias en Panel</h2>
<p>Las pruebas de raíces unitarias para panel suelen ser usadas principalmente en casos macroeconómicos. De forma similar al caso de series univariadas, asumiremos una forma de AR(1) para una serie en panel:
<span class="math display">\[\begin{equation}
    \Delta Y_{it} = \mu_i + \rho_i Y_{i t-1} + \sum_{i = 1}^{k_i} \varphi_{ij} \Delta Y_{i t-j} + \varepsilon_{it}
        (\#eq:eqARPanel)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(i = 1, \ldots, N\)</span>, <span class="math inline">\(t = 1, \ldots, T\)</span> y <span class="math inline">\(\varepsilon_{it}\)</span> es una v.a. iid que cumple con:
<span class="math display">\[\begin{eqnarray*}
    \mathbb{E}[\varepsilon_{it}] &amp; = &amp; 0 \\
    \mathbb{E}[\varepsilon_{it}^2] &amp; = &amp; \sigma^2_i &lt; \infty \\
    \mathbb{E}[\varepsilon_{it}^4] &amp; &lt; &amp; \infty
\end{eqnarray*}\]</span></p>
<p>Al igual que en el caso univariado, en este tipo de pruebas buscamos identificar cuando las series son I(1) y cuando I(0). Pasra tal efecto, la prueba de raíz unitaria que utilizaremos está basada en una prueba Dickey-Fuller Aumentada en la cual la hipótesis nula (<span class="math inline">\(H_0\)</span>) es que todas las series en el panel son no estacionarias, es decir, son I(1). Es decir,
<span class="math display">\[\begin{equation}
    H_0 : \rho_i = 0
            (\#eq:emq3)
\end{equation}\]</span></p>
<p>Por su parte, en el caso de la hipótesis nula tenndremos dos:</p>
<ol style="list-style-type: decimal">
<li><p><span class="math inline">\(H_1^A :\)</span> Todas las series son I(0) – caso homogéneo, o</p></li>
<li><p><span class="math inline">\(H_1^B :\)</span> Al menos una de las series es I(0) – caso heterogéneo</p></li>
</ol>
</div>
<div id="panel-var" class="section level2" number="11.3">
<h2><span class="header-section-number">11.3</span> Panel VAR</h2>
<p>En esta sección extenderemos el caso del modelo VAR(p) a uno en forma panel. En este caso asumimos que las viables exogenas son los <span class="math inline">\(p\)</span> rezagos de las <span class="math inline">\(k\)</span> variables endogenas. Consideremos el siguiente caso de un modelo panel VAR con efectos fijos –ciertamente es posible hacer estimaciones con efectos aleatorios, no obstante requiere de supuestos adicionales que no contemplamos en estas notas –, el cual es la forma más común de estimación:
<span class="math display">\[\begin{equation}
    \mathbf{Y}_{it} = \mu_i + \sum_{l = 1}^p \mathbf{A}_l \mathbf{Y}_{i t - l} + \mathbf{B} \mathbf{X}_{it} + \varepsilon_{it}
    (\#eq:eqPVAR)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\mathbf{Y}_{it}\)</span> es un vector de variables endogenas estacionarias para la unidad de corte transversal <span class="math inline">\(i\)</span> en el tiempo <span class="math inline">\(t\)</span>, <span class="math inline">\(\mathbf{X}_{it}\)</span> es una matriz que contiene varaibles exógenas, y <span class="math inline">\(\varepsilon_{it}\)</span> es un término de error que cumple con:
<span class="math display">\[\begin{eqnarray*}
    \mathbb{E}[\varepsilon_{it}] &amp; = &amp; 0 \\
    Var[\varepsilon_{it}] &amp; = &amp; \Sigma_\varepsilon
\end{eqnarray*}\]</span></p>
<p>Donde <span class="math inline">\(\Sigma_\varepsilon\)</span> es una matriz definida positiva.</p>
<p>Para el porceso de estimación la ecuación @ref(eq:eqPVAR) se modifica en su versión en diferencias para quedar como:
<span class="math display">\[\begin{equation}
    \Delta \mathbf{Y}_{it} = \sum_{l = 1}^p \mathbf{A}_l \Delta \mathbf{Y}_{i t - l} + \mathbf{B} \Delta \mathbf{X}_{it} + \Delta \varepsilon_{it}
    (\#eq:eqDinamicPVAR)
\end{equation}\]</span></p>
<p>La ecuación @ref(eq:eqDinamicPVAR) se estima por un GMM.</p>
</div>
<div id="cointegración-1" class="section level2" number="11.4">
<h2><span class="header-section-number">11.4</span> Cointegración</h2>
<!--chapter:end:10-Datos_Panel.Rmd-->
</div>
</div>
<div id="otros-modelos-de-series-de-tiempo-no-lineales" class="section level1" number="12">
<h1><span class="header-section-number">12</span> Otros Modelos de Series de Tiempo No lineales</h1>
<div id="modelos-de-cambio-de-régimen" class="section level2" number="12.1">
<h2><span class="header-section-number">12.1</span> Modelos de cambio de régimen</h2>
<p>En años recientes, los modelos de serie de tiempo han sido incorporados en análisis de la existencia de diferentes estados que son generados por procesos estocásticos subyacentes. En esta sección del curso revisaremos algunos modelos de cambio de regimen. Restringimos nuestra revisión a modelos que asuman que la dinámica de las series puede ser descrito por modelos del tipo AR y dejamos fuera procesos del tipo MA.</p>
<p>En general distinguimos que existen dos tipos de modelos:</p>
<ol style="list-style-type: decimal">
<li><p>Modelos caracterizados por una variable observable, por lo que tenemos certeza de los régimanes en cada uno de los momentos.</p></li>
<li><p>Modelos en los que el régimen no puede ser observado por una variable, pero si conocemos el proceso estocástico subyacente.</p></li>
</ol>
<div id="regímenes-determinados-por-información-observable" class="section level3" number="12.1.1">
<h3><span class="header-section-number">12.1.1</span> Regímenes determinados por información observable</h3>
<p>En estos casos asumimos que el régimen ocurren en un momento <span class="math inline">\(t\)</span> y puede ser determinado por una variable observable. Este modelo es conocido como el modelo autoregresivo con umbral (TAR, Threshold Autoregressive model). En este caso también diremos que cuando el régimen está determinado por la información de la misma serie será llamdao Self-Exciting TAR (SETAR).</p>
<p>Veámos un ejemplo. Supongamos que existe un umbral, <span class="math inline">\(c\)</span>, para el régimen que esta determinado por <span class="math inline">\(q_t = y_{t-1}\)</span> y que el estado de la naturaleza nos permite establecer dos estados o regímenes:
<span class="math display">\[\begin{equation}
    y_t =
    \begin{cases}
        \phi_{01} + \phi_{11} y_{t-1} + \varepsilon_t \text{ si } y_{t-1} \leq c \\
        \phi_{02} + \phi_{12} y_{t-1} + \varepsilon_t \text{ si } y_{t-1} &gt; c
    \end{cases}
    (\#eq:emq1)
\end{equation}\]</span></p>
<p>Donde asumiremos que <span class="math inline">\(\varepsilon_t\)</span> es i.i.d y que cumple con:
<span class="math display">\[\begin{equation*}
    \mathbb{E}[\varepsilon_t | \Omega_{t-1}] = 0
\end{equation*}\]</span></p>
<p>Donde <span class="math inline">\(\Omega_{t-1} = \{ y_{t-1}, y_{t-2}, \ldots \}\)</span>. Existe una variante de este modelo que suaviza la transición entre regímenes conocido como Smooth Transition AR (STAR) y puede ser especificado en su modalidad de dos regémenes como:
<span class="math display">\[\begin{equation}
    y_t = (\phi_{01} + \phi_{11} y_{t-1}) (1 - G(y_{t-1}; \gamma, c)) + (\phi_{02} + \phi_{12} y_{t-1}) G(y_{t-1}; \gamma, c) + \varepsilon_t
        (\#eq:emq2)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(G(y_{t-1}; \gamma, c)\)</span> es una función de distribución de probabilidad que suviza la transición entre regímenes. La práctica común es suponer que está tiene una forma logística:
<span class="math display">\[\begin{equation}
    G(y_{t-1}; \gamma, c) = \frac{1}{1 + e^{-\gamma (y_{t-1} - c)}}
        (\#eq:emq3)
\end{equation}\]</span></p>
<p>Es posible hacer estensiones de lo anterior a modelos de orden superior dando como resultado:
<span class="math display">\[\begin{equation}
    y_t =
    \begin{cases}
        \phi_{01} + \phi_{11} y_{t-1} + \phi_{21} y_{t-2} + \ldots + \phi_{p_1 1} y_{t-p_1} + \varepsilon_t \text{ si } y_{t-1} \leq c \\
        \phi_{02} + \phi_{12} y_{t-1} + \phi_{22} y_{t-2} + \ldots + \phi_{p_2 2} y_{t-p_2} + \varepsilon_t \text{ si } y_{t-1} &gt; c
    \end{cases}
            (\#eq:emq4)
\end{equation}\]</span></p>
<p>En el segundo caso:
<span class="math display">\[\begin{eqnarray*}
    y_t &amp; = &amp; (\phi_{01} + \phi_{11} y_{t-1} + \phi_{21} y_{t-2} + \ldots + \phi_{p_1 1} y_{t-p_1}) (1 - G(y_{t-1}; \gamma, c)) \\
    &amp;  &amp; + (\phi_{02} + \phi_{12} y_{t-1} + \phi_{22} y_{t-2} + \ldots + \phi_{p_2 2} y_{t-p_2}) G(y_{t-1}; \gamma, c) \\
    &amp;  &amp; + \varepsilon_t
\end{eqnarray*}\]</span></p>
<p>De igual forma que en el caso de los modelos ARIMA y VAR, el número de rrezagos utilizados es determinado mediennte el uso de criterios de información como el de Akaike:
<span class="math display">\[\begin{equation}
    AIC(p_1, p_2) = n_1 ln(\hat{\sigma}^2_1) + n_2 ln(\hat{\sigma}^2_2) + 2(p_1 + 1) + 2(p_2 + 1)
            (\#eq:emq5)
\end{equation}\]</span></p>
<p>Los modelos SETAR y STAR generan procesos estacionarios siempre que cumplan ciertas condiciones. En estas notas nos enfocaremos únicamente en el modelo SETAR el cual genera en un proceso estacionario cuando:</p>
<ol style="list-style-type: decimal">
<li><span class="math inline">\(\phi_{11} &lt; 1\)</span>, <span class="math inline">\(\phi_{12} &lt; 1\)</span>, <span class="math inline">\(\phi_{11} \cdot \phi_{12} &lt; 1\)</span></li>
</ol>
<p>2, <span class="math inline">\(\phi_{11} = 1\)</span>, <span class="math inline">\(\phi_{12} &lt; 1\)</span>, <span class="math inline">\(\phi_{01} &gt; 0\)</span></p>
<ol start="3" style="list-style-type: decimal">
<li><p><span class="math inline">\(\phi_{11} &lt; 1\)</span>, <span class="math inline">\(\phi_{12} = 1\)</span>, <span class="math inline">\(\phi_{02} &lt; 0\)</span></p></li>
<li><p><span class="math inline">\(\phi_{11} = 1\)</span>, <span class="math inline">\(\phi_{12} = 1\)</span>, <span class="math inline">\(\phi_{02} &lt; 0 &lt; \phi_{01}\)</span></p></li>
</ol>
<p>5.<span class="math inline">\(\phi_{11} \cdot \phi_{12} = 1\)</span>, <span class="math inline">\(\phi_{11} &lt; 0\)</span>, <span class="math inline">\(\phi_{02} + \phi_{12} \cdot \phi_{01} &gt; 0\)</span></p>
<p>Finalmente, en ocasiones podemos estar interesados en modelos donde los regímenes sean más de 2, es decir, digamos <span class="math inline">\(m\)</span> umbrales bajo un modelo SETAR o STAR. Por ejemplo, en el caso de un modelo SETAR podemos verificar que <span class="math inline">\(m\)</span> regímnes implican <span class="math inline">\(m + 1\)</span> umbrales: <span class="math inline">\(c_0, c_1, \ldots, c_m\)</span>. En cuyo caso:
<span class="math display">\[\begin{equation*}
    -\infty = c_0 &lt; c_1 &lt; \ldots &lt; c_{m-1} &lt; c_m = \infty
\end{equation*}\]</span></p>
<p>Así, tendríamos ecuaciones:
<span class="math display">\[\begin{equation}
    y_t = \phi_{0j} + \phi_{ij} y_{t-1} + \varepsilon_t \text{ si } c_{j-1} &lt; y_{t-1} &lt; c_j
            (\#eq:emq6)
\end{equation}\]</span></p>
<p>Para <span class="math inline">\(j = 1, 2, \ldots, m\)</span>. De forma similar podemos recomponer el modelo STAR.</p>
</div>
<div id="regímenes-determinados-por-variables-no-observables" class="section level3" number="12.1.2">
<h3><span class="header-section-number">12.1.2</span> Regímenes determinados por variables no observables</h3>
<p>Este tipo de modelosmasume que el regímen ocurre en el momento <span class="math inline">\(t\)</span> y que no puede ser observado, ya que este es determinado por un proceso no observable, el cual denotamos como <span class="math inline">\(s_t\)</span>. En el caso de dos regímenes, <span class="math inline">\(s_t\)</span> puede ser asumido como que toma 2 valores: 1 y 2, por ejemplo. Supongamos que el proceso subyacente tiene una forma del tipo AR(1) dado por:
<span class="math display">\[\begin{equation}
    y_t =
    \begin{cases}
        \phi_{01} + \phi_{11} y_{t-1} + \varepsilon_t \text{ si } s_t = 1 \\
        \phi_{02} + \phi_{12} y_{t-1} + \varepsilon_t \text{ si } s_t = 2
    \end{cases}
    (\#eq:eqswchingobs)
\end{equation}\]</span></p>
<p>O en un formato más corto de notación:
<span class="math display">\[\begin{equation}
    y_t = \phi_{0 s_t} + \phi_{1 s_t} y_{t-1} + \varepsilon_t
        (\#eq:eqswchingobs1)
\end{equation}\]</span></p>
<p>Para complementar el modelo, las propiedades del proceso <span class="math inline">\(s_t\)</span> necesitan ser especificadas. El modelo más popular dentro de esta familia es el propuesto por James Hamilton en 1989 el cual es conocido como Markov Switching Model (MSM), en el cual el proceso <span class="math inline">\(s_t\)</span> se asume como un proceso de Markov de primer orden. Esto implica que el regímen actula <span class="math inline">\(s_t\)</span> sólo dependen del período <span class="math inline">\(s_{t-1}\)</span>.</p>
<p>Así, el modelo es completado mediante la definición de las probabilidades de transición para moverse del un estado a otro:
<span class="math display">\[\begin{eqnarray*}
    \mathbb{P}(s_t = 1 | s_{t-1} = 1) &amp; = &amp; p_{11} \\
    \mathbb{P}(s_t = 2 | s_{t-1} = 1) &amp; = &amp; p_{12} \\
    \mathbb{P}(s_t = 1 | s_{t-1} = 2) &amp; = &amp; p_{21} \\
    \mathbb{P}(s_t = 2 | s_{t-1} = 2) &amp; = &amp; p_{22}
\end{eqnarray*}\]</span></p>
<p>Así, <span class="math inline">\(p_{ij}\)</span> es igual a la probabilidad de que la cadena de Markov pase del estado <span class="math inline">\(i\)</span> en el momento <span class="math inline">\(t-1\)</span> al estdo <span class="math inline">\(j\)</span> en el tiempo <span class="math inline">\(t\)</span>. En todo caso asumiremos que <span class="math inline">\(p_{ij} &gt; 0\)</span> y que:
<span class="math display">\[\begin{eqnarray*}
    p_{11} + p_{12} = 1 \\
    p_{21} + p_{22} = 1
\end{eqnarray*}\]</span></p>
<p>Otro tipo de probabilidades a analizar son las probabilidades incondicionales de <span class="math inline">\(\mathbb{P}(s_t = i)\)</span>, <span class="math inline">\(i = 1, 2\)</span>. Usando la teoría ergódica de la cadenas de Markov, estas probabilidades están dadas por:
<span class="math display">\[\begin{eqnarray*}
    \mathbb{P}(s_t = 1) &amp; = &amp; \frac{1 - p_{22}}{2 - p_{11} - p_{22}} \\
    \mathbb{P}(s_t = 2) &amp; = &amp; \frac{1 - p_{11}}{2 - p_{11} - p_{22}}
\end{eqnarray*}\]</span></p>
<p>Un caso más general es el de múltiples regímenes en el cual <span class="math inline">\(s_t\)</span> puede tomar cualquier valor <span class="math inline">\(m &gt; 2\)</span>, <span class="math inline">\(m \in \mathbb{N}\)</span>. Este modelo se puede escribir como:
<span class="math display">\[\begin{equation}
    y_t = \phi_{0j} + \phi_{1j} y_{t-1} + \varepsilon_t \text{ si } s_t = j \text{, para } j = 1, 2, \ldots, m
        (\#eq:eqswchingobs2)
\end{equation}\]</span></p>
<p>Donde las probabilidades de transición estarán dadas por:
<span class="math display">\[\begin{equation}
    p_{ij} = \mathbb{P}(s_t = j | s_{t-1} = i) \text{ para } i , j = 1, 2, \ldots, m
         (\#eq:eqswchingobs3)
\end{equation}\]</span></p>
<p>Donde la ecuación anterior satisface que <span class="math inline">\(p_{ij} &gt; 0\)</span>, <span class="math inline">\(\forall i, j = = 1, 2, \ldots, m\)</span> y que:
<span class="math display">\[\begin{equation*}
    \sum_{j=1}^m p_{ij} = 1 \text{ para } i = 1, 2, \ldots, m
\end{equation*}\]</span></p>
<p>Finalmente, plantearemos el procedimiento empiríco seguido para la estimación de este tipo de modelos:</p>
<ol style="list-style-type: decimal">
<li><p>Estimar un proceso AR(p)</p></li>
<li><p>Probar una hipótesis nula de no linealidad de acurdo con alguno de los modelos SERAR, STAR o MSM</p></li>
<li><p>Estimar lo parámetros</p></li>
<li><p>Evluar los resultados del modelo</p></li>
<li><p>Ajustar, en su caso, la estimación o modelo</p></li>
<li><p>Pronósticar o realizar análisis impluso-respuesta</p></li>
</ol>
<!--chapter:end:11-Otros_Modelos.Rmd-->
</div>
</div>
</div>
<div id="apendice-i" class="section level1" number="13">
<h1><span class="header-section-number">13</span> Apendice I</h1>
<div id="estimador-de-mínimos-cuadrados-ordinarios-y-el-análisis-clásico-de-regresión" class="section level2" number="13.1">
<h2><span class="header-section-number">13.1</span> Estimador de Mínimos Cuadrados Ordinarios y el análisis clásico de regresión</h2>
<p>El estimador de Mínimos Cuadrados Ordinarios (MCO) es el estimador básico en econometría o, propiamente dicho, en el análisis de regresión. Esta sección cubre las propiedades finitas del estimador de MCO, mismas que son validas para cualquier tamaño de muestra dado. El material cubierto es totalmente estándar.</p>
<p>Cualquier estudio econométrico inicia con un conjunto de proposiciones sobre algún fenómeno de la economía. Algunos ejemplos familiares son las ecuaciones de demanda, las funciones de producción y algunos otros modelos macroeconómicos. Así, la investigación empírica provee las estimaciones de los parámetros desconocidos en el modelo. La teoría especifica un conjunto de relaciones determinísticas sobre las variables.</p>
<p>Dichas relaciones sulen estudiarse mediante el análisis de regresión múltiple, el cual permite el estudio de la relación entre una <em>variable dependiente</em> y otras más denominadas <em>variables independientes</em>. En adelante, en general diremos que la forma de representar la relación entre la variable dependiente y las variables independientes, tendrá la siguiente notación:
<span class="math display">\[\begin{eqnarray}
    y &amp; = &amp; f(x_1, x_2, \ldots , x_K) + \varepsilon \nonumber \\
    &amp; = &amp; x_1\beta_1 + x_2\beta_2 + \ldots + x_K\beta_K + \varepsilon
    (\#eq:emq1)
\end{eqnarray}\]</span></p>
<p>donde <span class="math inline">\(y\)</span> es la variable dependiente o <em>explicada</em>, el conjunto de variables dado por <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, …, <span class="math inline">\(x_K\)</span> son las variables independientes o <em>explicativas</em> y de la teoría tomamos la especificación descrita por <span class="math inline">\(f(x_1, x_2, \ldots, x_K)\)</span>. Esta función es comúnmente llamada la <em>ecuación de regresión poblacional</em> de <span class="math inline">\(y\)</span> en <span class="math inline">\(x_1\)</span>, <span class="math inline">\(x_2\)</span>, …, <span class="math inline">\(x_K\)</span>. El término <span class="math inline">\(\varepsilon\)</span> es una <em>perturbación</em> aleatoria o error de estimación.</p>
<p>Este error existe por varias razones, principalmente, porque no esperamos capturar toda la influencia que existe o determina a una varaible económica en un modelo simplista como el que generalmente se formula en el análisis de regresión. Digamos, entonces, que existe un conjunto de información no observable que permite la existencia del término de error. Por ejemplo, existe una clara dificultad para obtener medidas razonables de cualidades como habilidades o capcidades de aprendizaje de un conjunto de individuos a los cuales, quizá, queremos medir su productividad. Por lo tanto, sólo podemos medir el efecto de aquellas variables o información que es cuantificable. El resto de la información la conoceremos como aquella que no es observable. Así, el término de error existe a razón de dicha información.</p>
<p>Implícitamente, estamos suponiendo que cada una de las observaciones en una muestra dada por <span class="math inline">\(\{y_i, x_{i1}, x_{i2}, \ldots, x_{iK} \}\)</span>, para <span class="math inline">\(i = 1, \ldots, n\)</span>, fue generada por un proceso subyacente descrito por:
<span class="math display">\[\begin{equation}
    y_i = x_{i1}\beta_1 + x_{i2}\beta_2 + \ldots + x_{iK}\beta_K + \varepsilon_i
        (\#eq:emq2)
\end{equation}\]</span></p>
<p>Es decir, el valor observado de <span class="math inline">\(y_i\)</span> es igual a la suma de dos partes: una parte determinística, <span class="math inline">\(x_{i1}\beta_1 + x_{i2}\beta_2 + \ldots + x_{iK}\beta_K\)</span>, y una parte aleatoria, <span class="math inline">\(\varepsilon_i\)</span>. Dicho esto, el objetivo del análisis de regresión radica en estimar los parámetros desconocidos del modelo (<span class="math inline">\(\beta_1\)</span>, <span class="math inline">\(\beta_2\)</span>, <span class="math inline">\(\ldots\)</span>, <span class="math inline">\(\beta_K\)</span>), validar la proposiciones teóricas usando los datos disponibles y predecir el valor de la variable <span class="math inline">\(y_i\)</span> mediante el uso del modelo estimado.</p>
<p>Sea <span class="math inline">\(\mathbf{X}_k\)</span> el vector columna de <span class="math inline">\(n\)</span> observaciones de la variable <span class="math inline">\(x_k\)</span>, donde <span class="math inline">\(k = 1, \ldots, K\)</span>, y que colocado en una matriz da por resultado un arreglo <span class="math inline">\(\mathbf{X}\)</span> de tamaño <span class="math inline">\(n \times K\)</span>. Es decir, cada una de las columnas de la siguiente matriz representa todas las observaciones de cada una de las variables:
<span class="math display">\[\begin{equation}
    \left[
    \begin{array}{c c c c}
    \mathbf{X}_1 &amp; \mathbf{X}_2 &amp; \ldots &amp; \mathbf{X}_K
    \end{array}
    \right]
    =
    \left[
    \begin{array}{c c c c}
    x_{11} &amp; x_{12} &amp; \ldots &amp; x_{1K}\\
    x_{21} &amp; x_{22} &amp; \ldots &amp; x_{2K}\\
    x_{31} &amp; x_{32} &amp; \ldots &amp; x_{3K}\\
    \vdots &amp; \vdots &amp; \ldots &amp; \vdots\\
    x_{n1} &amp; x_{n2} &amp; \ldots &amp; x_{nK}\\
    \end{array}
    \right]
        (\#eq:emq3)
\end{equation}\]</span></p>
<p>En la mayoría de las veces vamos a asumir que existe una columna compuesta del número 1 (uno) en todas sus entradas, tal que, el paramétro <span class="math inline">\(\beta_1\)</span> es un término constante en el modelo. De esta forma la matriz anteriormente mostrada se puede ver como:
<span class="math display">\[\begin{equation}
    \left[
    \begin{array}{c c c c}
    \mathbf{1} &amp; \mathbf{X}_2 &amp; \ldots &amp; \mathbf{X}_K
    \end{array}
    \right]
    =
    \left[
    \begin{array}{c c c c}
    1 &amp; x_{12} &amp; \ldots &amp; x_{1K}\\
    1 &amp; x_{22} &amp; \ldots &amp; x_{2K}\\
    1 &amp; x_{32} &amp; \ldots &amp; x_{3K}\\
    \vdots &amp; \vdots &amp; \ldots &amp; \vdots\\
    1 &amp; x_{n2} &amp; \ldots &amp; x_{nK}\\
    \end{array}
    \right]
        (\#eq:emq4)
\end{equation}\]</span></p>
<p>Adicionalmente, denotaremos a <span class="math inline">\(\mathbf{Y}\)</span> como un vector columna de <span class="math inline">\(n\)</span> observaciones (<span class="math inline">\(y_1\)</span>, <span class="math inline">\(y_2\)</span>, <span class="math inline">\(\ldots\)</span>, <span class="math inline">\(y_n\)</span>, en forma de columna), y a <span class="math inline">\(\boldsymbol{\varepsilon}\)</span> como el vector columna de <span class="math inline">\(n\)</span> perturbaciones (<span class="math inline">\(\varepsilon_1\)</span>, <span class="math inline">\(\varepsilon_2\)</span>, <span class="math inline">\(\ldots\)</span>, <span class="math inline">\(\varepsilon_n\)</span>, en forma de columna). El modelo descrito en la ecuación (1) se puede escribir en su forma general como:</p>
<p><span class="math display">\[\begin{equation}
{\bf{Y}} = {\bf {X}}_1\beta_1 + {\bf{X}}_2\beta_2 + \ldots + {\bf{X}}_K\beta_K + {\boldsymbol{\varepsilon}}
    (\#eq:emq5)
\end{equation}\]</span></p>
<p>Ecuación que podemos rescribir como:
<span class="math display">\[\begin{equation}
\mathbf{Y}
=
\left[
\begin{array}{c c c c}
\mathbf{X}_1 &amp; \mathbf{X}_2 &amp; \ldots &amp; \mathbf{X}_K
\end{array}
\right]
\left[
\begin{array}{c}
\beta_1 \\
\beta_2 \\
\vdots \\
\beta_K
\end{array}
\right]
+
\
\boldsymbol{\varepsilon}
=
\boldsymbol{X\beta} + \boldsymbol{\varepsilon}
   (\#eq:emq6)
\end{equation}\]</span>
\end{equation}</p>
<p>Adicionalmente, de ahora en delante diremos que la regresión lineal dada por <span class="math inline">\(y_i = x_{i1}\beta_1 + x_{i2}\beta_2 + \ldots + x_{iK}\beta_K + \varepsilon_i\)</span>, se podrá escribir como:
<span class="math display">\[\begin{equation}
y_i = (x_{i1}, x_{i2}, \ldots, x_{iK})(\beta_1, \beta_2, \ldots, \beta_K)&#39; + \varepsilon = \mathbf{X}&#39;_i \boldsymbol{\beta} + \varepsilon_i
   (\#eq:emq7)
\end{equation}\]</span></p>
<p>Así, los parámetros desconocidos, <span class="math inline">\(\boldsymbol{\beta}\)</span>, de la relación estocástica dada por <span class="math inline">\(y_i = \mathbf{X}&#39;_i \boldsymbol{\beta} + \varepsilon_i\)</span> son el objeto de la estimación. En este sentido distingamos que <span class="math inline">\(\boldsymbol{\beta}\)</span> y <span class="math inline">\(\varepsilon_i\)</span> son, respectivamente, el conjumto de los parámetros y el término de error de la población, y que, por lo tanto, denotaremos a las estimaciones relsultantes de una muestra como <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> y <span class="math inline">\(e_i\)</span>. Es decir, siempre que no podamos adquirir o conocer la iformación de todos los elementos de la población, nuestras aproximaciones muestrales se denotarán de forma distinta a las que refieran a la población.</p>
<p>Así, los principios de <em>regresión poblacional</em> y <em>regresión muestral</em> están dados por las fórmulas <span class="math inline">\(E[y_i|\mathbf{X}_i] = \mathbf{X}&#39;_i\boldsymbol{\beta}\)</span> y <span class="math inline">\(\hat{y}_i = \mathbf{X}&#39;_i\hat{\boldsymbol{\beta}}\)</span>, respectivamente. Donde <span class="math inline">\(\hat{y}_i\)</span> es el estimador de <span class="math inline">\(E[y_i|\mathbf{X}_i]\)</span>.</p>
<p>Por su parte, el término de error asociado será:
<span class="math display">\[\begin{equation}
\varepsilon_i = y_i - {\bf{X}}&#39;_i \boldsymbol{\beta}
   (\#eq:emq8)
\end{equation}\]</span></p>
<p>si hablamos del caso poblacional o,
<span class="math display">\[\begin{equation}
e_i = y_i - {\bf{X}}&#39;_i \hat{\boldsymbol{\beta}}
   (\#eq:emq9)
\end{equation}\]</span></p>
<p>cuando hagamos referencia al caso muestral. Es decir, nuestro estimador de <span class="math inline">\(\varepsilon_i\)</span> es <span class="math inline">\(e_i\)</span>. De lo dicho hasta ahora podemos escribir:
<span class="math display">\[\begin{equation}
y_i = \mathbf{X}&#39;_i \boldsymbol{\beta} + \varepsilon_i = \mathbf{X}&#39;_i \hat{\boldsymbol{\beta}} + e_i
   (\#eq:emq10)
\end{equation}\]</span></p>
<p>Intuitivamente, la ecuación (36) significa que siempre que poseamos una muestra de los elementos de la población, podremos explicar una parte de la variable dependiente, no su totalidad. En este sentido, el análisis de regresión consiste en un proceso de ajuste a la variable dependiente. Está es la idea que da origen al <span class="math inline">\(R^2\)</span> y otras medidas de bondad de ajuste, mismas que más adelante en el curso analizaremos.</p>
<p>Regresando a la discusión central de esta sección, el método de MCO, en consecuencia, resulta en encontrar la combinación de parámetros <span class="math inline">\(\hat\beta\)</span> que permita minimizar la suma de los residuales al cuadrado dada por:
<span class="math display">\[\begin{equation}
\sum^{n}_{i=1}{e^2_i} = \sum^{n}_{i=1}{(y_i - {\bf X}&#39;_i\hat{\boldsymbol{\beta}})^2}
   (\#eq:emq11)
\end{equation}\]</span></p>
<p>donde <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span> denota el vector de estimadores <span class="math inline">\(\hat{\beta}_1\)</span>, <span class="math inline">\(\ldots\)</span>, <span class="math inline">\(\hat{\beta}_K\)</span>. En términos matriciales, dado que <span class="math inline">\((e_1, e_2, \ldots, e_n)&#39;(e_1, e_2, \ldots, e_n) = {\mathbf{e&#39;e}}\)</span>, el problema del método de MCO consiste en:
<span class="math display">\[\begin{equation}
Minimizar_{\hat{\boldsymbol \beta}} S(\hat{\boldsymbol \beta}) = Minimizar_{\hat{\boldsymbol \beta}} \mathbf{e&#39;e}
   (\#eq:emq12)
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
= Minimizar_{\hat{\boldsymbol \beta}} (\mathbf{Y}-\mathbf{X}\hat{\boldsymbol \beta})&#39;(\mathbf{Y}-\mathbf{X}\hat{\boldsymbol \beta})
   (\#eq:emq13)
\end{equation}\]</span></p>
<p>Expandiendo la expresión <span class="math inline">\(\mathbf{e&#39;e}\)</span> obtenemos:
<span class="math display">\[\begin{equation}
\mathbf{e&#39;e} = \mathbf{Y&#39;Y} - 2 \mathbf{Y&#39;X} \hat{\boldsymbol \beta} + \hat{\boldsymbol \beta}&#39; \mathbf{X&#39;X}\hat{\boldsymbol \beta}
   (\#eq:emq14)
\end{equation}\]</span></p>
<p>De esta forma obtenemos que las condiciones necesarias de un mínimo son:
<span class="math display">\[\begin{equation}
\frac{\partial S(\hat{\boldsymbol \beta})}{\partial \hat{\boldsymbol \beta}} = -2{\bf{X&#39;Y}} + 2{\bf{X&#39;X}} \hat{\boldsymbol{\beta}} = \bf{0}
   (\#eq:emq15)
\end{equation}\]</span></p>
<p>De ecuación anterior obtenemos para la solución del problema del mínimo a las ecuaciones siguientes conocidas como dadas por:
<span class="math display">\[\begin{equation}
\bf{X&#39;X}\hat{\boldsymbol \beta} = \bf{X&#39;Y}
   (\#eq:emq16)
\end{equation}\]</span></p>
<p>Notemos que dichas ecuaciones normales son en realidad un sistema de ecuaciones de <span class="math inline">\(K\)</span> variables o incógnitas. Por un lado, recordemos que <span class="math inline">\(\mathbf X\)</span> es una matriz de dimensión <span class="math inline">\(n \times K\)</span>, con lo cual <span class="math inline">\(\mathbf X&#39;\)</span> es de dimensión <span class="math inline">\(K \times n\)</span>. Así, el producto <span class="math inline">\(\mathbf{X&#39;X}\)</span> dará como resultado una matriz cuadrada de dimensión <span class="math inline">\(K \times K\)</span>. Por otro lado, sabemos que <span class="math inline">\(\mathbf Y\)</span> es un vector de tamaño <span class="math inline">\(n \times 1\)</span>, con lo cual el producto <span class="math inline">\(\mathbf{X&#39;Y}\)</span> da como resultado un vector de dimención <span class="math inline">\(K \times 1\)</span>. En conclusión, el sistema de ecuaciones normales consiste en <span class="math inline">\(K\)</span> ecuaciones con <span class="math inline">\(K\)</span> incógnitas (<span class="math inline">\(\hat{\beta}_1, \ldots, \hat{\beta}_K\)</span>). Ante este hecho, existen múltiples formas mediante las cuales se puede solucionar dicho sistema, sin embargo en nuesto caso seguiremos el siguiente procedimiento.</p>
<p>Si la inversa de la matriz <span class="math inline">\(\mathbf{X&#39;X}\)</span> existe (recuerde que el procedimiento de MCO tradicional supone que <span class="math inline">\(\mathbf{X}\)</span> es de rango completo), la solución esta dada por la siguiente expresión:
<span class="math display">\[\begin{equation}
\hat{\boldsymbol \beta} = (\mathbf{X&#39;X})^{-1}\mathbf{X&#39;Y}
   (\#eq:emq17)
\end{equation}\]</span></p>
<p>Esta expresión, a pesar de ser en apariencia compleja se puede ver como un conjunto de sumas. En general hemos supuesto que nuestra regresión a estimar esta descrita por la eccuación: <span class="math inline">\(y_i = x_{i1}\beta_1 + x_{i2}\beta_2 + \ldots + x_{iK}\beta_K + \varepsilon_i\)</span>, de esta forma tenemos <span class="math inline">\(K\)</span> variables independientes es nuestra regresión.</p>
<p>Ahora bien, si denotamos a <span class="math inline">\(\mathbf{X}_k\)</span> como el vector columna formado por todas las observaciones de la muestra (<span class="math inline">\(i = 1, 2, \ldots, n\)</span>) para la variable <span class="math inline">\(k\)</span>, podemos decir que la matriz <span class="math inline">\(\mathbf X\)</span> que contiene todas las variable independientes se forma por la concatenación de cada uno de los <span class="math inline">\(K\)</span> vectores columna. Dicho esto, podemos ver que las matrices <span class="math inline">\(\mathbf{X}\)</span> y <span class="math inline">\(\mathbf{X&#39;}\)</span> se pueden expresar como:</p>
<p><span class="math display">\[
\mathbf{X} =
\left[ \begin{array}{ccccc}
x_{11} &amp; x_{12} &amp; x_{13} &amp; \ldots &amp; x_{1K} \\
x_{21} &amp; x_{22} &amp; x_{23} &amp; \ldots &amp; x_{2K} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
x_{n1} &amp; x_{n2} &amp; x_{n3} &amp; \ldots &amp; x_{nK}
\end{array} \right] =
\left[ \begin{array}{ccccc}
\mathbf{X}_1 &amp; \mathbf{X}_2&amp; \mathbf{X}_3 &amp; \ldots &amp; \mathbf{X}_K
\end{array} \right]
\]</span></p>
<p><span class="math display">\[
\bf{X&#39;} =
\left[ \begin{array}{ccccc}
x_{11} &amp; x_{21} &amp; x_{31} &amp; \ldots &amp; x_{n1} \\
x_{12} &amp; x_{22} &amp; x_{32} &amp; \ldots &amp; x_{n2} \\
x_{13} &amp; x_{23} &amp; x_{33} &amp; \ldots &amp; x_{n3} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
x_{1K} &amp; x_{2K} &amp; x_{3K} &amp; \ldots &amp; x_{nK}
\end{array} \right] =
\left[ \begin{array}{c}
\mathbf{X}_1&#39; \\
\mathbf{X}_2&#39;\\
\mathbf{X}_3&#39;\\
\vdots \\
\mathbf{X}_K&#39;
\end{array} \right]
\]</span></p>
<p>Si suponemos que nuestra regresión tiene una constante, la especificación sería: <span class="math inline">\(y_i = \beta_1 + x_{i2}\beta_2 + \ldots + x_{iK}\beta_K + \varepsilon_i\)</span>, con unas matrices <span class="math inline">\(\mathbf X\)</span> y <span class="math inline">\(\mathbf X&#39;\)</span> dadas:
<span class="math display">\[
\mathbf{X} =
\left[ \begin{array}{ccccc}
1 &amp; x_{12} &amp; x_{13} &amp; \ldots &amp; x_{1K} \\
1 &amp; x_{22} &amp; x_{23} &amp; \ldots &amp; x_{2K} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
1 &amp; x_{n2} &amp; x_{n3} &amp; \ldots &amp; x_{nK}
\end{array} \right] =
\left[ \begin{array}{ccccc}
\mathbf{1_n} &amp; \mathbf{X}_2&amp; \mathbf{X}_3 &amp; \ldots &amp; \mathbf{X}_K
\end{array} \right]
\]</span></p>
<p><span class="math display">\[
\bf{X&#39;} =
\left[ \begin{array}{ccccc}
1 &amp; 1 &amp; 1 &amp; \ldots &amp; 1 \\
x_{12} &amp; x_{22} &amp; x_{32} &amp; \ldots &amp; x_{n2} \\
x_{13} &amp; x_{23} &amp; x_{33} &amp; \ldots &amp; x_{n3} \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
x_{1K} &amp; x_{2K} &amp; x_{3K} &amp; \ldots &amp; x_{nK}
\end{array} \right] =
\left[ \begin{array}{c}
\mathbf{1_n}&#39; \\
\mathbf{X}_2&#39;\\
\mathbf{X}_3&#39;\\
\vdots \\
\mathbf{X}_K&#39;
\end{array} \right]
\]</span></p>
<p>Donde <span class="math inline">\(\mathbf{1_n}\)</span> es un vector columna compuesto de 1’s (unos). Retomando (14), desarrollemos cada uno de los casos anteriores, así obtenemos lo siguiente para el caso general:
<span class="math display">\[
\mathbf{X&#39;X} =
\left[ \begin{array}{c}
\mathbf{X}_1&#39; \\
\mathbf{X}_2&#39; \\
\mathbf{X}_3&#39;\\
\vdots \\
\mathbf{X}_K&#39;
\end{array} \right]
\left[ \begin{array}{ccccc}
\mathbf{X}_1 &amp; \mathbf{X}_2 &amp; \mathbf{X}_3 &amp; \ldots &amp; \mathbf{X}_K
\end{array} \right]
\]</span></p>
<p><span class="math display">\[
\left[ \begin{array}{ccccc}
\mathbf{X}_1&#39;\bf{X}_1 &amp; \mathbf{X}_1&#39;\mathbf{X}_2 &amp; \mathbf{X}_1&#39;\mathbf{X}_3 &amp; \ldots &amp; \mathbf{X}_1&#39;\mathbf{X}_K \\
\mathbf{X}_2&#39;\mathbf{X}_1 &amp; \mathbf{X}_2&#39;\mathbf{X}_2 &amp; \mathbf{X}_2&#39;\mathbf{X}_3 &amp; \ldots &amp; \mathbf{X}_2&#39;\mathbf{X}_K \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
\mathbf{X}_K&#39;\mathbf{X}_1 &amp; \mathbf{X}_K&#39;\mathbf{X}_2 &amp; \mathbf{X}_K&#39;\mathbf{X}_3 &amp; \ldots &amp; \mathbf{X}_K&#39;\mathbf{X}_K
\end{array} \right]
\]</span></p>
<p>Por lo tanto, obtenemos que:</p>
<p><span class="math display">\[
\mathbf{X&#39;X} =
\left[ \begin{array}{ccccc}
\sum^{n}_{i=1}{x_{i1}^2} &amp; \sum^{n}_{i=1}{x_{i1}x_{i2}} &amp; \sum^{n}_{i=1}{x_{i1}x_{i3}} &amp; \ldots &amp; \sum^{n}_{i=1}{x_{i1}x_{iK}}\\
\sum^{n}_{i=1}{x_{i2}x_{i1}} &amp; \sum^{n}_{i=1}{x^{2}_{i2}} &amp; \sum^{n}_{i=1}{x_{i2}x_{i3}} &amp; \ldots &amp; \sum^{n}_{i=1}{x_{i2}x_{iK}}\\
\sum^{n}_{i=1}{x_{i3}x_{i1}} &amp; \sum^{n}_{i=1}{x_{i3}x_{i2}} &amp; \sum^{n}_{i=1}{x^2_{i3}} &amp; \ldots &amp; \sum^{n}_{i=1}{x_{i3}x_{iK}}\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
\sum^{n}_{i=1}{x_{iK}x_{i1}} &amp; \sum^{n}_{i=1}{x_{iK}x_{i2}} &amp; \sum^{n}_{i=1}{x_{iK}x_{i3}} &amp; \ldots &amp; \sum^{n}_{i=1}{x^2_{iK}}
\end{array} \right]
\]</span></p>
<p>Por otro lado, cuando supongamos que existe un término constante:</p>
<p><span class="math display">\[
\mathbf{X&#39;X} =
\left[ \begin{array}{ccccc}
n &amp; \sum^{n}_{i=1}{x_{i2}} &amp; \sum^{n}_{i=1}{x_{i3}} &amp; \ldots &amp; \sum^{n}_{i=1}{x_{iK}}\\
\sum^{n}_{i=1}{x_{i2}} &amp; \sum^{n}_{i=1}{x^{2}_{i2}} &amp; \sum^{n}_{i=1}{x_{i2}x_{i3}} &amp; \ldots &amp; \sum^{n}_{i=1}{x_{i2}x_{iK}}\\
\sum^{n}_{i=1}{x_{i3}} &amp; \sum^{n}_{i=1}{x_{i3}x_{i2}} &amp; \sum^{n}_{i=1}{x^2_{i3}} &amp; \ldots &amp; \sum^{n}_{i=1}{x_{i3}x_{iK}}\\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
\sum^{n}_{i=1}{x_{iK}} &amp; \sum^{n}_{i=1}{x_{iK}x_{i2}} &amp; \sum^{n}_{i=1}{x_{iK}x_{i3}} &amp; \ldots &amp; \sum^{n}_{i=1}{x^2_{iK}}
\end{array} \right]
\]</span></p>
<p>Adicionalmente, el producto <span class="math inline">\(\mathbf{X&#39;Y}\)</span>, en el caso general, se puede expresar como:</p>
<p><span class="math display">\[
\mathbf{X&#39;Y}
=
\left[ \begin{array}{c}
\mathbf{X}_1&#39; \\
\mathbf{X}_2&#39; \\
\mathbf{X}_3&#39;\\
\vdots \\
\mathbf{X}_K&#39;
\end{array} \right] \mathbf{Y}
=
\left[ \begin{array}{c}
\mathbf{X}_1&#39;\mathbf{Y}\\
\mathbf{X}_2&#39;\mathbf{Y}\\
\mathbf{X}_3&#39;\mathbf{Y}\\
\vdots\\
\mathbf{X}_K&#39;\mathbf{Y}
\end{array} \right]
=
\left[ \begin{array}{c}
\sum^{n}_{i=1}{x_{i1}y_{i}}\\
\sum^{n}_{i=1}{x_{i2}y_{i}}\\
\sum^{n}_{i=1}{x_{i3}y_{i}}\\
\vdots\\
\sum^{n}_{i=1}{x_{iK}y_{i}}
\end{array} \right]
\]</span></p>
<p>Si el modelo supone la existencia de un término constante, dicho producto se expresa como:</p>
<p><span class="math display">\[
\mathbf{X&#39;Y}
=
\left[ \begin{array}{c}
\mathbf{1_n}&#39; \\
\mathbf{X}_2&#39; \\
\mathbf{X}_3&#39;\\
\vdots \\
\mathbf{X}_K&#39;
\end{array} \right] \mathbf{Y}
=
\left[ \begin{array}{c}
\mathbf{1_n}&#39;\mathbf{Y}\\
\mathbf{X}_2&#39;\mathbf{Y}\\
\mathbf{X}_3&#39;\mathbf{Y}\\
\vdots\\
\mathbf{X}_K&#39;\mathbf{Y}
\end{array} \right]
=
\left[ \begin{array}{c}
\sum^{n}_{i=1}{y_{i}}\\
\sum^{n}_{i=1}{x_{i2}y_{i}}\\
\sum^{n}_{i=1}{x_{i3}y_{i}}\\
\vdots\\
\sum^{n}_{i=1}{x_{iK}y_{i}}
\end{array} \right]
\]</span></p>
<p>Finalmente, para que esta solución dada para el procedimiento de MCO sea un mínimo debemos buscar las condiciones de segundo orden:
<span class="math display">\[\begin{equation}
\frac{\partial^2 S(\hat{\boldsymbol \beta})}{\partial \hat{\boldsymbol \beta} \partial \hat{\boldsymbol \beta&#39;}} = 2 \mathbf{X&#39;X}
   (\#eq:emq18)
\end{equation}\]</span></p>
<p>donde la matriz <span class="math inline">\(\mathbf{X&#39;X}\)</span> debe ser positiva definida para que la solución de MCO sea un mínimo. Sea <span class="math inline">\(q = \mathbf{c&#39;X&#39;Xc}\)</span> para algún vector <span class="math inline">\(\mathbf{c}\)</span> distinto de cero. Entonces:</p>
<p><span class="math display">\[
q = \mathbf{v&#39;v} = \sum_{i=1}^{n}{v_i^2} \textrm{, donde } \mathbf{v = Xc}
\]</span></p>
<p>Así, <span class="math inline">\(q\)</span> es positivo. Si <span class="math inline">\(\mathbf v\)</span> fuera cero, entonces existe una combinación lineal de las columnas de <span class="math inline">\(\mathbf X\)</span> que da como resultado cero, lo cual contradice el supuesto de que <span class="math inline">\(\mathbf X\)</span> es de rango completo. En todos los casos, si <span class="math inline">\(\mathbf X\)</span> es de rango completo, entonces la solución del método de MCO, <span class="math inline">\(\hat{\boldsymbol{\beta}}\)</span>, es la única que mínimiza la suma de los residuales al cuadrado.</p>
<p>Finalmente, no debemos perder de vista que lo aqui espresado tiene un objeto, mostrar como este procedimiento de MCO es valido cuando suponemos regresiones del tipo:
<span class="math display">\[\begin{equation}
y_t = \beta_0 + y_{t-1}\beta_1 + \ldots + y_{t-\tau}\beta_\tau + \varepsilon_t
   (\#eq:emq19)
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(t = 0, 1, 2, \ldots, T\)</span> es un índice del tiempo, la variable dependiente es <span class="math inline">\(y_t\)</span> y las variables independientes son la misma variable independiente, pero en forma rezagada. Así, podemos definir un vector columna <span class="math inline">\(\mathbf{Y}_{t-k}\)</span> el vector columna de <span class="math inline">\(T\)</span> observaciones de la variable dependiente rezagada <span class="math inline">\(k\)</span> veces, donde <span class="math inline">\(k = 1, \ldots, \tau\)</span>, y que colocado en una matriz da por resultado un arreglo <span class="math inline">\(\mathbf{X}\)</span> de tamaño <span class="math inline">\(T-\tau \times \tau+1\)</span>.</p>
</div>
<div id="estimación-por-el-método-de-máxima-verosimilitud-mv" class="section level2" number="13.2">
<h2><span class="header-section-number">13.2</span> Estimación por el método de Máxima Verosimilitud (MV)</h2>
<p>Ahora analicemos otro método de estimación que tiene más uso en series de tiempo: MV. Iniciemos con algo de notación. La función de densidad de probabilidad de una variable aleatoria <span class="math inline">\(y\)</span>, condicional en un conjunto de parámetros, <span class="math inline">\(\boldsymbol{\theta}\)</span>, la denotaremos como <span class="math inline">\(f(y|\boldsymbol{\theta})\)</span>. Dicha función identifica el mecanismo generador de datos subyacente a la muestra observable y al mismo tiempo prove una descripción matemática de los datos que el proceso generará.</p>
<p>Por otro lado, la función de densidad conjunta de n observaciones <em>independientes e idénticamente distribuidas</em> (i.i.d) está dada por el siguiente producto de las funciones de densidad individuales:
<span class="math display">\[\begin{equation}
f(y_1, y_2, \ldots, y_n |\boldsymbol{\theta}) = \prod_{i=1}^n f(y_i|\boldsymbol{\theta}) = L(\boldsymbol{\theta} | \boldsymbol{y})
   (\#eq:emq20)
\end{equation}\]</span></p>
<p>A esta función de densidad conjunta se le conoce como <em>Función de Verosimilitud</em>, la cual se define como una función del vector de parámetros, <span class="math inline">\(\boldsymbol{\theta}\)</span>, donde <span class="math inline">\(\boldsymbol{y}\)</span> indica la familia de observaciones en la muestra de datos. Notemos que la función de densidad conjunta la hemos escrito como una función de los datos observados condicional en los parámetros a estimar. Sin embargo, por otro lado también hemos dicho que la función de verosimilitud, aquella que es ídentica a la función de densidad conjunta, es una función de los parámetros condicional en los datos observados. Aunque ambas funciones son la misma cabe hace enfasís de que en la segunda buscamos aquellos parámetros que máximizan la función de verosimilitud condicional en los datos observados.</p>
<p>Ahora bien, el procedimiento de máxima verosimilitud, por simplicidad, se estima aplicando la función logarítmo natural a <span class="math inline">\(L(\boldsymbol{\theta} | \boldsymbol{y})\)</span>. Derivado de que la función logarítmo natural es monótona, ésta preserva el orden y con ello el valorque máximiza a la función. De esta forma escribiremos que la función será:
<span class="math display">\[\begin{equation}
ln(L(\boldsymbol{\theta} | \boldsymbol{y})) = ln(\prod_{i=1}^n f(y_i|\boldsymbol{\theta})) = \sum_{i = 1}^{n} ln(f(y_i|\boldsymbol{\theta}))
   (\#eq:emq21)
\end{equation}\]</span></p>
<p>Así, por simplicidad diremos que denotaremos a el logarítmo de la función de densidad conjunta como:</p>
<p><span class="math display">\[\begin{equation}
ln(L(\boldsymbol{\theta} | \boldsymbol{y})) = l(\boldsymbol{\theta} | \boldsymbol{y})
   (\#eq:emq22)
\end{equation}\]</span></p>
<p>Dicho lo anterior, el objetivo de esta sección es mostrar el procedimiento de estimación de Máxima Verosimilitud aplicado a una regresión lineal. Retomemos la idea de que en nuestra ecuación de regresión lineal: <span class="math inline">\(y_i = \mathbf{X}_i&#39;\boldsymbol \beta + \varepsilon_i\)</span> para <span class="math inline">\(i = 1, \ldots, n\)</span>, el término de error <span class="math inline">\(\varepsilon_i\)</span> se distribuye como una normal con media cero y varianza constante, <span class="math inline">\(\sigma^2\)</span>:
<span class="math display">\[
\varepsilon_i \sim \mathbf{N}(0, \sigma^2)
\]</span></p>
<p>Asimismo, en genral hemos dicho que, visto como vector, el término de error tiene una distribución de la forma:
<span class="math display">\[
\boldsymbol \varepsilon \sim \mathbf{N}(\mathbf{0}, \sigma^2 \mathbf{I}_n)
\]</span></p>
<p>Obsérvese que la forma de la varianza del término de error: <span class="math inline">\(Var[\boldsymbol \varepsilon | \mathbf X] = \sigma^2 \mathbf{I}_n\)</span>, implica que la distribución de cada una de las <span class="math inline">\(\varepsilon_i\)</span> es independiente, de tel forma que la función de densidad esta dada por:
<span class="math display">\[
f(\varepsilon_i | \boldsymbol \theta) = \frac{1}{\sqrt{2 \pi \sigma^2}}e^{-\frac{1}{2} \frac{(\varepsilon_i - 0)^2}{\sigma^2}}
\]</span></p>
<p>Sustituyendo la definición del término de error obetenemos la siguiente expresión:
<span class="math display">\[\begin{equation}
f(\varepsilon_i | \boldsymbol \theta) = \frac{1}{\sqrt{2 \pi \sigma^2}}e^{-\frac{1}{2} \frac{(\mathbf{X}_i&#39;\boldsymbol \beta - y_i)^2}{\sigma^2}}
   (\#eq:emq23)
\end{equation}\]</span></p>
<p>Donde el vector <span class="math inline">\(\boldsymbol \theta\)</span> se compone de el vector <span class="math inline">\(\boldsymbol \beta\)</span> y <span class="math inline">\(\sigma^2\)</span>.</p>
<p>Por lo tanto, la función de verosimilitud asociada a este caso está dada por la siguiente expresión:
<span class="math display">\[\begin{equation}
L(\boldsymbol{\theta} | \boldsymbol{\varepsilon}) = \prod_{i=1}^n f(\varepsilon_i|\boldsymbol{\theta}) = \prod_{i=1}^n\frac{1}{\sqrt{2 \pi \sigma^2}}e^{-\frac{1}{2} \frac{(\mathbf{X}_i&#39;\boldsymbol \beta - y_i)^2}{\sigma^2}}
   (\#eq:emq24)
\end{equation}\]</span></p>
<p>Esta última ecuación, en su forma logarítmica, se puede expresar como:
<span class="math display">\[\begin{eqnarray}
l(\boldsymbol{\theta} | \boldsymbol{\varepsilon})
&amp; = &amp;
\sum_{i=1}^n{ \left[ ln(1) - ln(\sqrt{2 \pi \sigma^2}) - \frac{1}{2} \frac{(y_i - \mathbf{X}_i&#39;\boldsymbol \beta)^2}{\sigma^2} \right]} \nonumber \\
&amp; = &amp;
\sum_{i=1}^n{ \left[- \frac{1}{2}ln(2 \pi \sigma^2) - \frac{1}{2} \frac{(y_i - \mathbf{X}_i&#39;\boldsymbol \beta)^2}{\sigma^2} \right]} \nonumber \\
&amp; = &amp;
- \frac{1}{2} \sum_{i=1}^n{ \left[ln(2 \pi \sigma^2) + \frac{(y_i - \mathbf{X}_i&#39;\boldsymbol \beta)^2}{\sigma^2} \right]} \nonumber \\
&amp; = &amp;
- \frac{1}{2} \left[ \sum_{i=1}^n{ \left[ln(2 \pi \sigma^2) \right]} + \sum_{i=1}^n{ \left[\frac{(y_i - \mathbf{X}_i&#39;\boldsymbol \beta)^2}{\sigma^2} \right]} \right] \nonumber \\\nonumber \\
&amp; = &amp;
- \frac{1}{2} \left[ n \times ln(2 \pi \sigma^2) + \frac{1}{\sigma^2} \sum_{i=1}^n{ \left[(y_i - \mathbf{X}_i&#39;\boldsymbol \beta)^2\right]} \right] \nonumber \\
&amp; = &amp;
- \frac{n}{2}ln(2 \pi \sigma^2) - \frac{1}{2 \sigma^2} \boldsymbol \varepsilon&#39; \boldsymbol \varepsilon \nonumber \\
&amp; = &amp;
- \frac{n}{2}ln(2 \pi \sigma^2) - \frac{1}{2 \sigma^2} (\mathbf{Y} - \mathbf{X} \boldsymbol \beta)&#39;(\mathbf{Y} - \mathbf{X} \boldsymbol \beta) \nonumber \\
&amp; = &amp;
- \frac{n}{2}ln(2 \pi \sigma^2) - \frac{1}{2 \sigma^2} (\mathbf{Y&#39;Y} - 2\mathbf{Y&#39;X} \boldsymbol \beta + \boldsymbol \beta&#39; \mathbf{X&#39;X} \boldsymbol \beta)
   (\#eq:emq25)
\end{eqnarray}\]</span></p>
<p>Establecida la función de verosimilitud, el siguiente paso consisten en la estimación de los parámetros. Para tal efecto debemos determinar las condiciones de primer orden, quedando de la siguiente forma:
<span class="math display">\[\begin{equation}
\frac{\partial l(\boldsymbol{\theta} | \boldsymbol{\varepsilon})}{\partial \hat{\boldsymbol \beta}} = -2{\mathbf{X&#39;Y}} + 2{\mathbf{X&#39;X}} \hat{\boldsymbol{\beta}} = \mathbf{0}
   (\#eq:emq26)
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
\frac{\partial l(\boldsymbol{\theta} | \boldsymbol{\varepsilon})}{\partial \hat{\sigma}^2} = - \frac{n}{2 \sigma^2} + \frac{1}{2 (\sigma^2)^2} (\mathbf{Y} - \mathbf{X} \hat{\boldsymbol \beta})&#39;(\mathbf{Y} - \mathbf{X} \hat{\boldsymbol \beta}) = \bf{0}
(\#eq:emq27)
\end{equation}\]</span></p>
<p>De las dos ecuaciones anteriores podemos deducir las fórmulas de nuestros estimadores de Máxima Verosimilitud:
<span class="math display">\[\begin{equation}
\hat{\boldsymbol{\beta}} = (\mathbf{X&#39;X})^{-1}\mathbf{X&#39;Y}
(\#eq:emq28)
\end{equation}\]</span></p>
<p><span class="math display">\[\begin{equation}
\hat{\sigma}^2 = \frac{\mathbf{e&#39;e}}{n}
(\#eq:emq29)
\end{equation}\]</span></p>
<p>El procedimiento de de máxima verosimilitud es el más atractivo de los demás procedimientos de estimación, ya que sus propiedades asíntoticas son que:</p>
<p><em>Un estimador es asíntoticamente eficiente si éste es consistente, asíntoticamente distribuido de forma normal y posee una matriz de varianza y covarianza que no es más grande que la matrix de varianzas y covarianzas asociadas a cualquier otro estimador.</em></p>
<p>Si se asume que la función de densidad conjunta cumple con las condiones de regularidad (que la primer derivada del logarítmo de la función de verosimilitud es continua en todo punto, y que las condiciones de primer órden y segundo órden son conocidas), podemos enunciar el suiguente:</p>
<p><strong>Teorema. Propiedades de un Estimador de Máxima Verosimilitud}. Bajo condiciones de regularidad, el estimador de máxima verosimilitud posee las siguientes propiedades asíntoticas:</strong></p>
<ol style="list-style-type: decimal">
<li>Consistencia: <span class="math inline">\(plim \hat{\boldsymbol{\theta}} = \boldsymbol{\theta}_0\)</span></li>
<li>Normalidad asíntotica: <span class="math inline">\(\hat{\boldsymbol{\theta}} \sim N[\boldsymbol{\theta}_0, I(\boldsymbol{\theta}_0)^{-1}]\)</span>, donde
<span class="math display">\[
I(\boldsymbol{\theta}_0) = -E_0[\partial^2 ln(L)/\partial \boldsymbol{\theta}_0 \partial \boldsymbol{\theta}&#39;_0]
\]</span></li>
<li>Eficiencia asíntotica: <span class="math inline">\(\hat{\boldsymbol{\theta}}\)</span> es asíntoticamente eficiente y alcanza la cota inferior de Cramér-Rao.</li>
<li>Invarianza. El estimador de máxima verosimilitud de <span class="math inline">\(\boldsymbol{\gamma}_0 = c(\boldsymbol{\theta}_0)\)</span> es <span class="math inline">\(c(\hat{\boldsymbol{\theta}})\)</span> si <span class="math inline">\(c(\boldsymbol{\theta}_0)\)</span> es una función continúa y diferenciable.</li>
</ol>
</div>
<div id="métricas-de-bondad-de-ajuste" class="section level2" number="13.3">
<h2><span class="header-section-number">13.3</span> Métricas de bondad de ajuste</h2>
<p>El criterio que dio origen a los estimadores de MCO consiste en el valor mínimo para la suma del cuadrado de todos los residuales. Esta suma es, por otro lado, una medida de ajuste de la línea de regresión a los datos. Sin embargo, esta medida puede ser facilmente alterada y, por lo tanto, rescalada por una simple multiplicación de los residuales por cualquier valor. Recordemos que el valor de los residuales esta basado en los valores de <span class="math inline">\(\bf{X}\)</span>, así podríamos pregntarnos por cuanto de la variación de <span class="math inline">\(\bf{Y}\)</span> es explicada por la varación de <span class="math inline">\(\bf{X}\)</span>.</p>
<p>De la Figura 1 podemos afirmar que la variación total de la variable dependiente <span class="math inline">\(\bf{Y}\)</span> se puede descomponer en dos partes, es decir, la variación total de <span class="math inline">\(\bf{Y}\)</span> se puede expresar como la suma dada por:</p>
<p><span class="math display">\[SST = \sum^{n}_{i=1}{(y_i - \bar{y})^2} \]</span></p>
<p>Dada la deficnición de regresión tenemos que <span class="math inline">\(\bf{Y} = \bf{X} \hat{\boldsymbol{\beta}} + \bf{e} = \hat{\bf{Y}} + \bf{e}\)</span>. Es decir, <span class="math inline">\(y_i = \hat{y}_i + e_i = {\bf{X}}_i \hat{\boldsymbol{\beta}} + e_i\)</span>. De donde podemos inferir que:</p>
<p><span class="math display">\[ y_i - \bar{y} = \hat{y}_i - \bar{y} + e_i = ({\bf{X}}_i - \bar{\bf{X}}_i )\hat{\boldsymbol{\beta}} + e_i \]</span></p>
<p>Se definimos <span class="math inline">\(\bf{M^0}\)</span> como una matriz saca promedios (con las propiedad de ser idempotente y simetrica) y definida como:</p>
<p><span class="math display">\[
\bf{M^0}=
\left[ \begin{array}{ccccc}
1 &amp; 0 &amp; 0 &amp; \ldots &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; \ldots &amp; 0 \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
0 &amp; 0 &amp; 0 &amp; \ldots &amp; 1
\end{array} \right]
-
\left[ \begin{array}{ccccc}
1 &amp; 1 &amp; 1 &amp; \ldots &amp; 1 \\
1 &amp; 1 &amp; 1 &amp; \ldots &amp; 1 \\
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
1 &amp; 1 &amp; 1 &amp; \ldots &amp; 1
\end{array} \right]
\]</span>
<span class="math display">\[=
\bf{I}_n
-
\left[ \begin{array}{c}
1  \\
1 \\
\vdots \\
1
\end{array} \right]  
\left[ \begin{array}{ccccc}
1 &amp; 1 &amp; 1 &amp; \ldots &amp; 1 \\
\end{array} \right]
=
\bf{I}_n - i&#39;i
\]</span></p>
<p>De tal forma que para cualquier vector o matriz, <span class="math inline">\(\bf{W}\)</span>, sucede que: <span class="math inline">\(\bf{M^0}\bf{W}= \bf{W} - \bar{\bf{W}}\)</span>, por ello le llammos matriz saca promedios. Regresando a nuestra discusión, podemos escribir que:</p>
<p><span class="math display">\[\bf{Y} - \bar{\bf{Y}} = \bf{M^0Y} = \bf{M^0X} \hat{\boldsymbol{\beta}} + \bf{M^0e}\]</span></p>
<p>Recordemos que si <span class="math inline">\(\bf{M^0}\)</span> extrae los promedios, estonces <span class="math inline">\(\bf{M^0e} = e\)</span>. Así podemos verificar que el producto <span class="math inline">\(\bf{Y&#39;M^0}\bf{M^0Y}\)</span> es igual a:</p>
<p><span class="math display">\[SST = ({\bf{Y}} - \bar{\bf{Y}})&#39;({\bf{Y}} - \bar{\bf{Y}}) = \sum^{n}_{i=1}{(y_i - {\bar{y}})^2} = \bf{Y&#39;M^0Y}\]</span></p>
<p><span class="math display">\[\bf{Y&#39;M^0Y} = Y&#39;(\bf{M^0X} \hat{\boldsymbol{\beta}} + \bf{M^0e}) = (\bf{X} \hat{\boldsymbol{\beta}} + \bf{e})&#39;(\bf{M^0X} \hat{\boldsymbol{\beta}} + \bf{M^0e})\]</span>
<span class="math display">\[= (\hat{\boldsymbol{\beta}}&#39; \bf{X&#39;} + \bf{e&#39;})(\bf{M^0X} \hat{\boldsymbol{\beta}} + \bf{M^0e}) \]</span>
<span class="math display">\[= \hat{\boldsymbol{\beta}}&#39; \bf{X&#39;}\bf{M^0X} \hat{\boldsymbol{\beta}} + \hat{\boldsymbol{\beta}}&#39; \bf{X&#39;}\bf{M^0e} + \bf{e&#39;}\bf{M^0X} \hat{\boldsymbol{\beta}} + \bf{e&#39;}\bf{M^0e}\]</span></p>
<p>Finlamente, como recordaran de clases pasadas, dijimos que sólo cuando nuestra regresión inclui constante la suma de residuales <span class="math inline">\(\sum^{n}_{i=1}{e_i} = 0\)</span>. De esta forma, el promedio de residuales <span class="math inline">\((\sum^{n}_{i=1}{e_i})/n = 0\)</span>. Es decir, que nuestra matriz saca promedio multiplicada por el vector de residuales es igual a <span class="math inline">\(\bf{M^0e} = e - \bar{e} = e\)</span>. Así:</p>
<p><span class="math display">\[\bf{Y&#39;M^0Y} = \hat{\boldsymbol{\beta}}&#39; \bf{X&#39;}\bf{M^0X} \hat{\boldsymbol{\beta}} + \hat{\boldsymbol{\beta}}&#39; \bf{X&#39;}\bf{e} + \bf{e&#39;}\bf{X} \hat{\boldsymbol{\beta}} + \bf{e&#39;}\bf{e}\]</span></p>
<p>Por otro lado, sabemos que la solución por el método de MCO garantiza que el producto de <span class="math inline">\(\bf{X&#39;e} = \bf{e&#39;X} = 0\)</span>.</p>
<p><span class="math display">\[SST = \bf{Y&#39;M^0Y} = \hat{\boldsymbol{\beta}}&#39; \bf{X&#39;}\bf{M^0X} \hat{\boldsymbol{\beta}} + \bf{e&#39;}\bf{e}\]</span>
<span class="math display">\[SST = SSR + SSE\]</span></p>
<p>O en palabras, la variavilidad total de <span class="math inline">\(\bf{Y}\)</span> se puede descomponer en dos: la variavilidad originada por la regresión y la variavilidad que no puede ser explicada, es decir, la del término de error.</p>
<p>Dicho esto, porponemos el siguiente coeficiente de bondad de ajuste a los datos, el cual suele concerse como <span class="math inline">\(R^2\)</span>:</p>
<p><span class="math display">\[R^2 = \frac{SSR}{SST} = \frac{SST - SSE}{SST} = 1 - \frac{SSE}{SST}\]</span></p>
<p>En fórmula:</p>
<p><span class="math display">\[R^2 = 1 - \frac{\bf{e&#39;e}}{\bf{Y&#39;M^0Y}}\]</span></p>
<p>Por último el <span class="math inline">\(R^2\)</span> ajustado solo es:</p>
<p><span class="math display">\[R^2 = 1 - \frac{{\bf{e&#39;e}}/(n-K)}{{\bf{Y&#39;M^0Y}}/(n-1)}\]</span></p>
</div>
<div id="pruebas-de-hipótesis" class="section level2" number="13.4">
<h2><span class="header-section-number">13.4</span> Pruebas de Hipótesis</h2>
<p>El Análisis de Regresión se suele usar con mucha frecuencia para los siguientes propósitos: la estimación y predicción, y para probar algún tipo de hipótesis. La estimación y predicción se analizará con mayor detalle al final de esta clase y el sesiones futuras. Por lo que respecta a las pruebas de hipótesis estableceremos los siguiente.</p>
<p>Recordemos que nuestro modelo general de regresión está dado por la siguiente expresión:</p>
<p><span class="math display">\[{\bf Y} = {\bf X}{\boldsymbol \beta} + {\boldsymbol \varepsilon}\]</span></p>
<p>Ahora consideremos un ejemplo, supongamos que desea plantear una regresión del tipo logarítmica con el objeto de determinar la demanda de tabaco. Así, establece la siguiente relación:</p>
<p><span class="math display">\[ln(Q_{Tabaco}) = \beta_0 + \beta_1 ln(P_{Tabaco}) + \beta_2 ln(P_{Alcohol}) + \beta_3 ln(Ingreso) + \varepsilon\]</span></p>
<p>Donde <span class="math inline">\(Q_{Tabaco}\)</span> es la cantidad de tabaco demandada, y <span class="math inline">\(P_{Tabaco}\)</span> y <span class="math inline">\(P_{Alcohol}\)</span> son el precio del tabaco y del aocohol, respectivamente. Suponga, adicionalmente, que sospecha que el tabaco y el alcohol guardan una relación de complementariedad, por lo que espera que los paramétros asociados a las variables de precios de ambos tengan el mismo signo (-). Asimismo, suponga que estas variables son las únicas relevantes para este caso y el resto de la información es no observable o no medible.</p>
<p>Supongamos, quizá de forma absurda, que el tabaco y el alcohol exhiben una elásticidad unitaria, por lo que decide plantear la siguiente hipótesis:</p>
<blockquote>
<p><span class="math inline">\(H_0: \beta_1 = 1\)</span> y <span class="math inline">\(\beta_2 = 1\)</span></p>
</blockquote>
<blockquote>
<p><span class="math inline">\(H_1: No\)</span> <span class="math inline">\(H_0\)</span></p>
</blockquote>
<p>La hipótesis nula es equivalente a escribir el siguiente sistema de ecuaciones:</p>
<p><span class="math display">\[0 \beta_0 + 1 \beta_1 + 0 \beta_2 + 0 \beta_3 = 1\]</span>
<span class="math display">\[0 \beta_0 + 0 \beta_1 + 1 \beta_2 + 0 \beta_3 = 1\]</span></p>
<p>El cual podemos escribir como:</p>
<p><span class="math display">\[
\left(
\begin{array}{c c c c}
0 &amp; 1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; 0 &amp; 0 \\
\end{array}
\right)
\left(
\begin{array}{c}
\beta_0 \\
\beta_1 \\
\beta_2 \\
\beta_3 \\
\end{array}
\right)
=
\left(
\begin{array}{c}
1 \\
1 \\
\end{array}
\right)
\]</span></p>
<p>En forma reducida:</p>
<p><span class="math display">\[{\bf R} {\boldsymbol \beta} = q\]</span></p>
<p>Con lo cual la hipótesis original se puede escribir como:</p>
<p><span class="math display">\[H_0: {\bf R} {\boldsymbol \beta} = q\]</span></p>
<p><span class="math display">\[H_1: {\bf R} {\boldsymbol \beta} \ne q\]</span></p>
<p>Observemos que podemos afirmar que la hipótesis tiene dos restricciones. Regresando a nuestro caso general:</p>
<p><span class="math display">\[{\bf Y} = {\bf X}{\boldsymbol \beta} + {\boldsymbol \varepsilon}\]</span></p>
<p>Por analogía podríamos escribir un conjunto de ``J’’ restricciones como:</p>
<p><span class="math display">\[r_{10} \beta_0 + r_{11} \beta_1 + \ldots + r_{1K} \beta_K = q_1\]</span>
<span class="math display">\[r_{20} \beta_0 + r_{21} \beta_1 + \ldots + r_{2K} \beta_K = q_2\]</span>
<span class="math display">\[\vdots\]</span>
<span class="math display">\[r_{J0} \beta_0 + r_{J1} \beta_1 + \ldots + r_{JK} \beta_K = q_J\]</span></p>
<p>Sistema que se puede escribir en forma matricial como:</p>
<p><span class="math display">\[
\left(
\begin{array}{c c c c}
r_{10} &amp; r_{11} &amp; \ldots &amp; r_{1K} \\
r_{20} &amp; r_{21} &amp; \ldots &amp; r_{2K} \\
\vdots &amp; \vdots &amp; \ldots &amp; \vdots \\
r_{J0} &amp; r_{J1} &amp; \ldots &amp; r_{JK} \\
\end{array}
\right)
\left(
\begin{array}{c}
\beta_0 \\
\beta_1 \\
\vdots \\
\beta_3 \\
\end{array}
\right)
=
\left(
\begin{array}{c}
q_1 \\
q_2 \\
\vdots \\
q_J \\
\end{array}
\right)
\]</span></p>
<p>De esta forma podemos, finalmente, escribir una hipótesis general:</p>
<blockquote>
<p><span class="math display">\[H_0: {\bf R} {\boldsymbol \beta} = q\]</span></p>
</blockquote>
<blockquote>
<p><span class="math inline">\(H_1: No\)</span> <span class="math inline">\(H_0\)</span></p>
</blockquote>
<p>Dicho lol anterior, el restante argumento versa sobre cómo hacer uso de estas restricciones conjuntas.</p>
<div id="prueba-f" class="section level3" number="13.4.1">
<h3><span class="header-section-number">13.4.1</span> Prueba F</h3>
<p>Cuando deseamos evaluar una hipótesis con más de una restricción se debe ocupar la prueba F. La cual se puede escribir como:</p>
<p><span class="math display">\[F_{[J, n-K]} = \frac{({\bf R}{\boldsymbol \beta} - {\bf q})&#39; [s^2 {\bf R} ({\bf X&#39;X})^{-1} {\bf R}&#39;] ({\bf R}{\boldsymbol \beta} - {\bf q})}{J}\]</span></p>
<p>Esta estadística se distribuye como una F de Fisher con <span class="math inline">\(J\)</span> y <span class="math inline">\(n-K\)</span> grados de libertad.</p>
</div>
<div id="prueba-t" class="section level3" number="13.4.2">
<h3><span class="header-section-number">13.4.2</span> Prueba t</h3>
<p>Cuando deseamos evaluar una hipótesis con solo una restricción se debe ocupar la prueba t. La cual se puede escribir como:</p>
<p><span class="math display">\[t_{[n-K, \alpha/2]} = ({\bf R}{\boldsymbol \beta} - {\bf q})&#39; [s^2 {\bf R} ({\bf X&#39;X})^{-1} {\bf R}&#39;] ({\bf R}{\boldsymbol \beta} - {\bf q})\]</span></p>
<p>Esta estadística se distribuye como una t con <span class="math inline">\(n-K\)</span> grados de libertad.</p>
<!--chapter:end:12-Apendice.Rmd-->
</div>
</div>
</div>
<div id="apéndice-ii" class="section level1" number="14">
<h1><span class="header-section-number">14</span> Apéndice II</h1>
<div id="referencias" class="section level2" number="14.1">
<h2><span class="header-section-number">14.1</span> Referencias</h2>
<ul>
<li>Cowpertwait, P. y Metcalfe, A. (2009). <em>Introductory Time Series with R</em>. Spinger.</li>
<li>Guerrero Guzmán, Victor (2014). <em>Análisis Estadístico y Pronóstico de Series de Tiempo Económicas</em>. Jit Press. 3ra Edición. (Las ediciones 1 y 2 del libro fueron publicadas con el título: <em>Análisis Estadístico de Series de Tiempo Económicas</em>).</li>
<li>Enders, Walter (2015). <em>Applied Econometric Time Series</em>. 4ta Edición. Wiley.</li>
<li>Franses, Philip H. y Dick van Dijk (2003). <em>Nonlinear Time Series Models in Empirical Finance</em>. Cambridge University Press.</li>
<li>Hodrick, R. y Prescott, E. (1997). Postwar U.s. Business Cycles: An Empirical Investigation. <em>Journal of Money, Credit and Banking</em>. Vol. 29, No. 1, pp. 1-16.</li>
<li>Kirchgassner, G., Wolters, J., y Hassler, U. (2012). <em>Introduction to Modern Time Series Analysis</em>. 2nd Edition. Spinger.</li>
<li>Kleiber, Christian y Claudio Lupi (2011). <em>Panel Unit Root Testing with R</em>. CRAN task views are visible at <a href="http://cran.r-project.org/web/views/" class="uri">http://cran.r-project.org/web/views/</a>.</li>
<li>Lutkepohl, Helmut (2005). <em>New Introduction to Multiple Time Series Analysis</em>. Spinger.</li>
<li>Shrestha, Min B. y Guna R. Bhatta (2018). <em>Selecting appropriate methodological framework for time series data analysis</em>. The Journal of Finance and Data Science (4) 71-89.</li>
<li>Sigmund, Michael y Robert Ferstl (nd). Panel Vector Autoregression in R with the Package panelvar. Electronic copy available at: <a href="https://ssrn.com/abstract=2896087" class="uri">https://ssrn.com/abstract=2896087</a></li>
<li>Tsay, Ruey (2014). <em>Multivariate Time Series Analysis with R and Financial Applications</em>. Wiley.</li>
<li>Wei, William (2019). <em>Multivariate Time Series Analysis and Applications</em>. Wiley Series in Probability ans Statistics.</li>
</ul>
<!--chapter:end:13-ApendiceII.Rmd-->
</div>
</div>
<div class="footnotes footnotes-end-of-document">
<hr />
<ol>
<li id="fn1"><p>Los datos y algoritmo está disponible en el repositorio de GitHub y corresponde a la Clase 3.<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
<li id="fn2"><p>El procedimiento e implementación del ejercicio está en el archivo R denominado Clase 4 del repositorio de GitHub.<a href="#fnref2" class="footnote-back">↩︎</a></p></li>
<li id="fn3"><p>El procedimiento e implementación del ejercicio está en el archivo R denominado Clase 5 del repositorio de GitHub.<a href="#fnref3" class="footnote-back">↩︎</a></p></li>
<li id="fn4"><p>Fuente: INEGI, .<a href="#fnref4" class="footnote-back">↩︎</a></p></li>
<li id="fn5"><p>Las tasas de crecimiento no son porcentuales, para hacerlas porcentuales faltaría multiplicar por 100 a la serie.<a href="#fnref5" class="footnote-back">↩︎</a></p></li>
<li id="fn6"><p>Note que raíces son equivalentes al inversio de las del polinomio dado por <span class="math inline">\(\lambda^2 a_2 - \lambda a_1 - 1 = 0\)</span>.<a href="#fnref6" class="footnote-back">↩︎</a></p></li>
<li id="fn7"><p>Es fácil demostrar está afirmación, sólo requiere de desarrollar la expresión y utilizar el hecho de que <span class="math inline">\(U_t\)</span> es un proceso pueramente aleatorio, por lo que la covarianza es cero (0).<a href="#fnref7" class="footnote-back">↩︎</a></p></li>
<li id="fn8"><p>La información y material respecto del modelo esta disponible en la dirección <a href="#fnref8" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
<!--bookdown:body:end-->
  </main>

  <div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page">
      <h2>On this page</h2>
      <div id="book-on-this-page"></div>

      <div class="book-extra">
        <ul class="list-unstyled">
          <li><a id="book-source" href="#">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="#">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
      </div>
    </nav>
  </div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5">
  <div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Notas de Clase: Series de Tiempo</strong>" was written by Benjamín Oliva, Omar Alfaro-Rivera y Emiliano Pérez Caullieres. It was last built on 2022-08-07.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer>


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
<script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>

</html>
