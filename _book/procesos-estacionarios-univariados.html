<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Capítulo 4 Procesos estacionarios univariados | Notas de Clase: Series de Tiempo</title>
<meta name="author" content="Benjamín Oliva, Omar Alfaro-Rivera y Emiliano Pérez Caullieres">
<meta name="description" content="En este capítulo analizaremos el método o metodología de análisis de series de tiempo propuesto por Box y Jenkins (1970). Los modelos propuestos dentro de está metodología o conjunto de métodos se...">
<meta name="generator" content="bookdown 0.27 with bs4_book()">
<meta property="og:title" content="Capítulo 4 Procesos estacionarios univariados | Notas de Clase: Series de Tiempo">
<meta property="og:type" content="book">
<meta property="og:description" content="En este capítulo analizaremos el método o metodología de análisis de series de tiempo propuesto por Box y Jenkins (1970). Los modelos propuestos dentro de está metodología o conjunto de métodos se...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Capítulo 4 Procesos estacionarios univariados | Notas de Clase: Series de Tiempo">
<meta name="twitter:description" content="En este capítulo analizaremos el método o metodología de análisis de series de tiempo propuesto por Box y Jenkins (1970). Los modelos propuestos dentro de está metodología o conjunto de métodos se...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.4.0/transition.js"></script><script src="libs/bs3compat-0.4.0/tabs.js"></script><script src="libs/bs3compat-0.4.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Notas de Clase: Series de Tiempo</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introducción</a></li>
<li><a class="" href="elementos-de-ecuaciones-en-diferencia.html"><span class="header-section-number">2</span> Elementos de Ecuaciones en Diferencia</a></li>
<li><a class="" href="modelos-de-series-de-tiempo-estacionarias.html"><span class="header-section-number">3</span> Modelos de Series de Tiempo Estacionarias</a></li>
<li><a class="active" href="procesos-estacionarios-univariados.html"><span class="header-section-number">4</span> Procesos estacionarios univariados</a></li>
<li><a class="" href="desestacionalizaci%C3%B3n-y-filtrado-de-series.html"><span class="header-section-number">5</span> Desestacionalización y filtrado de Series</a></li>
<li><a class="" href="procesos-basados-en-vectores-autoregresivos.html"><span class="header-section-number">6</span> Procesos Basados en Vectores Autoregresivos</a></li>
<li><a class="" href="procesos-no-estacionarios.html"><span class="header-section-number">7</span> Procesos No Estacionarios</a></li>
<li><a class="" href="cointegraci%C3%B3n.html"><span class="header-section-number">8</span> Cointegración</a></li>
<li><a class="" href="modelos-univariados-y-multivariados-de-volatilidad.html"><span class="header-section-number">9</span> Modelos Univariados y Multivariados de Volatilidad</a></li>
<li><a class="" href="modelos-adrl.html"><span class="header-section-number">10</span> Modelos ADRL</a></li>
<li><a class="" href="modelos-de-datos-panel.html"><span class="header-section-number">11</span> Modelos de Datos Panel</a></li>
<li><a class="" href="otros-modelos-de-series-de-tiempo-no-lineales.html"><span class="header-section-number">12</span> Otros Modelos de Series de Tiempo No lineales</a></li>
<li><a class="" href="apendice-i.html"><span class="header-section-number">13</span> Apendice I</a></li>
<li><a class="" href="ap%C3%A9ndice-ii.html"><span class="header-section-number">14</span> Apéndice II</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="git@github.com:emilianoprzcls/bookdown-notas-series-de-tiempo.git">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="procesos-estacionarios-univariados" class="section level1" number="4">
<h1>
<span class="header-section-number">Capítulo 4</span> Procesos estacionarios univariados<a class="anchor" aria-label="anchor" href="#procesos-estacionarios-univariados"><i class="fas fa-link"></i></a>
</h1>
<p>En este capítulo analizaremos el método o metodología de análisis de series de tiempo propuesto por Box y Jenkins (1970). Los modelos propuestos dentro de está metodología o conjunto de métodos se han vuelto indispensables para efectos de realizar pronósticos de corto plazo.</p>
<p>En este sentido, se analizarán los métodos más importantes en series de tiempo: Autoregresivos (AR) y de Medias Móviles (MA). Asimismo, se realizará un análisis de los procesos que resultan de la combinación de ambos, conocida como ARMA, los cuales son más comúnmente usados para realizar pronósticos.</p>
<div id="procesos-autoregresivos-ar" class="section level2" number="4.1">
<h2>
<span class="header-section-number">4.1</span> Procesos Autoregresivos (AR)<a class="anchor" aria-label="anchor" href="#procesos-autoregresivos-ar"><i class="fas fa-link"></i></a>
</h2>
<p>Los procesos autoregresivos tienen su origen en el trabajo de Cochrane y Orcutt de 1949, mediante el cual analizaron los residuales de una regresión clásica como un proceso autoregresivo. Puede consultarse el apéndice para la discusión del modelo de regresión clásica.</p>
<div id="ar1" class="section level3" number="4.1.1">
<h3>
<span class="header-section-number">4.1.1</span> AR(1)<a class="anchor" aria-label="anchor" href="#ar1"><i class="fas fa-link"></i></a>
</h3>
<p>Como primer caso analizaremos al proceso autoregresivo de primer orden, <span class="math inline">\(AR(1)\)</span>, el cual podemos definir como una Ecuación Lineal en Diferencia Estocástica de Primer Orden. Diremos que una Ecuación Lineal en Diferencia de Primer Orden es estocástica si en su representación analítica considera un componente estocástico como en la ecuación <a href="procesos-estacionarios-univariados.html#eq:EDOEst">(4.1)</a> descrita a continuación:
<span class="math display" id="eq:EDOEst">\[\begin{equation}
    X_t = a_0 + a_1 X_{t-1} + U_t
    \tag{4.1}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(a_0\)</span> es un término constante, <span class="math inline">\(U_t\)</span> es un proceso estacionario, con media cero (0), una varianza finita y constante (<span class="math inline">\(\sigma^2\)</span>) y una covarianza que depende de la distancia entre <span class="math inline">\(t\)</span> y cualquier <span class="math inline">\(t-s\)</span> (<span class="math inline">\(\gamma_s\)</span>)–que no depende de los valores pasados o futuros de la variable–, <span class="math inline">\(X_0\)</span> es el valor inicial de <span class="math inline">\(X_t\)</span>. No obstante, en general vamos a asumir que la covarianza será cero (0), por lo que tendremos un proceso puramente aleatorio. Considerando la ecuación <a href="procesos-estacionarios-univariados.html#eq:EDOEst">(4.1)</a> y un proceso de sustitución sucesivo podemos establecer lo siguiente, empezando con <span class="math inline">\(X_1\)</span>:
<span class="math display">\[\begin{eqnarray*}
    X_{1} &amp; = &amp; a_0 + a_1 X_{0} + U_{1}
\end{eqnarray*}\]</span></p>
<p>Para <span class="math inline">\(X_2\)</span>:
<span class="math display">\[\begin{eqnarray*}
X_{2} &amp; = &amp; a_0 + a_1 X_{1} + U_{2} \\
    &amp; = &amp; a_0 + a_1 (a_0 + a_1 X_{0} + U_{1}) + U_{2} \\
    &amp; = &amp; a_0 + a_1 a_0 + a_1^2 X_{0} + a_1 U_{1} + U_{2}
\end{eqnarray*}\]</span></p>
<p>Para <span class="math inline">\(X_3\)</span>:
<span class="math display">\[\begin{eqnarray*}
X_{3} &amp; = &amp; a_0 + \alpha X_{2} + U_{3} \\
    &amp; = &amp; a_0 + a_1 (a_0 + a_1 a_0 + a_1^2 X_{0} + a_1 U_{1} + U_{2}) + U_{3} \\
    &amp; = &amp; a_0 + a_1 a_0 + a_1^2 a_0 + a_1^3 X_{0} + a_1^2 U_{1} + a_1 U_{2} + U_{3}
\end{eqnarray*}\]</span></p>
<p>Así, para cualquier <span class="math inline">\(X_t\)</span>, <span class="math inline">\(t = 1, 2, 3, \ldots\)</span>, obtendríamos:
<span class="math display" id="eq:EDOSSol">\[\begin{eqnarray}
X_{t} &amp; = &amp; a_0 + a_1 X_{t - 1} + U_{t} \nonumber \\
    &amp; = &amp; a_0 + a_1 (a_0 + a_1 a_0 + a_1^2 a_0 + \ldots + a_1^{t-2} a_0 + a_1^{t-1} X_{0} \nonumber \\
    &amp;   &amp; + a_1^{t-2} U_{1} + \ldots + a_1 U_{t - 2} + U_{t - 1}) + U_{t} \nonumber \\
    &amp; = &amp; a_0 + a_1 a_0 + a_1^2 a_0 + a_1^3 a_0 + \ldots + a_1^{t-1} a_0 + a_1^{t} X_{0} \nonumber \\
    &amp;   &amp; + a_1^{t-1} U_{1} + \ldots a_1^2 U_{t - 2} + a_1 U_{t - 1} + U_{t} \nonumber \\
    &amp; = &amp; (1 + a_1 + a_1^2 + a_1^3 + \ldots + a_1^{t-1}) a_0 + a_1^{t} X_{0} \nonumber \\
    &amp;   &amp; + a_1^{t-1} U_{1} + \ldots + a_1^2 U_{t - 2} + a_1 U_{t - 1} + U_{t}  \nonumber\\
    &amp; = &amp; \frac{1 - a_1^t}{1 - a_1} a_0 + a_1^{t} X_{0} + \sum^{t-1}_{j = 0} a_1^{j} U_{t - j}
    \tag{4.2}
\end{eqnarray}\]</span></p>
<p>De esta forma en la ecuación <a href="procesos-estacionarios-univariados.html#eq:EDOSSol">(4.2)</a> observamos un proceso que es explicado por dos partes: una que depende del tiempo y otra que depende de un proceso estocástico. Asimismo, debe notarse que la condición de convergencia es idéntica que en el caso de ecuaciones en diferencia estudiadas al inicio del curso: <span class="math inline">\(\lvert a_1 \lvert &lt; 1\)</span>, por lo que cuando <span class="math inline">\(t \to \infty\)</span>, la expresión <a href="procesos-estacionarios-univariados.html#eq:EDOSSol">(4.2)</a> será la siguiente:
<span class="math display" id="eq:EDOSLP">\[\begin{equation}
    X_t = \frac{1}{1 - a_1} a_0 + \sum^{\infty}_{j = 0} a_1^{j} U_{t - j}
    \tag{4.3}
\end{equation}\]</span></p>
<p>Así, desaparece la parte dependiente del tiempo y únicamente prevalece la parte que es dependiente del proceso estocástico. Esta es la solución de largo plazo del proceso <span class="math inline">\(AR(1)\)</span>, la cual depende del proceso estocástico. Notemos, además, que esta solución implica que la variable o la serie de tiempo <span class="math inline">\(X_t\)</span> es tambien un proceso estocástico que hereda las propiedades de <span class="math inline">\(U_t\)</span>. Así, <span class="math inline">\(X_t\)</span> es también un proceso estocástico estacionario, como demostraremos más adelante.</p>
<p>Observemos que la ecuación <a href="procesos-estacionarios-univariados.html#eq:EDOSLP">(4.3)</a> se puede reescribir si consideramos la formulación que en la literatura se denomina como la descomposición de Wold, en la cual se define que es posible asumir que <span class="math inline">\(\psi_j = a_1^j\)</span> y se considera el caso en el cual <span class="math inline">\(\lvert a_1 \lvert&lt; 1\)</span>, de esta forma tendremos que por ejemplo cuando:
<span class="math display">\[\begin{equation*}
    \sum^{\infty}_{j = 0} \psi^2_j = \sum^{\infty}_{j = 0} a_1^{2j} = \frac{1}{1 - a_1^2}
\end{equation*}\]</span></p>
<p>Alternativamente y de forma similar a las ecuaciones en diferencia estudiadas previamente podemos escribir el proceso <span class="math inline">\(AR(1)\)</span> mediante el uso del operador rezago como:
<span class="math display" id="eq:AR1">\[\begin{eqnarray}
    X_t &amp; = &amp; a_0 + a_1 L X_t + U_t \nonumber \\
    X_t - a_1 L X_t &amp; = &amp; a_0 + U_t \nonumber \\
    (1 - a_1 L) X_t &amp; = &amp; a_0 + U_t \nonumber \\
    X_t &amp; = &amp; \frac{a_0}{1 - a_1 L} + \frac{1}{1 - a_1 L} U_t
    \tag{4.4}
\end{eqnarray}\]</span></p>
<p>En esta última ecuación retomamos el siguiente término para reescribirlo como:
<span class="math display" id="eq:AR2">\[\begin{equation}
    \frac{1}{1 - a_1 L} = 1 + a_1 L + a_1^2 L^2 + a_1^3 L^3 + \ldots
    \tag{4.5}
\end{equation}\]</span></p>
<p>Tomando este resultado para sustituirlo en ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1">(4.4)</a>, obtenemos la siguiente expresión:
<span class="math display" id="eq:AR1Sol">\[\begin{eqnarray}
X_t &amp; = &amp; (1 + a_1 L + a_1^2 L^2 + a_1^3 L^3 + \ldots) a_0 + (1 + a_1 L + a_1^2 L^2 + a_1^3 L^3 + \ldots) U_t \nonumber \\
    &amp; = &amp; (1 + a_1 + a_1^2 + a_1^3 + \ldots) a_0 + U_t + a_1 U_{t-1} + a_1^2 U_{t-2} + a_1^3 U_{t-3} + \ldots \nonumber \\
    &amp; = &amp; \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j}
    \tag{4.6}
\end{eqnarray}\]</span></p>
<p>Donde la condición de convergencia y estabilidad del proceso descrito en esta ecuación es que <span class="math inline">\(\lvert a_1 \lvert &lt; 1\)</span>. Por lo que hemos demostrado que mediante el uso del operador de rezago es posible llegar al mismo resultado que obtuvimos mediante el procedimiento de sustituciones iterativas.</p>
<p>La ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1Sol">(4.6)</a> se puede interpretar como sigue. La solución o trayectoria de equilibrio de un AR(1) se divide en dos partes. La primera es una constante que depende de los valores de <span class="math inline">\(a_0\)</span> y <span class="math inline">\(a_1\)</span>. La segunda parte es la suma ponderada de las desviaciones o errores observados y acumulados en el tiempo hasta el momento <span class="math inline">\(t\)</span>.</p>
<p>Ahora obtendremos los momentos que describen a la serie de tiempo cuando se trata de un porceso <span class="math inline">\(AR(1)\)</span>. Para ello debemos obtener la media, la varianza y las covarianzas de <span class="math inline">\(X_t\)</span>. Para los siguientes resultados debemos recordar y tener en mente que si <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio, entonces:</p>
<ol style="list-style-type: decimal">
<li>
<span class="math inline">\(\mathbb{E}[U_t] = 0\)</span> para todo <span class="math inline">\(t\)</span>
</li>
<li>
<span class="math inline">\(Var[U_t] = \sigma^2\)</span> para todo <span class="math inline">\(t\)</span>
</li>
<li>
<span class="math inline">\(Cov[U_t, U_s] = 0\)</span> para todo <span class="math inline">\(t \neq s\)</span>
</li>
</ol>
<p>Dicho lo anterior y partiendo de la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1Sol">(4.6)</a>, el primer momento o valor esperado de la serie de tiempo será el siguiente:
<span class="math display" id="eq:AR1m1">\[\begin{eqnarray}
\mathbb{E}[X_t] &amp; = &amp; \mathbb{E} \left[ \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j} \right] \nonumber \\
    &amp; = &amp; \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j \mathbb{E}[U_{t-j}] \nonumber \\
    &amp; = &amp; \frac{a_0}{1 - a_1} = \mu
    \tag{4.7}
\end{eqnarray}\]</span></p>
<p>Respecto de la varianza podemos escribir la siguiente expresión a partir de la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1Sol">(4.6)</a>:
<span class="math display" id="eq:AR1Var">\[\begin{eqnarray}
Var[X_t] &amp; = &amp; \mathbb{E}[(X_t - \mu)^2] \nonumber \\
    &amp; = &amp; \mathbb{E} \left[ \left( \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j} - \frac{a_0}{1 - a_1} \right)^2 \right] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_{t} + a_1 U_{t-1} + a_1^2 U_{t-2} + a_1^3 U_{t-3} + \ldots)^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[U^2_{t} + a_1^2 U^2_{t-1} + a_1^4 U^2_{t-2} + a_1^6 U^2_{t-3} + \ldots \nonumber \\
    &amp;   &amp; + 2 a_1 U_t U_{t-1} + 2 a_1^2 U_t U_{t-2} + \ldots] \nonumber \\
    &amp; = &amp; \mathbb{E}[U^2_{t}] + a_1^2 \mathbb{E}[U^2_{t-1}] + a_1^4 \mathbb{E}[U^2_{t-2}] + a_1^6 \mathbb{E}[U^2_{t-3}] + \ldots \nonumber \\
    &amp; = &amp; \sigma^2 + a_1^2 \sigma^2 + a_1^4 \sigma^2 + a_1^6 \sigma^2 + \ldots \nonumber \\
    &amp; = &amp; \sigma^2 (1 + a_1^2 + a_1^4 + a_1^6 + \ldots) \nonumber \\
    &amp; = &amp; \sigma^2 \frac{1}{1 - a_1^2} = \gamma(0)
    \tag{4.8}
\end{eqnarray}\]</span></p>
<p>Previo a analizar la covarianza de la serie recordemos que para el proceso puramente aleatorio <span class="math inline">\(U_t\)</span> su varianza y covarianza puede verse como <span class="math inline">\(\mathbb{E}[U_t, U_s] = \sigma^2\)</span>, para <span class="math inline">\(t = s\)</span>, y <span class="math inline">\(\mathbb{E}[U_t, U_s] = 0\)</span>, para cualquier otro caso, respectivamente.</p>
<p>Dicho lo anterior, partiendo de la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1Sol">(4.6)</a> la covarianza de la serie estará dada por:
<span class="math display" id="eq:AR1Cov">\[\begin{eqnarray}
Cov(X_t, X_{t-\tau}) &amp; = &amp; \mathbb{E}[(X_t - \mu)(X_{t-\tau} - \mu)] \nonumber \\
    &amp; = &amp; \mathbb{E} \left[ \left( \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-j} - \frac{a_0}{1 - a_1} \right) \right. \nonumber \\
    &amp;   &amp; \left. \times \left( \frac{a_0}{1 - a_1} + \sum^{\infty}_{j = 0} a_1^j U_{t-\tau-j} - \frac{a_0}{1 - a_1} \right) \right] \nonumber \\
    &amp; = &amp; a_1^{\tau} \mathbb{E}[U^2_{t-\tau} + a_1 U^2_{t-\tau-1} + a_1^2 U^2_{t-\tau-2} + a_1^3 U^2_{t-\tau-3} + \ldots] \nonumber \\
    &amp; = &amp; a_1^{\tau} \sigma^2 \frac{1}{1 - a_1^2} = \gamma(\tau)
    \tag{4.9}
\end{eqnarray}\]</span></p>
<p>Notése que con estos resultados en las ecuaciones <a href="procesos-estacionarios-univariados.html#eq:AR1Var">(4.8)</a> y <a href="procesos-estacionarios-univariados.html#eq:AR1Cov">(4.9)</a> podemos construir la función de autocorrelación teórica como sigue:
<span class="math display" id="eq:emi1">\[\begin{eqnarray}
\rho(\tau) &amp; = &amp; \frac{\gamma(\tau)}{\gamma(0)} \nonumber \\
    &amp; = &amp; a_1^\tau
    \tag{4.10}
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\tau = 1, 2, 3, \ldots\)</span> y <span class="math inline">\(\lvert a_1 \lvert &lt; 1\)</span>. Este último resultado significa que cuando el proceso autoregresivo es de orden 1 (es decir, AR(1)) la función de autocorrelación teóricamente es igual al parámetro <span class="math inline">\(a_1\)</span> elevado al número de rezagos considerados. No obstante, note que esto no significa que la autocorrelación observada sea como lo expresa en planteamiento anterior. Por el contrario, una observación sencilla mostraría que la autocorrelación observada sería ligeramente distinta a la autocorrelación teórica.</p>
<p>Ahora veámos algunos ejemplos. En el primer ejemplo simularemos una serie y mostraremos el analísis de un proceso construído considerando un proceso puramente aleatorio como componente <span class="math inline">\(U_t\)</span>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;El procedimiento e implementación del ejercicio está en el archivo R denominado Clase 4 del repositorio de GitHub.&lt;/p&gt;"><sup>2</sup></a> Por su parte, en un segundo ejemplo aplicaremos el análisis a una serie de tiempo de una variable económica observada.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;El procedimiento e implementación del ejercicio está en el archivo R denominado Clase 5 del repositorio de GitHub.&lt;/p&gt;"><sup>3</sup></a></p>
<p>Para el primer ejemplo consideremos un proceso dado por la forma de un <span class="math inline">\(AR(1)\)</span> como en la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1">(4.4)</a> cuya solución esta dada por la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1Sol">(4.6)</a>. En especifico, supongamos que el término o componente estocástico <span class="math inline">\(U_t\)</span> es una serie generada a partir de numeros aleatorios de una función normal con media <span class="math inline">\(0\)</span> y desviación estándar <span class="math inline">\(4\)</span>. Los detalles del proceso simulado se muestra en las siguientes gráficas.</p>
<p>La Figura <a href="procesos-estacionarios-univariados.html#fig:GAR1Real">4.1</a> ilustra el comportamiento que se debería observar en una serie considerando el procedimiento iterativo de construcción. Por su parte, la Figura <a href="procesos-estacionarios-univariados.html#fig:GAR1Teo">4.2</a> ilustra el proceso o trayectoria de la solución de la serie de tiempo. Finalmente, las Figuras <a href="procesos-estacionarios-univariados.html#fig:GAR1FACr">4.3</a> y <a href="procesos-estacionarios-univariados.html#fig:GAR1FACr">4.3</a> muestran el correlograma calculado considerando una función de autocorrelación aplicada al porceso real y una función de autocorrelación aplicada al proceso teórico, respectivamente.</p>
<p>Recordemos que una trayectoria de equilibrio o solución de un <span class="math inline">\(AR(1)\)</span> es como se muestra en la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR1Sol">(4.6)</a>. Así, nuestra serie simulada cumple con la característica de que los errores son más relevantes cuando la serie es corta. Por el contrario, los errores son menos relevantes, cuando la serie es muy larga. La Figura <a href="procesos-estacionarios-univariados.html#fig:GAR1Com">4.5</a> ilustra esta observación de la trayectoria de equilibrio.</p>
<p>Para el segundo ejemplo consideremos una aplicación a una serie de tiempo en especifico: Pasajeros transportados mensualmente en el Sistema de Transporte Colectivo Metro (pasajeros medidos en millones).<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Fuente: INEGI, .&lt;/p&gt;"><sup>4</sup></a></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://www.stefanom.io/latex2exp/">latex2exp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Parametros:</span></span>
<span><span class="va">a0</span> <span class="op">&lt;-</span> <span class="fl">5</span>; <span class="va">a1</span> <span class="op">&lt;-</span> <span class="fl">0.9</span>; <span class="va">X_0</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">a0</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">a1</span><span class="op">)</span><span class="op">)</span>; <span class="cn">T</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co"># Definimos un data frame para almacenar el proceso, agregamos una columna para el tiempo</span></span>
<span><span class="va">X_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Tiempo <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="cn">T</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#  Parte estocastica de la serie de tiempo:</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">12345</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Agregamos un término estocástico al data frame</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">U_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="cn">T</span><span class="op">+</span><span class="fl">1</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Agregamos columnas con NA's para un proceso teorico y uno real</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">X_t</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span></span>
<span><span class="co"># La serie teórica inicia en un valor inicial X_0</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">X_t</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">X_0</span></span>
<span></span>
<span><span class="co"># La serie real inicia en un valor inicial X_0</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">X_0</span></span>
<span></span>
<span><span class="co"># Agregamos una columna para la función de Autocorrelación teórica:</span></span>
<span><span class="va">X_t</span><span class="op">$</span><span class="va">rho</span> <span class="op">&lt;-</span><span class="cn">NA</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="cn">T</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Real:</span></span>
<span>  <span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">a0</span> <span class="op">+</span> <span class="va">a1</span><span class="op">*</span><span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">X_t</span><span class="op">$</span><span class="va">U_t</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Teórico:</span></span>
<span>  <span class="va">X_t</span><span class="op">$</span><span class="va">X_t</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="va">X_t</span><span class="op">$</span><span class="va">X_t</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="op">(</span><span class="va">a1</span><span class="op">^</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="va">X_t</span><span class="op">$</span><span class="va">U_t</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="co"># Autocorrelación:</span></span>
<span>  <span class="va">X_t</span><span class="op">$</span><span class="va">rho</span><span class="op">[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op">=</span> <span class="va">a1</span><span class="op">^</span><span class="op">(</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GAR1Real"></span>
<img src="03-PE_Univariados_files/figure-html/GAR1Real-1.png" alt="AR(1) considerando $X_t=5+0.9X_{t-1}+U_t$ ; $X_0=50$ y que $U_t$~$N(0, 4)$ y que $U_t \sim \mathcal{N}(0, 4)$" width="100%"><p class="caption">
Figure 4.1: AR(1) considerando <span class="math inline">\(X_t=5+0.9X_{t-1}+U_t\)</span> ; <span class="math inline">\(X_0=50\)</span> y que <span class="math inline">\(U_t\)</span>~<span class="math inline">\(N(0, 4)\)</span> y que <span class="math inline">\(U_t \sim \mathcal{N}(0, 4)\)</span>
</p>
</div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">X_t</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tiempo</span>, y <span class="op">=</span> <span class="va">X_t</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Tiempo"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$X_t$"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Comportamiento del Proceso Teórico"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Con un error con Distribución Normal (media = 0, desviación estándar = 4)"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Fuente: Elaboración propia."</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GAR1Teo"></span>
<img src="03-PE_Univariados_files/figure-html/GAR1Teo-1.png" alt="$X_t = \frac{5}{1 - 0.9} + \sum_{j = 0}^{t-1} 0.9^j U_{t-j}$, y que $U_t \sim \mathcal{N}(0, 4)$}" width="100%"><p class="caption">
Figure 4.2: <span class="math inline">\(X_t = \frac{5}{1 - 0.9} + \sum_{j = 0}^{t-1} 0.9^j U_{t-j}\)</span>, y que <span class="math inline">\(U_t \sim \mathcal{N}(0, 4)\)</span>}
</p>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">X_t</span><span class="op">$</span><span class="va">XR_t</span>, lag.max <span class="op">=</span> <span class="fl">30</span>, col <span class="op">=</span> <span class="st">"blue"</span>, </span>
<span>    ylab <span class="op">=</span> <span class="st">"Autocorrelacion"</span>,</span>
<span>    xlab<span class="op">=</span><span class="st">"Rezagos"</span>, </span>
<span>    main<span class="op">=</span><span class="st">"Funcion de Autocorrelacion Real"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GAR1FACr"></span>
<img src="03-PE_Univariados_files/figure-html/GAR1FACr-1.png" alt="Función de autocorrelación de un AR(1): $\rho(\tau)=\frac{\gamma(    au)}{\gamma(0)}$" width="100%"><p class="caption">
Figure 4.3: Función de autocorrelación de un AR(1): <span class="math inline">\(\rho(\tau)=\frac{\gamma( au)}{\gamma(0)}\)</span>
</p>
</div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/barplot.html">barplot</a></span><span class="op">(</span><span class="va">X_t</span><span class="op">$</span><span class="va">rho</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">]</span>, names.arg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span>, border<span class="op">=</span><span class="st">"blue"</span>, density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">20</span><span class="op">)</span>, </span>
<span>        ylab <span class="op">=</span> <span class="st">"Autocorrelacion"</span>, </span>
<span>        xlab<span class="op">=</span><span class="st">"Rezagos"</span>, </span>
<span>        main<span class="op">=</span><span class="st">"Funcion de Autocorrelacion Teórica"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GAR1FACt"></span>
<img src="03-PE_Univariados_files/figure-html/GAR1FACt-1.png" alt="Función de autocorrelación de un AR(1): $\rho(\tau)= a_1^\tau$" width="100%"><p class="caption">
Figure 4.4: Función de autocorrelación de un AR(1): <span class="math inline">\(\rho(\tau)= a_1^\tau\)</span>
</p>
</div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">X_t</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Tiempo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">XR_t</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">X_t</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.5</span>, color <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Tiempo"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="fu"><a href="https://www.stefanom.io/latex2exp/reference/TeX.html">TeX</a></span><span class="op">(</span><span class="st">"$X_t$"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Comportamiento de los Procesos Real y Teórico"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Con un error con Distribución Normal (media = 0, desviación estándar = 4)"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Fuente: Elaboración propia."</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GAR1Com"></span>
<img src="03-PE_Univariados_files/figure-html/GAR1Com-1.png" alt="AR(1) considerando en conjunto $X_t = 5 + 0.9 X_{t-1} + U_t$; $X_0 = 50$ y $X_t = \frac{5}{1 - 0.9} + \sum_{j = 0}^{t-1} 0.9^j U_{t-j}$, y que $U_t \sim \mathcal{N}(0, 4)$" width="100%"><p class="caption">
Figure 4.5: AR(1) considerando en conjunto <span class="math inline">\(X_t = 5 + 0.9 X_{t-1} + U_t\)</span>; <span class="math inline">\(X_0 = 50\)</span> y <span class="math inline">\(X_t = \frac{5}{1 - 0.9} + \sum_{j = 0}^{t-1} 0.9^j U_{t-j}\)</span>, y que <span class="math inline">\(U_t \sim \mathcal{N}(0, 4)\)</span>
</p>
</div>
<p>A la serie se le aplicará una metodología de estimación dada por el método de Máxima Verosimilitud (ML, por sus siglás en inglés). Antes de realizar el proceso de estimación consideremos una transformación de diferencias logaritmicas, con el objeto de obtener una serie de tiempo expresada en tasas de crecimiento y con un comportamiento parecido a un proceso estacionario.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;Las tasas de crecimiento no son porcentuales, para hacerlas porcentuales faltaría multiplicar por 100 a la serie.&lt;/p&gt;"><sup>5</sup></a></p>
<p>Así, para cada una de las series que analicemos en diferencias logaritmicas las expresaremos bajo la siguiente transformación: <span class="math display">\[\begin{equation*}
    DLX_t = log(X_t) - log(X_{t-k})
\end{equation*}\]</span></p>
<p>Donde <span class="math inline">\(k = 1, 2, 3, \ldots\)</span> y <span class="math inline">\(log(.)\)</span> es la función logaritmo natural. Esta expresión se pude interpretar como una tasa de crecimiento puesto que asumimos variaciones pequeñas para las cuales se cumple que: <span class="math inline">\(log(X_t) - log(X_{t-k}) \approx \frac{X_t - X_{t-k}}{X_t}\)</span>.</p>
<p>Primero, al realizar el análisis de una serie de tiempo deberemos decidir si éste se realizará para la serie en niveles o en diferencias. Por convención, decimos que la series esta en niveles si ésta se analiza sin heacerle ninguna transformación o si se analiza aplicando logarimos. Cuando la serie se analiza en diferencias significa que la diferencia se hace sin aplicar logaritmos o aplicando logaritmos. Sin embargo, lo común es hacer un análisis en logaritmos.</p>
<p>Para decidir cómo analizar la serie de pasajeros en el metro de la CDMX en la Figura <a href="procesos-estacionarios-univariados.html#fig:GPaxMetro">4.6</a> se muestra la gráfica de la serie en niveles (sin transformación logaritmica y con transformación logarítmica) y en diferencias logarítmicas mensuales (es decir, con <span class="math inline">\(k = 1\)</span>).</p>
<p>A continuación, estimaremos una <span class="math inline">\(AR(1)\)</span> para la serie en niveles bajo la transformación logaritmica (<span class="math inline">\(PaxLMetro_t\)</span>) y en diferencias logarítmitcas (<span class="math inline">\(PaxDLMetro_t\)</span>). Para el primer caso obtenemos el siguiente resultado:</p>
<p><span class="math display">\[\begin{eqnarray}
PaxLMetro_t  =  4.8190 &amp; + &amp; 0.5916 PaxLMetro_{t-1} \\
    (0.0105) &amp; + &amp; (0.0526) \\
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
\hat{\sigma}^2 &amp; = &amp; 0.004335  y  AIC  =  -602.73
\end{eqnarray}\]</span></p>
<p>Para el segundo caso obtenemos el siguiente resultado:</p>
<p><span class="math display">\[\begin{eqnarray}
PaxDLMetro_t  =  0.0007 &amp; - &amp; 0.6194 PaxDLMetro_{t-1} \\
    (0.0023) &amp; + &amp; (0.0511) \\
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
\hat{\sigma}^2 &amp; = &amp; 0.003344 &amp; y &amp; AIC &amp; = &amp; -660.53
\end{eqnarray}\]</span></p>
<p>En ambos casos observamos que el parámetro asociado al componente AR es significativo y cumple con la restricción de ser en valor absoluto menor a 1, por lo que la solución asociada al procesp será convergente. También en ambos casos se reporta la estadística o Criterio de Información de Akaike (AIC, por sus siglas en inglés), misma que más adelante discutiremos su importancia y aplicación.</p>
</div>
<div id="ar2" class="section level3" number="4.1.2">
<h3>
<span class="header-section-number">4.1.2</span> AR(2)<a class="anchor" aria-label="anchor" href="#ar2"><i class="fas fa-link"></i></a>
</h3>
<p>Una vez analizado el caso de <span class="math inline">\(AR(1)\)</span> analizaremos el caso del <span class="math inline">\(AR(2)\)</span>. La ecuación generalizada del proceso autoregresivo de orden 2 (denotado como <span class="math inline">\(AR(2)\)</span>) puede ser escrito como:
<span class="math display" id="eq:AR2Eq">\[\begin{equation}
    X_t = a_0 + a_1 X_{t-1} + a_2 X_{t-2} + U_t
    \tag{4.11}
\end{equation}\]</span></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">stats</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://readxl.tidyverse.org">readxl</a></span><span class="op">)</span></span>
<span><span class="va">Datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Base_Transporte.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Conversion a series de tiempo:</span></span>
<span></span>
<span><span class="co">#Una serie - caso univariado:</span></span>
<span></span>
<span><span class="co"># En Niveles</span></span>
<span><span class="va">Dat_Aereo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pax_Nal"</span>, <span class="st">"Pax_Int"</span>, <span class="st">"Vue_Nal"</span>, <span class="st">"Vue_Int"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Pax_Metro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Metro</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># En Logaritmos:</span></span>
<span><span class="va">Dat_LAereo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Pax_Nal"</span>, <span class="st">"Pax_Int"</span>, <span class="st">"Vue_Nal"</span>, <span class="st">"Vue_Int"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Pax_LMetro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Metro</span><span class="op">)</span>, start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Diferencias mensuales:</span></span>
<span></span>
<span><span class="va">Pax_DLMetro</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Metro</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos</span><span class="op">$</span><span class="va">Pax_Metro</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                 start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#Graficas</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Pax_Metro</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Pasajeros transportados (Millones) en el SCM"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Pax_LMetro</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"LN Pasajeros transportados (Millones) en el SCM"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Pax_DLMetro</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Diff LN Pasajeros transportados (Millones) en el SCM"</span>, </span>
<span>     col <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Pax_Metro</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Pasajeros transportados (Millones) en el SCM"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Pax_LMetro</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"LN Pasajeros transportados (Millones) en el SCM"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Pax_DLMetro</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, </span>
<span>     main <span class="op">=</span> <span class="st">"Diff LN Pasajeros transportados (Millones) en el SCM"</span>, </span>
<span>     col <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GPaxMetro"></span>
<img src="03-PE_Univariados_files/figure-html/GPaxMetro-1.png" alt="Pasajeros transportados (Millones) en el metro de la CDM en niveles y en diferencias logaritmicas." width="100%"><p class="caption">
Figure 4.6: Pasajeros transportados (Millones) en el metro de la CDM en niveles y en diferencias logaritmicas.
</p>
</div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Donde <span class="math inline">\(U_t\)</span> denota un proceso puramente aleatorio con media cero (<span class="math inline">\(0\)</span>), varianza constante (<span class="math inline">\(\sigma^2\)</span>) y autocovarianza cero (<span class="math inline">\(Cov(U_t, U_s) = 0\)</span>, con <span class="math inline">\(t \neq s\)</span>), y un parametro <span class="math inline">\(a_2 \neq 0\)</span>. Así, utilizando el operador rezago podemos reescribir la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR2Eq">(4.11)</a> como:
<span class="math display">\[\begin{eqnarray*}
    X_t - a_1 X_{t-1} - a_2 X_{t-2} &amp; = &amp; a_0 + U_t \\
    (1 - a_1 L^1 - a_2 L^2) X_t &amp; = &amp; a_0 + U_t
\end{eqnarray*}\]</span></p>
<p>Donde, vamos a denotar a <span class="math inline">\(\alpha (L) = (1 - a_1 L^1 - a_2 L^2)\)</span>, y lo llamaremos como un polinomio que depende del operador rezago y que es distinto de cero. De esta forma podemos reescribir a la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR2Eq">(4.11)</a> como:
<span class="math display" id="eq:AR2Eq1">\[\begin{equation}
    \alpha(L) X_t = a_0 + U_t
    \tag{4.12}
\end{equation}\]</span></p>
<p>Ahora, supongamos que existe el inverso multiplicativo del polinomio <span class="math inline">\(\alpha(L)\)</span>, el cual será denotado como: <span class="math inline">\(\alpha^{-1}(L)\)</span> y cumple con que:
<span class="math display" id="eq:AR2Eq2">\[\begin{equation}
    \alpha^{-1}(L) \alpha(L) = 1   
      \tag{4.13}
\end{equation}\]</span></p>
<p>Así, podemos escribir la solución a la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR2Eq">(4.11)</a> como:
<span class="math display">\[\begin{equation}
    X_t = \alpha^{-1}(L) \delta + \alpha^{-1}(L) U_t
\end{equation}\]</span></p>
<p>Si utilizamos el hecho que <span class="math inline">\(\alpha^{-1}(L)\)</span> se puede descomponer a través del procedimiento de Wold en un polinomio de forma similar el caso de <span class="math inline">\(AR(1)\)</span>, tenemos que:
<span class="math display" id="eq:AR2Eq3">\[\begin{equation}
    \alpha^{-1}(L) = \psi_0 + \psi_1 L + \psi_2 L^2 + \ldots
      \tag{4.14}
\end{equation}\]</span></p>
<p>Por lo tanto, el inverso multiplicativo <span class="math inline">\(\alpha^{-1}(L)\)</span> se puede ver como:
<span class="math display" id="eq:InvAlpha">\[\begin{equation}
    1 = (1 - a_1 L^1 - a_2 L^2) (\psi_0 + \psi_1 L + \psi_2 L^2 + \ldots)
      \tag{4.15}
\end{equation}\]</span></p>
<p>Desarrollando la ecuación <a href="procesos-estacionarios-univariados.html#eq:InvAlpha">(4.15)</a> tenemos la sigueinte expresión:</p>
<p><span class="math display">\[\begin{eqnarray}
    1 &amp; = &amp; \psi_0 &amp; + &amp; \psi_1 L &amp; + &amp; \psi_2 L^2 &amp; + &amp; \psi_3 L^3 &amp; + &amp; \ldots \\
     &amp;  &amp;  &amp; - &amp; a_1 \psi_0 L &amp; - &amp; a_1 \psi_1 L^2 &amp; - &amp; a_1 \psi_2 L^3 &amp; - &amp; \ldots \\
    &amp; &amp;  &amp;  &amp;  &amp; - &amp; a_2 \psi_0 L^2  &amp; - &amp; a_2 \psi_1 L^3 &amp; - &amp; \ldots
\end{eqnarray}\]</span></p>
<p>Ahora, podemos agrupar todos los términos en función del exponente asociado al operador rezago <span class="math inline">\(L\)</span>. La siguiente es una solución partícular y es una de las múltiples que podrían existir que cumpla con la ecuación <a href="procesos-estacionarios-univariados.html#eq:InvAlpha">(4.15)</a>. Sin embargo, para efectos del análisis sólo necesitamos una de esas soluciones. Utilizaremos las siguientes condiciones que deben cumplirse en una de las posibles soluciones:</p>
<p><span class="math display">\[\begin{eqnarray}
    L^0 : &amp;   &amp; \Rightarrow &amp; \psi_0 = 1 \\
    L : &amp; \psi_1 - a_1 \psi_0 = 0 &amp; \Rightarrow &amp; \psi_1 = a_1$ \\
    L^2 : &amp; \psi_2 - a_1 \psi_1 - a_2 \psi_0 = 0 &amp; \Rightarrow &amp; \psi_2 = a^2_1 + a_2 \\
    L^3 : &amp; \psi_3 - a_1 \psi_2 - a_2 \psi_1 = 0 &amp; \Rightarrow &amp; \psi_3 = a^3_1 + 2 a_1 a_2$ \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots
\end{eqnarray}\]</span></p>
<p>De esta forma podemos observar que en el límite siempre obtendremos una ecuación del tipo <span class="math inline">\(\psi_j - a_1 \psi_{j-1} - a_2 \psi_{j-2} = 0\)</span> asociada a cada uno de los casos en que exista un <span class="math inline">\(L^j\)</span>, donde <span class="math inline">\(j \neq 0, 1\)</span>, y la cual siempre podremos resolver conociendo que las condiciones iniciales son: <span class="math inline">\(\psi_0 = 1\)</span> y <span class="math inline">\(\psi_1 = a_1\)</span>.</p>
<p>Así, de las relaciones antes mencionadas y considerando que <span class="math inline">\(\alpha^{-1} (L)\)</span> aplicada a una constante como <span class="math inline">\(a_0\)</span>, tendrá como resultado otra constante. De esta forma podemos escribir que la solución del proceso AR(2) en la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR2Eq">(4.11)</a> será dada por una expresión como sigue:
<span class="math display" id="eq:AR2EqSol">\[\begin{equation}
    X_t = \frac{\delta}{1 - a_1 - a_2} + \sum^{\infty}_{j = 0} \psi_{t - j} U_{t - j}
    \tag{4.16}
\end{equation}\]</span></p>
<p>Donde todos los parametros <span class="math inline">\(\psi_i\)</span> está determinado por los parámtros <span class="math inline">\(a_0\)</span>, <span class="math inline">\(a_1\)</span> y <span class="math inline">\(a_2\)</span>. En particular, <span class="math inline">\(\psi_0 = 1\)</span> y <span class="math inline">\(\psi_1 = a_1\)</span> como describimos anteriormente. Al igual que en el caso del <span class="math inline">\(AR(1)\)</span>, en la ecuación <a href="procesos-estacionarios-univariados.html#eq:AR2EqSol">(4.16)</a> las condiciones de estabilidad estarán dadas por las soluciones del siguiente polinomio característico:<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Note que raíces son equivalentes al inversio de las del polinomio dado por &lt;span class="math inline"&gt;\(\lambda^2 a_2 - \lambda a_1 - 1 = 0\)&lt;/span&gt;.&lt;/p&gt;'><sup>6</sup></a>
<span class="math display" id="eq:AR2EqSol1">\[\begin{equation}
    \lambda^2 - \lambda a_1 - a_2 = 0
    \tag{4.17}
\end{equation}\]</span></p>
<p>Así, la condición de estabilidad de la trayectoria es que <span class="math inline">\(\lvert\lambda_i\lvert &lt; 1\)</span>, para <span class="math inline">\(i = 1, 2\)</span>. Es decir, es necesario que cada una de las raíces sea, en valor absoluto, siempre menor que la unidad. Estas son las condiciones de estabilidad para el proceso <span class="math inline">\(AR(2)\)</span>.</p>
<p>Finalmente, al igual que en un <span class="math inline">\(AR(1)\)</span>, a continuación determinamos los momentos de una serie que sigue un proceso <span class="math inline">\(AR(2)\)</span>. Iniciamos con la determinación de la media de la serie:
<span class="math display" id="eq:AR2EqSol2">\[\begin{equation}
    \mathbb{E}[X_t] = \mu = \frac{a_0}{1 - a_1 - a_2}
    \tag{4.18}
\end{equation}\]</span></p>
<p>Lo anterior es cierto puesto que <span class="math inline">\(\mathbb{E}[U_{t - i}] = 0\)</span>, para todo <span class="math inline">\(i = 0, 1, 2, \ldots\)</span>. Para determinar la varianza utilizaremos las siguientes relaciones basadas en el uso del valor esperado, varianza y covarianza de la serie. Adicionalmente, para simplificar el trabajo asumamos que <span class="math inline">\(a_0 = 0\)</span>, lo cual implica que <span class="math inline">\(\mu = 0\)</span>. Dicho lo anterior, partamos de:
<span class="math display" id="eq:AR2EqSol3">\[\begin{eqnarray}
    \mathbb{E}[X_t X_{t - \tau}] &amp; = &amp; \mathbb{E}[(a_1 X_{t-1} + a_2 X_{t-2} + U_t) X_{t - \tau}]\\
    &amp; = &amp; a_1 \mathbb{E}[X_{t - 1} X_{t - \tau}] + a_2 \mathbb{E}[X_{t - 2} X_{t - \tau}] + \mathbb{E}[U_{t} X_{t - \tau}]
    \tag{4.19}
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\tau = 0, 1, 2, 3, \ldots\)</span> y que <span class="math inline">\(\mathbb{E}[U_{t} X_{t - \tau}] = 0\)</span> para todo <span class="math inline">\(\tau \neq 0\)</span>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;Es fácil demostrar está afirmación, sólo requiere de desarrollar la expresión y utilizar el hecho de que &lt;span class="math inline"&gt;\(U_t\)&lt;/span&gt; es un proceso pueramente aleatorio, por lo que la covarianza es cero (0).&lt;/p&gt;'><sup>7</sup></a> Dicho esto, podemos derivar el valor del valor esperado para diferentes valores de <span class="math inline">\(\tau\)</span>:</p>
<p><span class="math display">\[\begin{eqnarray}
    \tau = 0: &amp; \gamma(0) &amp; = &amp; \alpha_1 \gamma(1) + \alpha_2 \gamma(2) + \sigma^2 \\
    \tau = 1: &amp; \gamma(1) &amp; = &amp; \alpha_1 \gamma(0) + \alpha_2 \gamma(1) \\
    \tau = 2: &amp; \gamma(2) &amp; = &amp; \alpha_1 \gamma(1) + \alpha_2 \gamma(0) \\
    \vdots &amp; \vdots &amp; \vdots &amp; \vdots
\end{eqnarray}\]</span></p>
<p>Donde debe ser claro que <span class="math inline">\(\mathbb{E}[(X_{t} - \mu)(X_{t - \tau} - \mu)] = \mathbb{E}[X_{t} X_{t - \tau}] = \gamma(\tau)\)</span>. Así, en general cuando <span class="math inline">\(\tau \neq 0\)</span>:
<span class="math display">\[\begin{equation}
    \gamma(\tau) = a_1 \gamma(\tau - 1) + a_2 \gamma(\tau - 2)
\end{equation}\]</span></p>
<p>Realizando la sustitución recursiva y solucionando el sistema respectivo obtenemos que las varianza y covarianzas estaran determinadas por:
<span class="math display" id="eq:AR2EqSol5">\[\begin{equation}
    Var[X_t] = \gamma(0) = \frac{1 - a_2}{(1 + a_2)[(1 - a_2)^2 - a^2_1]} \sigma^2
    \tag{4.20}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:AR2EqSol6">\[\begin{equation}
    \gamma(1) = \frac{a_1}{(1 + a_2)[(1 - a_2)^2 - a^2_1]} \sigma^2
    \tag{4.21}
\end{equation}\]</span></p>
<p><span class="math display" id="eq:AR2EqSol7">\[\begin{equation}
    \gamma(2) = \frac{a^2_1 + a_2 - a^2_2}{(1 + a_2)[(1 - a_2)^2 - a^2_1]} \sigma^2
    \tag{4.22}
\end{equation}\]</span></p>
<p>Recordemos que las funciones de autocorrelación se obtienen de la división de cada unas de las funciones de covarianza (<span class="math inline">\(\gamma(\tau)\)</span>) por la varianza (<span class="math inline">\(\gamma(0)\)</span>). Así, podemos construir la siguiente expresión:
<span class="math display" id="eq:AR2EqSol8">\[\begin{equation}
    \rho(\tau) - a_1 \rho(\tau - 1) - a_2 \rho(\tau - 2) = 0
    \tag{4.23}
\end{equation}\]</span></p>
<p>Ahora veámos un ejemplo. Utilizaremos la serie de Pasajeros en vuelos nacionales (en vuelos de salidas) para estimar un <span class="math inline">\(AR(2)\)</span> mediante el método de máxima verosimilitud (ML, por sus siglas en inglés). Antes de realizar el proceso de estimación consideremos una transformación de la serie en logaritmos y una más en diferencias logarítmicas; lo anterior con el objeto de obtener un conjunto de series de tiempo suavizada y expresada en tasas de crecimiento, con un comportamiento parecido a un proceso estacionario.</p>
<p>Así, para cada una de las series que analicemos en diferencias logarítmicas las expresaremos bajo la siguiente transformación:
<span class="math display">\[\begin{equation*}
    DLX_t = log(X_t) - log(X_{t-k})
\end{equation*}\]</span></p>
<p>Donde <span class="math inline">\(k = 1, 2, 3, \ldots\)</span> y <span class="math inline">\(log(.)\)</span> es la función logaritmo natural. Por convención, decimos que la serie está en niveles si ésta se analiza sin heacerle ninguna transformación o se analiza en logarimos. Cuando la serie se analiza en diferencias significa que la diferencia se hace sin aplicar logaritmos. Y cuando la serie analizada está en diferenncias logarítmicas también diremos que esta en diferencias. Sin embargo, lo común es hacer un análisis en logaritmos y en difereencias logarítmicas.</p>
<p>Primero, para decidir si se realizará un AR(2) para la serie en niveles o en diferencias analizaremos su gráfica. La serie en niveles, en niveles bajo una transformación logarítmica y en diferencias logarítmicas mensuales de los pasajeros en vuelos nacionales se muestra en la Figura <a href="procesos-estacionarios-univariados.html#fig:GPaxNal">4.7</a>.</p>
<p>A continuación, estimaremos un <span class="math inline">\(AR(2)\)</span> para la serie en niveles bajo una transformación logarítmica (<span class="math inline">\(LPaxNal_t\)</span>) y en diferencias logarítmitcas (<span class="math inline">\(DLPax_Nal_t\)</span>). Para el primer caso obtenemos el siguiente resultado:</p>
<p><span class="math display">\[\begin{eqnarray}
    LPaxNal_t &amp; = &amp; 14.6267 &amp; + &amp; 0.7637  &amp; LPaxNal_{t-1} \\
    &amp;  &amp; (0.1816) &amp;  &amp; (0.0637) &amp; \\
    &amp;  &amp;  &amp; + &amp; 0.2025 &amp; LPaxNal_{t-2} \\
    &amp;  &amp;  &amp;  &amp; (0.0646) &amp;
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
\hat{\sigma}^2 &amp; = &amp; 0.01138 &amp; y &amp; AIC &amp; = &amp; -372.64
\end{eqnarray}\]</span></p>
<p>Para el segundo caso obtenemos el siguiente resultado:
<span class="math display">\[\begin{eqnarray}
    DLPaxNal_t &amp; = &amp; 0.0050 &amp; - &amp; 0.3205  &amp; DLPaxNal_{t-1} \\
    &amp;  &amp; (0.0036) &amp;  &amp; (0.0592) &amp; \\
    &amp;  &amp;  &amp; - &amp; 0.4242 &amp; DLPaxNal_{t-2} \\
    &amp;  &amp;  &amp;  &amp; (0.0591) &amp;
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
\hat{\sigma}^2 &amp; = &amp; 0.009378 &amp; y &amp; AIC &amp; = &amp; -418.3
\end{eqnarray}\]</span></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">Datos1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Clase_06/Base_Transporte.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">Pax_Nal1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos1</span><span class="op">$</span><span class="va">Pax_Nal</span>, </span>
<span>              start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>              end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>              freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Logaritmos:</span></span>
<span><span class="va">LPax_Nal1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos1</span><span class="op">$</span><span class="va">Pax_Nal</span><span class="op">)</span>, </span>
<span>               start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>               end <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">7</span><span class="op">)</span>, </span>
<span>               freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Diferencias mensuales:</span></span>
<span><span class="va">DLPax_Nal1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos1</span><span class="op">$</span><span class="va">Pax_Nal</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos1</span><span class="op">$</span><span class="va">Pax_Nal</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Pax_Nal1</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, ylab <span class="op">=</span> <span class="st">"Pasajeros"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Pasajeros en vuelos nacionales de salida"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">LPax_Nal1</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, ylab <span class="op">=</span> <span class="st">"LN Pasajeros"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"LN Pasajeros en vuelos nacionales de salida"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">DLPax_Nal1</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, ylab <span class="op">=</span> <span class="st">"DLN Pasajeros"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Diff LN Pasajeros en vuelos nacionales de salida"</span>, </span>
<span>     col <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GPaxNal"></span>
<img src="03-PE_Univariados_files/figure-html/GPaxNal-1.png" alt="Pasajeros transportados (Millones) en el metro de la CDM en niveles y en diferencias logaritmicas." width="100%"><p class="caption">
Figure 4.7: Pasajeros transportados (Millones) en el metro de la CDM en niveles y en diferencias logaritmicas.
</p>
</div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#</span></span>
<span><span class="va">AR_LPax_Nal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">LPax_Nal1</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AR_LPax_Nal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; arima(x = LPax_Nal1, order = c(2, 0, 0), method = "ML")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;          ar1      ar2  intercept</span></span>
<span><span class="co">#&gt;       1.0290  -0.1521    14.6263</span></span>
<span><span class="co">#&gt; s.e.  0.0613   0.0618     0.0857</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sigma^2 estimated as 0.03009:  log likelihood = 85.37,  aic = -162.74</span></span>
<span></span>
<span><span class="co">#plot(AR_LPax_Nal$residuals, xlab = "Tiempo", ylab = "",main = "Residuales del AR (2) para LN de pasajeros en vuelos nacionales de salida",col = "darkgreen")</span></span>
<span></span>
<span><span class="co"># AR(2) en DIFERENCIAS:</span></span>
<span></span>
<span><span class="va">AR_DLPax_Nal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">DLPax_Nal1</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AR_DLPax_Nal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; arima(x = DLPax_Nal1, order = c(2, 0, 0), method = "ML")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;          ar1      ar2  intercept</span></span>
<span><span class="co">#&gt;       0.1132  -0.2794     0.0043</span></span>
<span><span class="co">#&gt; s.e.  0.0598   0.0596     0.0092</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sigma^2 estimated as 0.02963:  log likelihood = 87.79,  aic = -167.57</span></span>
<span></span>
<span><span class="co">#plot(AR_DLPax_Nal$residuals, xlab = "Tiempo", ylab = "",main = "Residuales del AR (2) para DLN \nde pasajeros en vuelos nacionales de salida",col = "darkred")</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"BD/Clase_06/arroots.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"BD/Clase_06/plot.armaroots.R"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot.armaroots</span><span class="op">(</span><span class="fu">arroots</span><span class="op">(</span><span class="va">AR_LPax_Nal</span><span class="op">)</span>, </span>
<span>               main<span class="op">=</span><span class="st">"Inverse AR roots of \nAR(2): LN Pax Nal"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot.armaroots</span><span class="op">(</span><span class="fu">arroots</span><span class="op">(</span><span class="va">AR_DLPax_Nal</span><span class="op">)</span>, </span>
<span>               main<span class="op">=</span><span class="st">"Inverse AR roots of \nAR(2): Diff LN Pax Nal"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GRootsAR2"></span>
<img src="03-PE_Univariados_files/figure-html/GRootsAR2-1.png" alt="Inverso de las Raíces del polinomio característico." width="100%"><p class="caption">
Figure 4.8: Inverso de las Raíces del polinomio característico.
</p>
</div>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Para ambos casos entre parentésis indicamos los errores estándar y reportamos el estadístico de Akaike, AIC. Finalmente, podemos determinar si las soluciones serán convergentes, para ello en la Figura <a href="procesos-estacionarios-univariados.html#fig:GRootsAR2">4.8</a> mostramos las raíces asociadas a cada uno de los polinomios. De la inspección visual podemos concluir que ambas propuesta de AR(2) representan una solución convergente y estable.</p>
</div>
<div id="arp" class="section level3" number="4.1.3">
<h3>
<span class="header-section-number">4.1.3</span> AR(p)<a class="anchor" aria-label="anchor" href="#arp"><i class="fas fa-link"></i></a>
</h3>
<p>Veremos ahora una generalización de los procesos autoregresivos (AR). Esta generalización es conocida como un proceso <span class="math inline">\(AR(p)\)</span> y que puede ser descrito por la siguiente ecuación en diferencia estocástica:
<span class="math display" id="eq:ARpEq">\[\begin{equation}
    X_t = a_0 + a_1 X_{t-1} + a_2 X_{t-2} + a_3 X_{t-3} + \ldots + a_p X_{t-p} + U_t
    \tag{4.24}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(a_p \neq 0\)</span>, y <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio con media cero (0), varianza constante (<span class="math inline">\(\sigma^2\)</span>) y covarianza cero (0). Usando el operador rezago, <span class="math inline">\(L^k\)</span>, para <span class="math inline">\(k = 0, 1, 2, \ldots, p\)</span>, obtenemos la siguiente expresión de la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARpEq">(4.24)</a>:
<span class="math display" id="eq:ARpEq1">\[\begin{equation}
    (1 - a_1 L - a_2 L^2 - a_3 L^3 - \ldots - a_p L^p) X_t = a_0 + U_t
    \tag{4.25}
\end{equation}\]</span></p>
<p>Definamos el polinomio <span class="math inline">\(\alpha(L)\)</span> como:
<span class="math display" id="eq:PolA">\[\begin{equation}
    \alpha(L) = 1 - a_1 L - a_2 L^2 - a_3 L^3 - \ldots - a_p L^p
    \tag{4.26}
\end{equation}\]</span></p>
<p>De forma similar que en los procesos <span class="math inline">\(AR(1)\)</span> y <span class="math inline">\(AR(2)\)</span>, las condiciones de estabilidad del proceso <span class="math inline">\(AR(p)\)</span> estarán dadas por la solución de la ecuación característica:
<span class="math display" id="eq:PolA1">\[\begin{equation}
    \lambda^p - a_1 \lambda^{p-1} - a_2 \lambda^{p-2} - a_3 \lambda^{p-3} - \ldots - a_p = 0
        \tag{4.27}
\end{equation}\]</span></p>
<p>Así, solo si el polinomio anterior tiene raíces cuyo valor absoluto sea menor a uno (<span class="math inline">\(\lvert\lambda_i\lvert &lt; 1\)</span>) y si <span class="math inline">\(1 - a_1 L - a_2 L^2 - a_3 L^3 - \ldots - a_p L^p &lt; 1\)</span> podremos decir que el proceso es convergente y estable. Lo anterior significa que la ecuación <a href="procesos-estacionarios-univariados.html#eq:PolA">(4.26)</a> puede expresarse en términos de la descomposición de Wold o como la suma infinita de términos como:
<span class="math display" id="eq:PolA2">\[\begin{equation}
    \frac{1}{1 - a_1 L  - a_2 L^2 - a_3 L^3  - \ldots - a_p L^p} = \psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots
\tag{4.28}
\end{equation}\]</span></p>
<p>Donde, por construcción de <span class="math inline">\(\alpha(L) \alpha^{-1}(L) = 1\)</span> implica que <span class="math inline">\(\psi_0 = 1\)</span>. De forma similar a los proceso AR(1) y AR(2), es posible determinar el valor de los coefieentes <span class="math inline">\(\psi_j\)</span> en términos de los coefientes <span class="math inline">\(a_i\)</span>. Así, la solución del proceso <span class="math inline">\(AR(p)\)</span> estará dada por:
<span class="math display" id="eq:ARpEqSol">\[\begin{equation}
    X_t = \frac{a_0}{1 - a_1  - a_2 - a_3  - \ldots - a_p} + \sum^{\infty}_{j = 0} \psi_j U_{t-j}
    \tag{4.29}
\end{equation}\]</span></p>
<p>Considerando la solución de la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARpEq">(4.24)</a> expresada en la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARpEqSol">(4.29)</a> podemos determinar los momentos del proceso y que estarán dados por una media como:
<span class="math display" id="eq:ARpEqSol1">\[\begin{equation}
    \mathbb{E}[X_t] = \mu = \frac{a_o}{1 - a_1  - a_2 - a_3  - \ldots - a_p}
        \tag{4.30}
\end{equation}\]</span></p>
<p>Lo anterior, considerado que <span class="math inline">\(\mathbb{E}[U_t] = 0\)</span>, para todo <span class="math inline">\(t\)</span>. Para determinar la varianza del proceso, sin pérdida de generalidad, podemos definir una ecuación: <span class="math inline">\(\gamma(\tau) = \mathbb{E}[X_{t - \tau} X_t]\)</span>, la cual (omitiendo la constante, ya que la correlación de una constante con cuaquier variable aleatoria que depende del tiempo es cero (0)) puede ser escrita como:
<span class="math display" id="eq:ARpEqSol2">\[\begin{equation}
    \gamma(\tau) = \mathbb{E}[(X_{t - \tau}) \cdot (a_1 X_{t-1} + a_2 X_{t-2} + a_3 X_{t-3} + \ldots + + a_p X_{t-p} + U_t)]
        \tag{4.31}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\tau = 0, 1, 2, \ldots, p\)</span> y <span class="math inline">\(a_0 = 0\)</span>, lo que implica que <span class="math inline">\(\mu = 0\)</span>. De lo anterior obtenemos el siguiente conjunto de ecuaciones mediante sustituciones de los valores de <span class="math inline">\(\tau\)</span>:
<span class="math display">\[\begin{eqnarray}
    \gamma(0) &amp; = &amp; a_1 \gamma(1) + a_2 \gamma(2) + \ldots + a_p \gamma(p) + \sigma^2 \nonumber \\
    \gamma(1) &amp; = &amp; a_1 \gamma(0) + a_2 \gamma(1) + \ldots + a_p \gamma(p-1) \nonumber \\
    \vdots \nonumber \\
    \gamma(p) &amp; = &amp; a_1 \gamma(p-1) + a_2 \gamma(p-2) + \ldots + a_p \gamma(0) \nonumber
\end{eqnarray}\]</span></p>
<p>De esta forma, es fácil observar que la ecuación general para <span class="math inline">\(p &gt; 0\)</span> estará dada por:
<span class="math display" id="eq:Gammap">\[\begin{equation}
    \gamma(p) - a_1 \gamma(\tau - 1) - a_2 \gamma(\tau - 2) - \ldots - a_p \gamma(\tau - p) = 0
    \tag{4.32}
\end{equation}\]</span></p>
<p>Dividiendo la ecuación <a href="procesos-estacionarios-univariados.html#eq:Gammap">(4.32)</a> por <span class="math inline">\(\gamma(0)\)</span>, se obtiene la siguiente ecuación:
<span class="math display" id="eq:Gammap1">\[\begin{equation}
    \rho(p) - a_1 \rho(\tau - 1) + a_2 \rho(\tau - 2) + \ldots + a_p \rho(\tau - p) = 0
        \tag{4.33}
\end{equation}\]</span></p>
<p>Así, podemos escribir el siguiente sistema de ecuaciones:
<span class="math display">\[\begin{eqnarray}
    \rho(1) &amp; = &amp; a_1 + a_2 \rho(1) + a_3 \rho(2) + \ldots + a_p \rho(p-1) \nonumber \\
    \rho(2) &amp; = &amp; a_1 \rho(1) + a_2 + a_3 \rho(1) + \ldots + a_p \rho(p-2) \nonumber \\
    &amp; \vdots &amp; \nonumber \\
    \rho(p) &amp; = &amp; a_1 \rho(p-1) + a_2 \rho(p-2) + \ldots + a_p \nonumber
\end{eqnarray}\]</span></p>
<p>Lo anterior se puede expresar como un conjunto de vectores y matrices de la siguiente forma:
<span class="math display" id="eq:Gammap2">\[\begin{equation}
    \left[
    \begin{array}{c}
        \rho(1) \\
        \rho(2) \\
        \vdots \\
        \rho(p)
    \end{array}
    \right]
    =
    \left[
    \begin{array}{c c c c}
        1 &amp; \rho(1) &amp; \ldots &amp; \rho(p - 1) \\
        \rho(1) &amp; 1 &amp; \ldots &amp; \rho(p - 2) \\
        \rho(2) &amp; \rho(1) &amp; \ldots &amp; \rho(p - 3) \\
        \vdots &amp; \vdots &amp; \ldots &amp; \vdots \\
        \rho(p - 1) &amp; \rho(p - 2) &amp; \ldots &amp; 1 \\
    \end{array}
    \right]
    \left[
    \begin{array}{c}
        a_1 \\
        a_2 \\
        a_3 \\
        \vdots \\
        a_p \\
    \end{array}
    \right]
\tag{4.34}
\end{equation}\]</span></p>
<p>De lo anterior podemos escribir la siguiente ecuación que es una forma alternativa para expresar los valores de los coefientes <span class="math inline">\(a_i\)</span> de la la solución del proceso <span class="math inline">\(AR(p)\)</span>:
<span class="math display" id="eq:Gammap3">\[\begin{equation}
    \mathbf{\rho} = \mathbf{R} \mathbf{a}
  \tag{4.35}
\end{equation}\]</span></p>
<p>Es decir, podemos obtener la siguiente expresión:
<span class="math display" id="eq:Gammap4">\[\begin{equation}
    \mathbf{a} = \mathbf{R}^{-1} \mathbf{\rho}
    \tag{4.36}
\end{equation}\]</span></p>
<p>Ahora veámos un ejemplo. Utilizaremos la serie de Pasajeros en vuelos internacionales de salida para estimar un <span class="math inline">\(AR(p)\)</span> mediante el método de máxima verosimilitud (ML). Antes de realizar el proceso de estimación consideremos una transformación de la serie en logaritmos y una más en diferencias logaritmicas; lo anterior con el objeto de obtener un conjunto de series de tiempo suavizada y expresada en tasas de crecimiento, con un comportamiento parecido a un proceso estacionario.</p>
<p>Primero, para decidir si se realizará un <span class="math inline">\(AR(p)\)</span> para la serie en niveles o en diferencias análizaremos su gráfica. La serie de e Pasajeros en vuelos internacionales de salidas se muestra en la Figura <a href="procesos-estacionarios-univariados.html#fig:GPaxInt">4.9</a>. En está se muestra la gráfica de la serie en niveles (sin transformación logaritmica y con transformación logaritmica) y en diferencias logaritmicas mensuales (es decir, con diferencia respecto del mes inmediato anterior).</p>
<p>De la gráfica en la Figura <a href="procesos-estacionarios-univariados.html#fig:GPaxInt">4.9</a> observamos que quizá le mejor forma de estimar un AR(p) es mediante la serie en diferencias, ya que ésta es la que parece ser una serie estacionaria. A continuación, estimaremos una AR(4) para la serie en diferencias logarimitcas (<span class="math inline">\(DLPaxInt_t\)</span>):</p>
<p><span class="math display">\[\begin{eqnarray}
    DLPaxInt_t &amp; = &amp; 0.0050 &amp; - &amp; 0.2701  &amp; DLPaxInt_{t-1} \\
    &amp;  &amp; (0.0052) &amp;  &amp; (0.0655) &amp; \\
    &amp;  &amp;  &amp; - &amp; 0.4326 &amp; DLPaxNal_{t-2} \\
    &amp;  &amp;  &amp;  &amp; (0.0664) &amp; \\
    &amp;  &amp;  &amp; - &amp; 0.1956 &amp; DLPaxNal_{t-3} \\
    &amp;  &amp;  &amp;  &amp; (0.0664) &amp; \\
    &amp;  &amp;  &amp; - &amp; 0.0316 &amp; DLPaxNal_{t-4} \\
    &amp;  &amp;  &amp;  &amp; (0.0653) &amp;
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
\hat{\sigma}^2 &amp; = &amp; 0.02371 &amp; y &amp; AIC &amp; = &amp; -198.16
\end{eqnarray}\]</span></p>
<p>Entre parentésis indicamos los errores estándar y reportamos el estadístico de Akaike, AIC. Finalmente, podemos determinar si las soluciones serán convergentes, para ello en la Figura <a href="procesos-estacionarios-univariados.html#fig:GRootsARp">4.10</a> mostramos las raíces asociadas a cada uno de los polinomios. De la inspección visual podemos concluir que el AR(4) representan una solución convergente y estable.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">Datos2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Clase_07/Base_Transporte.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"BD/Clase_07/arroots.R"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"BD/Clase_07/plot.armaroots.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Conversion a series de tiempo:</span></span>
<span><span class="va">Pax_Int2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos2</span><span class="op">$</span><span class="va">Pax_Int</span>, </span>
<span>              start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>              freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Logaritmos:</span></span>
<span><span class="va">LPax_Int2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos2</span><span class="op">$</span><span class="va">Pax_Int</span><span class="op">)</span>, </span>
<span>               start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>               freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Diferencias mensuales:</span></span>
<span><span class="va">DLPax_Int2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos2</span><span class="op">$</span><span class="va">Pax_Int</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos2</span><span class="op">$</span><span class="va">Pax_Int</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Pax_Int2</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, ylab <span class="op">=</span> <span class="st">"Pasajeros"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Pasajeros en vuelos internacionales de salida"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkgreen"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">LPax_Int2</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, ylab <span class="op">=</span> <span class="st">"LN Pasajeros"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"LN Pasajeros en vuelos internacionales de salida"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">DLPax_Int2</span>, xlab <span class="op">=</span> <span class="st">"Tiempo"</span>, ylab <span class="op">=</span> <span class="st">"DLN Pasajeros"</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Diff LN Pasajeros en vuelos internacionales de salia"</span>, </span>
<span>     col <span class="op">=</span> <span class="st">"darkred"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GPaxInt"></span>
<img src="03-PE_Univariados_files/figure-html/GPaxInt-1.png" alt="Pasajeros en vuelos internacionales de salida en niveles y en diferencias logaritmicas." width="100%"><p class="caption">
Figure 4.9: Pasajeros en vuelos internacionales de salida en niveles y en diferencias logaritmicas.
</p>
</div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># AR(p) en NIVELES:</span></span>
<span></span>
<span><span class="va">AR_LPax_Int2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">LPax_Int2</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AR_LPax_Int2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; arima(x = LPax_Int2, order = c(4, 0, 0), method = "ML")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;          ar1      ar2     ar3     ar4  intercept</span></span>
<span><span class="co">#&gt;       0.9861  -0.2941  0.0726  0.0825    13.9419</span></span>
<span><span class="co">#&gt; s.e.  0.0618   0.0870  0.0869  0.0619     0.1031</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sigma^2 estimated as 0.06747:  log likelihood = -19.04,  aic = 50.07</span></span>
<span></span>
<span><span class="co">#plot(AR_LPax_Int$residuals)</span></span>
<span></span>
<span><span class="co">#plot.armaroots(arroots(AR_LPax_Int), </span></span>
<span>               <span class="co">#main="Inverse AR roots of \nAR(p): LN PAx Int")</span></span>
<span></span>
<span><span class="co"># AR(p) en DIFERENCIAS:</span></span>
<span></span>
<span><span class="va">AR_DLPax_Int2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">DLPax_Int2</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">AR_DLPax_Int2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; arima(x = DLPax_Int2, order = c(4, 0, 0), method = "ML")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;          ar1      ar2      ar3      ar4  intercept</span></span>
<span><span class="co">#&gt;       0.0441  -0.2426  -0.1457  -0.0483      0.004</span></span>
<span><span class="co">#&gt; s.e.  0.0622   0.0615   0.0614   0.0620      0.012</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sigma^2 estimated as 0.07134:  log likelihood = -25.59,  aic = 63.17</span></span>
<span></span>
<span><span class="co">#plot(AR_DLPax_Int$residuals, xlab = "Tiempo", ylab = "DLN Pasajeros",</span></span>
<span>     <span class="co">#main = "Residuales de un AR(4) para pasajeros en vuelos internacionales de salida",</span></span>
<span>     <span class="co">#col = "darkblue")</span></span></code></pre></div>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">plot.armaroots</span><span class="op">(</span><span class="fu">arroots</span><span class="op">(</span><span class="va">AR_DLPax_Int2</span><span class="op">)</span>,main<span class="op">=</span><span class="st">"Inverse AR roots of \nAR(p): Diff LN PAx Int"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GRootsARp"></span>
<img src="03-PE_Univariados_files/figure-html/GRootsARp-1.png" alt="Inverso de las Raíces del polinomio característico." width="100%"><p class="caption">
Figure 4.10: Inverso de las Raíces del polinomio característico.
</p>
</div>
</div>
</div>
<div id="procesos-de-medias-móviles-ma" class="section level2" number="4.2">
<h2>
<span class="header-section-number">4.2</span> Procesos de Medias Móviles (MA)<a class="anchor" aria-label="anchor" href="#procesos-de-medias-m%C3%B3viles-ma"><i class="fas fa-link"></i></a>
</h2>
<div id="ma1" class="section level3" number="4.2.1">
<h3>
<span class="header-section-number">4.2.1</span> MA(1)<a class="anchor" aria-label="anchor" href="#ma1"><i class="fas fa-link"></i></a>
</h3>
<p>Una vez planteado el proceso generalizado de <span class="math inline">\(AR(p)\)</span>, iniciamos el planteamiento de los proceso de medias móviles, denotados como <span class="math inline">\(MA(q)\)</span>. Iniciemos con el planteamiento del proceso <span class="math inline">\(MA(1)\)</span>, que se puede escribir como una ecuación como la siguiente:
<span class="math display" id="eq:MA1Eq">\[\begin{equation}
    X_t = \mu + U_t - b_1 U_{t-1}
    \tag{4.37}
\end{equation}\]</span></p>
<p>O como:
<span class="math display" id="eq:MA1Eq1">\[\begin{equation}
    X_t - \mu = (1 - b_1 L) U_{t}
    \tag{4.38}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio, es decir, con <span class="math inline">\(\mathbb{E}[U_t] = 0\)</span>, <span class="math inline">\(Var[U_t] = \sigma^2\)</span>, y <span class="math inline">\(Cov[U_t, U_s] = 0\)</span>. Así, un proceso <span class="math inline">\(MA(1)\)</span> puede verse como un proceso AR con una descomposición de Wold en la que <span class="math inline">\(\psi_0 = 1\)</span>, <span class="math inline">\(\psi_1 = - b_1\)</span> y <span class="math inline">\(\psi_j = 0\)</span> para todo <span class="math inline">\(j &gt; 1\)</span>.</p>
<p>Al igual que los procesos autoregresivos, determinaremos los momentos de un proceso <span class="math inline">\(MA(1)\)</span>. En el caso de la media observamos que será:
<span class="math display" id="eq:MA1Eq2">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mu + \mathbb{E}[U_t] - b_1 \mathbb{E}[U_{t - 1}] \nonumber \\
    &amp; = &amp; \mu
    \tag{4.39}
\end{eqnarray}\]</span></p>
<p>Por su parte la varianza estará dada por:
<span class="math display" id="eq:MA1Eq3">\[\begin{eqnarray}
    Var[X_t] &amp; = &amp; \mathbb{E}[(X_t - \mu)^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1})^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t^2 - 2 b_1 U_t U_{t-1} + b_1^2 U_{t - 1}^2] \nonumber \\
    &amp; = &amp;\mathbb{E}[U_t^2] - 2 b_1 \mathbb{E}[U_t U_{t-1}] + b_1^2 \mathbb{E}[U_{t - 1}^2]] \nonumber \\
    &amp; = &amp; \sigma^2 + b_1^2 \sigma^2 \nonumber \\
    &amp; = &amp; (1 + b_1^2) \sigma^2 = \gamma(0)
    \tag{4.40}
\end{eqnarray}\]</span></p>
<p>De esta forma, la varianza del proceso es constante en cualquier periodo <span class="math inline">\(t\)</span>. Para determinar la covarianza utilizaremos la siguiente ecuación:
<span class="math display" id="eq:MA1Cov">\[\begin{eqnarray}
    \mathbb{E}[(x_t - \mu)(x_{t + \tau} - \mu)] &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1})(U_{t + \tau} - b_1 U_{t + \tau - 1})] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t U_{t + \tau} - b_1 U_t U_{t + \tau - 1} - b_1 U_{t - 1} U_{t + \tau} \nonumber \\
    &amp;   &amp; + b_1^2 U_{t - 1} U_{t + \tau - 1}] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t U_{t + \tau}] - b_1 \mathbb{E}[U_t U_{t + \tau - 1}] \nonumber \\
    &amp;   &amp; - b_1 \mathbb{E}[U_{t - 1} U_{t + \tau}] + b_1^2 \mathbb{E}[U_{t - 1} U_{t + \tau - 1}]
    \tag{4.41}
\end{eqnarray}\]</span></p>
<p>Si hacemos sustituciones de diferentes valores de <span class="math inline">\(\tau\)</span> en la ecuación <a href="procesos-estacionarios-univariados.html#eq:MA1Cov">(4.41)</a> notaremos que la covarianza será distinta de cero únicamente para el caso de <span class="math inline">\(\tau = 1, -1\)</span>. En ambos casos tendremos como resultado:
<span class="math display" id="eq:MA1Cov1">\[\begin{eqnarray}
    \mathbb{E}[(x_t - \mu)(x_{t + 1} - \mu)] &amp; = &amp; \mathbb{E}[(x_t - \mu)(x_{t - 1} - \mu)] \nonumber \\
    &amp; = &amp; - b_1 \mathbb{E}[U_t U_{t}] \nonumber \\
    &amp; = &amp; - b_1 \mathbb{E}[U_{t - 1} U_{t - 1}] \nonumber \\
    &amp; = &amp; - b_1^2 \sigma^2 = \gamma(1)
        \tag{4.42}
\end{eqnarray}\]</span></p>
<p>De esta forma tendremos que las funciones de autocorrelación estarán dadas por los siguientes casos:
<span class="math display">\[\begin{eqnarray}
    \rho(0) &amp; = &amp; 1 \nonumber \\
    \rho(1) &amp; = &amp; \frac{- b_1}{1 + b_1^2} \nonumber \\
    \rho(\tau) &amp; = &amp; 0 \text{ para todo } \tau &gt; 1 \nonumber
\end{eqnarray}\]</span></p>
<p>Ahora regresando a la ecuación <a href="procesos-estacionarios-univariados.html#eq:MA1Eq">(4.37)</a>,e su solución la podemos expresar como:
<span class="math display">\[\begin{eqnarray}
    U_ t &amp; = &amp; - \frac{\mu}{1 - b_1} + \frac{1}{1 - b_1 L} X_t \nonumber \\
    &amp; = &amp; - \frac{\mu}{1 - b_1} + X_t + b_1 X_{t-1} + b_1^2 X_{t-2} + \ldots \nonumber
\end{eqnarray}\]</span></p>
<p>Donde la condición para que se cumpla esta ecuación es que <span class="math inline">\(\lvert b_1 \lvert&lt; 1\)</span>. La manera de interpretar esta condición es como una condición de estabilidad de la solución y cómo una condición de invertibilidad. Notemos que un <span class="math inline">\(MA(1)\)</span> (y en general un <span class="math inline">\(MA(q)\)</span>) es equivalente a un <span class="math inline">\(AR(\infty)\)</span>, es decir, cuando se invierte un MA se genera un AR con infinitos rezagos.</p>
<p>En esta sección no desarrollaremos un ejemplo, primero explicaremos en qué consiste una modelación del tipo <span class="math inline">\(MA(q)\)</span> y después platearemos un ejemplo en concreto.</p>
</div>
<div id="maq" class="section level3" number="4.2.2">
<h3>
<span class="header-section-number">4.2.2</span> MA(q)<a class="anchor" aria-label="anchor" href="#maq"><i class="fas fa-link"></i></a>
</h3>
<p>En general, el proceso de medias móviles de orden <span class="math inline">\(q\)</span>, <span class="math inline">\(MA(q)\)</span>, puede ser escrito como:
<span class="math display" id="eq:MAqEQ">\[\begin{equation}
    X_t = \mu + U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q}
    \tag{4.43}
\end{equation}\]</span></p>
<p>Podemos reescribir la ecuación <a href="procesos-estacionarios-univariados.html#eq:MAqEQ">(4.43)</a> utilizando el operador rezago, así tendrémos el proceso de <span class="math inline">\(MA(q)\)</span> como:
<span class="math display" id="eq:MAqRed">\[\begin{eqnarray}
    X_t - \mu &amp; = &amp; (1 - b_1 L - b_2 L^2 - \ldots - b_q L^q) U_{t} \nonumber \\
    X_t - \mu &amp; = &amp; \beta(L) U_t
    \tag{4.44}
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio con <span class="math inline">\(\mathbb{E}[U_t] = 0\)</span>, <span class="math inline">\(Var[U_t] = \mathbb{E}[U_t^2] = 0\)</span> y <span class="math inline">\(Cov[U_t, U_s] = \mathbb{E}[U_t, U_s] = 0\)</span>, y <span class="math inline">\(\beta(L) = 1 - b_1 L - b_2 L^2 - \ldots - b_q L^q\)</span> es un polinomio del operador rezago <span class="math inline">\(L\)</span>. la ecuación <a href="procesos-estacionarios-univariados.html#eq:MAqRed">(4.44)</a> puede ser interpretada como un proceso <span class="math inline">\(AR(q)\)</span> sobre la serie <span class="math inline">\(U_t\)</span>.</p>
<p>Ahora determinemos los momentos de un proceso <span class="math inline">\(MA(q)\)</span>:
<span class="math display" id="eq:MAqRed1">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mathbb{E}[\mu + U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q}] \nonumber \\
    &amp; = &amp; \mu + \mathbb{E}[U_t] - b_1 \mathbb{E}[U_{t-1}] - b_2 \mathbb{E}[U_{t-2}] - \ldots - b_q \mathbb{E}[U_{t-q}] \nonumber \\
    &amp; = &amp; \mu
    \tag{4.45}
\end{eqnarray}\]</span></p>
<p>En el caso de la varianza tenemos que se puede expresar como:
<span class="math display" id="eq:MAqRed2">\[\begin{eqnarray}
    Var[X_t] &amp; = &amp; \mathbb{E}[(X_t - \mu)^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q})^2] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t^2 + b_1^2 U_{t-1}^2 + b_2^2 U_{t-2}^2 + \ldots + b_q^2 U_{t-q}^2 \nonumber \\
    &amp;   &amp; - 2 b_1 U_t U_{t - 1} - \ldots - 2 b_{q - 1} b_q U_{t - q + 1} U_{t - q}] \nonumber \\
    &amp; = &amp; \mathbb{E}[U_t^2] + b_1^2 \mathbb{E}[U_{t-1}^2] + b_2^2 \mathbb{E}[U_{t-2}^2] + \ldots + b_q^2 \mathbb{E}[U_{t-q}^2] \nonumber \\
    &amp;   &amp; - 2 b_1 \mathbb{E}[U_t U_{t - 1}] - \ldots - 2 b_{q - 1} b_q \mathbb{E}[U_{t - q + 1} U_{t - q}] \nonumber \\
    &amp; = &amp; \sigma^2 + b^2_1 \sigma^2 + b^2_2 \sigma^2 + \ldots + b^2_q \sigma^2 \nonumber \\
    &amp; = &amp; (1 + b^2_1 + b^2_2 + \ldots + b^2_q) \sigma^2
    \tag{4.46}
\end{eqnarray}\]</span></p>
<p>En el caso de las covarianzas podemos utilizar una idea similar al caso del <span class="math inline">\(AR(p)\)</span>, construir una expresión general para cualquier rezago <span class="math inline">\(\tau\)</span>:
<span class="math display">\[\begin{eqnarray}
    Cov[X_t, X_{t + \tau}] &amp; = &amp; \mathbb{E}[(X_t - \mu)(X_{t + \tau} - \mu)] \nonumber \\
    &amp; = &amp; \mathbb{E}[(U_t - b_1 U_{t-1} - b_2 U_{t-2} - \ldots - b_q U_{t-q}) \nonumber \\
    &amp;   &amp; (U_{t + \tau} - b_1 U_{t + \tau -1} - b_2 U_{t + \tau -2} - \ldots - b_q U_{t + \tau - q})] \nonumber
\end{eqnarray}\]</span></p>
<p>La expresión anterior se puede desarrollar para múltiples casos de <span class="math inline">\(\tau = 1, 2, \ldots, q\)</span>. De esta forma tenemos el siguiente sistema:
<span class="math display">\[\begin{eqnarray}
    \tau = 1 &amp; : &amp; \gamma(1) = (- b_1 + b_1 b_2 + \ldots + b_{q-1} b_q) \sigma^2 \nonumber \\
    \tau = 2 &amp; : &amp; \gamma(2) = (- b_2 + b_1 b_3 + \ldots + b_{q-2} b_q) \sigma^2 \nonumber \\
    &amp; \vdots &amp; \nonumber \\
    \tau = q &amp; : &amp; \gamma(q) = b_q \sigma^2 \nonumber
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(\gamma(\tau) = 0\)</span> para todo <span class="math inline">\(\tau &gt; q\)</span>. Es decir, todas las autocovarianzas y autocorrelaciones con ordenes superiores a <span class="math inline">\(q\)</span> son cero (0). De esta forma, esta caracterítica teórica permite identificar el orden de <span class="math inline">\(MA(q)\)</span> visualizando la función de autocorrelación y verificando a partir de cual valor de rezago la autocorrelación es no significaiva.</p>
<p>Regresando al problema original que es el de determinar una solución para la eucación @ref(eq:MAq_EQ), tenemos que dicha solución estará dada por un <span class="math inline">\(AR(\infty)\)</span> en términos de <span class="math inline">\(U_t\)</span>:
<span class="math display" id="eq:MAqEqSol">\[\begin{eqnarray}
    U_t &amp; = &amp; - \frac{\mu}{1 - b_1 - b_2 - \ldots - b_q} + \beta(L)^{-1} X_t \nonumber \\
    &amp;   &amp; - \frac{\mu}{1 - b_1 - b_2 - \ldots - b_q} + \sum_{j = 0}^{\infty} c_j X_{t-j}
    \tag{4.47}
\end{eqnarray}\]</span></p>
<p>Donde se cumple que: <span class="math inline">\(1 = (1 - b_1 L^1 - b_2 L^2 - \ldots - b_q L^q)(1 - c_1 L - c_2 L^2 - \ldots)\)</span> y los coeficientes <span class="math inline">\(c_j\)</span> se pueden determinar por un método de coeficientes indeterminados y en términos de los valores <span class="math inline">\(b_i\)</span>. De igual forma que en el caso de la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARpEq">(4.24)</a>, en la ecuación <a href="procesos-estacionarios-univariados.html#eq:MAqEqSol">(4.47)</a> se deben cumplir condiciones de estabilidad asociadas con las raíces del polinomio carácterististico dado por:
<span class="math display" id="eq:MAqEqSol2">\[\begin{equation}
    1 - b_1 x - b_2 x^2 - \ldots b_q x^q = 0
    \tag{4.48}
\end{equation}\]</span></p>
<p>El cual debe cumplir que <span class="math inline">\(\lvert x_i \lvert &lt; 1\)</span> y que <span class="math inline">\(1 - b_1 - b_2 - \ldots b_q &lt; 1\)</span>.</p>
<p>Ahora veamos un ejemplo del proceso <span class="math inline">\(MA(q)\)</span>, para lo cual retomaremos la serie de Pasajeros transportados en el metro de la CDMX (<span class="math inline">\(PaxMetro\)</span>). Estimaremos el <span class="math inline">\(MA(q)\)</span> mediante el método de máxima verosimilitud (ML). Antes de realizar el proceso de estimación consideremos una transformación de la serie en logaritmos y una más en diferencias logaritmicas; lo anterior con el objeto de obtener un conjunto de series de tiempo suavizada y expresada en tasas de crecimiento, con un comportamiento parecido a un proceso estacionario.</p>
<p>La serie de Pasajeros transportados en el metro de la CDMX se muestra en la Figura <a href="procesos-estacionarios-univariados.html#fig:GPaxMetro">4.6</a> se muestra la gráfica de la serie en niveles (sin transformación logarítmica y con transformación logarítmica) y en diferencias logarítmicas mensuales (es decir, con una diferencia respecto del mes inmediato anterior). Utilizaremos la serie en diferencias, ya que es la que parece ser estacionaria. Esta serie tiene la peculiaridad de que tiene un salto a la baja y uno al alza entre septiembre de 2017 y octubre de 2017. Para controlar ese efecto, en nuestro modelo <span class="math inline">\(MA(q)\)</span> incluiremos dos variables dummies para dichos meses.</p>
<p>A continuación, estimaremos una <span class="math inline">\(MA(4)\)</span> para la serie en diferencias:</p>
<p><span class="math display">\[\begin{eqnarray}
    DLPaxMetro_t &amp; = &amp; 0.0000 &amp; - &amp; 0.7804  &amp; U_{t-1} \\
    &amp;  &amp; (0.0000) &amp;  &amp; (0.0661) &amp; \\
    &amp;  &amp;  &amp; + &amp; 0.3591 &amp; U_{t-2} \\
    &amp;  &amp;  &amp;  &amp; (0.0826) &amp; \\
    &amp;  &amp;  &amp; - &amp; 0.2775 &amp; U_{t-3} \\
    &amp;  &amp;  &amp;  &amp; (0.0908) &amp; \\
    &amp;  &amp;  &amp; - &amp; 0.1120 &amp; U_{t-4} \\
    &amp;  &amp;  &amp;  &amp; (0.0769) &amp; \\
    &amp;  &amp;  &amp; - &amp; 0.3789 &amp; DSep2017 \\
    &amp;  &amp;  &amp;  &amp; (0.0436) &amp; \\
    &amp;  &amp;  &amp; + &amp; 0.3695 &amp; DOct2017 \\
    &amp;  &amp;  &amp;  &amp; (0.0434) &amp;
\end{eqnarray}\]</span>
<span class="math display">\[\begin{eqnarray}
    \hat{\sigma}^2 &amp; = &amp; 0.002176 &amp; y &amp; AIC &amp; = &amp; -749.94
\end{eqnarray}\]</span></p>
<p>Entre parentésis indicamos los errores estándar y al final reportamos el estadístico de Akaike, AIC. Finalmente, podemos determinar si la solución serán convergente, para ello en la Figura <a href="procesos-estacionarios-univariados.html#fig:GRootsMAq">4.11</a> mostramos las raíces asociadas a cada uno de los polinomios. De la inspección visual podemos concluir que ambas propuesta de AR(2) representan una solución convergente y estable.</p>
</div>
</div>
<div id="procesos-armap-q-y-arimap-d-q" class="section level2" number="4.3">
<h2>
<span class="header-section-number">4.3</span> Procesos ARMA(p, q) y ARIMA(p, d, q)<a class="anchor" aria-label="anchor" href="#procesos-armap-q-y-arimap-d-q"><i class="fas fa-link"></i></a>
</h2>
<p>Hemos establecido algunas relaciones las de los porcesos AR y los procesos MA, es decir, cómo un <span class="math inline">\(MA(q)\)</span> de la serie <span class="math inline">\(X_t\)</span> puede ser reexpresada como un <span class="math inline">\(AR(\infty)\)</span> de la serie <span class="math inline">\(U_t\)</span>, y viceversa un <span class="math inline">\(AR(p)\)</span> de la serie <span class="math inline">\(X_t\)</span> puede ser reeexpresada como un <span class="math inline">\(MA(\infty)\)</span>.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Datos3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Clase_09/Base_Transporte_ARIMA.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"BD/Clase_09/maroots.R"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"BD/Clase_09/arroots.R"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"BD/Clase_09/plot.armaroots.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Conversion a series de tiempo:</span></span>
<span><span class="va">ax_Nal3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">Pax_Nal</span>, </span>
<span>              start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>              freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">LPax_Nal3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">Pax_Nal</span><span class="op">)</span>, </span>
<span>               start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>               freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DLPax_Nal3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">Pax_Nal</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">Pax_Nal</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Feb2020</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">D_Feb2020</span>,</span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">D_Mar2020</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">D_Mar2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Abr2020</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">D_Abr2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_May2020</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">D_May2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Jun2020</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">D_Jun2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Jul2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">D_Jul2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Ene2021</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">D_Ene2021</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Mar2021</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">D_Mar2021</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Ene</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">D_Ene</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Feb</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">D_Feb</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Jul</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">D_Jul</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Dic</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos3</span><span class="op">$</span><span class="va">D_Dic</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/include_graphics.html">include_graphics</a></span><span class="op">(</span><span class="st">"imagenes/G_Roots_MAq.png"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GRootsMAq"></span>
<img src="imagenes/G_Roots_MAq.png" alt="Inverso de las Raíces del polinomio característico." width="100%"><p class="caption">
Figure 4.11: Inverso de las Raíces del polinomio característico.
</p>
</div>
<p>En este sentido, para cerrar esta sección veámos el caso de la especificación que conjunta ambos modelos en un modelo general conocido como <span class="math inline">\(ARMA(p, q)\)</span> o <span class="math inline">\(ARIMA(p, d, q)\)</span>. La diferencia entre el primero y el segundo es las veces que su tuvo que diferenciar la serie analizada, registro que se lleva en el índice <span class="math inline">\(d\)</span> de los paramétros dentro del concepto <span class="math inline">\(ARIMA(p, d, q)\)</span>. No obstante, en general nos referiremos al modelo como <span class="math inline">\(ARMA(p, q)\)</span> y dependerá del analista si modela la serie en niveles (por ejemplo, en logaritmos) o en diferencias logarítmicas (o diferencias sin logaritmos).</p>
<div id="arma1-1" class="section level3" number="4.3.1">
<h3>
<span class="header-section-number">4.3.1</span> ARMA(1, 1)<a class="anchor" aria-label="anchor" href="#arma1-1"><i class="fas fa-link"></i></a>
</h3>
<p>Dicho lo anterior vamos a empezar con el análisis de un <span class="math inline">\(ARMA(1, 1)\)</span>. Un proceso <span class="math inline">\(ARMA(1, 1)\)</span> puede verse como:
<span class="math display" id="eq:ARMA11Eq">\[\begin{equation}
    X_t = \delta + a_1 X_{t - 1} + U_t - b_1 U_{t - 1}
    \tag{4.49}
\end{equation}\]</span></p>
<p>Aplicando el operado rezago podemos rescribir la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMA11Eq">(4.49)</a> como:
<span class="math display" id="eq:ARMA11Eq1">\[\begin{equation}
    (1 - a_1 L) X_t = \delta + (1 - b_1 L) U_t
     \tag{4.50}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso pueramente aleatorio como en los casos de <span class="math inline">\(AR(p)\)</span> y <span class="math inline">\(MA(q)\)</span>, y <span class="math inline">\(X_t\)</span> puede ser una serie en niveles o en diferencias (ambas, en términos logarítmicos).</p>
<p>Así, el modelo <span class="math inline">\(ARIMA (p, q)\)</span> también tiene una representación de Wold que estará dada por las siguientes expresiones:
<span class="math display" id="eq:ARMA11Prev">\[\begin{equation}
    X_t = \frac{\delta}{1 - a_1} + \frac{1 - b_1 L}{1 - a_1 L} U_t
    \tag{4.51}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(a_1 \neq b_1\)</span>, puesto que en caso contrario <span class="math inline">\(X_t\)</span> sería un proceso puramente aleatorio con una media <span class="math inline">\(\mu = \frac{\delta}{1 - a_1}\)</span>. Así, podemos reescribir la descomposición de Wold a partir del componente de la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMA11Prev">(4.51)</a>
<span class="math display" id="eq:ARMA11EQWold">\[\begin{equation}
    \frac{1 - b_1 L}{1 - a_1 L} = \psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots
    \tag{4.52}
\end{equation}\]</span></p>
<p>Está ecuación es equivalente a la expresión:
<span class="math display">\[\begin{eqnarray}
    (1 - b_1 L) &amp; = &amp; (1 - a_1 L)(\psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots) \nonumber \\
    &amp; = &amp; \psi_0 + \psi_1 L + \psi_2 L^2 + \psi_3 L^3 + \ldots \nonumber \\
    &amp;   &amp; - a_1 \psi_0 L - a_1 \psi_1 L^2 - a_2 \psi_2 L^3 - a_1 \psi_3 L^4 - \ldots \nonumber
\end{eqnarray}\]</span></p>
<p>De esta forma podemos establecer el siguiente sistema de coeficientes indeterminados:
<span class="math display">\[\begin{eqnarray}
    L^0 : &amp;   &amp; \Rightarrow  &amp;  \psi_0 = 1  \\
     L^1 :  &amp;  \psi_1 - a_1 \psi_0 = - b_1  &amp;  \Rightarrow  &amp;  \psi_1 = a_1 - b_1  \\
     L^2 :  &amp;  \psi_2 - a_1 \psi_1 = 0  &amp;  \Rightarrow  &amp;  \psi_2 = a_1(a_1 - b_1)  \\
     L^3 :  &amp;  \psi_3 - a_1 \psi_2 = 0  &amp;  \Rightarrow  &amp;  \psi_3 = a^2_1(a_1 - b_1)  \\
     \vdots  &amp;  \vdots  &amp;  \vdots  &amp;  \vdots  \\
     L^j :  &amp;  \psi_j - a_1 \psi_{j - 1} = 0  &amp;  \Rightarrow  &amp;  \psi_j = a^{j - 1}_1(a_1 - b_1)
\end{eqnarray}\]</span></p>
<p>Así, la solución a la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMA11Eq">(4.49)</a> estará dada por la siguiente generalización:
<span class="math display" id="eq:ARMA11Sol">\[\begin{equation}
    X_t = \frac{\delta}{1 - a_1} + U_t + (a_1 - b_1) U_{t - 1} + a_1(a_1 - b_1) U_{t - 2} + a_1^2(a_1 - b_1) U_{t - 3} + \ldots
\tag{4.53}
\end{equation}\]</span></p>
<p>En la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMA11Sol">(4.53)</a> las condiciones de estabilidad y de invertibilidad del sistema (de un MA a un AR, y viceversa) estarán dadas por: <span class="math inline">\(\lvert a_1 \lvert &lt; 1\)</span> y <span class="math inline">\(\lvert b_1 \lvert&lt; 1\)</span>. Adicionalmente, la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMA11Sol">(4.53)</a> expresa cómo una serie que tiene un comportamiento <span class="math inline">\(ARMA(1, 1)\)</span> es equivalente a una serie modelada bajo un <span class="math inline">\(MA(\infty)\)</span>.</p>
<p>Al igual que en los demás modelos, ahora determinaremos los momentos del proceso <span class="math inline">\(ARMA(1, 1)\)</span>. La media estará dada por:
<span class="math display" id="eq:ARMA11Sol1">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mathbb{E}[\delta + a_1 X_{t-1} + U_t - b_1 U_{t-1}] \nonumber \\
    &amp; = &amp; \delta + a_1 \mathbb{E}[X_{t-1}] \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1} \nonumber \\
    &amp; = &amp; \mu
    \tag{4.54}
\end{eqnarray}\]</span></p>
<p>Donde hemos utilizado que <span class="math inline">\(\mathbb{E}[X_t] = \mathbb{E}[X_{t-1}] = \mu\)</span>. Es decir, la media de un <span class="math inline">\(ARMA(1, 1)\)</span> es idéntica a la de un <span class="math inline">\(AR(1)\)</span>.</p>
<p>Para determinar la varianza tomaremos una estrategía similar a los casos de <span class="math inline">\(AR(p)\)</span> y <span class="math inline">\(MA(q)\)</span>. Por lo que para todo <span class="math inline">\(\tau \geq 0\)</span>, y suponiendo por simplicidad que <span class="math inline">\(\delta = 0\)</span> (lo que implica que <span class="math inline">\(\mu = 0\)</span>) tendremos:
<span class="math display" id="eq:ARMA11Cov">\[\begin{eqnarray}
    \mathbb{E}[X_{t-\tau} X_t] &amp; = &amp; \mathbb{E}[(X_{t-\tau}) \cdot (a_1 X_{t-1} + U_t - b_1 U_{t-1})] \nonumber \\
    &amp; = &amp; a_1 \mathbb{E}[X_{t-\tau} X_{t-1}] + \mathbb{E}[X_{t-\tau} U_t] - b_1 \mathbb{E}[X_{t-\tau} U_{t-1}]
    \tag{4.55}
\end{eqnarray}\]</span></p>
<p>De la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMA11Cov">(4.55)</a> podemos determinar una expresión para el caso de <span class="math inline">\(\tau = 0\)</span>:
<span class="math display" id="eq:ARMA11Cov1">\[\begin{eqnarray}
    \mathbb{E}[X_{t} X_t] &amp; = &amp; \gamma(0) \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + \mathbb{E}[U_t X_t] - b_1 \mathbb{E}[X_t U_{t-1}] \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + \sigma^2 + b_1 \mathbb{E}[U_{t-1} (a_1 X_{t-1} + U_t - b_1 U_{t-1})] \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + \sigma^2 - b_1 a_1 \sigma^2 + b_1 \sigma^2 \nonumber \\
    &amp; = &amp; a_1 \gamma(1) + (1 - b_1 (a_1 - b_1)) \sigma^2
        \tag{4.56}
\end{eqnarray}\]</span></p>
<p>Para el caso en que <span class="math inline">\(\tau = 1\)</span>:
<span class="math display" id="eq:ARMA11Cov2">\[\begin{eqnarray}
    \mathbb{E}[X_{t-1} X_t] &amp; = &amp; \gamma(1) \nonumber \\
    &amp; = &amp; a_1 \gamma(0) + \mathbb{E}[X_{t-1} U_t] - b_1 \mathbb{E}[X_{t-1} U_{t-1}] \nonumber \\
    &amp; = &amp; a_1 \gamma(0) - b_1 \sigma^2
        \tag{4.57}
\end{eqnarray}\]</span></p>
<p>Estas últimas expresiones podemos resolverlas como sistema para determinar los siguientes valores:
<span class="math display" id="eq:ARMA11Cov3">\[\begin{eqnarray}
    \gamma(0) &amp; = &amp; \frac{1 + b_1^2 - 2 a_1 b_1}{1 - a_1^2} \sigma^2
    \tag{4.58}
\end{eqnarray}\]</span></p>
<p><span class="math display" id="eq:ARMA11Cov4">\[\begin{eqnarray}
    \gamma(1) &amp; = &amp; \frac{(a_1 - b_1)(1 - a_1 b_1)}{1 - a_1^2} \sigma^2
    \tag{4.59}
\end{eqnarray}\]</span></p>
<p>En general para cualquier valor <span class="math inline">\(\tau \geq 2\)</span> tenemos que la autocovarianza y la función de autocorrelación serán:
<span class="math display" id="eq:ARMA11Cov5">\[\begin{eqnarray}
    \gamma(\tau) = a_1 \gamma(\tau - 1) \\
    \tag{4.60}
    \end{eqnarray}\]</span></p>
<p><span class="math display" id="eq:ARMA11Cov6">\[\begin{eqnarray}    
    \rho(\tau) = a_1 \rho(\tau - 1)
    \tag{4.61}
\end{eqnarray}\]</span></p>
<p>Por ejemplo, para el caso de <span class="math inline">\(\tau = 1\)</span> tendríamos:
<span class="math display" id="eq:ARMA11Cov7">\[\begin{equation}
    \rho(1) = \frac{(a_1 - b_1)(1 - a_1 b_1)}{1 + b_1^2 - 2 a_1 b_1}
    \tag{4.62}
\end{equation}\]</span></p>
<p>De esta forma, la función de autocorrelación oscilará en razón de los valores que tome <span class="math inline">\(a_1\)</span> y <span class="math inline">\(b_1\)</span>.</p>
</div>
<div id="armap-q" class="section level3" number="4.3.2">
<h3>
<span class="header-section-number">4.3.2</span> ARMA(p, q)<a class="anchor" aria-label="anchor" href="#armap-q"><i class="fas fa-link"></i></a>
</h3>
<p>La especificación general de un <span class="math inline">\(ARMA(p, q)\)</span> (donde <span class="math inline">\(p, q \in \mathbb{N}\)</span>) puede ser descrita por la siguiente ecuación:
<span class="math display" id="eq:ARMApqEq">\[\begin{eqnarray}
    X_t &amp; = &amp; \delta + a_1 X_{t - 1} + a_2 X_{t - 2} + \ldots + a_p X_{t - p} \nonumber \\
    &amp;   &amp; + U_t - b_1 U_{t - 1} - b_2  U_{t - 2} - \ldots - b_q  U_{t - q}
    \tag{4.63}
\end{eqnarray}\]</span></p>
<p>Donde <span class="math inline">\(U_t\)</span> es un proceso puramente aleatorio, y <span class="math inline">\(X_t\)</span> puede ser modelada en niveles o en diferencias (ya sea en logaritmos o sin transformación logarítmica).</p>
<p>Mediante el uso del operador rezago se puede escribir la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMApqEq">(4.63)</a> como:
<span class="math display" id="eq:ARMApqEQLag">\[\begin{equation}
    (1 - a_1 L - a_2 L^2 - \ldots - a_p L^p) X_t = \delta + (1 - b_1 L - b_2 L^2 - \ldots - b_q L^q) U_t
    \tag{4.64}
\end{equation}\]</span></p>
<p>En la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMApqEQLag">(4.64)</a> definamos dos polinomios: <span class="math inline">\(\alpha(L) = (1 - a_1 L - a_2 L^2 - \ldots - a_p L^p)\)</span> y <span class="math inline">\(\beta(L) = (1 - b_1 L - b_2 L^2 - \ldots - b_q L^q)\)</span>. Así, podemos reescribir la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMApqEQLag">(4.64)</a> como:
<span class="math display" id="eq:ARMApqEQLag1">\[\begin{equation}
    \alpha(L) X_t = \delta + \beta(L) U_t
    \tag{4.65}
\end{equation}\]</span></p>
<p>Asumiendo que existe el polinomio inverso tal que: <span class="math inline">\(\alpha(L)^{-1}\alpha(L) = 1\)</span>.La solución entonces puede ser escrita como:
<span class="math display" id="eq:ARMApqWold">\[\begin{eqnarray}
    X_t &amp; = &amp; \alpha(L)^{-1} \delta + \alpha(L)^{-1} \beta(L) U_t \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} + \frac{\beta(L)}{\alpha(L)} U_t \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} + U_t + \psi_1 L U_t + \psi_2 L^2 U_t + \ldots
    \tag{4.66}
\end{eqnarray}\]</span></p>
<p>Donde la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMApqWold">(4.66)</a> nos permite interpretar que un ARMA(p, q) se puede reexpresar e interpreetar como un <span class="math inline">\(MA(\infty)\)</span> y donde las condiciones para la estabilidad de la solución y la invertibilidad es que las ráices de los polinomios característicos <span class="math inline">\(\alpha(L)\)</span> y <span class="math inline">\(\beta(L)\)</span> son en valor absoluto menores a 1.</p>
<p>Adicionalmente, la fracción en la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMApqWold">(4.66)</a> se puede descomponer como en la forma de Wold:
<span class="math display" id="eq:ARMApqWold1">\[\begin{equation}
    \frac{\beta(L)}{\alpha(L)} = 1 + \psi_1 L + \psi_2 L^2 + \ldots
    \tag{4.67}
\end{equation}\]</span></p>
<p>Bajo los supuestos de estacionariedad del componente <span class="math inline">\(U_t\)</span>, los valores de la media y varianza de un proceso <span class="math inline">\(ARMA(p, q)\)</span> serán como describimos ahora. Para el caso de la media podemos partir de la ecuación <a href="procesos-estacionarios-univariados.html#eq:ARMApqWold">(4.66)</a> para generar:
<span class="math display" id="eq:ARMApqWold2">\[\begin{eqnarray}
    \mathbb{E}[X_t] &amp; = &amp; \mathbb{E}\left[ \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} + U_t + \psi_1 U_{t-1} + \psi_2 U_{t-2} + \ldots \right] \nonumber \\
    &amp; = &amp; \frac{\delta}{1 - a_1 - a_2 - \ldots - a_p} \nonumber \\
    &amp; = &amp; \mu
    \tag{4.68}
\end{eqnarray}\]</span></p>
<p>Esta expresión indica que en general un proceso <span class="math inline">\(ARMA(p, q)\)</span> converge a una media idéntica a la de un porceso <span class="math inline">\(AR(p)\)</span>. Para determinar la varianza utilizaremos la misma estratégia que hemos utilizado para otros modelos <span class="math inline">\(AR(p)\)</span> y <span class="math inline">\(MA(q)\)</span>.</p>
<p>Sin pérdida de generalidad podemos asumir que <span class="math inline">\(\delta = 0\)</span>, lo que implica que <span class="math inline">\(\mu = 0\)</span>, de lo que podemos establecer una expresión de autocovarianzas para cualquier valor <span class="math inline">\(\tau = 0, 1, 2, \ldots\)</span>:
<span class="math display" id="eq:ARMApqWold3">\[\begin{eqnarray}
    \gamma(\tau) &amp; = &amp; \mathbb{E}[X_{t-\tau} X_t] \nonumber \\
    &amp; = &amp; \mathbb{E}[X_{t-\tau} (\delta + a_1 X_{t - 1} + a_2 X_{t - 2} + \ldots + a_p X_{t - p} \nonumber \\
    &amp;   &amp; + U_t - b_1 U_{t - 1} - b_2  U_{t - 2} - \ldots - b_q  U_{t - q})] \nonumber \\
    &amp; = &amp; a_1 \gamma(\tau - 1) + a_2 \gamma(\tau - 2) + \ldots + a_p \gamma(\tau - p) \nonumber \\
    &amp;   &amp; + \mathbb{E}[X_{t-\tau} U_{t}] - b_1  \mathbb{E}[X_{t-\tau} U_{t-1}] - \ldots  - b_q  \mathbb{E}[X_{t-\tau} U_{t-q}]
    \tag{4.69}
\end{eqnarray}\]</span></p>
<p>Ahora veámos un ejemplo. Utilizaremos la serie de Pasajeros en vuelos nacionales de salida para estimar un <span class="math inline">\(ARMA(p, q)\)</span> mediante el método de máxima verosimilitud (ML). Antes de realizar el proceso de estimación consideremos una transformación de la serie en diferencias logaritmicas, ya que según la gráfica en la Figura <a href="procesos-estacionarios-univariados.html#fig:GPaxNal">4.7</a> esa es la que puede ser estacionaria.</p>
<p>A continuación, estimaremos una <span class="math inline">\(ARMA(1, 1)\)</span> para la serie en diferencias logarimitcas (<span class="math inline">\(DLPaxNal_t\)</span>). También incorporaremos al análisis variables exogénas tales como dummies de estacionalidad. En particular, utilizaremos los meses de enero, febrero, julio y diciembre. No debe pasar desapercibido que un análisis de estacionalidad más formal debeería considerar todos los meses para separar del término de error la parte que puedee ser explicada por los ciclos estacionales.</p>
<p>Así obtenemos el siguiente resultado:</p>
<p><span class="math display">\[\begin{eqnarray}
     DLPaxNal_t  &amp;  =  &amp;  -0.0025  &amp;  +  &amp;  0.6018   &amp;  DLPaxNal_{t-1}  \\
    &amp;  &amp;  (0.0045)  &amp;  &amp;  (0.0964)  &amp; \\
    &amp;  &amp;  &amp;  -  &amp;  0.9064  &amp;  U_{t-1}  \\
    &amp;  &amp;  &amp;  &amp;  (0.0397)  &amp; \\
    &amp;  &amp;  &amp;  -  &amp;  0.0867  &amp;  DEne_t  \\
    &amp;  &amp;  &amp;  &amp;  (0.0230)  &amp; \\
    &amp;  &amp;  &amp;  -  &amp;  0.0409  &amp;  DFeb_t  \\
    &amp;  &amp;  &amp;  &amp;  (0.0263)  &amp; \\
    &amp;  &amp;  &amp;  +  &amp;  0.1529  &amp;  DJul_t  \\
    &amp;  &amp;  &amp;  &amp;  (0.0245)  &amp; \\
    &amp;  &amp;  &amp;  +  &amp;  0.0628  &amp;  DDic_t  \\
    &amp;  &amp;  &amp;  &amp;  (0.0223)  &amp;
\end{eqnarray}\]</span></p>
<p><span class="math display">\[\begin{eqnarray}
    \hat{\sigma}^2 &amp; = &amp; 0.007096 &amp; y &amp; AIC &amp; = &amp; -475.12
\end{eqnarray}\]</span></p>
<p>Donde entre parentésis indicamos los errores estándar. Adicionalmente, reportamos el estadístico de Akaike (AIC). Finalmente, podemos determinar si las soluciones serán convergentes, para ello en la Figura <a href="procesos-estacionarios-univariados.html#fig:GRootsARMA11">4.12</a> mostramos las raíces asociadas a cada uno de los polinomios. De la inspección visual podemos concluir que tenemos una solución convergente y estable. Por su parte la Figura <a href="procesos-estacionarios-univariados.html#fig:GResidualsARMA11">4.13</a> muestra los residuales de la estimación del <span class="math inline">\(ARMA(1, 1)\)</span>.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">Datos4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Clase_10.5/Base_Transporte_ARIMA.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Funciones que extrae y grafica las raices del polinomio caracteristico</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"BD/Clase_09/arroots.R"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"BD/Clase_09/maroots.R"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"BD/Clase_09/plot.armaroots.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Conversion a series de tiempo:</span></span>
<span><span class="va">Pax_Nal4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">Pax_Nal</span>, </span>
<span>              start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>              freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">LPax_Nal4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">Pax_Nal</span><span class="op">)</span>, </span>
<span>               start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>               freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DLPax_Nal4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">Pax_Nal</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">Pax_Nal</span><span class="op">)</span>, k <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DLPax_Nal_S4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span><span class="op">(</span><span class="va">DLPax_Nal4</span>, <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Feb20204</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">D_Feb2020</span>,</span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Mar20204</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">D_Mar2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Abr20204</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">D_Abr2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_May20204</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">D_May2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Jun20204</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">D_Jun2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Jul20204</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">D_Jul2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Ene20214</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">D_Ene2021</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Mar20214</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">D_Mar2021</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Ene4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">D_Ene</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Feb4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">D_Feb</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Jul4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">D_Jul</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Dic4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Datos4</span><span class="op">$</span><span class="va">D_Dic</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Funciones que determinan el rezago optimo (que minimiza el criterio de Akaike)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"BD/Clase_10.5/Lag_Opt_ARIMA_Exog.R"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"BD/Clase_10.5/Lag_Opt_SARIMA_Exog.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimacion de ARIMA(1, 1, 1)</span></span>
<span><span class="va">ARMA_DLPax_Nal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">DLPax_Nal4</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>                        xreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">D_Ene4</span>, <span class="va">D_Feb4</span>, <span class="va">D_Jul4</span>, <span class="va">D_Dic4</span><span class="op">)</span>,</span>
<span>                        method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ARMA_DLPax_Nal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; arima(x = DLPax_Nal4, order = c(1, 0, 1), xreg = cbind(D_Ene4, D_Feb4, D_Jul4, </span></span>
<span><span class="co">#&gt;     D_Dic4), method = "ML")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;           ar1     ma1  intercept   D_Ene4   D_Feb4  D_Jul4</span></span>
<span><span class="co">#&gt;       -0.5620  0.8029     0.0013  -0.0938  -0.1195  0.1855</span></span>
<span><span class="co">#&gt; s.e.   0.1095  0.0725     0.0138   0.0383   0.0391  0.0343</span></span>
<span><span class="co">#&gt;       D_Dic4</span></span>
<span><span class="co">#&gt;       0.0643</span></span>
<span><span class="co">#&gt; s.e.  0.0374</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sigma^2 estimated as 0.02558:  log likelihood = 106.7,  aic = -197.41</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot.armaroots</span><span class="op">(</span><span class="fu">arroots</span><span class="op">(</span><span class="va">ARMA_DLPax_Nal</span><span class="op">)</span>, </span>
<span>               main<span class="op">=</span><span class="st">"Inverse AR roots of \nAR(p): LN PAx Nal"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot.armaroots</span><span class="op">(</span><span class="fu">maroots</span><span class="op">(</span><span class="va">ARMA_DLPax_Nal</span><span class="op">)</span>, </span>
<span>               main<span class="op">=</span><span class="st">"Inverse MA roots of \nMA(q): LN PAx Nal"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GRootsARMA11"></span>
<img src="03-PE_Univariados_files/figure-html/GRootsARMA11-1.png" alt="Inverso de las Raíces del polinomio característico de un ARMA(1,1)" width="100%"><p class="caption">
Figure 4.12: Inverso de las Raíces del polinomio característico de un ARMA(1,1)
</p>
</div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>En lo que resta de este capítulo, utilizaremos la serie en diferencias logarítmicas de los pasajeros en vuelos nacionales de salida, <span class="math inline">\(DLPaxNal_t\)</span>, para discutir los ejemplos que ilustran cada uno de los puntos teóricos que a continuación exponemos.</p>
</div>
</div>
<div id="función-de-autocorrelación-parcial" class="section level2" number="4.4">
<h2>
<span class="header-section-number">4.4</span> Función de Autocorrelación Parcial<a class="anchor" aria-label="anchor" href="#funci%C3%B3n-de-autocorrelaci%C3%B3n-parcial"><i class="fas fa-link"></i></a>
</h2>
<p>Ahora introduciremos el concepto de Función de Autocorrelación Parcial (PACF, por sus siglas en inglés). Primero, dadas las condiciones de estabilidad y de convergencia, si suponemos que un proceso AR, MA, ARMA o ARIMA tienen toda la información de los rezagos de la serie en conjunto y toda la información de los promedio móviles del término de error, resulta importante construir una métrica para distinguir el efecto de <span class="math inline">\(X_{t - \tau}\)</span> o el efecto de <span class="math inline">\(U_{t - \tau}\)</span> (para cualquier <span class="math inline">\(\tau\)</span>) sobre <span class="math inline">\(X_t\)</span> de forma individual.</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ARMA_DLPax_Nal</span><span class="op">$</span><span class="va">residuals</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Residuales de un ARIMA LN Pasajeros en vuelos nacionales de salida"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkblue"</span>,</span>
<span>     ylab <span class="op">=</span> <span class="st">"Residuals ARMA(1, 1)"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GResidualsARMA11"></span>
<img src="03-PE_Univariados_files/figure-html/GResidualsARMA11-1.png" alt="Inverso de las Raíces del polinomio característico de un ARMA(1,1)" width="100%"><p class="caption">
Figure 4.13: Inverso de las Raíces del polinomio característico de un ARMA(1,1)
</p>
</div>
<p>La idea es construir una métrica de la correlación que existe entre las diferentes varibles aleatorias, si para tal efecto se ha controlado el efecto del resto de la información. Así, podemos definir la ecuación que puede responder a este planteamiento como:
<span class="math display" id="eq:PACFEq">\[\begin{equation}
    X_t = \phi_{k1} X_{t-1} + \phi_{k2} X_{t-2} + \ldots + \phi_{kk} X_{t-k} + U_t
    \tag{4.70}
\end{equation}\]</span></p>
<p>Donde <span class="math inline">\(\phi_{ki}\)</span> es el coeficiente de la variable dada con el rezago <span class="math inline">\(i\)</span> si el proceso tiene un órden <span class="math inline">\(k\)</span>. Así, los coeficientes <span class="math inline">\(\phi_{kk}\)</span> son los coeficientes de la autocorrelación parcial (considerando un proceso AR(k)). Observemos que la autocorrelaicón parcial mide la correlación entre <span class="math inline">\(X_t\)</span> y <span class="math inline">\(X_{t-k}\)</span> que se mantiene cuando el efecto de las variables <span class="math inline">\(X_{t-1}\)</span>, <span class="math inline">\(X_{t-2}\)</span>, <span class="math inline">\(\ldots\)</span> y <span class="math inline">\(X_{t-k-1}\)</span> en <span class="math inline">\(X_{t}\)</span> y <span class="math inline">\(X_{t-k}\)</span> ha sido eliminado.</p>
<p>Dada la expresión considerada en la ecuación <a href="procesos-estacionarios-univariados.html#eq:PACFEq">(4.70)</a>, podemos resolver el problema de establecer el valor de cada <span class="math inline">\(\phi_{ki}\)</span> mediante la solución del sistema que se representa en lo siguiente:</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:foo1">Table 4.1: </span> Relación entre la Función de autocorrelación y la Función de autocorrelación parcial de una serie <span class="math inline">\(X_t\)</span>.</caption>
<colgroup>
<col width="33%">
<col width="33%">
<col width="33%">
</colgroup>
<thead><tr class="header">
<th align="center">Modelo si:</th>
<th align="center">Función de autocorrelación</th>
<th align="center">Función de autocorrelación parcial</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(MA(q)\)</span></td>
<td align="center">Rompimientos en la función</td>
<td align="center">No hay rompimientos</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(AR(q)\)</span></td>
<td align="center">No hay rompimientos</td>
<td align="center">Rompimientos en la función</td>
</tr>
</tbody>
</table></div>
<p><span class="math display" id="eq:PACFEq1">\[\begin{equation}
    \left[
    \begin{array}{c}
        \rho(1) \\
        \rho(2) \\
        \vdots \\
        \rho(k)
    \end{array}
    \right]
    =
    \left[
    \begin{array}{c c c c}
        1 &amp; \rho(1) &amp; \ldots &amp; \rho(k - 1)\\
        \rho(1) &amp; 1 &amp; \ldots &amp; \rho(k - 2)\\
        \rho(2) &amp; \rho(1) &amp; \ldots &amp; \rho(k - 3)\\
        \vdots &amp; \vdots &amp; \ldots &amp; \vdots\\
        \rho(k - 1) &amp; \rho(k - 2) &amp; \ldots &amp; 1\\
    \end{array}
    \right]
    \left[
    \begin{array}{c}
        \phi_{k1} \\
        \phi_{k2} \\
        \phi_{k3} \\
        \vdots \\
        \phi_{kk} \\
    \end{array}
    \right]
    \tag{4.71}    
\end{equation}\]</span></p>
<p>Del cual se puede derivar una solución, resoviendo por el método de cramer, o cualquier otro método que consideremos y que permita calcular la solución de sistemas de ecuaciones.</p>
<p>Posterior al análisis analítico platearemos un enfoque para interpretar las funciones de autocorrelación y autocorrelación parcial. Este enfoque pretende aportar al principio de parcimonia, en el cual podemos identificar el número de parámetros que posiblemente puede describir mejor a la serie en un modelo ARMA(p, q).</p>
<p>En el Cuadro <a href="procesos-estacionarios-univariados.html#tab:foo1">4.1</a> se muestra un resumen de las caranterísticas que debemos observar para determinar el número de parámetros de cada uno de los componentes AR y MA. Lo anterior por observación de las funciones de autocorrelación y autocorrelación parcial. Este enfoque no es el más formal, más adelante implemtaremos uno más formal y que puede ser más claro de cómo determinar el númeto de parámetros.</p>
<p>Continuando con el ejemplo en la Figura <a href="procesos-estacionarios-univariados.html#fig:GACFPACF">4.14</a> mostramos tanto la Función de Autocorrelación como la Función de Autocorrelación Parcial. En esta identificamos que ambas gráficas muestran que el modelo que explica a la variable <span class="math inline">\(DLPaxNal_t\)</span> tiene tanto componentes AR como MA. Sin embargo, dado lo errático del comportamiento de ambas funciones, resulta complicado determinar cuál sería un buen número de parametros <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> a considerar en el <span class="math inline">\(ARMA(p,q)\)</span>. Por esta razón a continuación platearemos algunas pruebas más formales para determinar dichos parámetros.</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">acf</a></span><span class="op">(</span><span class="va">DLPax_Nal4</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">234</span><span class="op">]</span>, lag.max <span class="op">=</span> <span class="fl">24</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">"Rezagos"</span>,</span>
<span>    main <span class="op">=</span> <span class="st">"Diff LN Pasajeros Nacionales"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/acf.html">pacf</a></span><span class="op">(</span><span class="va">DLPax_Nal4</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">234</span><span class="op">]</span>, lag.max <span class="op">=</span> <span class="fl">24</span>, </span>
<span>     xlab <span class="op">=</span> <span class="st">'Rezagos'</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Diff LN Pasajeros Nacionales"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GACFPACF"></span>
<img src="03-PE_Univariados_files/figure-html/GACFPACF-1.png" alt="Función de Autocorrelación y la Función de Autocorrelación Parcial de una serie $DLPaxNal_t$." width="100%"><p class="caption">
Figure 4.14: Función de Autocorrelación y la Función de Autocorrelación Parcial de una serie <span class="math inline">\(DLPaxNal_t\)</span>.
</p>
</div>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="selección-de-las-constantes-p-q-d-en-un-arp-un-maq-un-armap-q-o-un-arimap-d-q" class="section level2" number="4.5">
<h2>
<span class="header-section-number">4.5</span> Selección de las constantes p, q, d en un AR(p), un MA(q), un ARMA(p, q) o un ARIMA(p, d, q)<a class="anchor" aria-label="anchor" href="#selecci%C3%B3n-de-las-constantes-p-q-d-en-un-arp-un-maq-un-armap-q-o-un-arimap-d-q"><i class="fas fa-link"></i></a>
</h2>
<p>Respecto de cómo estimar un proceso ARMA(p, q) –en general utilizaremos este modelo para discutir, pero lo planteado en esta sección es igualmente aplicable en cualquier otro caso como aquellos modelos que incluyen variables exogénas– existen diversas formas de estimar los paramétros <span class="math inline">\(a_i\)</span> y <span class="math inline">\(b_i\)</span>: i) por máxima verosimilitd y ii) por mínimos cuadrados órdinarios. El primer caso requiere que conozcamos la distribución del proceso aleatorio <span class="math inline">\(U_t\)</span>. El segundo, por el contrario, no requiere el mismo supuesto. No obstante, para el curso utilizaremos el método de máxima verosimilitud.</p>
<p>Otra duda que debe quedar hasta el momento es ¿cómo determinar el orden <span class="math inline">\(p\)</span> y <span class="math inline">\(q\)</span> del proceso ARMA(p, q)? La manera más convencional y formal que existe para tal efecto es utilizar los criterios de información. Así, el orden se elije de acuerdo a aquel críterio de información que resulta ser el mínimo. En el caso de <span class="math inline">\(d\)</span> se selecciona revisando la gráfica que parezca más estacionaria–más adelante mostraremos un proceso más formal para su selección.</p>
<p>Los criterios de información más comunes son los siguientes:</p>
<ol style="list-style-type: decimal">
<li><p>FPE (Final Prediction Error):
<span class="math display" id="eq:ls1">\[\begin{equation}
FPE = \frac{T+m}{T-m}\frac{1}{T}\sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2
\tag{4.72}
\end{equation}\]</span></p></li>
<li><p>Akaike:
<span class="math display" id="eq:ls2">\[\begin{equation}
AIC = ln \left[ \frac{1}{T} \sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2 \right] + m \frac{2}{T}
     \tag{4.73}
\end{equation}\]</span></p></li>
<li><p>Schwarz:
<span class="math display" id="eq:ls3">\[\begin{equation}
SC = ln \left[ \frac{1}{T} \sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2 \right] + m \frac{ln(T)}{T}
   \tag{4.74}
\end{equation}\]</span></p></li>
<li><p>Hannan - Quinn:
<span class="math display" id="eq:ls4">\[\begin{equation}
HQ = ln \left[ \frac{1}{T} \sum_{t=1}^{T} \left( \hat{U}_t^{(p)} \right) ^2 \right] + m \frac{2 ln(ln(T))}{T}
   \tag{4.75}
\end{equation}\]</span></p></li>
</ol>
<p>Donde <span class="math inline">\(\hat{U}_t^{(p)}\)</span> son los residuales estimados mediante un proceso ARIMA y <span class="math inline">\(m\)</span> es el número de parametros estimados: <span class="math inline">\(m = p + q + 0 + 1\)</span> (ya que asumimos que <span class="math inline">\(d = 0\)</span>). Una propiedad que no se debe perder de vista es que los criterios de información cumplen la siguiente relación:
<span class="math display" id="eq:ls5">\[\begin{equation}
    orden(SC) \leq orden(HQ) \leq orden(AIC)
    \tag{4.76}
\end{equation}\]</span></p>
<p>Por esta razón, durante el curso solo utilizaremos el criterio se Akaike para determinar el orden óptimo del proceso ARMA, ya que ello garantiza el orden más grande posible.</p>
<p>Ahora veamos un ejemplo de estimación del número de rezagos optimo de un <span class="math inline">\(ARMA(p, q)\)</span>. Retomemos la serie en diferencias logarítmicas de los pasajeros en vuelos nacionales de salidas, pero ahora incluiremos la variables exógenas de dummies estacionales: enero, febrero, julio y diciembre.</p>
<p>Como mencionamos, las gráficas de las funciones de autocorrelación permiten observar el valor de la correlación existente entre la variable en el momento <span class="math inline">\(t\)</span> con cada uno de los rezagos. Incluso la Función de Autocorrelación Parcial puede ayudar a determinar el número máximo de rezagos que se debe incluir en el proceso <span class="math inline">\(AR(p)\)</span>. No obstante, una métrica más formal es el uso de los criterios de información. En nuestro caso, dado lo discutido, sólo utilizareemos el criterio de Akaike.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:SelecARMApq">Table 4.2: </span> Criterio de Akike para diferentes modelos <span class="math inline">\(ARMA(p, q)\)</span> de la serie <span class="math inline">\(DLPaxNal_t\)</span>.</caption>
<thead><tr class="header">
<th align="center">Modelo</th>
<th align="center">AR(p)</th>
<th align="center">MA(p)</th>
<th align="center">Akaike (AIC)</th>
<th align="center">Óptimo</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">1</td>
<td align="center">1</td>
<td align="center">-475.1190</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">1</td>
<td align="center">2</td>
<td align="center">-473.4397</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">1</td>
<td align="center">3</td>
<td align="center">-483.1239</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">1</td>
<td align="center">4</td>
<td align="center">-482.4932</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">1</td>
<td align="center">5</td>
<td align="center">-506.9880</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">1</td>
<td align="center">6</td>
<td align="center">-533.9411</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center">7</td>
<td align="center">2</td>
<td align="center">1</td>
<td align="center">-473.4758</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="odd">
<td align="center">24</td>
<td align="center">4</td>
<td align="center">6</td>
<td align="center">-752.8996</td>
<td align="center">*</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
<td align="center"><span class="math inline">\(\vdots\)</span></td>
</tr>
<tr class="odd">
<td align="center">36</td>
<td align="center">6</td>
<td align="center">6</td>
<td align="center">-752.2632</td>
<td align="center"></td>
</tr>
</tbody>
</table></div>
<p>Al respecto, en el Cuadro <a href="procesos-estacionarios-univariados.html#tab:SelecARMApq">4.2</a> reportamos el criterio de Akaike que resultan de aplicar dicho criterio a los residuales resultantes de cada combinación de procesos <span class="math inline">\(ARMA(p, q)\)</span>. La forma de escoger será aquel modelo que reporta el criterio de Akaike menor. En la cuarta columna de la tabla se señala el valor del criterio de información que resulta ser el mínimo de todos los posibles.</p>
<p>El Cuadro <a href="procesos-estacionarios-univariados.html#tab:SelecARMApq">4.2</a> reporta los resultados para 36 diferentes modelos, todos incluyen variables exogenas. Como resultado del análisis concluimos que el modelo más adecuado es el 24, el cual considera un <span class="math inline">\(ARMA(4, 6)\)</span>, con variables dummies para controlar la estacionalidad de los meses de enero, febrero, julio y diciembre. En el Cuadro <a href="procesos-estacionarios-univariados.html#tab:ResultARMApq">4.3</a> mostramos los resutados del modelo.</p>
<p>No obstante, una inspección de los residuales del modelo nos permite sospechar que requiere de incluir un par de dummies más. Ambas, asociadas con la caída del transporte aéreo en 2009, principalmente asociado con la crisis mundial de ese año. La Figura <a href="procesos-estacionarios-univariados.html#fig:GResidualsARMA46">4.15</a> muestra los residuales mencionados.</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Funciones que determinan el rezago optimo (que minimiza el criterio de Akaike)</span></span>
<span><span class="co">#Esta es una prueba mas formar respecto de la meta inspeccion grafica</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/source.html">source</a></span><span class="op">(</span><span class="st">"BD/Clase_09/Lag_Opt_ARIMA_Exog.R"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Estimacion del proceso ARIMA(p, 1, q):</span></span>
<span><span class="co">#CON variables exogenas:</span></span>
<span><span class="fu">Lag_Opt_ARIMA_Exog</span><span class="op">(</span>p_max <span class="op">=</span> <span class="fl">6</span>, q_max <span class="op">=</span> <span class="fl">6</span>, </span>
<span>                   X_t <span class="op">=</span> <span class="va">DLPax_Nal4</span>, </span>
<span>                   Ex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                   Z_t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">D_Ene4</span>, <span class="va">D_Feb4</span>, <span class="va">D_Jul4</span>, <span class="va">D_Dic4</span><span class="op">)</span> <span class="op">)</span></span>
<span><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span><span class="co">#&gt; = Z_t, method = "ML"): possible convergence problem: optim</span></span>
<span><span class="co">#&gt; gave code = 1</span></span>
<span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span><span class="co">#&gt; = Z_t, method = "ML"): possible convergence problem: optim</span></span>
<span><span class="co">#&gt; gave code = 1</span></span>
<span><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span></span>
<span><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span><span class="co">#&gt; = Z_t, method = "ML"): possible convergence problem: optim</span></span>
<span><span class="co">#&gt; gave code = 1</span></span>
<span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span><span class="co">#&gt; = Z_t, method = "ML"): possible convergence problem: optim</span></span>
<span><span class="co">#&gt; gave code = 1</span></span>
<span><span class="co">#&gt;       Rezago p Rezago q       AIC Optimo</span></span>
<span><span class="co">#&gt;  [1,]        1        1 -197.4050      0</span></span>
<span><span class="co">#&gt;  [2,]        1        2 -225.1386      0</span></span>
<span><span class="co">#&gt;  [3,]        1        3 -223.5953      0</span></span>
<span><span class="co">#&gt;  [4,]        1        4 -220.5549      0</span></span>
<span><span class="co">#&gt;  [5,]        1        5 -218.6917      0</span></span>
<span><span class="co">#&gt;  [6,]        1        6 -231.4310      0</span></span>
<span><span class="co">#&gt;  [7,]        2        1 -220.2086      0</span></span>
<span><span class="co">#&gt;  [8,]        2        2 -224.4070      0</span></span>
<span><span class="co">#&gt;  [9,]        2        3 -224.5471      0</span></span>
<span><span class="co">#&gt; [10,]        2        4 -223.3335      0</span></span>
<span><span class="co">#&gt; [11,]        2        5 -225.1568      0</span></span>
<span><span class="co">#&gt; [12,]        2        6 -229.4401      0</span></span>
<span><span class="co">#&gt; [13,]        3        1 -222.6373      0</span></span>
<span><span class="co">#&gt; [14,]        3        2 -224.7367      0</span></span>
<span><span class="co">#&gt; [15,]        3        3 -220.9403      0</span></span>
<span><span class="co">#&gt; [16,]        3        4 -276.7301      1</span></span>
<span><span class="co">#&gt; [17,]        3        5 -275.5672      0</span></span>
<span><span class="co">#&gt; [18,]        3        6 -227.4626      0</span></span>
<span><span class="co">#&gt; [19,]        4        1 -221.3591      0</span></span>
<span><span class="co">#&gt; [20,]        4        2 -222.9806      0</span></span>
<span><span class="co">#&gt; [21,]        4        3 -243.7884      0</span></span>
<span><span class="co">#&gt; [22,]        4        4 -243.9174      0</span></span>
<span><span class="co">#&gt; [23,]        4        5 -244.1439      0</span></span>
<span><span class="co">#&gt; [24,]        4        6 -271.5143      0</span></span>
<span><span class="co">#&gt; [25,]        5        1 -220.0956      0</span></span>
<span><span class="co">#&gt; [26,]        5        2 -221.8154      0</span></span>
<span><span class="co">#&gt; [27,]        5        3 -272.1756      0</span></span>
<span><span class="co">#&gt; [28,]        5        4 -245.4954      0</span></span>
<span><span class="co">#&gt; [29,]        5        5 -243.5682      0</span></span>
<span><span class="co">#&gt; [30,]        5        6 -269.1516      0</span></span>
<span><span class="co">#&gt; [31,]        6        1 -227.5711      0</span></span>
<span><span class="co">#&gt; [32,]        6        2 -226.2520      0</span></span>
<span><span class="co">#&gt; [33,]        6        3 -273.6243      0</span></span>
<span><span class="co">#&gt; [34,]        6        4 -270.1272      0</span></span>
<span><span class="co">#&gt; [35,]        6        5 -270.0199      0</span></span>
<span><span class="co">#&gt; [36,]        6        6 -269.4984      0</span></span>
<span></span>
<span><span class="co">#SIN variables exogenas:</span></span>
<span><span class="fu">Lag_Opt_ARIMA_Exog</span><span class="op">(</span>p_max <span class="op">=</span> <span class="fl">6</span>, q_max <span class="op">=</span> <span class="fl">6</span>, </span>
<span>                   X_t <span class="op">=</span> <span class="va">DLPax_Nal4</span>, </span>
<span>                   Ex <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                   Z_t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">D_Ene4</span>, <span class="va">D_Feb4</span>, <span class="va">D_Jul4</span>, <span class="va">D_Dic4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), method =</span></span>
<span><span class="co">#&gt; "ML"): possible convergence problem: optim gave code = 1</span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), method =</span></span>
<span><span class="co">#&gt; "ML"): possible convergence problem: optim gave code = 1</span></span>
<span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), method =</span></span>
<span><span class="co">#&gt; "ML"): possible convergence problem: optim gave code = 1</span></span>
<span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), method =</span></span>
<span><span class="co">#&gt; "ML"): possible convergence problem: optim gave code = 1</span></span>
<span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), method =</span></span>
<span><span class="co">#&gt; "ML"): possible convergence problem: optim gave code = 1</span></span>
<span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), method =</span></span>
<span><span class="co">#&gt; "ML"): possible convergence problem: optim gave code = 1</span></span>
<span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), method =</span></span>
<span><span class="co">#&gt; "ML"): possible convergence problem: optim gave code = 1</span></span>
<span><span class="co">#&gt;       Rezago p Rezago q       AIC Optimo</span></span>
<span><span class="co">#&gt;  [1,]        1        1 -158.4886      0</span></span>
<span><span class="co">#&gt;  [2,]        1        2 -188.4346      0</span></span>
<span><span class="co">#&gt;  [3,]        1        3 -187.4277      0</span></span>
<span><span class="co">#&gt;  [4,]        1        4 -187.7574      0</span></span>
<span><span class="co">#&gt;  [5,]        1        5 -186.0283      0</span></span>
<span><span class="co">#&gt;  [6,]        1        6 -197.3958      0</span></span>
<span><span class="co">#&gt;  [7,]        2        1 -184.0936      0</span></span>
<span><span class="co">#&gt;  [8,]        2        2 -189.0901      0</span></span>
<span><span class="co">#&gt;  [9,]        2        3 -188.0542      0</span></span>
<span><span class="co">#&gt; [10,]        2        4 -186.0658      0</span></span>
<span><span class="co">#&gt; [11,]        2        5 -190.3917      0</span></span>
<span><span class="co">#&gt; [12,]        2        6 -195.4309      0</span></span>
<span><span class="co">#&gt; [13,]        3        1 -188.0653      0</span></span>
<span><span class="co">#&gt; [14,]        3        2 -187.8864      0</span></span>
<span><span class="co">#&gt; [15,]        3        3 -205.6144      0</span></span>
<span><span class="co">#&gt; [16,]        3        4 -241.7423      0</span></span>
<span><span class="co">#&gt; [17,]        3        5 -241.5593      0</span></span>
<span><span class="co">#&gt; [18,]        3        6 -247.4453      0</span></span>
<span><span class="co">#&gt; [19,]        4        1 -164.8898      0</span></span>
<span><span class="co">#&gt; [20,]        4        2 -186.7417      0</span></span>
<span><span class="co">#&gt; [21,]        4        3 -214.8872      0</span></span>
<span><span class="co">#&gt; [22,]        4        4 -211.3784      0</span></span>
<span><span class="co">#&gt; [23,]        4        5 -208.6211      0</span></span>
<span><span class="co">#&gt; [24,]        4        6 -216.6316      0</span></span>
<span><span class="co">#&gt; [25,]        5        1 -184.9023      0</span></span>
<span><span class="co">#&gt; [26,]        5        2 -186.8473      0</span></span>
<span><span class="co">#&gt; [27,]        5        3 -245.1477      0</span></span>
<span><span class="co">#&gt; [28,]        5        4 -213.9622      0</span></span>
<span><span class="co">#&gt; [29,]        5        5 -212.4953      0</span></span>
<span><span class="co">#&gt; [30,]        5        6 -241.4802      0</span></span>
<span><span class="co">#&gt; [31,]        6        1 -200.6707      0</span></span>
<span><span class="co">#&gt; [32,]        6        2 -198.6868      0</span></span>
<span><span class="co">#&gt; [33,]        6        3 -248.2317      0</span></span>
<span><span class="co">#&gt; [34,]        6        4 -246.1741      0</span></span>
<span><span class="co">#&gt; [35,]        6        5 -264.2011      0</span></span>
<span><span class="co">#&gt; [36,]        6        6 -270.5896      1</span></span>
<span></span>
<span><span class="co">#Estimacion:</span></span>
<span><span class="va">ARMA_Ex_DLPax_Nal</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">DLPax_Nal4</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">0</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>                           xreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">D_Ene4</span>, <span class="va">D_Feb4</span>, <span class="va">D_Jul4</span>, <span class="va">D_Dic4</span><span class="op">)</span>,</span>
<span>                           method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ARMA_Ex_DLPax_Nal</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; arima(x = DLPax_Nal4, order = c(3, 0, 4), xreg = cbind(D_Ene4, D_Feb4, D_Jul4, </span></span>
<span><span class="co">#&gt;     D_Dic4), method = "ML")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;           ar1     ar2     ar3     ma1      ma2      ma3</span></span>
<span><span class="co">#&gt;       -1.0454  0.1932  0.6873  1.3011  -0.2973  -1.4188</span></span>
<span><span class="co">#&gt; s.e.   0.0504  0.0872  0.0504  0.0563   0.0499   0.0476</span></span>
<span><span class="co">#&gt;           ma4  intercept   D_Ene4   D_Feb4  D_Jul4  D_Dic4</span></span>
<span><span class="co">#&gt;       -0.5849    -0.0142  -0.1312  -0.0061  0.2910  0.0612</span></span>
<span><span class="co">#&gt; s.e.   0.0564     0.0099   0.0412   0.0434  0.0514  0.0431</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sigma^2 estimated as 0.01722:  log likelihood = 151.37,  aic = -276.73</span></span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ARMA_Ex_DLPax_Nal</span><span class="op">$</span><span class="va">residuals</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Residuales ARMA Diff LN Pasajeros Nacionales"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GResidualsARMA46"></span>
<img src="03-PE_Univariados_files/figure-html/GResidualsARMA46-1.png" alt="Residuales del ARMA(4, 6) de una serie $DLPaxNal_t$." width="100%"><p class="caption">
Figure 4.15: Residuales del ARMA(4, 6) de una serie <span class="math inline">\(DLPaxNal_t\)</span>.
</p>
</div>
<p>Una vez incluidas dos dummies más para mayo y junio de 2009, analizamos un total de 36 modelos ARMA y determinamos que el orden que minimizza el criterio de Akaike es un <span class="math inline">\(ARMA(4, 6)\)</span>. El Cuadro <a href="procesos-estacionarios-univariados.html#tab:ResultARMApq">4.3</a> muestra los resultados para este nuevo modelo. No lo motramos en esta sección, pero ambos modelos reportados tienen raices de sus respectivos polinomios característicos menores a 1 en valor absoluto. En la Figura @ref(fig:GResidualsARMA46D} mostramos los residuales ahora ajustados por las dummies de mayo y junio de 2009.</p>
</div>
<div id="pronósticos" class="section level2" number="4.6">
<h2>
<span class="header-section-number">4.6</span> Pronósticos<a class="anchor" aria-label="anchor" href="#pron%C3%B3sticos"><i class="fas fa-link"></i></a>
</h2>
<p>Para pronósticar el valor de la serie es necesario determinar cuál es el valor esperado de la serie en un momento <span class="math inline">\(t + \tau\)</span> condicional en que ésta se comporta como un <span class="math inline">\(AR(p)\)</span>, un <span class="math inline">\(MA(q)\)</span> o un <span class="math inline">\(ARMA(p, q)\)</span> y a que los valores antes de <span class="math inline">\(t\)</span> están dados. Por lo que el pronóstico de la serie estará dado por una expresión:</p>
<p><span class="math display" id="eq:ARMApqFor">\[\begin{eqnarray}
    \mathbb{E}_t[X_{t+\tau}] = \delta + a_1 \mathbb{E}_t[X_{t+\tau-1}] + a_2 \mathbb{E}_t[X_{t+\tau-2}] + \ldots + + a_p \mathbb{E}_t[X_{t+\tau-p}]
    \tag{4.77}
\end{eqnarray}\]</span></p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Nueva Estimacion del proceso ARIMA(p, 1, q):</span></span>
<span><span class="co">#CON variables exogenas rezagos optimos:</span></span>
<span><span class="fu">Lag_Opt_ARIMA_Exog</span><span class="op">(</span>p_max <span class="op">=</span> <span class="fl">6</span>, q_max <span class="op">=</span> <span class="fl">6</span>, </span>
<span>                   X_t <span class="op">=</span> <span class="va">DLPax_Nal4</span>, </span>
<span>                   Ex <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                   Z_t <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">D_Ene4</span>, <span class="va">D_Feb4</span>, <span class="va">D_Jul4</span>, <span class="va">D_Dic4</span>, <span class="va">D_Mar20204</span>, <span class="va">D_Abr20204</span>, <span class="va">D_Jun20204</span>, <span class="va">D_Jul20204</span>, <span class="va">D_Mar20214</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span></span>
<span><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span><span class="co">#&gt; = Z_t, method = "ML"): possible convergence problem: optim</span></span>
<span><span class="co">#&gt; gave code = 1</span></span>
<span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span><span class="co">#&gt; = Z_t, method = "ML"): possible convergence problem: optim</span></span>
<span><span class="co">#&gt; gave code = 1</span></span>
<span><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span><span class="co">#&gt; = Z_t, method = "ML"): possible convergence problem: optim</span></span>
<span><span class="co">#&gt; gave code = 1</span></span>
<span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span><span class="co">#&gt; = Z_t, method = "ML"): possible convergence problem: optim</span></span>
<span><span class="co">#&gt; gave code = 1</span></span>
<span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span><span class="co">#&gt; = Z_t, method = "ML"): possible convergence problem: optim</span></span>
<span><span class="co">#&gt; gave code = 1</span></span>
<span><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span></span>
<span><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span></span>
<span><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span></span>
<span><span class="co">#&gt; Warning in log(s2): NaNs produced</span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span><span class="co">#&gt; = Z_t, method = "ML"): possible convergence problem: optim</span></span>
<span><span class="co">#&gt; gave code = 1</span></span>
<span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span><span class="co">#&gt; = Z_t, method = "ML"): possible convergence problem: optim</span></span>
<span><span class="co">#&gt; gave code = 1</span></span>
<span></span>
<span><span class="co">#&gt; Warning in arima(X_t, order = c(i, 0, (j - grupo)), xreg</span></span>
<span><span class="co">#&gt; = Z_t, method = "ML"): possible convergence problem: optim</span></span>
<span><span class="co">#&gt; gave code = 1</span></span>
<span><span class="co">#&gt;       Rezago p Rezago q       AIC Optimo</span></span>
<span><span class="co">#&gt;  [1,]        1        1 -515.9705      0</span></span>
<span><span class="co">#&gt;  [2,]        1        2 -515.2759      0</span></span>
<span><span class="co">#&gt;  [3,]        1        3 -526.1788      0</span></span>
<span><span class="co">#&gt;  [4,]        1        4 -544.6840      0</span></span>
<span><span class="co">#&gt;  [5,]        1        5 -549.7059      0</span></span>
<span><span class="co">#&gt;  [6,]        1        6 -566.3787      0</span></span>
<span><span class="co">#&gt;  [7,]        2        1 -515.6097      0</span></span>
<span><span class="co">#&gt;  [8,]        2        2 -523.5230      0</span></span>
<span><span class="co">#&gt;  [9,]        2        3 -528.3379      0</span></span>
<span><span class="co">#&gt; [10,]        2        4 -562.7803      0</span></span>
<span><span class="co">#&gt; [11,]        2        5 -629.1112      0</span></span>
<span><span class="co">#&gt; [12,]        2        6 -639.3428      0</span></span>
<span><span class="co">#&gt; [13,]        3        1 -493.0232      0</span></span>
<span><span class="co">#&gt; [14,]        3        2 -521.5237      0</span></span>
<span><span class="co">#&gt; [15,]        3        3 -540.6415      0</span></span>
<span><span class="co">#&gt; [16,]        3        4 -627.6871      0</span></span>
<span><span class="co">#&gt; [17,]        3        5 -638.1619      0</span></span>
<span><span class="co">#&gt; [18,]        3        6 -642.3540      0</span></span>
<span><span class="co">#&gt; [19,]        4        1 -491.1436      0</span></span>
<span><span class="co">#&gt; [20,]        4        2 -616.1311      0</span></span>
<span><span class="co">#&gt; [21,]        4        3 -541.0899      0</span></span>
<span><span class="co">#&gt; [22,]        4        4 -751.3579      0</span></span>
<span><span class="co">#&gt; [23,]        4        5 -749.8460      0</span></span>
<span><span class="co">#&gt; [24,]        4        6 -750.2787      0</span></span>
<span><span class="co">#&gt; [25,]        5        1 -580.2799      0</span></span>
<span><span class="co">#&gt; [26,]        5        2 -572.7953      0</span></span>
<span><span class="co">#&gt; [27,]        5        3 -678.9301      0</span></span>
<span><span class="co">#&gt; [28,]        5        4 -747.5442      0</span></span>
<span><span class="co">#&gt; [29,]        5        5 -689.7247      0</span></span>
<span><span class="co">#&gt; [30,]        5        6 -678.0239      0</span></span>
<span><span class="co">#&gt; [31,]        6        1 -661.8683      0</span></span>
<span><span class="co">#&gt; [32,]        6        2 -663.5500      0</span></span>
<span><span class="co">#&gt; [33,]        6        3 -661.5526      0</span></span>
<span><span class="co">#&gt; [34,]        6        4 -680.3478      0</span></span>
<span><span class="co">#&gt; [35,]        6        5 -696.3317      0</span></span>
<span><span class="co">#&gt; [36,]        6        6 -764.4944      1</span></span>
<span></span>
<span></span>
<span><span class="va">ARMA_Ex_DLPax_Nal_2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/arima.html">arima</a></span><span class="op">(</span><span class="va">DLPax_Nal4</span>, order <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">0</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>                             xreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">D_Ene4</span>, <span class="va">D_Feb4</span>, <span class="va">D_Jul4</span>, <span class="va">D_Dic4</span>, <span class="va">D_Mar20204</span>, <span class="va">D_Abr20204</span>, <span class="va">D_Jun20204</span>, <span class="va">D_Jul20204</span>, <span class="va">D_Mar20214</span><span class="op">)</span>,</span>
<span>                             method <span class="op">=</span> <span class="st">"ML"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in arima(DLPax_Nal4, order = c(6, 0, 6), xreg =</span></span>
<span><span class="co">#&gt; cbind(D_Ene4, D_Feb4, : possible convergence problem: optim</span></span>
<span><span class="co">#&gt; gave code = 1</span></span>
<span></span>
<span><span class="co"># Estimacion:</span></span>
<span><span class="va">ARMA_Ex_DLPax_Nal_2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; arima(x = DLPax_Nal4, order = c(6, 0, 6), xreg = cbind(D_Ene4, D_Feb4, D_Jul4, </span></span>
<span><span class="co">#&gt;     D_Dic4, D_Mar20204, D_Abr20204, D_Jun20204, D_Jul20204, D_Mar20214), method = "ML")</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;          ar1     ar2     ar3     ar4     ar5      ar6</span></span>
<span><span class="co">#&gt;       0.0033  0.0010  0.0056  0.0016  0.0079  -0.9948</span></span>
<span><span class="co">#&gt; s.e.  0.0062  0.0062  0.0085  0.0063  0.0062   0.0037</span></span>
<span><span class="co">#&gt;           ma1      ma2      ma3     ma4      ma5     ma6</span></span>
<span><span class="co">#&gt;       -0.0527  -0.0989  -0.1029  0.0245  -0.0505  0.9383</span></span>
<span><span class="co">#&gt; s.e.   0.0499   0.0305   0.0483  0.0344   0.0493  0.0377</span></span>
<span><span class="co">#&gt;       intercept   D_Ene4   D_Feb4  D_Jul4  D_Dic4</span></span>
<span><span class="co">#&gt;          0.0169  -0.0635  -0.1604  0.0946  0.0056</span></span>
<span><span class="co">#&gt; s.e.     0.0040   0.0934   0.0172  0.0927  0.0175</span></span>
<span><span class="co">#&gt;       D_Mar20204  D_Abr20204  D_Jun20204  D_Jul20204</span></span>
<span><span class="co">#&gt;          -0.4333     -1.9604      0.9050      0.5063</span></span>
<span><span class="co">#&gt; s.e.      0.0497      0.0489      0.0519      0.0516</span></span>
<span><span class="co">#&gt;       D_Mar20214</span></span>
<span><span class="co">#&gt;           0.2198</span></span>
<span><span class="co">#&gt; s.e.      0.0504</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; sigma^2 estimated as 0.002315:  log likelihood = 405.25,  aic = -764.49</span></span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">ARMA_Ex_DLPax_Nal_2</span><span class="op">$</span><span class="va">residuals</span>, </span>
<span>     ylab <span class="op">=</span> <span class="st">""</span>,</span>
<span>     main <span class="op">=</span> <span class="st">"Residuales ARMA Diff LN Pasajeros Nacionales"</span>,</span>
<span>     col <span class="op">=</span> <span class="st">"darkblue"</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:GResidualsARMA46D"></span>
<img src="03-PE_Univariados_files/figure-html/GResidualsARMA46D-1.png" alt="Residuales del ARMA(4, 6) de una serie $DLPaxNal_t$." width="100%"><p class="caption">
Figure 4.16: Residuales del ARMA(4, 6) de una serie <span class="math inline">\(DLPaxNal_t\)</span>.
</p>
</div>
<p>Lo anterior para todo <span class="math inline">\(\tau = 0, 1, 2, \ldots\)</span> y considerando que los componentes MA(q) en la eucación <a href="procesos-estacionarios-univariados.html#eq:ARMApqFor">(4.77)</a> son cero dado que para todo valor <span class="math inline">\(t + \tau\)</span> es cierto que <span class="math inline">\(\mathbb{E}_t[U_{t+\tau}]\)</span>.</p>
<div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:ResultARMApq">Table 4.3: </span> Criterio de Akike para diferentes modelos ARMA(p, q) de la serie <span class="math inline">\(DLPaxNal_t\)</span>. <em>Nota: El método de estimación fue máxima verosimilitud.</em>
</caption>
<thead><tr class="header">
<th align="center"></th>
<th align="center">Modelo 1</th>
<th align="center"></th>
<th align="center">Modelo 2</th>
<th align="center"></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">Variable</td>
<td align="center">Coeficiente</td>
<td align="center">Error Est.</td>
<td align="center">Coeficiente</td>
<td align="center">Error Est.</td>
</tr>
<tr class="even">
<td align="center">Constante</td>
<td align="center">0.0134</td>
<td align="center">0.0033</td>
<td align="center">0.0145</td>
<td align="center">0.0029</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLPaxNal_{t-1}\)</span></td>
<td align="center">0.0004</td>
<td align="center">0.0011</td>
<td align="center">0.0014</td>
<td align="center">0.0016</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLPaxNal_{t-2}\)</span></td>
<td align="center">0.9997</td>
<td align="center">0.0019</td>
<td align="center">0.9988</td>
<td align="center">0.0024</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DLPaxNal_{t-3}\)</span></td>
<td align="center">0.0001</td>
<td align="center">0.0012</td>
<td align="center">0.0002</td>
<td align="center">0.0014</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DLPaxNal_{t-4}\)</span></td>
<td align="center">-0.9997</td>
<td align="center">0.0004</td>
<td align="center">-0.9993</td>
<td align="center">0.0009</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{U}_{t-1}\)</span></td>
<td align="center">-0.2877</td>
<td align="center">0.0670</td>
<td align="center">-0.1472</td>
<td align="center">0.0633</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{U}_{t-2}\)</span></td>
<td align="center">-1.2028</td>
<td align="center">0.0608</td>
<td align="center">-1.3323</td>
<td align="center">0.0625</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{U}_{t-3}\)</span></td>
<td align="center">0.2302</td>
<td align="center">0.0765</td>
<td align="center">0.1201</td>
<td align="center">0.0756</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{U}_{t-4}\)</span></td>
<td align="center">1.2085</td>
<td align="center">0.0645</td>
<td align="center">1.3142</td>
<td align="center">0.0642</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{U}_{t-5}\)</span></td>
<td align="center">-0.2634</td>
<td align="center">0.0708</td>
<td align="center">-0.1034</td>
<td align="center">0.0717</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(\hat{U}_{t-6}\)</span></td>
<td align="center">-0.2171</td>
<td align="center">0.0606</td>
<td align="center">-0.3864</td>
<td align="center">0.0657</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DEne_{t}\)</span></td>
<td align="center">-0.2904</td>
<td align="center">0.0172</td>
<td align="center">-0.2865</td>
<td align="center">0.0156</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DFeb_{t}\)</span></td>
<td align="center">-0.1312</td>
<td align="center">0.0170</td>
<td align="center">-0.1273</td>
<td align="center">0.0140</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DJul_{t}\)</span></td>
<td align="center">0.3303</td>
<td align="center">0.0173</td>
<td align="center">0.3164</td>
<td align="center">0.0156</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(Dic_{t}\)</span></td>
<td align="center">-0.0118</td>
<td align="center">0.0169</td>
<td align="center">-0.0138</td>
<td align="center">0.0137</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(DMay2009_{t}\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">-0.3378</td>
<td align="center">0.0360</td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(DJun2009_{t}\)</span></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">0.2371</td>
<td align="center">0.0359</td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(\hat{\sigma}^2\)</span></td>
<td align="center">0.001841</td>
<td align="center"></td>
<td align="center">0.001283</td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center">AIC</td>
<td align="center">-752.9</td>
<td align="center"></td>
<td align="center">-835.73</td>
<td align="center"></td>
</tr>
</tbody>
</table></div>
<p>Continuando con el ejemplo, en la Figura <a href="procesos-estacionarios-univariados.html#fig:PaxNalf">4.17</a> mostramos el resultado del pronóstico de la serie a partir del modelo ARMA(4, 6) que hemos discutido anteriormente.</p>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Forecast:</span></span>
<span><span class="va">Predict_Datos</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Clase_10/Predict_Base_Transporte_ARIMA.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Conversion a series de tiempo:</span></span>
<span><span class="va">D_Mar2020_fP</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Mar2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">8</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Abr2020_fP</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Abr2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">8</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Jun2020_fP</span>    <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Jun2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">8</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Jul2020_fP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Jul2020</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">8</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Mar2021_fP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Mar2021</span>, </span>
<span>                start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">8</span><span class="op">)</span>, </span>
<span>                freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Ene_fP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Ene</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">8</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Feb_fP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Feb</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">8</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Jul_fP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Jul</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">8</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="va">D_Dic_fP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html">ts</a></span><span class="op">(</span><span class="va">Predict_Datos</span><span class="op">$</span><span class="va">D_Dic</span>, </span>
<span>            start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2021</span>, <span class="fl">8</span><span class="op">)</span>, </span>
<span>            freq <span class="op">=</span> <span class="fl">12</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prediccion 2 años de la serie en diferencias:</span></span>
<span><span class="co"># Usando la estimacion del proceso ARIMA(p, 1, q):</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ARMA_Ex_DLPax_Nal_2</span>, n.ahead <span class="op">=</span> <span class="fl">24</span>, </span>
<span>        newxreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">D_Ene_fP</span>, <span class="va">D_Feb_fP</span>, <span class="va">D_Jul_fP</span>, <span class="va">D_Dic_fP</span>, </span>
<span>                        <span class="va">D_Mar2020_fP</span>, <span class="va">D_Abr2020_fP</span>, <span class="va">D_Jun2020_fP</span>, <span class="va">D_Jul2020_fP</span>, <span class="va">D_Mar2021_fP</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $pred</span></span>
<span><span class="co">#&gt;               Jan          Feb          Mar          Apr</span></span>
<span><span class="co">#&gt; 2021                                                    </span></span>
<span><span class="co">#&gt; 2022 -0.113805772 -0.162345095  0.143209830 -0.013117736</span></span>
<span><span class="co">#&gt; 2023 -0.112840693 -0.164880914  0.142135423 -0.013327904</span></span>
<span><span class="co">#&gt;               May          Jun          Jul          Aug</span></span>
<span><span class="co">#&gt; 2021                                         0.034506463</span></span>
<span><span class="co">#&gt; 2022  0.056486178  0.001136661  0.178229215  0.037070040</span></span>
<span><span class="co">#&gt; 2023  0.055930178  0.001792611  0.177247937             </span></span>
<span><span class="co">#&gt;               Sep          Oct          Nov          Dec</span></span>
<span><span class="co">#&gt; 2021 -0.109937459  0.046817343 -0.022944168  0.038579201</span></span>
<span><span class="co">#&gt; 2022 -0.108866052  0.047031034 -0.022405053  0.037915211</span></span>
<span><span class="co">#&gt; 2023                                                    </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $se</span></span>
<span><span class="co">#&gt;             Jan        Feb        Mar        Apr        May</span></span>
<span><span class="co">#&gt; 2021                                                       </span></span>
<span><span class="co">#&gt; 2022 0.04899045 0.04910882 0.04916415 0.04935297 0.04957147</span></span>
<span><span class="co">#&gt; 2023 0.05023197 0.05035300 0.05040132 0.05057457 0.05078330</span></span>
<span><span class="co">#&gt;             Jun        Jul        Aug        Sep        Oct</span></span>
<span><span class="co">#&gt; 2021                       0.04846132 0.04852048 0.04871765</span></span>
<span><span class="co">#&gt; 2022 0.04957786 0.04961940 0.04973912 0.04979084 0.04997169</span></span>
<span><span class="co">#&gt; 2023 0.05078908 0.05082888                                 </span></span>
<span><span class="co">#&gt;             Nov        Dec</span></span>
<span><span class="co">#&gt; 2021 0.04894129 0.04894801</span></span>
<span><span class="co">#&gt; 2022 0.05018523 0.05019131</span></span>
<span><span class="co">#&gt; 2023</span></span>
<span></span>
<span><span class="va">DLPax_Nal_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">ARMA_Ex_DLPax_Nal_2</span>, n.ahead <span class="op">=</span> <span class="fl">24</span>, </span>
<span>                      newxreg <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">D_Ene_fP</span>, <span class="va">D_Feb_fP</span>, <span class="va">D_Jul_fP</span>, <span class="va">D_Dic_fP</span>, </span>
<span>                                      <span class="va">D_Mar2020_fP</span>, <span class="va">D_Abr2020_fP</span>, <span class="va">D_Jun2020_fP</span>, <span class="va">D_Jul2020_fP</span>, <span class="va">D_Mar2021_fP</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">DLPax_Nal_f</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "pred" "se"</span></span>
<span></span>
<span><span class="co"># Prediccion de la serie original:</span></span>
<span><span class="va">Pronostico_Arima</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readxl.tidyverse.org/reference/read_excel.html">read_excel</a></span><span class="op">(</span><span class="st">"BD/Clase_10/Pronostico_Arima.xlsx"</span>, sheet <span class="op">=</span> <span class="st">"Datos"</span>, col_names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">Pronostico_Arima</span><span class="op">$</span><span class="va">Pax_Nal_f</span> <span class="op">&lt;-</span> <span class="va">Pronostico_Arima</span><span class="op">$</span><span class="va">Pax_Nal</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">Pronostico_Arima</span><span class="op">$</span><span class="va">Pax_Nal_f</span><span class="op">[</span><span class="fl">259</span> <span class="op">+</span> <span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> </span>
<span>    <span class="va">Pronostico_Arima</span><span class="op">$</span><span class="va">Pax_Nal_f</span><span class="op">[</span><span class="fl">259</span> <span class="op">+</span> <span class="va">i</span> <span class="op">-</span> <span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">DLPax_Nal_f</span><span class="op">$</span><span class="va">pred</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/View.html">View</a></span><span class="op">(</span><span class="va">Pronostico_Arima</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">Pronostico_Arima</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Periodo</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Pax_Nal_f</span>, color <span class="op">=</span> <span class="st">"Pax_Nal_f"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html">geom_line</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">Pax_Nal</span>, color <span class="op">=</span> <span class="st">"Pax_Nal"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_color_brewer</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"qual"</span>, palette <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>legend.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guides.html">guides</a></span><span class="op">(</span>col <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/guide_legend.html">guide_legend</a></span><span class="op">(</span>nrow <span class="op">=</span> <span class="fl">1</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">xlab</a></span><span class="op">(</span><span class="st">"Tiempo"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ylab</a></span><span class="op">(</span><span class="st">"Pasajeros"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">11</span>, face <span class="op">=</span> <span class="st">"bold"</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.subtitle <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.caption <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">10</span>, hjust <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>plot.margin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html">unit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, <span class="st">"cm"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Pasajeros en vuelos nacionales (Salidas)"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"(Ene-2000 a Jun-2019)"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Fuente: Elaboración propia"</span></span>
<span>  <span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Removed 24 row(s) containing missing values</span></span>
<span><span class="co">#&gt; (geom_path).</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<span style="display:block;" id="fig:PaxNalf"></span>
<img src="03-PE_Univariados_files/figure-html/PaxNalf-1.png" alt="Pronóstico de la serie $PaxNAl_t$ a partir de una ARMA(4,6) en diferencias logaritmicas." width="100%"><p class="caption">
Figure 4.17: Pronóstico de la serie <span class="math inline">\(PaxNAl_t\)</span> a partir de una ARMA(4,6) en diferencias logaritmicas.
</p>
</div>

</div>
</div>

  <div class="chapter-nav">
<div class="prev"><a href="modelos-de-series-de-tiempo-estacionarias.html"><span class="header-section-number">3</span> Modelos de Series de Tiempo Estacionarias</a></div>
<div class="next"><a href="desestacionalizaci%C3%B3n-y-filtrado-de-series.html"><span class="header-section-number">5</span> Desestacionalización y filtrado de Series</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#procesos-estacionarios-univariados"><span class="header-section-number">4</span> Procesos estacionarios univariados</a></li>
<li>
<a class="nav-link" href="#procesos-autoregresivos-ar"><span class="header-section-number">4.1</span> Procesos Autoregresivos (AR)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ar1"><span class="header-section-number">4.1.1</span> AR(1)</a></li>
<li><a class="nav-link" href="#ar2"><span class="header-section-number">4.1.2</span> AR(2)</a></li>
<li><a class="nav-link" href="#arp"><span class="header-section-number">4.1.3</span> AR(p)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#procesos-de-medias-m%C3%B3viles-ma"><span class="header-section-number">4.2</span> Procesos de Medias Móviles (MA)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#ma1"><span class="header-section-number">4.2.1</span> MA(1)</a></li>
<li><a class="nav-link" href="#maq"><span class="header-section-number">4.2.2</span> MA(q)</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#procesos-armap-q-y-arimap-d-q"><span class="header-section-number">4.3</span> Procesos ARMA(p, q) y ARIMA(p, d, q)</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#arma1-1"><span class="header-section-number">4.3.1</span> ARMA(1, 1)</a></li>
<li><a class="nav-link" href="#armap-q"><span class="header-section-number">4.3.2</span> ARMA(p, q)</a></li>
</ul>
</li>
<li><a class="nav-link" href="#funci%C3%B3n-de-autocorrelaci%C3%B3n-parcial"><span class="header-section-number">4.4</span> Función de Autocorrelación Parcial</a></li>
<li><a class="nav-link" href="#selecci%C3%B3n-de-las-constantes-p-q-d-en-un-arp-un-maq-un-armap-q-o-un-arimap-d-q"><span class="header-section-number">4.5</span> Selección de las constantes p, q, d en un AR(p), un MA(q), un ARMA(p, q) o un ARIMA(p, d, q)</a></li>
<li><a class="nav-link" href="#pron%C3%B3sticos"><span class="header-section-number">4.6</span> Pronósticos</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="git@github.com:emilianoprzcls/bookdown-notas-series-de-tiempo.git/blob/master/03-PE_Univariados.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="git@github.com:emilianoprzcls/bookdown-notas-series-de-tiempo.git/edit/master/03-PE_Univariados.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Notas de Clase: Series de Tiempo</strong>" was written by Benjamín Oliva, Omar Alfaro-Rivera y Emiliano Pérez Caullieres. It was last built on 2022-08-13.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
